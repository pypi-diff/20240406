# Comparing `tmp/sae-vis-0.2.7.tar.gz` & `tmp/sae-vis-0.2.8.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "sae-vis-0.2.7.tar", last modified: Sat Apr  6 14:21:39 2024, max compression
+gzip compressed data, was "sae-vis-0.2.8.tar", last modified: Sat Apr  6 16:00:54 2024, max compression
```

## Comparing `sae-vis-0.2.7.tar` & `sae-vis-0.2.8.tar`

### file list

```diff
@@ -1,48 +1,48 @@
-drwxrwxrwx   0        0        0        0 2024-04-06 14:21:39.848043 sae-vis-0.2.7/
--rw-rw-rw-   0        0        0     1092 2024-04-06 14:20:39.000000 sae-vis-0.2.7/LICENSE
--rw-rw-rw-   0        0        0       27 2024-02-21 04:51:02.000000 sae-vis-0.2.7/MANIFEST.in
--rw-rw-rw-   0        0        0      377 2024-04-06 14:21:39.847041 sae-vis-0.2.7/PKG-INFO
--rw-rw-rw-   0        0        0     2636 2024-03-29 09:56:38.000000 sae-vis-0.2.7/README.md
-drwxrwxrwx   0        0        0        0 2024-04-06 14:21:39.618728 sae-vis-0.2.7/sae_vis/
--rw-rw-rw-   0        0        0      165 2024-02-21 04:27:15.000000 sae-vis-0.2.7/sae_vis/__init__.py
-drwxrwxrwx   0        0        0        0 2024-04-06 14:21:39.669736 sae-vis-0.2.7/sae_vis/__pycache__/
--rw-rw-rw-   0        0        0      373 2024-02-21 16:51:55.000000 sae-vis-0.2.7/sae_vis/__pycache__/__init__.cpython-311.pyc
--rw-rw-rw-   0        0        0    23307 2024-03-30 20:39:51.000000 sae-vis-0.2.7/sae_vis/__pycache__/data_config_classes.cpython-311.pyc
--rw-rw-rw-   0        0        0    48089 2024-03-31 11:17:20.000000 sae-vis-0.2.7/sae_vis/__pycache__/data_fetching_fns.cpython-311.pyc
--rw-rw-rw-   0        0        0    57756 2024-03-30 20:39:51.000000 sae-vis-0.2.7/sae_vis/__pycache__/data_storing_fns.cpython-311.pyc
--rw-rw-rw-   0        0        0    13155 2024-03-30 20:39:51.000000 sae-vis-0.2.7/sae_vis/__pycache__/html_fns.cpython-311.pyc
--rw-rw-rw-   0        0        0    13355 2024-03-30 10:24:03.000000 sae-vis-0.2.7/sae_vis/__pycache__/model_fns.cpython-311.pyc
--rw-rw-rw-   0        0        0    46162 2024-03-31 15:33:46.000000 sae-vis-0.2.7/sae_vis/__pycache__/utils_fns.cpython-311.pyc
-drwxrwxrwx   0        0        0        0 2024-04-06 14:21:39.698245 sae-vis-0.2.7/sae_vis/css/
--rw-rw-rw-   0        0        0      796 2024-03-24 10:41:36.000000 sae-vis-0.2.7/sae_vis/css/dropdown.css
--rw-rw-rw-   0        0        0     1289 2024-03-17 20:10:53.000000 sae-vis-0.2.7/sae_vis/css/general.css
--rw-rw-rw-   0        0        0     1464 2024-03-17 15:54:46.000000 sae-vis-0.2.7/sae_vis/css/sequences.css
--rw-rw-rw-   0        0        0     1671 2024-03-17 18:07:59.000000 sae-vis-0.2.7/sae_vis/css/tables.css
--rw-rw-rw-   0        0        0    17143 2024-03-30 20:16:23.000000 sae-vis-0.2.7/sae_vis/data_config_classes.py
--rw-rw-rw-   0        0        0    47062 2024-03-31 11:16:12.000000 sae-vis-0.2.7/sae_vis/data_fetching_fns.py
--rw-rw-rw-   0        0        0    50059 2024-03-30 20:35:07.000000 sae-vis-0.2.7/sae_vis/data_storing_fns.py
-drwxrwxrwx   0        0        0        0 2024-04-06 14:21:39.741248 sae-vis-0.2.7/sae_vis/html/
--rw-rw-rw-   0        0        0      137 2024-03-17 17:41:09.000000 sae-vis-0.2.7/sae_vis/html/acts_histogram_template.html
--rw-rw-rw-   0        0        0       87 2024-03-17 17:41:07.000000 sae-vis-0.2.7/sae_vis/html/feature_tables_template.html
--rw-rw-rw-   0        0        0      125 2024-03-17 17:40:27.000000 sae-vis-0.2.7/sae_vis/html/logits_histogram_template.html
--rw-rw-rw-   0        0        0       78 2024-03-17 17:40:08.000000 sae-vis-0.2.7/sae_vis/html/logits_table_template.html
--rw-rw-rw-   0        0        0       79 2024-03-17 17:43:18.000000 sae-vis-0.2.7/sae_vis/html/sequences_group_template.html
--rw-rw-rw-   0        0        0    13674 2024-04-01 09:31:33.000000 sae-vis-0.2.7/sae_vis/html_fns.py
-drwxrwxrwx   0        0        0        0 2024-04-06 14:21:39.846042 sae-vis-0.2.7/sae_vis/js/
--rw-rw-rw-   0        0        0     4378 2024-03-24 10:12:02.000000 sae-vis-0.2.7/sae_vis/js/_createDropdownsScript.js
--rw-rw-rw-   0        0        0     3077 2024-03-24 09:43:39.000000 sae-vis-0.2.7/sae_vis/js/actsHistogramScript.js
--rw-rw-rw-   0        0        0     2961 2024-03-17 16:48:44.000000 sae-vis-0.2.7/sae_vis/js/featureTablesScript.js
--rw-rw-rw-   0        0        0      533 2024-03-17 19:15:57.000000 sae-vis-0.2.7/sae_vis/js/gridColumnTitlesScript.js
--rw-rw-rw-   0        0        0     3512 2024-03-24 09:43:08.000000 sae-vis-0.2.7/sae_vis/js/logitsHistogramScript.js
--rw-rw-rw-   0        0        0     2769 2024-03-17 16:48:34.000000 sae-vis-0.2.7/sae_vis/js/logitsTableScript.js
--rw-rw-rw-   0        0        0    10991 2024-03-24 09:55:09.000000 sae-vis-0.2.7/sae_vis/js/tokenScript.js
--rw-rw-rw-   0        0        0     8967 2024-04-01 10:10:41.000000 sae-vis-0.2.7/sae_vis/model_fns.py
--rw-rw-rw-   0        0        0    34976 2024-04-05 11:44:02.000000 sae-vis-0.2.7/sae_vis/utils_fns.py
-drwxrwxrwx   0        0        0        0 2024-04-06 14:21:39.658727 sae-vis-0.2.7/sae_vis.egg-info/
--rw-rw-rw-   0        0        0      377 2024-04-06 14:21:39.000000 sae-vis-0.2.7/sae_vis.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     1252 2024-04-06 14:21:39.000000 sae-vis-0.2.7/sae_vis.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-04-06 14:21:39.000000 sae-vis-0.2.7/sae_vis.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       49 2024-04-06 14:21:39.000000 sae-vis-0.2.7/sae_vis.egg-info/requires.txt
--rw-rw-rw-   0        0        0        8 2024-04-06 14:21:39.000000 sae-vis-0.2.7/sae_vis.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2024-04-06 14:21:39.848043 sae-vis-0.2.7/setup.cfg
--rw-rw-rw-   0        0        0      842 2024-04-06 14:20:50.000000 sae-vis-0.2.7/setup.py
+drwxrwxrwx   0        0        0        0 2024-04-06 16:00:54.057817 sae-vis-0.2.8/
+-rw-rw-rw-   0        0        0     1092 2024-04-06 14:20:39.000000 sae-vis-0.2.8/LICENSE
+-rw-rw-rw-   0        0        0       27 2024-02-21 04:51:02.000000 sae-vis-0.2.8/MANIFEST.in
+-rw-rw-rw-   0        0        0     1305 2024-04-06 16:00:54.056816 sae-vis-0.2.8/PKG-INFO
+-rw-rw-rw-   0        0        0     2636 2024-03-29 09:56:38.000000 sae-vis-0.2.8/README.md
+drwxrwxrwx   0        0        0        0 2024-04-06 16:00:53.994294 sae-vis-0.2.8/sae_vis/
+-rw-rw-rw-   0        0        0      165 2024-02-21 04:27:15.000000 sae-vis-0.2.8/sae_vis/__init__.py
+drwxrwxrwx   0        0        0        0 2024-04-06 16:00:54.038301 sae-vis-0.2.8/sae_vis/__pycache__/
+-rw-rw-rw-   0        0        0      373 2024-02-21 16:51:55.000000 sae-vis-0.2.8/sae_vis/__pycache__/__init__.cpython-311.pyc
+-rw-rw-rw-   0        0        0    24181 2024-04-06 15:28:15.000000 sae-vis-0.2.8/sae_vis/__pycache__/data_config_classes.cpython-311.pyc
+-rw-rw-rw-   0        0        0    50492 2024-04-06 15:40:47.000000 sae-vis-0.2.8/sae_vis/__pycache__/data_fetching_fns.cpython-311.pyc
+-rw-rw-rw-   0        0        0    58256 2024-04-06 15:40:47.000000 sae-vis-0.2.8/sae_vis/__pycache__/data_storing_fns.cpython-311.pyc
+-rw-rw-rw-   0        0        0    13155 2024-04-06 15:09:38.000000 sae-vis-0.2.8/sae_vis/__pycache__/html_fns.cpython-311.pyc
+-rw-rw-rw-   0        0        0    13416 2024-04-06 15:09:38.000000 sae-vis-0.2.8/sae_vis/__pycache__/model_fns.cpython-311.pyc
+-rw-rw-rw-   0        0        0    47426 2024-04-06 15:40:47.000000 sae-vis-0.2.8/sae_vis/__pycache__/utils_fns.cpython-311.pyc
+drwxrwxrwx   0        0        0        0 2024-04-06 16:00:54.042818 sae-vis-0.2.8/sae_vis/css/
+-rw-rw-rw-   0        0        0      796 2024-03-24 10:41:36.000000 sae-vis-0.2.8/sae_vis/css/dropdown.css
+-rw-rw-rw-   0        0        0     1289 2024-03-17 20:10:53.000000 sae-vis-0.2.8/sae_vis/css/general.css
+-rw-rw-rw-   0        0        0     1464 2024-03-17 15:54:46.000000 sae-vis-0.2.8/sae_vis/css/sequences.css
+-rw-rw-rw-   0        0        0     1671 2024-03-17 18:07:59.000000 sae-vis-0.2.8/sae_vis/css/tables.css
+-rw-rw-rw-   0        0        0    18023 2024-04-06 15:22:47.000000 sae-vis-0.2.8/sae_vis/data_config_classes.py
+-rw-rw-rw-   0        0        0    49956 2024-04-06 15:36:52.000000 sae-vis-0.2.8/sae_vis/data_fetching_fns.py
+-rw-rw-rw-   0        0        0    49922 2024-04-06 15:35:49.000000 sae-vis-0.2.8/sae_vis/data_storing_fns.py
+drwxrwxrwx   0        0        0        0 2024-04-06 16:00:54.048814 sae-vis-0.2.8/sae_vis/html/
+-rw-rw-rw-   0        0        0      137 2024-03-17 17:41:09.000000 sae-vis-0.2.8/sae_vis/html/acts_histogram_template.html
+-rw-rw-rw-   0        0        0       87 2024-03-17 17:41:07.000000 sae-vis-0.2.8/sae_vis/html/feature_tables_template.html
+-rw-rw-rw-   0        0        0      125 2024-03-17 17:40:27.000000 sae-vis-0.2.8/sae_vis/html/logits_histogram_template.html
+-rw-rw-rw-   0        0        0       78 2024-03-17 17:40:08.000000 sae-vis-0.2.8/sae_vis/html/logits_table_template.html
+-rw-rw-rw-   0        0        0       79 2024-03-17 17:43:18.000000 sae-vis-0.2.8/sae_vis/html/sequences_group_template.html
+-rw-rw-rw-   0        0        0    13674 2024-04-01 09:31:33.000000 sae-vis-0.2.8/sae_vis/html_fns.py
+drwxrwxrwx   0        0        0        0 2024-04-06 16:00:54.055813 sae-vis-0.2.8/sae_vis/js/
+-rw-rw-rw-   0        0        0     4378 2024-03-24 10:12:02.000000 sae-vis-0.2.8/sae_vis/js/_createDropdownsScript.js
+-rw-rw-rw-   0        0        0     3077 2024-03-24 09:43:39.000000 sae-vis-0.2.8/sae_vis/js/actsHistogramScript.js
+-rw-rw-rw-   0        0        0     3083 2024-04-06 15:06:27.000000 sae-vis-0.2.8/sae_vis/js/featureTablesScript.js
+-rw-rw-rw-   0        0        0      533 2024-03-17 19:15:57.000000 sae-vis-0.2.8/sae_vis/js/gridColumnTitlesScript.js
+-rw-rw-rw-   0        0        0     3512 2024-03-24 09:43:08.000000 sae-vis-0.2.8/sae_vis/js/logitsHistogramScript.js
+-rw-rw-rw-   0        0        0     2769 2024-03-17 16:48:34.000000 sae-vis-0.2.8/sae_vis/js/logitsTableScript.js
+-rw-rw-rw-   0        0        0    10991 2024-03-24 09:55:09.000000 sae-vis-0.2.8/sae_vis/js/tokenScript.js
+-rw-rw-rw-   0        0        0     8967 2024-04-01 10:10:41.000000 sae-vis-0.2.8/sae_vis/model_fns.py
+-rw-rw-rw-   0        0        0    36140 2024-04-06 15:40:24.000000 sae-vis-0.2.8/sae_vis/utils_fns.py
+drwxrwxrwx   0        0        0        0 2024-04-06 16:00:54.026296 sae-vis-0.2.8/sae_vis.egg-info/
+-rw-rw-rw-   0        0        0     1305 2024-04-06 16:00:53.000000 sae-vis-0.2.8/sae_vis.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     1252 2024-04-06 16:00:53.000000 sae-vis-0.2.8/sae_vis.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-04-06 16:00:53.000000 sae-vis-0.2.8/sae_vis.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       49 2024-04-06 16:00:53.000000 sae-vis-0.2.8/sae_vis.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        8 2024-04-06 16:00:53.000000 sae-vis-0.2.8/sae_vis.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2024-04-06 16:00:54.057817 sae-vis-0.2.8/setup.cfg
+-rw-rw-rw-   0        0        0     1648 2024-04-06 15:13:21.000000 sae-vis-0.2.8/setup.py
```

### Comparing `sae-vis-0.2.7/LICENSE` & `sae-vis-0.2.8/LICENSE`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/README.md` & `sae-vis-0.2.8/README.md`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/__pycache__/data_config_classes.cpython-311.pyc` & `sae-vis-0.2.8/sae_vis/__pycache__/data_config_classes.cpython-311.pyc`

 * *Files 6% similar despite different names*

#### Python bytecode

```diff
@@ -1,42 +1,42 @@
 magic:    0xa70d0d0a
-moddate:  0x17730866 (Sat Mar 30 20:16:23 2024 UTC)
-files sz: 17143
+moddate:  0xc7681166 (Sat Apr  6 15:22:47 2024 UTC)
+files sz: 18023
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 10
    flags     : 0
    code
       0x9700640064016c006d015a016d025a026d035a030100640064026c046d
       055a056d065a060100640064036c076d085a086d095a096d0a5a0a6d0b5a
       0b6d0c5a0c6d0d5a0d0100640064046c0e6d0f5a100100640064056c116d
       125a120100640064066c136d145a14010002006515640764086409640a64
       0b640c640d640eac0fa6080000ab0800000000000000005a160200651564
       10ac11a6010000ab0100000000000000005a17020065156410ac11a60100
       00ab0100000000000000005a18020065156412ac13a6010000ab01000000
-      00000000005a19020065156414ac13a6010000ab0100000000000000005a
-      1a650102004700641584006416a6020000ab020000000000000000a60000
-      00ab0000000000000000005a1b650102004700641784006418651ba60300
-      00ab030000000000000000a6000000ab0000000000000000005a1c650102
-      00470064198400641a651ba6030000ab030000000000000000a6000000ab
-      0000000000000000005a1d650102004700641b8400641c651ba6030000ab
-      030000000000000000a6000000ab0000000000000000005a1e6501020047
-      00641d8400641e651ba6030000ab030000000000000000a6000000ab0000
-      000000000000005a1f650102004700641f84006420651ba6030000ab0300
-      00000000000000a6000000ab0000000000000000005a2065010200470064
-      2184006422651ba6030000ab030000000000000000a6000000ab00000000
-      00000000005a21650a651c651d651e651f65206521660619000000000000
-      0000005a2202004700642384006424a6020000ab0200000000000000005a
-      236505650102004700642584006426a6020000ab020000000000000000a6
-      000000ab000000000000000000a6000000ab0000000000000000005a2464
-      275a250200651564286429642a642b642c642d642eac2fa6070000ab0700
-      000000000000005a266505650102004700643084006431a6020000ab0200
+      00000000005a190200651564146415641664176418ac19a6050000ab0500
+      000000000000005a1a650102004700641a8400641ba6020000ab02000000
+      0000000000a6000000ab0000000000000000005a1b650102004700641c84
+      00641d651ba6030000ab030000000000000000a6000000ab000000000000
+      0000005a1c650102004700641e8400641f651ba6030000ab030000000000
+      000000a6000000ab0000000000000000005a1d6501020047006420840064
+      21651ba6030000ab030000000000000000a6000000ab0000000000000000
+      005a1e650102004700642284006423651ba6030000ab0300000000000000
+      00a6000000ab0000000000000000005a1f65010200470064248400642565
+      1ba6030000ab030000000000000000a6000000ab0000000000000000005a
+      20650102004700642684006427651ba6030000ab030000000000000000a6
+      000000ab0000000000000000005a21650a651c651d651e651f6520652166
+      06190000000000000000005a2202004700642884006429a6020000ab0200
+      000000000000005a236505650102004700642a8400642ba6020000ab0200
       00000000000000a6000000ab000000000000000000a6000000ab00000000
-      00000000005a2764325300
+      00000000005a24642c5a2502006515642d642e642f6430643164326433ac
+      34a6070000ab0700000000000000005a2665056501020047006435840064
+      36a6020000ab020000000000000000a6000000ab000000000000000000a6
+      000000ab0000000000000000005a2764375300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('dataclass', 'asdict', 'field'))
                  6 IMPORT_NAME              0 (dataclasses)
                  8 IMPORT_FROM              1 (dataclass)
                 10 STORE_NAME               1 (dataclass)
@@ -148,224 +148,232 @@
                214 STORE_NAME              25 (LOGITS_TABLE_CONFIG_HELP)
    
     37         216 PUSH_NULL
                218 LOAD_NAME               21 (dict)
    
     38         220 LOAD_CONST              20 ('Number of rows to show for each feature table.')
    
-    37         222 KW_NAMES                19
-               224 PRECALL                  1
-               228 CALL                     1
-               238 STORE_NAME              26 (FEATURE_TABLES_CONFIG_HELP)
+    39         222 LOAD_CONST              21 ('Whether to show the neuron alignment table.')
    
-    41         240 LOAD_NAME                1 (dataclass)
+    40         224 LOAD_CONST              22 ('Whether to show the correlated neurons table.')
    
-    42         242 PUSH_NULL
-               244 LOAD_BUILD_CLASS
-               246 LOAD_CONST              21 (<code object BaseComponentConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 41>)
-               248 MAKE_FUNCTION            0
-               250 LOAD_CONST              22 ('BaseComponentConfig')
-               252 PRECALL                  2
-               256 CALL                     2
+    41         226 LOAD_CONST              23 ('Whether to show the (pairwise) correlated features table.')
    
-    41         266 PRECALL                  0
-               270 CALL                     0
+    42         228 LOAD_CONST              24 ('Whether to show the correlated encoder-B features table.')
    
-    42         280 STORE_NAME              27 (BaseComponentConfig)
+    37         230 KW_NAMES                25
+               232 PRECALL                  5
+               236 CALL                     5
+               246 STORE_NAME              26 (FEATURE_TABLES_CONFIG_HELP)
    
-    62         282 LOAD_NAME                1 (dataclass)
+    45         248 LOAD_NAME                1 (dataclass)
    
-    63         284 PUSH_NULL
-               286 LOAD_BUILD_CLASS
-               288 LOAD_CONST              23 (<code object PromptConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 62>)
-               290 MAKE_FUNCTION            0
-               292 LOAD_CONST              24 ('PromptConfig')
-               294 LOAD_NAME               27 (BaseComponentConfig)
-               296 PRECALL                  3
-               300 CALL                     3
+    46         250 PUSH_NULL
+               252 LOAD_BUILD_CLASS
+               254 LOAD_CONST              26 (<code object BaseComponentConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 45>)
+               256 MAKE_FUNCTION            0
+               258 LOAD_CONST              27 ('BaseComponentConfig')
+               260 PRECALL                  2
+               264 CALL                     2
    
-    62         310 PRECALL                  0
-               314 CALL                     0
+    45         274 PRECALL                  0
+               278 CALL                     0
    
-    63         324 STORE_NAME              28 (PromptConfig)
+    46         288 STORE_NAME              27 (BaseComponentConfig)
    
-    67         326 LOAD_NAME                1 (dataclass)
+    66         290 LOAD_NAME                1 (dataclass)
    
-    68         328 PUSH_NULL
-               330 LOAD_BUILD_CLASS
-               332 LOAD_CONST              25 (<code object SequencesConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 67>)
-               334 MAKE_FUNCTION            0
-               336 LOAD_CONST              26 ('SequencesConfig')
-               338 LOAD_NAME               27 (BaseComponentConfig)
-               340 PRECALL                  3
-               344 CALL                     3
+    67         292 PUSH_NULL
+               294 LOAD_BUILD_CLASS
+               296 LOAD_CONST              28 (<code object PromptConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 66>)
+               298 MAKE_FUNCTION            0
+               300 LOAD_CONST              29 ('PromptConfig')
+               302 LOAD_NAME               27 (BaseComponentConfig)
+               304 PRECALL                  3
+               308 CALL                     3
    
-    67         354 PRECALL                  0
-               358 CALL                     0
+    66         318 PRECALL                  0
+               322 CALL                     0
    
-    68         368 STORE_NAME              29 (SequencesConfig)
+    67         332 STORE_NAME              28 (PromptConfig)
    
-    99         370 LOAD_NAME                1 (dataclass)
+    71         334 LOAD_NAME                1 (dataclass)
    
-   100         372 PUSH_NULL
-               374 LOAD_BUILD_CLASS
-               376 LOAD_CONST              27 (<code object ActsHistogramConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 99>)
-               378 MAKE_FUNCTION            0
-               380 LOAD_CONST              28 ('ActsHistogramConfig')
-               382 LOAD_NAME               27 (BaseComponentConfig)
-               384 PRECALL                  3
-               388 CALL                     3
+    72         336 PUSH_NULL
+               338 LOAD_BUILD_CLASS
+               340 LOAD_CONST              30 (<code object SequencesConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 71>)
+               342 MAKE_FUNCTION            0
+               344 LOAD_CONST              31 ('SequencesConfig')
+               346 LOAD_NAME               27 (BaseComponentConfig)
+               348 PRECALL                  3
+               352 CALL                     3
    
-    99         398 PRECALL                  0
-               402 CALL                     0
+    71         362 PRECALL                  0
+               366 CALL                     0
    
-   100         412 STORE_NAME              30 (ActsHistogramConfig)
+    72         376 STORE_NAME              29 (SequencesConfig)
    
-   112         414 LOAD_NAME                1 (dataclass)
+   103         378 LOAD_NAME                1 (dataclass)
    
-   113         416 PUSH_NULL
-               418 LOAD_BUILD_CLASS
-               420 LOAD_CONST              29 (<code object LogitsHistogramConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 112>)
-               422 MAKE_FUNCTION            0
-               424 LOAD_CONST              30 ('LogitsHistogramConfig')
-               426 LOAD_NAME               27 (BaseComponentConfig)
-               428 PRECALL                  3
-               432 CALL                     3
+   104         380 PUSH_NULL
+               382 LOAD_BUILD_CLASS
+               384 LOAD_CONST              32 (<code object ActsHistogramConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 103>)
+               386 MAKE_FUNCTION            0
+               388 LOAD_CONST              33 ('ActsHistogramConfig')
+               390 LOAD_NAME               27 (BaseComponentConfig)
+               392 PRECALL                  3
+               396 CALL                     3
    
-   112         442 PRECALL                  0
-               446 CALL                     0
+   103         406 PRECALL                  0
+               410 CALL                     0
    
-   113         456 STORE_NAME              31 (LogitsHistogramConfig)
+   104         420 STORE_NAME              30 (ActsHistogramConfig)
    
-   125         458 LOAD_NAME                1 (dataclass)
+   116         422 LOAD_NAME                1 (dataclass)
    
-   126         460 PUSH_NULL
-               462 LOAD_BUILD_CLASS
-               464 LOAD_CONST              31 (<code object LogitsTableConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 125>)
-               466 MAKE_FUNCTION            0
-               468 LOAD_CONST              32 ('LogitsTableConfig')
-               470 LOAD_NAME               27 (BaseComponentConfig)
-               472 PRECALL                  3
-               476 CALL                     3
+   117         424 PUSH_NULL
+               426 LOAD_BUILD_CLASS
+               428 LOAD_CONST              34 (<code object LogitsHistogramConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 116>)
+               430 MAKE_FUNCTION            0
+               432 LOAD_CONST              35 ('LogitsHistogramConfig')
+               434 LOAD_NAME               27 (BaseComponentConfig)
+               436 PRECALL                  3
+               440 CALL                     3
    
-   125         486 PRECALL                  0
-               490 CALL                     0
+   116         450 PRECALL                  0
+               454 CALL                     0
    
-   126         500 STORE_NAME              32 (LogitsTableConfig)
+   117         464 STORE_NAME              31 (LogitsHistogramConfig)
    
-   138         502 LOAD_NAME                1 (dataclass)
+   129         466 LOAD_NAME                1 (dataclass)
    
-   139         504 PUSH_NULL
-               506 LOAD_BUILD_CLASS
-               508 LOAD_CONST              33 (<code object FeatureTablesConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 138>)
-               510 MAKE_FUNCTION            0
-               512 LOAD_CONST              34 ('FeatureTablesConfig')
-               514 LOAD_NAME               27 (BaseComponentConfig)
-               516 PRECALL                  3
-               520 CALL                     3
+   130         468 PUSH_NULL
+               470 LOAD_BUILD_CLASS
+               472 LOAD_CONST              36 (<code object LogitsTableConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 129>)
+               474 MAKE_FUNCTION            0
+               476 LOAD_CONST              37 ('LogitsTableConfig')
+               478 LOAD_NAME               27 (BaseComponentConfig)
+               480 PRECALL                  3
+               484 CALL                     3
    
-   138         530 PRECALL                  0
-               534 CALL                     0
+   129         494 PRECALL                  0
+               498 CALL                     0
    
-   139         544 STORE_NAME              33 (FeatureTablesConfig)
+   130         508 STORE_NAME              32 (LogitsTableConfig)
    
-   151         546 LOAD_NAME               10 (Union)
+   142         510 LOAD_NAME                1 (dataclass)
    
-   152         548 LOAD_NAME               28 (PromptConfig)
+   143         512 PUSH_NULL
+               514 LOAD_BUILD_CLASS
+               516 LOAD_CONST              38 (<code object FeatureTablesConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 142>)
+               518 MAKE_FUNCTION            0
+               520 LOAD_CONST              39 ('FeatureTablesConfig')
+               522 LOAD_NAME               27 (BaseComponentConfig)
+               524 PRECALL                  3
+               528 CALL                     3
    
-   153         550 LOAD_NAME               29 (SequencesConfig)
+   142         538 PRECALL                  0
+               542 CALL                     0
    
-   154         552 LOAD_NAME               30 (ActsHistogramConfig)
+   143         552 STORE_NAME              33 (FeatureTablesConfig)
    
-   155         554 LOAD_NAME               31 (LogitsHistogramConfig)
+   165         554 LOAD_NAME               10 (Union)
    
-   156         556 LOAD_NAME               32 (LogitsTableConfig)
+   166         556 LOAD_NAME               28 (PromptConfig)
    
-   157         558 LOAD_NAME               33 (FeatureTablesConfig)
+   167         558 LOAD_NAME               29 (SequencesConfig)
    
-   152         560 BUILD_TUPLE              6
+   168         560 LOAD_NAME               30 (ActsHistogramConfig)
    
-   151         562 BINARY_SUBSCR
-               572 STORE_NAME              34 (GenericComponentConfig)
+   169         562 LOAD_NAME               31 (LogitsHistogramConfig)
    
-   160         574 PUSH_NULL
-               576 LOAD_BUILD_CLASS
-               578 LOAD_CONST              35 (<code object Column, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 160>)
-               580 MAKE_FUNCTION            0
-               582 LOAD_CONST              36 ('Column')
-               584 PRECALL                  2
-               588 CALL                     2
-               598 STORE_NAME              35 (Column)
+   170         564 LOAD_NAME               32 (LogitsTableConfig)
    
-   181         600 LOAD_NAME                5 (dataclass_json)
+   171         566 LOAD_NAME               33 (FeatureTablesConfig)
    
-   182         602 LOAD_NAME                1 (dataclass)
+   166         568 BUILD_TUPLE              6
    
-   183         604 PUSH_NULL
-               606 LOAD_BUILD_CLASS
-               608 LOAD_CONST              37 (<code object SaeVisLayoutConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 181>)
-               610 MAKE_FUNCTION            0
-               612 LOAD_CONST              38 ('SaeVisLayoutConfig')
-               614 PRECALL                  2
-               618 CALL                     2
+   165         570 BINARY_SUBSCR
+               580 STORE_NAME              34 (GenericComponentConfig)
    
-   182         628 PRECALL                  0
-               632 CALL                     0
+   174         582 PUSH_NULL
+               584 LOAD_BUILD_CLASS
+               586 LOAD_CONST              40 (<code object Column, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 174>)
+               588 MAKE_FUNCTION            0
+               590 LOAD_CONST              41 ('Column')
+               592 PRECALL                  2
+               596 CALL                     2
+               606 STORE_NAME              35 (Column)
    
-   181         642 PRECALL                  0
-               646 CALL                     0
+   195         608 LOAD_NAME                5 (dataclass_json)
    
-   183         656 STORE_NAME              36 (SaeVisLayoutConfig)
+   196         610 LOAD_NAME                1 (dataclass)
    
-   345         658 LOAD_CONST              39 ('Key: \n  the tree shows which components will be displayed in each column (from left to right)\n  arguments are [b #00aa00]green[/]\n  arguments changed from their default are [b dark_orange]orange[/], with default in brackets\n  argument descriptions are in [i]italics[/i]\n')
-               660 STORE_NAME              37 (KEY_LAYOUT_VIS)
+   197         612 PUSH_NULL
+               614 LOAD_BUILD_CLASS
+               616 LOAD_CONST              42 (<code object SaeVisLayoutConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 195>)
+               618 MAKE_FUNCTION            0
+               620 LOAD_CONST              43 ('SaeVisLayoutConfig')
+               622 PRECALL                  2
+               626 CALL                     2
    
-   353         662 PUSH_NULL
-               664 LOAD_NAME               21 (dict)
+   196         636 PRECALL                  0
+               640 CALL                     0
    
-   354         666 LOAD_CONST              40 ('The hook point to use for the SAE')
+   195         650 PRECALL                  0
+               654 CALL                     0
    
-   355         668 LOAD_CONST              41 ("The set of features which we'll be gathering data for. If an integer, we only get data for 1 feature")
+   197         664 STORE_NAME              36 (SaeVisLayoutConfig)
    
-   356         670 LOAD_CONST              42 ("The number of sequences we'll gather data for. If supplied then it can't be larger than `tokens[0]`, if not then we use all of `tokens`")
+   359         666 LOAD_CONST              44 ('Key: \n  the tree shows which components will be displayed in each column (from left to right)\n  arguments are [b #00aa00]green[/]\n  arguments changed from their default are [b dark_orange]orange[/], with default in brackets\n  argument descriptions are in [i]italics[/i]\n')
+               668 STORE_NAME              37 (KEY_LAYOUT_VIS)
    
-   358         672 LOAD_CONST              43 ("The minibatch size we'll use to split up the full batch during forward passes, to avoid OOMs.")
+   367         670 PUSH_NULL
+               672 LOAD_NAME               21 (dict)
    
-   360         674 LOAD_CONST              44 ("The feature minibatch size we'll use to split up our features, to avoid OOM errors")
+   368         674 LOAD_CONST              45 ('The hook point to use for the SAE')
    
-   361         676 LOAD_CONST              45 ('Random seed, for reproducibility (e.g. sampling quantiles)')
+   369         676 LOAD_CONST              46 ("The set of features which we'll be gathering data for. If an integer, we only get data for 1 feature")
    
-   362         678 LOAD_CONST              46 ('Whether to print out progress messages and other info during the data gathering process')
+   370         678 LOAD_CONST              47 ("The number of sequences we'll gather data for. If supplied then it can't be larger than `tokens[0]`, if not then we use all of `tokens`")
    
-   353         680 KW_NAMES                47
-               682 PRECALL                  7
-               686 CALL                     7
-               696 STORE_NAME              38 (SAE_CONFIG_DICT)
+   372         680 LOAD_CONST              48 ("The minibatch size we'll use to split up the full batch during forward passes, to avoid OOMs.")
    
-   366         698 LOAD_NAME                5 (dataclass_json)
+   374         682 LOAD_CONST              49 ("The feature minibatch size we'll use to split up our features, to avoid OOM errors")
    
-   367         700 LOAD_NAME                1 (dataclass)
+   375         684 LOAD_CONST              50 ('Random seed, for reproducibility (e.g. sampling quantiles)')
    
-   368         702 PUSH_NULL
-               704 LOAD_BUILD_CLASS
-               706 LOAD_CONST              48 (<code object SaeVisConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 366>)
-               708 MAKE_FUNCTION            0
-               710 LOAD_CONST              49 ('SaeVisConfig')
-               712 PRECALL                  2
-               716 CALL                     2
+   376         686 LOAD_CONST              51 ('Whether to print out progress messages and other info during the data gathering process')
    
-   367         726 PRECALL                  0
-               730 CALL                     0
+   367         688 KW_NAMES                52
+               690 PRECALL                  7
+               694 CALL                     7
+               704 STORE_NAME              38 (SAE_CONFIG_DICT)
    
-   366         740 PRECALL                  0
-               744 CALL                     0
+   380         706 LOAD_NAME                5 (dataclass_json)
    
-   368         754 STORE_NAME              39 (SaeVisConfig)
-               756 LOAD_CONST              50 (None)
-               758 RETURN_VALUE
+   381         708 LOAD_NAME                1 (dataclass)
+   
+   382         710 PUSH_NULL
+               712 LOAD_BUILD_CLASS
+               714 LOAD_CONST              53 (<code object SaeVisConfig, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 380>)
+               716 MAKE_FUNCTION            0
+               718 LOAD_CONST              54 ('SaeVisConfig')
+               720 PRECALL                  2
+               724 CALL                     2
+   
+   381         734 PRECALL                  0
+               738 CALL                     0
+   
+   380         748 PRECALL                  0
+               752 CALL                     0
+   
+   382         762 STORE_NAME              39 (SaeVisConfig)
+               764 LOAD_CONST              55 (None)
+               766 RETURN_VALUE
    consts
       0
       ('dataclass', 'asdict', 'field')
       ('dataclass_json', 'config')
       ('Optional', 'Iterable', 'Union', 'Literal', 'Iterator', 'Any')
       ('print',)
       ('Tree',)
@@ -380,132 +388,137 @@
       'Whether the hover information about a token appears below or above the token.'
       ('buffer', 'compute_buffer', 'n_quantiles', 'top_acts_group_size', 'quantile_group_size', 'top_logits_hoverdata', 'stack_mode', 'hover_below')
       'Number of bins for the histogram.'
       ('n_bins',)
       'Number of top/bottom logits to show in the table.'
       ('n_rows',)
       'Number of rows to show for each feature table.'
+      'Whether to show the neuron alignment table.'
+      'Whether to show the correlated neurons table.'
+      'Whether to show the (pairwise) correlated features table.'
+      'Whether to show the correlated encoder-B features table.'
+      ('n_rows', 'neuron_alignment_table', 'correlated_neurons_table', 'correlated_features_table', 'correlated_b_features_table')
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 5
          flags     : 0
          code
             0x970065005a0164005a02640165036602640284045a0465056401650665
             076507660219000000000000000000660264038404a6000000ab00000000
             00000000005a0864045300
-          41           0 RESUME                   0
+          45           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('BaseComponentConfig')
                        8 STORE_NAME               2 (__qualname__)
          
-          44          10 LOAD_CONST               1 ('return')
+          48          10 LOAD_CONST               1 ('return')
                       12 LOAD_NAME                3 (bool)
                       14 BUILD_TUPLE              2
-                      16 LOAD_CONST               2 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 44>)
+                      16 LOAD_CONST               2 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 48>)
                       18 MAKE_FUNCTION            4 (annotations)
                       20 STORE_NAME               4 (data_is_contained_in)
          
-          53          22 LOAD_NAME                5 (property)
+          57          22 LOAD_NAME                5 (property)
          
-          54          24 LOAD_CONST               1 ('return')
+          58          24 LOAD_CONST               1 ('return')
                       26 LOAD_NAME                6 (dict)
                       28 LOAD_NAME                7 (str)
                       30 LOAD_NAME                7 (str)
                       32 BUILD_TUPLE              2
                       34 BINARY_SUBSCR
                       44 BUILD_TUPLE              2
-                      46 LOAD_CONST               3 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 53>)
+                      46 LOAD_CONST               3 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 57>)
                       48 MAKE_FUNCTION            4 (annotations)
          
-          53          50 PRECALL                  0
+          57          50 PRECALL                  0
                       54 CALL                     0
          
-          54          64 STORE_NAME               8 (help_dict)
+          58          64 STORE_NAME               8 (help_dict)
                       66 LOAD_CONST               4 (None)
                       68 RETURN_VALUE
          consts
             'BaseComponentConfig'
             'return'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 1
                flags     : 3
                code 0x970064015300
-                44           0 RESUME                   0
+                48           0 RESUME                   0
                
-                51           2 LOAD_CONST               1 (True)
+                55           2 LOAD_CONST               1 (True)
                              4 RETURN_VALUE
                consts
                   "\n        This returns False only when the data that was computed based on `other` wouldn't be enough to show the data\n        that was computed based on `self`. For instance, if `self` was a config object with 10 rows, and `other` had\n        just 5 rows, then this would return False. A less obvious example: if `self` was a histogram config with 50 bins\n        then `other` would need to have exactly 50 bins (because we can't change the bins after generating them).\n        "
                   True
                names      ()
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'data_is_contained_in'
-               firstlineno 44
+               firstlineno 48
                lnotab 0x0207
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x970069005300
-                53           0 RESUME                   0
+                57           0 RESUME                   0
                
-                59           2 BUILD_MAP                0
+                63           2 BUILD_MAP                0
                              4 RETURN_VALUE
                consts
                   '\n        This is a dictionary which maps the name of each argument to a description of what it does. This is used when\n        printing out the help for a config object, to show what each argument does.\n        '
                names      ()
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help_dict'
-               firstlineno 53
+               firstlineno 57
                lnotab 0x0206
             None
          names      ('__name__', '__module__', '__qualname__', 'bool', 'data_is_contained_in', 'property', 'dict', 'str', 'help_dict')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'BaseComponentConfig'
-         firstlineno 41
+         firstlineno 45
          lnotab 0x0a030c0902011aff0e01
       'BaseComponentConfig'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 1
          flags     : 0
          code 0x970065005a0164005a0264015300
-          62           0 RESUME                   0
+          66           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('PromptConfig')
                        8 STORE_NAME               2 (__qualname__)
          
-          64          10 LOAD_CONST               1 (None)
+          68          10 LOAD_CONST               1 (None)
                       12 RETURN_VALUE
          consts
             'PromptConfig'
             None
          names      ('__name__', '__module__', '__qualname__')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'PromptConfig'
-         firstlineno 62
+         firstlineno 66
          lnotab 0x0a02
       'PromptConfig'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 5
          flags     : 0
@@ -514,110 +527,110 @@
             0000000000650664023c00000064035a076508650664043c00000064055a
             096505650664063c00000064075a0a6505650664083c00000064095a0b65
             056506640a3c00000064095a0c65056506640b3c000000640c5a0d650e64
             0d190000000000000000006506640e3c00000064035a0f65086506640f3c
             000000641065086602641184045a10641284005a11651264106513651465
             14660219000000000000000000660264138404a6000000ab000000000000
             0000005a1564145300
-          67           0 RESUME                   0
+          71           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('SequencesConfig')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-          69          12 LOAD_CONST               1 ((5, 5))
+          73          12 LOAD_CONST               1 ((5, 5))
                       14 STORE_NAME               3 (buffer)
                       16 LOAD_NAME                4 (tuple)
                       18 LOAD_NAME                5 (int)
                       20 LOAD_NAME                5 (int)
                       22 BUILD_TUPLE              2
                       24 BINARY_SUBSCR
                       34 LOAD_NAME                6 (__annotations__)
                       36 LOAD_CONST               2 ('buffer')
                       38 STORE_SUBSCR
          
-          70          42 LOAD_CONST               3 (True)
+          74          42 LOAD_CONST               3 (True)
                       44 STORE_NAME               7 (compute_buffer)
                       46 LOAD_NAME                8 (bool)
                       48 LOAD_NAME                6 (__annotations__)
                       50 LOAD_CONST               4 ('compute_buffer')
                       52 STORE_SUBSCR
          
-          71          56 LOAD_CONST               5 (10)
+          75          56 LOAD_CONST               5 (10)
                       58 STORE_NAME               9 (n_quantiles)
                       60 LOAD_NAME                5 (int)
                       62 LOAD_NAME                6 (__annotations__)
                       64 LOAD_CONST               6 ('n_quantiles')
                       66 STORE_SUBSCR
          
-          72          70 LOAD_CONST               7 (20)
+          76          70 LOAD_CONST               7 (20)
                       72 STORE_NAME              10 (top_acts_group_size)
                       74 LOAD_NAME                5 (int)
                       76 LOAD_NAME                6 (__annotations__)
                       78 LOAD_CONST               8 ('top_acts_group_size')
                       80 STORE_SUBSCR
          
-          73          84 LOAD_CONST               9 (5)
+          77          84 LOAD_CONST               9 (5)
                       86 STORE_NAME              11 (quantile_group_size)
                       88 LOAD_NAME                5 (int)
                       90 LOAD_NAME                6 (__annotations__)
                       92 LOAD_CONST              10 ('quantile_group_size')
                       94 STORE_SUBSCR
          
-          74          98 LOAD_CONST               9 (5)
+          78          98 LOAD_CONST               9 (5)
                      100 STORE_NAME              12 (top_logits_hoverdata)
                      102 LOAD_NAME                5 (int)
                      104 LOAD_NAME                6 (__annotations__)
                      106 LOAD_CONST              11 ('top_logits_hoverdata')
                      108 STORE_SUBSCR
          
-          75         112 LOAD_CONST              12 ('stack-all')
+          79         112 LOAD_CONST              12 ('stack-all')
                      114 STORE_NAME              13 (stack_mode)
                      116 LOAD_NAME               14 (Literal)
                      118 LOAD_CONST              13 (('stack-all', 'stack-quantiles', 'stack-none'))
                      120 BINARY_SUBSCR
                      130 LOAD_NAME                6 (__annotations__)
                      132 LOAD_CONST              14 ('stack_mode')
                      134 STORE_SUBSCR
          
-          76         138 LOAD_CONST               3 (True)
+          80         138 LOAD_CONST               3 (True)
                      140 STORE_NAME              15 (hover_below)
                      142 LOAD_NAME                8 (bool)
                      144 LOAD_NAME                6 (__annotations__)
                      146 LOAD_CONST              15 ('hover_below')
                      148 STORE_SUBSCR
          
-          78         152 LOAD_CONST              16 ('return')
+          82         152 LOAD_CONST              16 ('return')
                      154 LOAD_NAME                8 (bool)
                      156 BUILD_TUPLE              2
-                     158 LOAD_CONST              17 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 78>)
+                     158 LOAD_CONST              17 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 82>)
                      160 MAKE_FUNCTION            4 (annotations)
                      162 STORE_NAME              16 (data_is_contained_in)
          
-          90         164 LOAD_CONST              18 (<code object __post_init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 90>)
+          94         164 LOAD_CONST              18 (<code object __post_init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 94>)
                      166 MAKE_FUNCTION            0
                      168 STORE_NAME              17 (__post_init__)
          
-          94         170 LOAD_NAME               18 (property)
+          98         170 LOAD_NAME               18 (property)
          
-          95         172 LOAD_CONST              16 ('return')
+          99         172 LOAD_CONST              16 ('return')
                      174 LOAD_NAME               19 (dict)
                      176 LOAD_NAME               20 (str)
                      178 LOAD_NAME               20 (str)
                      180 BUILD_TUPLE              2
                      182 BINARY_SUBSCR
                      192 BUILD_TUPLE              2
-                     194 LOAD_CONST              19 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 94>)
+                     194 LOAD_CONST              19 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 98>)
                      196 MAKE_FUNCTION            4 (annotations)
          
-          94         198 PRECALL                  0
+          98         198 PRECALL                  0
                      202 CALL                     0
          
-          95         212 STORE_NAME              21 (help_dict)
+          99         212 STORE_NAME              21 (help_dict)
                      214 LOAD_CONST              20 (None)
                      216 RETURN_VALUE
          consts
             'SequencesConfig'
             (5, 5)
             'buffer'
             True
@@ -649,114 +662,114 @@
                   007c006a050000000000000000a6010000ab010000000000000000740900
                   0000000000000000007c016a050000000000000000a6010000ab01000000
                   00000000006b01000000007c006a06000000000000000064017c016a0600
                   00000000000000680276007c006a0700000000000000007c016a07000000
                   00000000006b01000000007c006a0800000000000000007c016a08000000
                   00000000006b01000000007c006a0900000000000000007c016a09000000
                   00000000006b01000000006707a6010000ab0100000000000000005300
-                78           0 RESUME                   0
+                82           0 RESUME                   0
                
-                79           2 LOAD_GLOBAL              1 (NULL + isinstance)
+                83           2 LOAD_GLOBAL              1 (NULL + isinstance)
                             14 LOAD_FAST                1 (other)
                             16 LOAD_FAST                0 (self)
                             18 LOAD_ATTR                1 (__class__)
                             28 PRECALL                  2
                             32 CALL                     2
                             42 POP_JUMP_FORWARD_IF_TRUE     2 (to 48)
                             44 LOAD_ASSERTION_ERROR
                             46 RAISE_VARARGS            1
                
-                80     >>   48 LOAD_GLOBAL              5 (NULL + all)
+                84     >>   48 LOAD_GLOBAL              5 (NULL + all)
                
-                81          60 LOAD_FAST                0 (self)
+                85          60 LOAD_FAST                0 (self)
                             62 LOAD_ATTR                3 (buffer)
                             72 LOAD_CONST               1 (0)
                             74 BINARY_SUBSCR
                             84 LOAD_FAST                1 (other)
                             86 LOAD_ATTR                3 (buffer)
                             96 LOAD_CONST               1 (0)
                             98 BINARY_SUBSCR
                            108 COMPARE_OP               1 (<=)
                
-                82         114 LOAD_FAST                0 (self)
+                86         114 LOAD_FAST                0 (self)
                            116 LOAD_ATTR                3 (buffer)
                            126 LOAD_CONST               2 (1)
                            128 BINARY_SUBSCR
                            138 LOAD_FAST                1 (other)
                            140 LOAD_ATTR                3 (buffer)
                            150 LOAD_CONST               2 (1)
                            152 BINARY_SUBSCR
                            162 COMPARE_OP               1 (<=)
                
-                83         168 LOAD_GLOBAL              9 (NULL + int)
+                87         168 LOAD_GLOBAL              9 (NULL + int)
                            180 LOAD_FAST                0 (self)
                            182 LOAD_ATTR                5 (compute_buffer)
                            192 PRECALL                  1
                            196 CALL                     1
                            206 LOAD_GLOBAL              9 (NULL + int)
                            218 LOAD_FAST                1 (other)
                            220 LOAD_ATTR                5 (compute_buffer)
                            230 PRECALL                  1
                            234 CALL                     1
                            244 COMPARE_OP               1 (<=)
                
-                84         250 LOAD_FAST                0 (self)
+                88         250 LOAD_FAST                0 (self)
                            252 LOAD_ATTR                6 (n_quantiles)
                            262 LOAD_CONST               1 (0)
                            264 LOAD_FAST                1 (other)
                            266 LOAD_ATTR                6 (n_quantiles)
                            276 BUILD_SET                2
                            278 CONTAINS_OP              0
                
-                85         280 LOAD_FAST                0 (self)
+                89         280 LOAD_FAST                0 (self)
                            282 LOAD_ATTR                7 (top_acts_group_size)
                            292 LOAD_FAST                1 (other)
                            294 LOAD_ATTR                7 (top_acts_group_size)
                            304 COMPARE_OP               1 (<=)
                
-                86         310 LOAD_FAST                0 (self)
+                90         310 LOAD_FAST                0 (self)
                            312 LOAD_ATTR                8 (quantile_group_size)
                            322 LOAD_FAST                1 (other)
                            324 LOAD_ATTR                8 (quantile_group_size)
                            334 COMPARE_OP               1 (<=)
                
-                87         340 LOAD_FAST                0 (self)
+                91         340 LOAD_FAST                0 (self)
                            342 LOAD_ATTR                9 (top_logits_hoverdata)
                            352 LOAD_FAST                1 (other)
                            354 LOAD_ATTR                9 (top_logits_hoverdata)
                            364 COMPARE_OP               1 (<=)
                
-                80         370 BUILD_LIST               7
+                84         370 BUILD_LIST               7
                            372 PRECALL                  1
                            376 CALL                     1
                            386 RETURN_VALUE
                consts
                   None
                   0
                   1
                names      ('isinstance', '__class__', 'all', 'buffer', 'int', 'compute_buffer', 'n_quantiles', 'top_acts_group_size', 'quantile_group_size', 'top_logits_hoverdata')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'data_is_contained_in'
-               firstlineno 78
+               firstlineno 82
                lnotab 0x02012e010c013601360152011e011e011e011ef9
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 3
                code
                   0x97007c006a00000000000000000067017c006a01000000000000000067
                   017c006a0200000000000000007a0500007a0000007c005f030000000000
                   00000064005300
-                90           0 RESUME                   0
+                94           0 RESUME                   0
                
-                92           2 LOAD_FAST                0 (self)
+                96           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (top_acts_group_size)
                             14 BUILD_LIST               1
                             16 LOAD_FAST                0 (self)
                             18 LOAD_ATTR                1 (quantile_group_size)
                             28 BUILD_LIST               1
                             30 LOAD_FAST                0 (self)
                             32 LOAD_ATTR                2 (n_quantiles)
@@ -770,92 +783,92 @@
                   None
                names      ('top_acts_group_size', 'quantile_group_size', 'n_quantiles', 'group_sizes')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       '__post_init__'
-               firstlineno 90
+               firstlineno 94
                lnotab 0x0202
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007400000000000000000000005300
-                94           0 RESUME                   0
+                98           0 RESUME                   0
                
-                96           2 LOAD_GLOBAL              0 (SEQUENCES_CONFIG_HELP)
+               100           2 LOAD_GLOBAL              0 (SEQUENCES_CONFIG_HELP)
                             14 RETURN_VALUE
                consts
                   None
                names      ('SEQUENCES_CONFIG_HELP',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help_dict'
-               firstlineno 94
+               firstlineno 98
                lnotab 0x0202
             None
          names      ('__name__', '__module__', '__qualname__', 'buffer', 'tuple', 'int', '__annotations__', 'compute_buffer', 'bool', 'n_quantiles', 'top_acts_group_size', 'quantile_group_size', 'top_logits_hoverdata', 'stack_mode', 'Literal', 'hover_below', 'data_is_contained_in', '__post_init__', 'property', 'dict', 'str', 'help_dict')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'SequencesConfig'
-         firstlineno 67
+         firstlineno 71
          lnotab 0x0c021e010e010e010e010e010e011a010e020c0c060402011aff0e01
       'SequencesConfig'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 5
          flags     : 0
          code
             0x970065005a0164005a02550064015a036504650564023c000000640365
             066602640484045a07650864036509650a650a6602190000000000000000
             00660264058404a6000000ab0000000000000000005a0b64065300
-          99           0 RESUME                   0
+         103           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('ActsHistogramConfig')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         101          12 LOAD_CONST               1 (50)
+         105          12 LOAD_CONST               1 (50)
                       14 STORE_NAME               3 (n_bins)
                       16 LOAD_NAME                4 (int)
                       18 LOAD_NAME                5 (__annotations__)
                       20 LOAD_CONST               2 ('n_bins')
                       22 STORE_SUBSCR
          
-         103          26 LOAD_CONST               3 ('return')
+         107          26 LOAD_CONST               3 ('return')
                       28 LOAD_NAME                6 (bool)
                       30 BUILD_TUPLE              2
-                      32 LOAD_CONST               4 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 103>)
+                      32 LOAD_CONST               4 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 107>)
                       34 MAKE_FUNCTION            4 (annotations)
                       36 STORE_NAME               7 (data_is_contained_in)
          
-         107          38 LOAD_NAME                8 (property)
+         111          38 LOAD_NAME                8 (property)
          
-         108          40 LOAD_CONST               3 ('return')
+         112          40 LOAD_CONST               3 ('return')
                       42 LOAD_NAME                9 (dict)
                       44 LOAD_NAME               10 (str)
                       46 LOAD_NAME               10 (str)
                       48 BUILD_TUPLE              2
                       50 BINARY_SUBSCR
                       60 BUILD_TUPLE              2
-                      62 LOAD_CONST               5 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 107>)
+                      62 LOAD_CONST               5 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 111>)
                       64 MAKE_FUNCTION            4 (annotations)
          
-         107          66 PRECALL                  0
+         111          66 PRECALL                  0
                       70 CALL                     0
          
-         108          80 STORE_NAME              11 (help_dict)
+         112          80 STORE_NAME              11 (help_dict)
                       82 LOAD_CONST               6 (None)
                       84 RETURN_VALUE
          consts
             'ActsHistogramConfig'
             50
             'n_bins'
             'return'
@@ -864,118 +877,118 @@
                nlocals   : 2
                stacksize : 4
                flags     : 3
                code
                   0x97007401000000000000000000007c017c006a010000000000000000a6
                   020000ab02000000000000000073024a0082017c006a0200000000000000
                   007c016a0200000000000000006b02000000005300
-               103           0 RESUME                   0
+               107           0 RESUME                   0
                
-               104           2 LOAD_GLOBAL              1 (NULL + isinstance)
+               108           2 LOAD_GLOBAL              1 (NULL + isinstance)
                             14 LOAD_FAST                1 (other)
                             16 LOAD_FAST                0 (self)
                             18 LOAD_ATTR                1 (__class__)
                             28 PRECALL                  2
                             32 CALL                     2
                             42 POP_JUMP_FORWARD_IF_TRUE     2 (to 48)
                             44 LOAD_ASSERTION_ERROR
                             46 RAISE_VARARGS            1
                
-               105     >>   48 LOAD_FAST                0 (self)
+               109     >>   48 LOAD_FAST                0 (self)
                             50 LOAD_ATTR                2 (n_bins)
                             60 LOAD_FAST                1 (other)
                             62 LOAD_ATTR                2 (n_bins)
                             72 COMPARE_OP               2 (==)
                             78 RETURN_VALUE
                consts
                   None
                names      ('isinstance', '__class__', 'n_bins')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'data_is_contained_in'
-               firstlineno 103
+               firstlineno 107
                lnotab 0x02012e01
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007400000000000000000000005300
-               107           0 RESUME                   0
+               111           0 RESUME                   0
                
-               109           2 LOAD_GLOBAL              0 (ACTIVATIONS_HISTOGRAM_CONFIG_HELP)
+               113           2 LOAD_GLOBAL              0 (ACTIVATIONS_HISTOGRAM_CONFIG_HELP)
                             14 RETURN_VALUE
                consts
                   None
                names      ('ACTIVATIONS_HISTOGRAM_CONFIG_HELP',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help_dict'
-               firstlineno 107
+               firstlineno 111
                lnotab 0x0202
             None
          names      ('__name__', '__module__', '__qualname__', 'n_bins', 'int', '__annotations__', 'bool', 'data_is_contained_in', 'property', 'dict', 'str', 'help_dict')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'ActsHistogramConfig'
-         firstlineno 99
+         firstlineno 103
          lnotab 0x0c020e020c0402011aff0e01
       'ActsHistogramConfig'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 5
          flags     : 0
          code
             0x970065005a0164005a02550064015a036504650564023c000000640365
             066602640484045a07650864036509650a650a6602190000000000000000
             00660264058404a6000000ab0000000000000000005a0b64065300
-         112           0 RESUME                   0
+         116           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('LogitsHistogramConfig')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         114          12 LOAD_CONST               1 (50)
+         118          12 LOAD_CONST               1 (50)
                       14 STORE_NAME               3 (n_bins)
                       16 LOAD_NAME                4 (int)
                       18 LOAD_NAME                5 (__annotations__)
                       20 LOAD_CONST               2 ('n_bins')
                       22 STORE_SUBSCR
          
-         116          26 LOAD_CONST               3 ('return')
+         120          26 LOAD_CONST               3 ('return')
                       28 LOAD_NAME                6 (bool)
                       30 BUILD_TUPLE              2
-                      32 LOAD_CONST               4 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 116>)
+                      32 LOAD_CONST               4 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 120>)
                       34 MAKE_FUNCTION            4 (annotations)
                       36 STORE_NAME               7 (data_is_contained_in)
          
-         120          38 LOAD_NAME                8 (property)
+         124          38 LOAD_NAME                8 (property)
          
-         121          40 LOAD_CONST               3 ('return')
+         125          40 LOAD_CONST               3 ('return')
                       42 LOAD_NAME                9 (dict)
                       44 LOAD_NAME               10 (str)
                       46 LOAD_NAME               10 (str)
                       48 BUILD_TUPLE              2
                       50 BINARY_SUBSCR
                       60 BUILD_TUPLE              2
-                      62 LOAD_CONST               5 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 120>)
+                      62 LOAD_CONST               5 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 124>)
                       64 MAKE_FUNCTION            4 (annotations)
          
-         120          66 PRECALL                  0
+         124          66 PRECALL                  0
                       70 CALL                     0
          
-         121          80 STORE_NAME              11 (help_dict)
+         125          80 STORE_NAME              11 (help_dict)
                       82 LOAD_CONST               6 (None)
                       84 RETURN_VALUE
          consts
             'LogitsHistogramConfig'
             50
             'n_bins'
             'return'
@@ -984,118 +997,118 @@
                nlocals   : 2
                stacksize : 4
                flags     : 3
                code
                   0x97007401000000000000000000007c017c006a010000000000000000a6
                   020000ab02000000000000000073024a0082017c006a0200000000000000
                   007c016a0200000000000000006b02000000005300
-               116           0 RESUME                   0
+               120           0 RESUME                   0
                
-               117           2 LOAD_GLOBAL              1 (NULL + isinstance)
+               121           2 LOAD_GLOBAL              1 (NULL + isinstance)
                             14 LOAD_FAST                1 (other)
                             16 LOAD_FAST                0 (self)
                             18 LOAD_ATTR                1 (__class__)
                             28 PRECALL                  2
                             32 CALL                     2
                             42 POP_JUMP_FORWARD_IF_TRUE     2 (to 48)
                             44 LOAD_ASSERTION_ERROR
                             46 RAISE_VARARGS            1
                
-               118     >>   48 LOAD_FAST                0 (self)
+               122     >>   48 LOAD_FAST                0 (self)
                             50 LOAD_ATTR                2 (n_bins)
                             60 LOAD_FAST                1 (other)
                             62 LOAD_ATTR                2 (n_bins)
                             72 COMPARE_OP               2 (==)
                             78 RETURN_VALUE
                consts
                   None
                names      ('isinstance', '__class__', 'n_bins')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'data_is_contained_in'
-               firstlineno 116
+               firstlineno 120
                lnotab 0x02012e01
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007400000000000000000000005300
-               120           0 RESUME                   0
+               124           0 RESUME                   0
                
-               122           2 LOAD_GLOBAL              0 (LOGITS_HISTOGRAM_CONFIG_HELP)
+               126           2 LOAD_GLOBAL              0 (LOGITS_HISTOGRAM_CONFIG_HELP)
                             14 RETURN_VALUE
                consts
                   None
                names      ('LOGITS_HISTOGRAM_CONFIG_HELP',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help_dict'
-               firstlineno 120
+               firstlineno 124
                lnotab 0x0202
             None
          names      ('__name__', '__module__', '__qualname__', 'n_bins', 'int', '__annotations__', 'bool', 'data_is_contained_in', 'property', 'dict', 'str', 'help_dict')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'LogitsHistogramConfig'
-         firstlineno 112
+         firstlineno 116
          lnotab 0x0c020e020c0402011aff0e01
       'LogitsHistogramConfig'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 5
          flags     : 0
          code
             0x970065005a0164005a02550064015a036504650564023c000000640365
             066602640484045a07650864036509650a650a6602190000000000000000
             00660264058404a6000000ab0000000000000000005a0b64065300
-         125           0 RESUME                   0
+         129           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('LogitsTableConfig')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         127          12 LOAD_CONST               1 (10)
+         131          12 LOAD_CONST               1 (10)
                       14 STORE_NAME               3 (n_rows)
                       16 LOAD_NAME                4 (int)
                       18 LOAD_NAME                5 (__annotations__)
                       20 LOAD_CONST               2 ('n_rows')
                       22 STORE_SUBSCR
          
-         129          26 LOAD_CONST               3 ('return')
+         133          26 LOAD_CONST               3 ('return')
                       28 LOAD_NAME                6 (bool)
                       30 BUILD_TUPLE              2
-                      32 LOAD_CONST               4 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 129>)
+                      32 LOAD_CONST               4 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 133>)
                       34 MAKE_FUNCTION            4 (annotations)
                       36 STORE_NAME               7 (data_is_contained_in)
          
-         133          38 LOAD_NAME                8 (property)
+         137          38 LOAD_NAME                8 (property)
          
-         134          40 LOAD_CONST               3 ('return')
+         138          40 LOAD_CONST               3 ('return')
                       42 LOAD_NAME                9 (dict)
                       44 LOAD_NAME               10 (str)
                       46 LOAD_NAME               10 (str)
                       48 BUILD_TUPLE              2
                       50 BINARY_SUBSCR
                       60 BUILD_TUPLE              2
-                      62 LOAD_CONST               5 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 133>)
+                      62 LOAD_CONST               5 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 137>)
                       64 MAKE_FUNCTION            4 (annotations)
          
-         133          66 PRECALL                  0
+         137          66 PRECALL                  0
                       70 CALL                     0
          
-         134          80 STORE_NAME              11 (help_dict)
+         138          80 STORE_NAME              11 (help_dict)
                       82 LOAD_CONST               6 (None)
                       84 RETURN_VALUE
          consts
             'LogitsTableConfig'
             10
             'n_rows'
             'return'
@@ -1104,249 +1117,320 @@
                nlocals   : 2
                stacksize : 4
                flags     : 3
                code
                   0x97007401000000000000000000007c017c006a010000000000000000a6
                   020000ab02000000000000000073024a0082017c006a0200000000000000
                   007c016a0200000000000000006b01000000005300
-               129           0 RESUME                   0
+               133           0 RESUME                   0
                
-               130           2 LOAD_GLOBAL              1 (NULL + isinstance)
+               134           2 LOAD_GLOBAL              1 (NULL + isinstance)
                             14 LOAD_FAST                1 (other)
                             16 LOAD_FAST                0 (self)
                             18 LOAD_ATTR                1 (__class__)
                             28 PRECALL                  2
                             32 CALL                     2
                             42 POP_JUMP_FORWARD_IF_TRUE     2 (to 48)
                             44 LOAD_ASSERTION_ERROR
                             46 RAISE_VARARGS            1
                
-               131     >>   48 LOAD_FAST                0 (self)
+               135     >>   48 LOAD_FAST                0 (self)
                             50 LOAD_ATTR                2 (n_rows)
                             60 LOAD_FAST                1 (other)
                             62 LOAD_ATTR                2 (n_rows)
                             72 COMPARE_OP               1 (<=)
                             78 RETURN_VALUE
                consts
                   None
                names      ('isinstance', '__class__', 'n_rows')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'data_is_contained_in'
-               firstlineno 129
+               firstlineno 133
                lnotab 0x02012e01
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007400000000000000000000005300
-               133           0 RESUME                   0
+               137           0 RESUME                   0
                
-               135           2 LOAD_GLOBAL              0 (LOGITS_TABLE_CONFIG_HELP)
+               139           2 LOAD_GLOBAL              0 (LOGITS_TABLE_CONFIG_HELP)
                             14 RETURN_VALUE
                consts
                   None
                names      ('LOGITS_TABLE_CONFIG_HELP',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help_dict'
-               firstlineno 133
+               firstlineno 137
                lnotab 0x0202
             None
          names      ('__name__', '__module__', '__qualname__', 'n_rows', 'int', '__annotations__', 'bool', 'data_is_contained_in', 'property', 'dict', 'str', 'help_dict')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'LogitsTableConfig'
-         firstlineno 125
+         firstlineno 129
          lnotab 0x0c020e020c0402011aff0e01
       'LogitsTableConfig'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 5
          flags     : 0
          code
-            0x970065005a0164005a02550064015a036504650564023c000000640365
-            066602640484045a07650864036509650a650a6602190000000000000000
-            00660264058404a6000000ab0000000000000000005a0b64065300
-         138           0 RESUME                   0
+            0x970065005a0164005a02550064015a036504650564023c00000064035a
+            066507650564043c00000064035a086507650564053c00000064035a0965
+            07650564063c00000064075a0a6507650564083c00000064096507660264
+            0a84045a0b650c6409650d650e650e660219000000000000000000660264
+            0b8404a6000000ab0000000000000000005a0f640c5300
+         142           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('FeatureTablesConfig')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         140          12 LOAD_CONST               1 (3)
+         144          12 LOAD_CONST               1 (3)
                       14 STORE_NAME               3 (n_rows)
                       16 LOAD_NAME                4 (int)
                       18 LOAD_NAME                5 (__annotations__)
                       20 LOAD_CONST               2 ('n_rows')
                       22 STORE_SUBSCR
          
-         142          26 LOAD_CONST               3 ('return')
-                      28 LOAD_NAME                6 (bool)
-                      30 BUILD_TUPLE              2
-                      32 LOAD_CONST               4 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 142>)
-                      34 MAKE_FUNCTION            4 (annotations)
-                      36 STORE_NAME               7 (data_is_contained_in)
-         
-         146          38 LOAD_NAME                8 (property)
-         
-         147          40 LOAD_CONST               3 ('return')
-                      42 LOAD_NAME                9 (dict)
-                      44 LOAD_NAME               10 (str)
-                      46 LOAD_NAME               10 (str)
-                      48 BUILD_TUPLE              2
-                      50 BINARY_SUBSCR
-                      60 BUILD_TUPLE              2
-                      62 LOAD_CONST               5 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 146>)
-                      64 MAKE_FUNCTION            4 (annotations)
-         
-         146          66 PRECALL                  0
-                      70 CALL                     0
+         145          26 LOAD_CONST               3 (True)
+                      28 STORE_NAME               6 (neuron_alignment_table)
+                      30 LOAD_NAME                7 (bool)
+                      32 LOAD_NAME                5 (__annotations__)
+                      34 LOAD_CONST               4 ('neuron_alignment_table')
+                      36 STORE_SUBSCR
+         
+         146          40 LOAD_CONST               3 (True)
+                      42 STORE_NAME               8 (correlated_neurons_table)
+                      44 LOAD_NAME                7 (bool)
+                      46 LOAD_NAME                5 (__annotations__)
+                      48 LOAD_CONST               5 ('correlated_neurons_table')
+                      50 STORE_SUBSCR
+         
+         147          54 LOAD_CONST               3 (True)
+                      56 STORE_NAME               9 (correlated_features_table)
+                      58 LOAD_NAME                7 (bool)
+                      60 LOAD_NAME                5 (__annotations__)
+                      62 LOAD_CONST               6 ('correlated_features_table')
+                      64 STORE_SUBSCR
+         
+         148          68 LOAD_CONST               7 (False)
+                      70 STORE_NAME              10 (correlated_b_features_table)
+                      72 LOAD_NAME                7 (bool)
+                      74 LOAD_NAME                5 (__annotations__)
+                      76 LOAD_CONST               8 ('correlated_b_features_table')
+                      78 STORE_SUBSCR
          
-         147          80 STORE_NAME              11 (help_dict)
-                      82 LOAD_CONST               6 (None)
-                      84 RETURN_VALUE
+         150          82 LOAD_CONST               9 ('return')
+                      84 LOAD_NAME                7 (bool)
+                      86 BUILD_TUPLE              2
+                      88 LOAD_CONST              10 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 150>)
+                      90 MAKE_FUNCTION            4 (annotations)
+                      92 STORE_NAME              11 (data_is_contained_in)
+         
+         160          94 LOAD_NAME               12 (property)
+         
+         161          96 LOAD_CONST               9 ('return')
+                      98 LOAD_NAME               13 (dict)
+                     100 LOAD_NAME               14 (str)
+                     102 LOAD_NAME               14 (str)
+                     104 BUILD_TUPLE              2
+                     106 BINARY_SUBSCR
+                     116 BUILD_TUPLE              2
+                     118 LOAD_CONST              11 (<code object help_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 160>)
+                     120 MAKE_FUNCTION            4 (annotations)
+         
+         160         122 PRECALL                  0
+                     126 CALL                     0
+         
+         161         136 STORE_NAME              15 (help_dict)
+                     138 LOAD_CONST              12 (None)
+                     140 RETURN_VALUE
          consts
             'FeatureTablesConfig'
             3
             'n_rows'
+            True
+            'neuron_alignment_table'
+            'correlated_neurons_table'
+            'correlated_features_table'
+            False
+            'correlated_b_features_table'
             'return'
             code
                argcount  : 2
                nlocals   : 2
-               stacksize : 4
+               stacksize : 8
                flags     : 3
                code
                   0x97007401000000000000000000007c017c006a010000000000000000a6
-                  020000ab02000000000000000073024a0082017c006a0200000000000000
-                  007c016a0200000000000000006b01000000005300
-               142           0 RESUME                   0
+                  020000ab02000000000000000073024a0082017405000000000000000000
+                  007c006a0300000000000000007c016a0300000000000000006b01000000
+                  007c006a0400000000000000007c016a0400000000000000006b01000000
+                  007c006a0500000000000000007c016a0500000000000000006b01000000
+                  007c006a0600000000000000007c016a0600000000000000006b01000000
+                  007c006a0700000000000000007c016a0700000000000000006b01000000
+                  006705a6010000ab0100000000000000005300
+               150           0 RESUME                   0
                
-               143           2 LOAD_GLOBAL              1 (NULL + isinstance)
+               151           2 LOAD_GLOBAL              1 (NULL + isinstance)
                             14 LOAD_FAST                1 (other)
                             16 LOAD_FAST                0 (self)
                             18 LOAD_ATTR                1 (__class__)
                             28 PRECALL                  2
                             32 CALL                     2
                             42 POP_JUMP_FORWARD_IF_TRUE     2 (to 48)
                             44 LOAD_ASSERTION_ERROR
                             46 RAISE_VARARGS            1
                
-               144     >>   48 LOAD_FAST                0 (self)
-                            50 LOAD_ATTR                2 (n_rows)
-                            60 LOAD_FAST                1 (other)
-                            62 LOAD_ATTR                2 (n_rows)
-                            72 COMPARE_OP               1 (<=)
-                            78 RETURN_VALUE
+               152     >>   48 LOAD_GLOBAL              5 (NULL + all)
+               
+               153          60 LOAD_FAST                0 (self)
+                            62 LOAD_ATTR                3 (n_rows)
+                            72 LOAD_FAST                1 (other)
+                            74 LOAD_ATTR                3 (n_rows)
+                            84 COMPARE_OP               1 (<=)
+               
+               154          90 LOAD_FAST                0 (self)
+                            92 LOAD_ATTR                4 (neuron_alignment_table)
+                           102 LOAD_FAST                1 (other)
+                           104 LOAD_ATTR                4 (neuron_alignment_table)
+                           114 COMPARE_OP               1 (<=)
+               
+               155         120 LOAD_FAST                0 (self)
+                           122 LOAD_ATTR                5 (correlated_neurons_table)
+                           132 LOAD_FAST                1 (other)
+                           134 LOAD_ATTR                5 (correlated_neurons_table)
+                           144 COMPARE_OP               1 (<=)
+               
+               156         150 LOAD_FAST                0 (self)
+                           152 LOAD_ATTR                6 (correlated_features_table)
+                           162 LOAD_FAST                1 (other)
+                           164 LOAD_ATTR                6 (correlated_features_table)
+                           174 COMPARE_OP               1 (<=)
+               
+               157         180 LOAD_FAST                0 (self)
+                           182 LOAD_ATTR                7 (correlated_b_features_table)
+                           192 LOAD_FAST                1 (other)
+                           194 LOAD_ATTR                7 (correlated_b_features_table)
+                           204 COMPARE_OP               1 (<=)
+               
+               152         210 BUILD_LIST               5
+                           212 PRECALL                  1
+                           216 CALL                     1
+                           226 RETURN_VALUE
                consts
                   None
-               names      ('isinstance', '__class__', 'n_rows')
+               names      ('isinstance', '__class__', 'all', 'n_rows', 'neuron_alignment_table', 'correlated_neurons_table', 'correlated_features_table', 'correlated_b_features_table')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'data_is_contained_in'
-               firstlineno 142
-               lnotab 0x02012e01
+               firstlineno 150
+               lnotab 0x02012e010c011e011e011e011e011efb
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007400000000000000000000005300
-               146           0 RESUME                   0
+               160           0 RESUME                   0
                
-               148           2 LOAD_GLOBAL              0 (FEATURE_TABLES_CONFIG_HELP)
+               162           2 LOAD_GLOBAL              0 (FEATURE_TABLES_CONFIG_HELP)
                             14 RETURN_VALUE
                consts
                   None
                names      ('FEATURE_TABLES_CONFIG_HELP',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help_dict'
-               firstlineno 146
+               firstlineno 160
                lnotab 0x0202
             None
-         names      ('__name__', '__module__', '__qualname__', 'n_rows', 'int', '__annotations__', 'bool', 'data_is_contained_in', 'property', 'dict', 'str', 'help_dict')
+         names      ('__name__', '__module__', '__qualname__', 'n_rows', 'int', '__annotations__', 'neuron_alignment_table', 'bool', 'correlated_neurons_table', 'correlated_features_table', 'correlated_b_features_table', 'data_is_contained_in', 'property', 'dict', 'str', 'help_dict')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'FeatureTablesConfig'
-         firstlineno 138
-         lnotab 0x0c020e020c0402011aff0e01
+         firstlineno 142
+         lnotab 0x0c020e010e010e010e010e020c0a02011aff0e01
       'FeatureTablesConfig'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 6
          flags     : 0
          code
             0x970065005a0164005a02640164029c0164036503640465046505190000
             000000000000006604640584065a06640665076508190000000000000000
             006602640784045a0964086505640665086604640984045a0a6406650566
             02640a84045a0b64015300
-         160           0 RESUME                   0
+         174           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('Column')
                        8 STORE_NAME               2 (__qualname__)
          
-         164          10 LOAD_CONST               1 (None)
+         178          10 LOAD_CONST               1 (None)
          
-         161          12 LOAD_CONST               2 (('width',))
+         175          12 LOAD_CONST               2 (('width',))
                       14 BUILD_CONST_KEY_MAP      1
                       16 LOAD_CONST               3 ('args')
          
-         163          18 LOAD_NAME                3 (GenericComponentConfig)
+         177          18 LOAD_NAME                3 (GenericComponentConfig)
          
-         161          20 LOAD_CONST               4 ('width')
+         175          20 LOAD_CONST               4 ('width')
          
-         164          22 LOAD_NAME                4 (Optional)
+         178          22 LOAD_NAME                4 (Optional)
                       24 LOAD_NAME                5 (int)
                       26 BINARY_SUBSCR
          
-         161          36 BUILD_TUPLE              4
-                      38 LOAD_CONST               5 (<code object __init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 161>)
+         175          36 BUILD_TUPLE              4
+                      38 LOAD_CONST               5 (<code object __init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 175>)
                       40 MAKE_FUNCTION            6 (kwdefaults, annotations)
                       42 STORE_NAME               6 (__init__)
          
-         169          44 LOAD_CONST               6 ('return')
+         183          44 LOAD_CONST               6 ('return')
                       46 LOAD_NAME                7 (Iterator)
                       48 LOAD_NAME                8 (Any)
                       50 BINARY_SUBSCR
                       60 BUILD_TUPLE              2
-                      62 LOAD_CONST               7 (<code object __iter__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 169>)
+                      62 LOAD_CONST               7 (<code object __iter__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 183>)
                       64 MAKE_FUNCTION            4 (annotations)
                       66 STORE_NAME               9 (__iter__)
          
-         172          68 LOAD_CONST               8 ('idx')
+         186          68 LOAD_CONST               8 ('idx')
                       70 LOAD_NAME                5 (int)
                       72 LOAD_CONST               6 ('return')
                       74 LOAD_NAME                8 (Any)
                       76 BUILD_TUPLE              4
-                      78 LOAD_CONST               9 (<code object __getitem__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 172>)
+                      78 LOAD_CONST               9 (<code object __getitem__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 186>)
                       80 MAKE_FUNCTION            4 (annotations)
                       82 STORE_NAME              10 (__getitem__)
          
-         175          84 LOAD_CONST               6 ('return')
+         189          84 LOAD_CONST               6 ('return')
                       86 LOAD_NAME                5 (int)
                       88 BUILD_TUPLE              2
-                      90 LOAD_CONST              10 (<code object __len__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 175>)
+                      90 LOAD_CONST              10 (<code object __len__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 189>)
                       92 MAKE_FUNCTION            4 (annotations)
                       94 STORE_NAME              11 (__len__)
                       96 LOAD_CONST               1 (None)
                       98 RETURN_VALUE
          consts
             'Column'
             None
@@ -1358,122 +1442,122 @@
                nlocals   : 3
                stacksize : 3
                flags     : 7
                code
                   0x97007401000000000000000000007c02a6010000ab0100000000000000
                   007c005f0100000000000000007c017c005f020000000000000000640053
                   00
-               161           0 RESUME                   0
+               175           0 RESUME                   0
                
-               166           2 LOAD_GLOBAL              1 (NULL + list)
+               180           2 LOAD_GLOBAL              1 (NULL + list)
                             14 LOAD_FAST                2 (args)
                             16 PRECALL                  1
                             20 CALL                     1
                             30 LOAD_FAST                0 (self)
                             32 STORE_ATTR               1 (components)
                
-               167          42 LOAD_FAST                1 (width)
+               181          42 LOAD_FAST                1 (width)
                             44 LOAD_FAST                0 (self)
                             46 STORE_ATTR               2 (width)
                             56 LOAD_CONST               0 (None)
                             58 RETURN_VALUE
                consts
                   None
                names      ('list', 'components', 'width')
                varnames   ('self', 'width', 'args')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       '__init__'
-               firstlineno 161
+               firstlineno 175
                lnotab 0x02052801
             'return'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 3
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-               169           0 RESUME                   0
+               183           0 RESUME                   0
                
-               170           2 LOAD_GLOBAL              1 (NULL + iter)
+               184           2 LOAD_GLOBAL              1 (NULL + iter)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (components)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('iter', 'components')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       '__iter__'
-               firstlineno 169
+               firstlineno 183
                lnotab 0x0201
             'idx'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 2
                flags     : 3
                code 0x97007c006a0000000000000000007c01190000000000000000005300
-               172           0 RESUME                   0
+               186           0 RESUME                   0
                
-               173           2 LOAD_FAST                0 (self)
+               187           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (components)
                             14 LOAD_FAST                1 (idx)
                             16 BINARY_SUBSCR
                             26 RETURN_VALUE
                consts
                   None
                names      ('components',)
                varnames   ('self', 'idx')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       '__getitem__'
-               firstlineno 172
+               firstlineno 186
                lnotab 0x0201
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 3
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-               175           0 RESUME                   0
+               189           0 RESUME                   0
                
-               176           2 LOAD_GLOBAL              1 (NULL + len)
+               190           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (components)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'components')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       '__len__'
-               firstlineno 175
+               firstlineno 189
                lnotab 0x0201
          names      ('__name__', '__module__', '__qualname__', 'GenericComponentConfig', 'Optional', 'int', '__init__', 'Iterator', 'Any', '__iter__', '__getitem__', '__len__')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'Column'
-         firstlineno 160
+         firstlineno 174
          lnotab 0x0a0402fd060202fe02030efd080818031003
       'Column'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 8
          flags     : 0
@@ -1486,25 +1570,25 @@
             067a070000650a64093c00000064065a12651364067a070000650a640a3c
             00000064065a14651564067a070000650a640b3c00000064065a16651764
             067a070000650a640c3c0000006403651865091900000000000000000066
             02640d84045a19640e6400640f651a6604641084045a1b09000900641764
             12651c6413651a640f651d64067a0700006606641484055a1e651f641864
             158404a6000000ab0000000000000000005a20651f641864168404a60000
             00ab0000000000000000005a2164065300
-         181           0 RESUME                   0
+         195           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('SaeVisLayoutConfig')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         184          12 LOAD_CONST               1 ('\n    This object allows you to set all the ways the feature vis will be laid out.\n\n    Args (specified by the user):\n        columns: \n            A list of `Column` objects, where each `Column` contains a list of component configs.\n        height:\n            The height of the vis (in pixels).\n\n    Args (defined during __init__):\n        seq_cfg: \n            The `SequencesConfig` object, which contains all the parameters for the top activating sequences (and the\n            quantile groups).\n        act_hist_cfg:\n            The `ActsHistogramConfig` object, which contains all the parameters for the activations histogram.\n        logits_hist_cfg:\n            The `LogitsHistogramConfig` object, which contains all the parameters for the logits histogram.\n        logits_table_cfg:\n            The `LogitsTableConfig` object, which contains all the parameters for the logits table.\n        feat_tables_cfg:\n            The `FeatureTablesConfig` object, which contains all the parameters for the feature tables.\n        prompt_cfg:\n            The `PromptConfig` object, which contains all the parameters for the prompt-centric vis.\n    ')
+         198          12 LOAD_CONST               1 ('\n    This object allows you to set all the ways the feature vis will be laid out.\n\n    Args (specified by the user):\n        columns: \n            A list of `Column` objects, where each `Column` contains a list of component configs.\n        height:\n            The height of the vis (in pixels).\n\n    Args (defined during __init__):\n        seq_cfg: \n            The `SequencesConfig` object, which contains all the parameters for the top activating sequences (and the\n            quantile groups).\n        act_hist_cfg:\n            The `ActsHistogramConfig` object, which contains all the parameters for the activations histogram.\n        logits_hist_cfg:\n            The `LogitsHistogramConfig` object, which contains all the parameters for the logits histogram.\n        logits_table_cfg:\n            The `LogitsTableConfig` object, which contains all the parameters for the logits table.\n        feature_tables_cfg:\n            The `FeatureTablesConfig` object, which contains all the parameters for the feature tables.\n        prompt_cfg:\n            The `PromptConfig` object, which contains all the parameters for the prompt-centric vis.\n    ')
                       14 STORE_NAME               3 (__doc__)
          
-         208          16 PUSH_NULL
+         222          16 PUSH_NULL
                       18 LOAD_NAME                4 (field)
                       20 LOAD_NAME                5 (dict)
                       22 KW_NAMES                 2
                       24 PRECALL                  1
                       28 CALL                     1
                       38 STORE_NAME               6 (columns)
                       40 LOAD_NAME                5 (dict)
@@ -1518,153 +1602,153 @@
                       66 LOAD_NAME                9 (Column)
                       68 BUILD_TUPLE              2
                       70 BINARY_SUBSCR
                       80 LOAD_NAME               10 (__annotations__)
                       82 LOAD_CONST               3 ('columns')
                       84 STORE_SUBSCR
          
-         209          88 LOAD_CONST               4 (750)
+         223          88 LOAD_CONST               4 (750)
                       90 STORE_NAME              11 (height)
                       92 LOAD_NAME                7 (int)
                       94 LOAD_NAME               10 (__annotations__)
                       96 LOAD_CONST               5 ('height')
                       98 STORE_SUBSCR
          
-         211         102 LOAD_CONST               6 (None)
+         225         102 LOAD_CONST               6 (None)
                      104 STORE_NAME              12 (seq_cfg)
                      106 LOAD_NAME               13 (SequencesConfig)
                      108 LOAD_CONST               6 (None)
                      110 BINARY_OP                7 (|)
                      114 LOAD_NAME               10 (__annotations__)
                      116 LOAD_CONST               7 ('seq_cfg')
                      118 STORE_SUBSCR
          
-         212         122 LOAD_CONST               6 (None)
+         226         122 LOAD_CONST               6 (None)
                      124 STORE_NAME              14 (act_hist_cfg)
                      126 LOAD_NAME               15 (ActsHistogramConfig)
                      128 LOAD_CONST               6 (None)
                      130 BINARY_OP                7 (|)
                      134 LOAD_NAME               10 (__annotations__)
                      136 LOAD_CONST               8 ('act_hist_cfg')
                      138 STORE_SUBSCR
          
-         213         142 LOAD_CONST               6 (None)
+         227         142 LOAD_CONST               6 (None)
                      144 STORE_NAME              16 (logits_hist_cfg)
                      146 LOAD_NAME               17 (LogitsHistogramConfig)
                      148 LOAD_CONST               6 (None)
                      150 BINARY_OP                7 (|)
                      154 LOAD_NAME               10 (__annotations__)
                      156 LOAD_CONST               9 ('logits_hist_cfg')
                      158 STORE_SUBSCR
          
-         214         162 LOAD_CONST               6 (None)
+         228         162 LOAD_CONST               6 (None)
                      164 STORE_NAME              18 (logits_table_cfg)
                      166 LOAD_NAME               19 (LogitsTableConfig)
                      168 LOAD_CONST               6 (None)
                      170 BINARY_OP                7 (|)
                      174 LOAD_NAME               10 (__annotations__)
                      176 LOAD_CONST              10 ('logits_table_cfg')
                      178 STORE_SUBSCR
          
-         215         182 LOAD_CONST               6 (None)
-                     184 STORE_NAME              20 (feat_tables_cfg)
+         229         182 LOAD_CONST               6 (None)
+                     184 STORE_NAME              20 (feature_tables_cfg)
                      186 LOAD_NAME               21 (FeatureTablesConfig)
                      188 LOAD_CONST               6 (None)
                      190 BINARY_OP                7 (|)
                      194 LOAD_NAME               10 (__annotations__)
-                     196 LOAD_CONST              11 ('feat_tables_cfg')
+                     196 LOAD_CONST              11 ('feature_tables_cfg')
                      198 STORE_SUBSCR
          
-         216         202 LOAD_CONST               6 (None)
+         230         202 LOAD_CONST               6 (None)
                      204 STORE_NAME              22 (prompt_cfg)
                      206 LOAD_NAME               23 (PromptConfig)
                      208 LOAD_CONST               6 (None)
                      210 BINARY_OP                7 (|)
                      214 LOAD_NAME               10 (__annotations__)
                      216 LOAD_CONST              12 ('prompt_cfg')
                      218 STORE_SUBSCR
          
-         218         222 LOAD_CONST               3 ('columns')
+         232         222 LOAD_CONST               3 ('columns')
                      224 LOAD_NAME               24 (list)
                      226 LOAD_NAME                9 (Column)
                      228 BINARY_SUBSCR
                      238 BUILD_TUPLE              2
-                     240 LOAD_CONST              13 (<code object __init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 218>)
+                     240 LOAD_CONST              13 (<code object __init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 232>)
                      242 MAKE_FUNCTION            4 (annotations)
                      244 STORE_NAME              25 (__init__)
          
-         251         246 LOAD_CONST              14 ('other')
+         265         246 LOAD_CONST              14 ('other')
                      248 LOAD_CONST               0 ('SaeVisLayoutConfig')
                      250 LOAD_CONST              15 ('return')
                      252 LOAD_NAME               26 (bool)
                      254 BUILD_TUPLE              4
-                     256 LOAD_CONST              16 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 251>)
+                     256 LOAD_CONST              16 (<code object data_is_contained_in, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 265>)
                      258 MAKE_FUNCTION            4 (annotations)
                      260 STORE_NAME              27 (data_is_contained_in)
          
-         271         262 NOP
+         285         262 NOP
          
-         272         264 NOP
+         286         264 NOP
          
-         269         266 LOAD_CONST              23 (('SaeVisLayoutConfig', True))
+         283         266 LOAD_CONST              23 (('SaeVisLayoutConfig', True))
                      268 LOAD_CONST              18 ('title')
          
-         271         270 LOAD_NAME               28 (str)
+         285         270 LOAD_NAME               28 (str)
          
-         269         272 LOAD_CONST              19 ('key')
+         283         272 LOAD_CONST              19 ('key')
          
-         272         274 LOAD_NAME               26 (bool)
+         286         274 LOAD_NAME               26 (bool)
          
-         269         276 LOAD_CONST              15 ('return')
+         283         276 LOAD_CONST              15 ('return')
          
-         273         278 LOAD_NAME               29 (Tree)
+         287         278 LOAD_NAME               29 (Tree)
                      280 LOAD_CONST               6 (None)
                      282 BINARY_OP                7 (|)
          
-         269         286 BUILD_TUPLE              6
-                     288 LOAD_CONST              20 (<code object help, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 269>)
+         283         286 BUILD_TUPLE              6
+                     288 LOAD_CONST              20 (<code object help, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 283>)
                      290 MAKE_FUNCTION            5 (defaults, annotations)
                      292 STORE_NAME              30 (help)
          
-         318         294 LOAD_NAME               31 (classmethod)
+         332         294 LOAD_NAME               31 (classmethod)
          
-         319         296 LOAD_CONST              24 (('return', 'SaeVisLayoutConfig'))
-                     298 LOAD_CONST              21 (<code object default_feature_centric_layout, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 318>)
+         333         296 LOAD_CONST              24 (('return', 'SaeVisLayoutConfig'))
+                     298 LOAD_CONST              21 (<code object default_feature_centric_layout, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 332>)
                      300 MAKE_FUNCTION            4 (annotations)
          
-         318         302 PRECALL                  0
+         332         302 PRECALL                  0
                      306 CALL                     0
          
-         319         316 STORE_NAME              32 (default_feature_centric_layout)
+         333         316 STORE_NAME              32 (default_feature_centric_layout)
          
-         329         318 LOAD_NAME               31 (classmethod)
+         343         318 LOAD_NAME               31 (classmethod)
          
-         330         320 LOAD_CONST              24 (('return', 'SaeVisLayoutConfig'))
-                     322 LOAD_CONST              22 (<code object default_prompt_centric_layout, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 329>)
+         344         320 LOAD_CONST              24 (('return', 'SaeVisLayoutConfig'))
+                     322 LOAD_CONST              22 (<code object default_prompt_centric_layout, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 343>)
                      324 MAKE_FUNCTION            4 (annotations)
          
-         329         326 PRECALL                  0
+         343         326 PRECALL                  0
                      330 CALL                     0
          
-         330         340 STORE_NAME              33 (default_prompt_centric_layout)
+         344         340 STORE_NAME              33 (default_prompt_centric_layout)
                      342 LOAD_CONST               6 (None)
                      344 RETURN_VALUE
          consts
             'SaeVisLayoutConfig'
-            '\n    This object allows you to set all the ways the feature vis will be laid out.\n\n    Args (specified by the user):\n        columns: \n            A list of `Column` objects, where each `Column` contains a list of component configs.\n        height:\n            The height of the vis (in pixels).\n\n    Args (defined during __init__):\n        seq_cfg: \n            The `SequencesConfig` object, which contains all the parameters for the top activating sequences (and the\n            quantile groups).\n        act_hist_cfg:\n            The `ActsHistogramConfig` object, which contains all the parameters for the activations histogram.\n        logits_hist_cfg:\n            The `LogitsHistogramConfig` object, which contains all the parameters for the logits histogram.\n        logits_table_cfg:\n            The `LogitsTableConfig` object, which contains all the parameters for the logits table.\n        feat_tables_cfg:\n            The `FeatureTablesConfig` object, which contains all the parameters for the feature tables.\n        prompt_cfg:\n            The `PromptConfig` object, which contains all the parameters for the prompt-centric vis.\n    '
+            '\n    This object allows you to set all the ways the feature vis will be laid out.\n\n    Args (specified by the user):\n        columns: \n            A list of `Column` objects, where each `Column` contains a list of component configs.\n        height:\n            The height of the vis (in pixels).\n\n    Args (defined during __init__):\n        seq_cfg: \n            The `SequencesConfig` object, which contains all the parameters for the top activating sequences (and the\n            quantile groups).\n        act_hist_cfg:\n            The `ActsHistogramConfig` object, which contains all the parameters for the activations histogram.\n        logits_hist_cfg:\n            The `LogitsHistogramConfig` object, which contains all the parameters for the logits histogram.\n        logits_table_cfg:\n            The `LogitsTableConfig` object, which contains all the parameters for the logits table.\n        feature_tables_cfg:\n            The `FeatureTablesConfig` object, which contains all the parameters for the feature tables.\n        prompt_cfg:\n            The `PromptConfig` object, which contains all the parameters for the prompt-centric vis.\n    '
             ('default_factory',)
             'columns'
             750
             'height'
             None
             'seq_cfg'
             'act_hist_cfg'
             'logits_hist_cfg'
             'logits_table_cfg'
-            'feat_tables_cfg'
+            'feature_tables_cfg'
             'prompt_cfg'
             code
                argcount  : 2
                nlocals   : 7
                stacksize : 6
                flags     : 11
                code
@@ -1684,49 +1768,49 @@
                   005f0700000000000000008c15780164076b0200000000720901007c057c
                   005f0800000000000000008c24780164086b0200000000720901007c057c
                   005f0900000000000000008c33780164096b0200000000720901007c057c
                   005f0a00000000000000008c427801640a6b0200000000720901007c057c
                   005f0b00000000000000008c51640b6b020000000072087c057c005f0c00
                   000000000000008c5e0900741b00000000000000000000640c7c069b009d
                   02a6010000ab0100000000000000008201640d5300
-               218           0 RESUME                   0
+               232           0 RESUME                   0
                
-               225           2 LOAD_CONST               1 (<code object <dictcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 225>)
+               239           2 LOAD_CONST               1 (<code object <dictcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 239>)
                              4 MAKE_FUNCTION            0
                              6 LOAD_GLOBAL              1 (NULL + enumerate)
                             18 LOAD_FAST                1 (columns)
                             20 PRECALL                  1
                             24 CALL                     1
                             34 GET_ITER
                             36 PRECALL                  0
                             40 CALL                     0
                             50 LOAD_FAST                0 (self)
                             52 STORE_ATTR               1 (columns)
                
-               228          62 LOAD_CONST               2 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 228>)
+               242          62 LOAD_CONST               2 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 242>)
                             64 MAKE_FUNCTION            0
                             66 LOAD_FAST                0 (self)
                             68 LOAD_ATTR                1 (columns)
                             78 LOAD_METHOD              2 (values)
                            100 PRECALL                  0
                            104 CALL                     0
                            114 GET_ITER
                            116 PRECALL                  0
                            120 CALL                     0
                            130 STORE_FAST               3 (all_components)
                
-               229         132 LOAD_CONST               3 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 229>)
+               243         132 LOAD_CONST               3 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 243>)
                            134 MAKE_FUNCTION            0
                            136 LOAD_FAST                3 (all_components)
                            138 GET_ITER
                            140 PRECALL                  0
                            144 CALL                     0
                            154 STORE_FAST               4 (all_component_names)
                
-               230         156 LOAD_GLOBAL              7 (NULL + len)
+               244         156 LOAD_GLOBAL              7 (NULL + len)
                            168 LOAD_FAST                4 (all_component_names)
                            170 PRECALL                  1
                            174 CALL                     1
                            184 LOAD_GLOBAL              7 (NULL + len)
                            196 LOAD_GLOBAL              9 (NULL + set)
                            208 LOAD_FAST                4 (all_component_names)
                            210 PRECALL                  1
@@ -1737,126 +1821,126 @@
                            244 POP_JUMP_FORWARD_IF_TRUE    10 (to 266)
                            246 LOAD_ASSERTION_ERROR
                            248 LOAD_CONST               4 ('Duplicate components in layout config')
                            250 PRECALL                  0
                            254 CALL                     0
                            264 RAISE_VARARGS            1
                
-               231     >>  266 LOAD_CONST               5 (<code object <dictcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 231>)
+               245     >>  266 LOAD_CONST               5 (<code object <dictcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 245>)
                            268 MAKE_FUNCTION            0
                            270 LOAD_GLOBAL             11 (NULL + zip)
                            282 LOAD_FAST                4 (all_component_names)
                            284 LOAD_FAST                3 (all_components)
                            286 PRECALL                  2
                            290 CALL                     2
                            300 GET_ITER
                            302 PRECALL                  0
                            306 CALL                     0
                            316 LOAD_FAST                0 (self)
                            318 STORE_ATTR               6 (components)
                
-               234         328 LOAD_GLOBAL             11 (NULL + zip)
+               248         328 LOAD_GLOBAL             11 (NULL + zip)
                            340 LOAD_FAST                3 (all_components)
                            342 LOAD_FAST                4 (all_component_names)
                            344 PRECALL                  2
                            348 CALL                     2
                            358 GET_ITER
                        >>  360 FOR_ITER               112 (to 586)
                            362 UNPACK_SEQUENCE          2
                            366 STORE_FAST               5 (comp)
                            368 STORE_FAST               6 (comp_name)
                
-               235         370 LOAD_FAST                6 (comp_name)
+               249         370 LOAD_FAST                6 (comp_name)
                
-               236         372 COPY                     1
+               250         372 COPY                     1
                            374 LOAD_CONST               6 ('Prompt')
                            376 COMPARE_OP               2 (==)
                            382 POP_JUMP_FORWARD_IF_FALSE     9 (to 402)
                            384 POP_TOP
                
-               237         386 LOAD_FAST                5 (comp)
+               251         386 LOAD_FAST                5 (comp)
                            388 LOAD_FAST                0 (self)
                            390 STORE_ATTR               7 (prompt_cfg)
                            400 JUMP_BACKWARD           21 (to 360)
                
-               238     >>  402 COPY                     1
+               252     >>  402 COPY                     1
                            404 LOAD_CONST               7 ('Sequences')
                            406 COMPARE_OP               2 (==)
                            412 POP_JUMP_FORWARD_IF_FALSE     9 (to 432)
                            414 POP_TOP
                
-               239         416 LOAD_FAST                5 (comp)
+               253         416 LOAD_FAST                5 (comp)
                            418 LOAD_FAST                0 (self)
                            420 STORE_ATTR               8 (seq_cfg)
                            430 JUMP_BACKWARD           36 (to 360)
                
-               240     >>  432 COPY                     1
+               254     >>  432 COPY                     1
                            434 LOAD_CONST               8 ('ActsHistogram')
                            436 COMPARE_OP               2 (==)
                            442 POP_JUMP_FORWARD_IF_FALSE     9 (to 462)
                            444 POP_TOP
                
-               241         446 LOAD_FAST                5 (comp)
+               255         446 LOAD_FAST                5 (comp)
                            448 LOAD_FAST                0 (self)
                            450 STORE_ATTR               9 (act_hist_cfg)
                            460 JUMP_BACKWARD           51 (to 360)
                
-               242     >>  462 COPY                     1
+               256     >>  462 COPY                     1
                            464 LOAD_CONST               9 ('LogitsHistogram')
                            466 COMPARE_OP               2 (==)
                            472 POP_JUMP_FORWARD_IF_FALSE     9 (to 492)
                            474 POP_TOP
                
-               243         476 LOAD_FAST                5 (comp)
+               257         476 LOAD_FAST                5 (comp)
                            478 LOAD_FAST                0 (self)
                            480 STORE_ATTR              10 (logits_hist_cfg)
                            490 JUMP_BACKWARD           66 (to 360)
                
-               244     >>  492 COPY                     1
+               258     >>  492 COPY                     1
                            494 LOAD_CONST              10 ('LogitsTable')
                            496 COMPARE_OP               2 (==)
                            502 POP_JUMP_FORWARD_IF_FALSE     9 (to 522)
                            504 POP_TOP
                
-               245         506 LOAD_FAST                5 (comp)
+               259         506 LOAD_FAST                5 (comp)
                            508 LOAD_FAST                0 (self)
                            510 STORE_ATTR              11 (logits_table_cfg)
                            520 JUMP_BACKWARD           81 (to 360)
                
-               246     >>  522 LOAD_CONST              11 ('FeatureTables')
+               260     >>  522 LOAD_CONST              11 ('FeatureTables')
                            524 COMPARE_OP               2 (==)
                            530 POP_JUMP_FORWARD_IF_FALSE     8 (to 548)
                
-               247         532 LOAD_FAST                5 (comp)
+               261         532 LOAD_FAST                5 (comp)
                            534 LOAD_FAST                0 (self)
-                           536 STORE_ATTR              12 (feat_tables_cfg)
+                           536 STORE_ATTR              12 (feature_tables_cfg)
                            546 JUMP_BACKWARD           94 (to 360)
                
-               248     >>  548 NOP
+               262     >>  548 NOP
                
-               249         550 LOAD_GLOBAL             27 (NULL + ValueError)
+               263         550 LOAD_GLOBAL             27 (NULL + ValueError)
                            562 LOAD_CONST              12 ('Unknown component name ')
                            564 LOAD_FAST                6 (comp_name)
                            566 FORMAT_VALUE             0
                            568 BUILD_STRING             2
                            570 PRECALL                  1
                            574 CALL                     1
                            584 RAISE_VARARGS            1
                
-               234     >>  586 LOAD_CONST              13 (None)
+               248     >>  586 LOAD_CONST              13 (None)
                            588 RETURN_VALUE
                consts
                   "\n        The __init__ method will allow you to extract things like `self.seq_cfg` from the object (even though they're \n        initially stored in the `columns` attribute). It also verifies that there are no duplicate components (which is\n        redundant, and could mess up the HTML).\n        "
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
                      flags     : 19
                      code 0x970069007c005d085c0200007d017d027c017c0293028c095300
-                     225           0 RESUME                   0
+                     239           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                 8 (to 24)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (idx)
                                   14 STORE_FAST               2 (col)
                                   16 LOAD_FAST                1 (idx)
@@ -1867,23 +1951,23 @@
                      consts
                      names      ()
                      varnames   ('.0', 'idx', 'col')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                      name       '<dictcomp>'
-                     firstlineno 225
+                     firstlineno 239
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
                      flags     : 19
                      code 0x970067007c005d097d017c0144005d047d027c0291038c058c0a5300
-                     228           0 RESUME                   0
+                     242           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                 9 (to 26)
                                    8 STORE_FAST               1 (column)
                                   10 LOAD_FAST                1 (column)
                                   12 GET_ITER
                              >>   14 FOR_ITER                 4 (to 24)
@@ -1896,26 +1980,26 @@
                      consts
                      names      ()
                      varnames   ('.0', 'column', 'component')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                      name       '<listcomp>'
-                     firstlineno 228
+                     firstlineno 242
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 5
                      flags     : 19
                      code
                         0x970067007c005d217d017c016a0000000000000000006a010000000000
                         000000a00200000000000000000000000000000000000000006400a60100
                         00ab01000000000000000091028c225300
-                     229           0 RESUME                   0
+                     243           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                33 (to 74)
                                    8 STORE_FAST               1 (comp)
                                   10 LOAD_FAST                1 (comp)
                                   12 LOAD_ATTR                0 (__class__)
                                   22 LOAD_ATTR                1 (__name__)
@@ -1930,24 +2014,24 @@
                         'Config'
                      names      ('__class__', '__name__', 'rstrip')
                      varnames   ('.0', 'comp')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                      name       '<listcomp>'
-                     firstlineno 229
+                     firstlineno 243
                      lnotab 0x
                   'Duplicate components in layout config'
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
                      flags     : 19
                      code 0x970069007c005d085c0200007d017d027c017c0293028c095300
-                     231           0 RESUME                   0
+                     245           0 RESUME                   0
                                    2 BUILD_MAP                0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                 8 (to 24)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (name)
                                   14 STORE_FAST               2 (comp)
                                   16 LOAD_FAST                1 (name)
@@ -1958,31 +2042,31 @@
                      consts
                      names      ()
                      varnames   ('.0', 'name', 'comp')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                      name       '<dictcomp>'
-                     firstlineno 231
+                     firstlineno 245
                      lnotab 0x
                   'Prompt'
                   'Sequences'
                   'ActsHistogram'
                   'LogitsHistogram'
                   'LogitsTable'
                   'FeatureTables'
                   'Unknown component name '
                   None
-               names      ('enumerate', 'columns', 'values', 'len', 'set', 'zip', 'components', 'prompt_cfg', 'seq_cfg', 'act_hist_cfg', 'logits_hist_cfg', 'logits_table_cfg', 'feat_tables_cfg', 'ValueError')
+               names      ('enumerate', 'columns', 'values', 'len', 'set', 'zip', 'components', 'prompt_cfg', 'seq_cfg', 'act_hist_cfg', 'logits_hist_cfg', 'logits_table_cfg', 'feature_tables_cfg', 'ValueError')
                varnames   ('self', 'columns', 'kwargs', 'all_components', 'all_component_names', 'comp', 'comp_name')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       '__init__'
-               firstlineno 218
+               firstlineno 232
                lnotab
                   0x02073c03460118016e013e032a0102010e0110010e0110010e0110010e
                   0110010e0110010a011001020124f1
             'other'
             'return'
             code
                argcount  : 2
@@ -1992,69 +2076,69 @@
                code
                   0x97007c006a000000000000000000a00100000000000000000000000000
                   00000000000000a6000000ab00000000000000000044005d365c0200007d
                   027d037c027c016a000000000000000000760172030100640153007c016a
                   0000000000000000007c02190000000000000000007d047c03a002000000
                   00000000000000000000000000000000007c04a6010000ab010000000000
                   00000073030100640153008c3764025300
-               251           0 RESUME                   0
+               265           0 RESUME                   0
                
-               258           2 LOAD_FAST                0 (self)
+               272           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (components)
                             14 LOAD_METHOD              1 (items)
                             36 PRECALL                  0
                             40 CALL                     0
                             50 GET_ITER
                        >>   52 FOR_ITER                54 (to 162)
                             54 UNPACK_SEQUENCE          2
                             58 STORE_FAST               2 (comp_name)
                             60 STORE_FAST               3 (comp)
                
-               260          62 LOAD_FAST                2 (comp_name)
+               274          62 LOAD_FAST                2 (comp_name)
                             64 LOAD_FAST                1 (other)
                             66 LOAD_ATTR                0 (components)
                             76 CONTAINS_OP              1
                             78 POP_JUMP_FORWARD_IF_FALSE     3 (to 86)
                
-               261          80 POP_TOP
+               275          80 POP_TOP
                             82 LOAD_CONST               1 (False)
                             84 RETURN_VALUE
                
-               263     >>   86 LOAD_FAST                1 (other)
+               277     >>   86 LOAD_FAST                1 (other)
                             88 LOAD_ATTR                0 (components)
                             98 LOAD_FAST                2 (comp_name)
                            100 BINARY_SUBSCR
                            110 STORE_FAST               4 (comp_other)
                
-               264         112 LOAD_FAST                3 (comp)
+               278         112 LOAD_FAST                3 (comp)
                            114 LOAD_METHOD              2 (data_is_contained_in)
                            136 LOAD_FAST                4 (comp_other)
                            138 PRECALL                  1
                            142 CALL                     1
                            152 POP_JUMP_FORWARD_IF_TRUE     3 (to 160)
                
-               265         154 POP_TOP
+               279         154 POP_TOP
                            156 LOAD_CONST               1 (False)
                            158 RETURN_VALUE
                
-               264     >>  160 JUMP_BACKWARD           55 (to 52)
+               278     >>  160 JUMP_BACKWARD           55 (to 52)
                
-               267     >>  162 LOAD_CONST               2 (True)
+               281     >>  162 LOAD_CONST               2 (True)
                            164 RETURN_VALUE
                consts
                   "\n        Returns True if `self` uses only data that would already exist in `other`. This is useful because our prompt-\n        centric vis needs to only use data that was already computed as part of our initial data gathering. For example,\n        if our SaeVisData object only contains the first 10 rows of the logits table, then we can't show the top 15 rows\n        in the prompt centric view!\n        "
                   False
                   True
                names      ('components', 'items', 'data_is_contained_in')
                varnames   ('self', 'other', 'comp_name', 'comp', 'comp_other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'data_is_contained_in'
-               firstlineno 251
+               firstlineno 265
                lnotab 0x02073c02120106021a012a0106ff0203
             True
             'title'
             'key'
             code
                argcount  : 3
                nlocals   : 20
@@ -2087,101 +2171,101 @@
                   00000000007c0e6407a6030000ab0300000000000000007d127c0f7c126b
                   0300000000721264087c0e9b0064097c0f9b02640a7c129b02640b7c119b
                   00640c7c109b009d0a7d136e0e640d7c0e9b0064097c0f9b02640e7c119b
                   00640c7c109b009d087d137c0ca005000000000000000000000000000000
                   00000000007c13a6010000ab01000000000000000001008c9690018c1b90
                   018c59741d000000000000000000007c03a6010000ab0100000000000000
                   000100640f5300
-               269           0 RESUME                   0
+               283           0 RESUME                   0
                
-               280           2 LOAD_FAST                2 (key)
+               294           2 LOAD_FAST                2 (key)
                              4 POP_JUMP_FORWARD_IF_FALSE    13 (to 32)
                              6 LOAD_FAST                1 (title)
                              8 LOAD_CONST               1 ('\n\n')
                             10 LOAD_GLOBAL              0 (KEY_LAYOUT_VIS)
                             22 BINARY_OP                0 (+)
                             26 BINARY_OP               13 (+=)
                             30 STORE_FAST               1 (title)
                
-               281     >>   32 LOAD_GLOBAL              3 (NULL + Tree)
+               295     >>   32 LOAD_GLOBAL              3 (NULL + Tree)
                             44 LOAD_FAST                1 (title)
                             46 PRECALL                  1
                             50 CALL                     1
                             60 STORE_FAST               3 (tree)
                
-               283          62 LOAD_GLOBAL              5 (NULL + len)
+               297          62 LOAD_GLOBAL              5 (NULL + len)
                             74 LOAD_FAST                0 (self)
                             76 LOAD_ATTR                3 (columns)
                             86 PRECALL                  1
                             90 CALL                     1
                            100 STORE_FAST               4 (n_columns)
                
-               286         102 LOAD_FAST                0 (self)
+               300         102 LOAD_FAST                0 (self)
                            104 LOAD_ATTR                3 (columns)
                            114 LOAD_METHOD              4 (items)
                            136 PRECALL                  0
                            140 CALL                     0
                            150 GET_ITER
                        >>  152 EXTENDED_ARG             1
                            154 FOR_ITER               343 (to 842)
                            156 UNPACK_SEQUENCE          2
                            160 STORE_FAST               5 (column_idx)
                            162 STORE_FAST               6 (vis_components)
                
-               288         164 LOAD_GLOBAL              5 (NULL + len)
+               302         164 LOAD_GLOBAL              5 (NULL + len)
                            176 LOAD_FAST                6 (vis_components)
                            178 PRECALL                  1
                            182 CALL                     1
                            192 STORE_FAST               7 (n_components)
                
-               289         194 LOAD_FAST                3 (tree)
+               303         194 LOAD_FAST                3 (tree)
                            196 LOAD_METHOD              5 (add)
                            218 LOAD_CONST               2 ('Column ')
                            220 LOAD_FAST                5 (column_idx)
                            222 FORMAT_VALUE             0
                            224 BUILD_STRING             2
                            226 PRECALL                  1
                            230 CALL                     1
                            240 STORE_FAST               8 (tree_column)
                
-               292         242 LOAD_GLOBAL             13 (NULL + enumerate)
+               306         242 LOAD_GLOBAL             13 (NULL + enumerate)
                            254 LOAD_FAST                6 (vis_components)
                            256 PRECALL                  1
                            260 CALL                     1
                            270 GET_ITER
                        >>  272 EXTENDED_ARG             1
                            274 FOR_ITER               281 (to 838)
                            276 UNPACK_SEQUENCE          2
                            280 STORE_FAST               9 (component_idx)
                            282 STORE_FAST              10 (vis_component)
                
-               294         284 LOAD_GLOBAL              5 (NULL + len)
+               308         284 LOAD_GLOBAL              5 (NULL + len)
                            296 LOAD_GLOBAL             15 (NULL + asdict)
                            308 LOAD_FAST               10 (vis_component)
                            310 PRECALL                  1
                            314 CALL                     1
                            324 PRECALL                  1
                            328 CALL                     1
                            338 STORE_FAST              11 (n_params)
                
-               295         340 LOAD_FAST                8 (tree_column)
+               309         340 LOAD_FAST                8 (tree_column)
                            342 LOAD_METHOD              5 (add)
                            364 LOAD_FAST               10 (vis_component)
                            366 LOAD_ATTR                8 (__class__)
                            376 LOAD_ATTR                9 (__name__)
                            386 FORMAT_VALUE             0
                            388 LOAD_METHOD             10 (rstrip)
                            410 LOAD_CONST               3 ('Config')
                            412 PRECALL                  1
                            416 CALL                     1
                            426 PRECALL                  1
                            430 CALL                     1
                            440 STORE_FAST              12 (tree_component)
                
-               298         442 LOAD_GLOBAL             13 (NULL + enumerate)
+               312         442 LOAD_GLOBAL             13 (NULL + enumerate)
                            454 LOAD_GLOBAL             15 (NULL + asdict)
                            466 LOAD_FAST               10 (vis_component)
                            468 PRECALL                  1
                            472 CALL                     1
                            482 LOAD_METHOD              4 (items)
                            504 PRECALL                  0
                            508 CALL                     0
@@ -2191,64 +2275,64 @@
                        >>  534 FOR_ITER               149 (to 834)
                            536 UNPACK_SEQUENCE          2
                            540 STORE_FAST              13 (param_idx)
                            542 UNPACK_SEQUENCE          2
                            546 STORE_FAST              14 (param)
                            548 STORE_FAST              15 (value)
                
-               302         550 LOAD_FAST               13 (param_idx)
+               316         550 LOAD_FAST               13 (param_idx)
                            552 LOAD_FAST               11 (n_params)
                            554 LOAD_CONST               4 (1)
                            556 BINARY_OP               10 (-)
                            560 COMPARE_OP               2 (==)
                            566 POP_JUMP_FORWARD_IF_FALSE     2 (to 572)
                            568 LOAD_CONST               5 ('\n')
                            570 JUMP_FORWARD             1 (to 574)
                        >>  572 LOAD_CONST               6 ('')
                        >>  574 STORE_FAST              16 (suffix)
                
-               303         576 LOAD_FAST                9 (component_idx)
+               317         576 LOAD_FAST                9 (component_idx)
                            578 LOAD_FAST                7 (n_components)
                            580 LOAD_CONST               4 (1)
                            582 BINARY_OP               10 (-)
                            586 COMPARE_OP               2 (==)
                            592 POP_JUMP_FORWARD_IF_FALSE    11 (to 616)
                            594 LOAD_FAST                5 (column_idx)
                            596 LOAD_FAST                4 (n_columns)
                            598 LOAD_CONST               4 (1)
                            600 BINARY_OP               10 (-)
                            604 COMPARE_OP               2 (==)
                            610 POP_JUMP_FORWARD_IF_FALSE     2 (to 616)
                            612 LOAD_CONST               6 ('')
                            614 STORE_FAST              16 (suffix)
                
-               306     >>  616 LOAD_FAST               10 (vis_component)
+               320     >>  616 LOAD_FAST               10 (vis_component)
                            618 LOAD_ATTR               11 (help_dict)
                            628 LOAD_METHOD             12 (get)
                            650 LOAD_FAST               14 (param)
                            652 LOAD_CONST               6 ('')
                            654 PRECALL                  2
                            658 CALL                     2
                            668 STORE_FAST              17 (desc)
                
-               307         670 LOAD_GLOBAL             27 (NULL + getattr)
+               321         670 LOAD_GLOBAL             27 (NULL + getattr)
                            682 LOAD_FAST               10 (vis_component)
                            684 LOAD_ATTR                8 (__class__)
                            694 LOAD_FAST               14 (param)
                            696 LOAD_CONST               7 ('no default')
                            698 PRECALL                  3
                            702 CALL                     3
                            712 STORE_FAST              18 (value_default)
                
-               310         714 LOAD_FAST               15 (value)
+               324         714 LOAD_FAST               15 (value)
                            716 LOAD_FAST               18 (value_default)
                            718 COMPARE_OP               3 (!=)
                            724 POP_JUMP_FORWARD_IF_FALSE    18 (to 762)
                
-               311         726 LOAD_CONST               8 ('[b dark_orange]')
+               325         726 LOAD_CONST               8 ('[b dark_orange]')
                            728 LOAD_FAST               14 (param)
                            730 FORMAT_VALUE             0
                            732 LOAD_CONST               9 (': ')
                            734 LOAD_FAST               15 (value)
                            736 FORMAT_VALUE             2 (repr)
                            738 LOAD_CONST              10 ('[/] (')
                            740 LOAD_FAST               18 (value_default)
@@ -2259,44 +2343,44 @@
                            750 LOAD_CONST              12 ('[/i]')
                            752 LOAD_FAST               16 (suffix)
                            754 FORMAT_VALUE             0
                            756 BUILD_STRING            10
                            758 STORE_FAST              19 (info)
                            760 JUMP_FORWARD            14 (to 790)
                
-               313     >>  762 LOAD_CONST              13 ('[b #00aa00]')
+               327     >>  762 LOAD_CONST              13 ('[b #00aa00]')
                            764 LOAD_FAST               14 (param)
                            766 FORMAT_VALUE             0
                            768 LOAD_CONST               9 (': ')
                            770 LOAD_FAST               15 (value)
                            772 FORMAT_VALUE             2 (repr)
                            774 LOAD_CONST              14 ('[/] \n[i]')
                            776 LOAD_FAST               17 (desc)
                            778 FORMAT_VALUE             0
                            780 LOAD_CONST              12 ('[/i]')
                            782 LOAD_FAST               16 (suffix)
                            784 FORMAT_VALUE             0
                            786 BUILD_STRING             8
                            788 STORE_FAST              19 (info)
                
-               314     >>  790 LOAD_FAST               12 (tree_component)
+               328     >>  790 LOAD_FAST               12 (tree_component)
                            792 LOAD_METHOD              5 (add)
                            814 LOAD_FAST               19 (info)
                            816 PRECALL                  1
                            820 CALL                     1
                            830 POP_TOP
                            832 JUMP_BACKWARD          150 (to 534)
                
-               298     >>  834 EXTENDED_ARG             1
+               312     >>  834 EXTENDED_ARG             1
                            836 JUMP_BACKWARD          283 (to 272)
                
-               292     >>  838 EXTENDED_ARG             1
+               306     >>  838 EXTENDED_ARG             1
                            840 JUMP_BACKWARD          345 (to 152)
                
-               316     >>  842 LOAD_GLOBAL             29 (NULL + rprint)
+               330     >>  842 LOAD_GLOBAL             29 (NULL + rprint)
                            854 LOAD_FAST                3 (tree)
                            856 PRECALL                  1
                            860 CALL                     1
                            870 POP_TOP
                            872 LOAD_CONST              15 (None)
                            874 RETURN_VALUE
                consts
@@ -2318,15 +2402,15 @@
                   None
                names      ('KEY_LAYOUT_VIS', 'Tree', 'len', 'columns', 'items', 'add', 'enumerate', 'asdict', '__class__', '__name__', 'rstrip', 'help_dict', 'get', 'getattr', 'rprint')
                varnames   ('self', 'title', 'key', 'tree', 'n_columns', 'column_idx', 'vis_components', 'n_components', 'tree_column', 'component_idx', 'vis_component', 'n_params', 'tree_component', 'param_idx', 'param', 'value', 'suffix', 'desc', 'value_default', 'info')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help'
-               firstlineno 269
+               firstlineno 283
                lnotab
                   0x020b1e011e0228033e021e0130032a02380166036c041a01280336012c
                   030c0124021c012cf004fa0418
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 9
@@ -2337,53 +2421,53 @@
                   0100000000000000000000740500000000000000000000a6000000ab0000
                   00000000000000740700000000000000000000a6000000ab000000000000
                   000000740900000000000000000000a6000000ab000000000000000000a6
                   030000ab030000000000000000740100000000000000000000740b000000
                   000000000000006401ac02a6010000ab010000000000000000a6010000ab
                   01000000000000000067036403ac04a6020000ab02000000000000000053
                   00
-               318           0 RESUME                   0
+               332           0 RESUME                   0
                
-               320           2 PUSH_NULL
+               334           2 PUSH_NULL
                              4 LOAD_FAST                0 (cls)
                
-               322           6 LOAD_GLOBAL              1 (NULL + Column)
+               336           6 LOAD_GLOBAL              1 (NULL + Column)
                             18 LOAD_GLOBAL              3 (NULL + FeatureTablesConfig)
                             30 PRECALL                  0
                             34 CALL                     0
                             44 PRECALL                  1
                             48 CALL                     1
                
-               323          58 LOAD_GLOBAL              1 (NULL + Column)
+               337          58 LOAD_GLOBAL              1 (NULL + Column)
                             70 LOAD_GLOBAL              5 (NULL + ActsHistogramConfig)
                             82 PRECALL                  0
                             86 CALL                     0
                             96 LOAD_GLOBAL              7 (NULL + LogitsTableConfig)
                            108 PRECALL                  0
                            112 CALL                     0
                            122 LOAD_GLOBAL              9 (NULL + LogitsHistogramConfig)
                            134 PRECALL                  0
                            138 CALL                     0
                            148 PRECALL                  3
                            152 CALL                     3
                
-               324         162 LOAD_GLOBAL              1 (NULL + Column)
+               338         162 LOAD_GLOBAL              1 (NULL + Column)
                            174 LOAD_GLOBAL             11 (NULL + SequencesConfig)
                            186 LOAD_CONST               1 ('stack-none')
                            188 KW_NAMES                 2
                            190 PRECALL                  1
                            194 CALL                     1
                            204 PRECALL                  1
                            208 CALL                     1
                
-               321         218 BUILD_LIST               3
+               335         218 BUILD_LIST               3
                
-               326         220 LOAD_CONST               3 (750)
+               340         220 LOAD_CONST               3 (750)
                
-               320         222 KW_NAMES                 4
+               334         222 KW_NAMES                 4
                            224 PRECALL                  2
                            228 CALL                     2
                            238 RETURN_VALUE
                consts
                   None
                   'stack-none'
                   ('stack_mode',)
@@ -2391,67 +2475,67 @@
                   ('columns', 'height')
                names      ('Column', 'FeatureTablesConfig', 'ActsHistogramConfig', 'LogitsTableConfig', 'LogitsHistogramConfig', 'SequencesConfig')
                varnames   ('cls',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'default_feature_centric_layout'
-               firstlineno 318
+               firstlineno 332
                lnotab 0x020204023401680138fd020502fa
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 11
                flags     : 3
                code
                   0x970002007c007401000000000000000000007403000000000000000000
                   00a6000000ab000000000000000000740500000000000000000000a60000
                   00ab0000000000000000007407000000000000000000006401ac02a60100
                   00ab01000000000000000074090000000000000000000064036404ac05a6
                   020000ab0200000000000000006406ac07a6050000ab0500000000000000
                   0067016408ac09a6020000ab0200000000000000005300
-               329           0 RESUME                   0
+               343           0 RESUME                   0
                
-               331           2 PUSH_NULL
+               345           2 PUSH_NULL
                              4 LOAD_FAST                0 (cls)
                
-               333           6 LOAD_GLOBAL              1 (NULL + Column)
+               347           6 LOAD_GLOBAL              1 (NULL + Column)
                
-               334          18 LOAD_GLOBAL              3 (NULL + PromptConfig)
+               348          18 LOAD_GLOBAL              3 (NULL + PromptConfig)
                             30 PRECALL                  0
                             34 CALL                     0
                
-               335          44 LOAD_GLOBAL              5 (NULL + ActsHistogramConfig)
+               349          44 LOAD_GLOBAL              5 (NULL + ActsHistogramConfig)
                             56 PRECALL                  0
                             60 CALL                     0
                
-               336          70 LOAD_GLOBAL              7 (NULL + LogitsTableConfig)
+               350          70 LOAD_GLOBAL              7 (NULL + LogitsTableConfig)
                             82 LOAD_CONST               1 (5)
                             84 KW_NAMES                 2
                             86 PRECALL                  1
                             90 CALL                     1
                
-               337         100 LOAD_GLOBAL              9 (NULL + SequencesConfig)
+               351         100 LOAD_GLOBAL              9 (NULL + SequencesConfig)
                            112 LOAD_CONST               3 (10)
                            114 LOAD_CONST               4 (0)
                            116 KW_NAMES                 5
                            118 PRECALL                  2
                            122 CALL                     2
                
-               338         132 LOAD_CONST               6 (450)
+               352         132 LOAD_CONST               6 (450)
                
-               333         134 KW_NAMES                 7
+               347         134 KW_NAMES                 7
                            136 PRECALL                  5
                            140 CALL                     5
                
-               332         150 BUILD_LIST               1
+               346         150 BUILD_LIST               1
                
-               341         152 LOAD_CONST               8 (1000)
+               355         152 LOAD_CONST               8 (1000)
                
-               331         154 KW_NAMES                 9
+               345         154 KW_NAMES                 9
                            156 PRECALL                  2
                            160 CALL                     2
                            170 RETURN_VALUE
                consts
                   None
                   5
                   ('n_rows',)
@@ -2464,25 +2548,25 @@
                   ('columns', 'height')
                names      ('Column', 'PromptConfig', 'ActsHistogramConfig', 'LogitsTableConfig', 'SequencesConfig')
                varnames   ('cls',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'default_prompt_centric_layout'
-               firstlineno 329
+               firstlineno 343
                lnotab 0x020204020c011a011a011e01200102fb10ff020902f6
             ('SaeVisLayoutConfig', True)
             ('return', 'SaeVisLayoutConfig')
-         names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'dict', 'columns', 'int', 'tuple', 'Column', '__annotations__', 'height', 'seq_cfg', 'SequencesConfig', 'act_hist_cfg', 'ActsHistogramConfig', 'logits_hist_cfg', 'LogitsHistogramConfig', 'logits_table_cfg', 'LogitsTableConfig', 'feat_tables_cfg', 'FeatureTablesConfig', 'prompt_cfg', 'PromptConfig', 'list', '__init__', 'bool', 'data_is_contained_in', 'str', 'Tree', 'help', 'classmethod', 'default_feature_centric_layout', 'default_prompt_centric_layout')
+         names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'dict', 'columns', 'int', 'tuple', 'Column', '__annotations__', 'height', 'seq_cfg', 'SequencesConfig', 'act_hist_cfg', 'ActsHistogramConfig', 'logits_hist_cfg', 'LogitsHistogramConfig', 'logits_table_cfg', 'LogitsTableConfig', 'feature_tables_cfg', 'FeatureTablesConfig', 'prompt_cfg', 'PromptConfig', 'list', '__init__', 'bool', 'data_is_contained_in', 'str', 'Tree', 'help', 'classmethod', 'default_feature_centric_layout', 'default_prompt_centric_layout')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'SaeVisLayoutConfig'
-         firstlineno 181
+         firstlineno 195
          lnotab
             0x0c03041848010e0214011401140114011401140218211014020102fd04
             0202fe020302fd020408fc0831020106ff0e01020a020106ff0e01
       'SaeVisLayoutConfig'
       'Key: \n  the tree shows which components will be displayed in each column (from left to right)\n  arguments are [b #00aa00]green[/]\n  arguments changed from their default are [b dark_orange]orange[/], with default in brackets\n  argument descriptions are in [i]italics[/i]\n'
       'The hook point to use for the SAE'
       "The set of features which we'll be gathering data for. If an integer, we only get data for 1 feature"
@@ -2504,120 +2588,120 @@
             0819000000000000000000650664043c00000064055a0b6508650664063c
             00000064075a0c6508650664083c0000000200650d650e6a0f0000000000
             000000ac09a6010000ab0100000000000000005a10650e6506640a3c0000
             000200650d650e6a110000000000000000ac09a6010000ab010000000000
             0000005a12650e6506640b3c000000640c5a136504650819000000000000
             0000006506640d3c000000640e5a1465156506640f3c0000006410651666
             02641184045a176414641265056602641384055a1864015300
-         366           0 RESUME                   0
+         380           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('SaeVisConfig')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         371          12 LOAD_CONST               1 (None)
+         385          12 LOAD_CONST               1 (None)
                       14 STORE_NAME               3 (hook_point)
                       16 LOAD_NAME                4 (Optional)
                       18 LOAD_NAME                5 (str)
                       20 BINARY_SUBSCR
                       30 LOAD_NAME                6 (__annotations__)
                       32 LOAD_CONST               2 ('hook_point')
                       34 STORE_SUBSCR
          
-         372          38 LOAD_CONST               1 (None)
+         386          38 LOAD_CONST               1 (None)
                       40 STORE_NAME               7 (features)
                       42 LOAD_NAME                4 (Optional)
                       44 LOAD_NAME                8 (int)
                       46 LOAD_NAME                9 (Iterable)
                       48 LOAD_NAME                8 (int)
                       50 BINARY_SUBSCR
                       60 BINARY_OP                7 (|)
                       64 BINARY_SUBSCR
                       74 LOAD_NAME                6 (__annotations__)
                       76 LOAD_CONST               3 ('features')
                       78 STORE_SUBSCR
          
-         373          82 LOAD_CONST               1 (None)
+         387          82 LOAD_CONST               1 (None)
                       84 STORE_NAME              10 (batch_size)
                       86 LOAD_NAME                4 (Optional)
                       88 LOAD_NAME                8 (int)
                       90 BINARY_SUBSCR
                      100 LOAD_NAME                6 (__annotations__)
                      102 LOAD_CONST               4 ('batch_size')
                      104 STORE_SUBSCR
          
-         374         108 LOAD_CONST               5 (256)
+         388         108 LOAD_CONST               5 (256)
                      110 STORE_NAME              11 (minibatch_size_features)
                      112 LOAD_NAME                8 (int)
                      114 LOAD_NAME                6 (__annotations__)
                      116 LOAD_CONST               6 ('minibatch_size_features')
                      118 STORE_SUBSCR
          
-         375         122 LOAD_CONST               7 (64)
+         389         122 LOAD_CONST               7 (64)
                      124 STORE_NAME              12 (minibatch_size_tokens)
                      126 LOAD_NAME                8 (int)
                      128 LOAD_NAME                6 (__annotations__)
                      130 LOAD_CONST               8 ('minibatch_size_tokens')
                      132 STORE_SUBSCR
          
-         378         136 PUSH_NULL
+         392         136 PUSH_NULL
                      138 LOAD_NAME               13 (field)
                      140 LOAD_NAME               14 (SaeVisLayoutConfig)
                      142 LOAD_ATTR               15 (default_feature_centric_layout)
                      152 KW_NAMES                 9
                      154 PRECALL                  1
                      158 CALL                     1
                      168 STORE_NAME              16 (feature_centric_layout)
                      170 LOAD_NAME               14 (SaeVisLayoutConfig)
                      172 LOAD_NAME                6 (__annotations__)
                      174 LOAD_CONST              10 ('feature_centric_layout')
                      176 STORE_SUBSCR
          
-         379         180 PUSH_NULL
+         393         180 PUSH_NULL
                      182 LOAD_NAME               13 (field)
                      184 LOAD_NAME               14 (SaeVisLayoutConfig)
                      186 LOAD_ATTR               17 (default_prompt_centric_layout)
                      196 KW_NAMES                 9
                      198 PRECALL                  1
                      202 CALL                     1
                      212 STORE_NAME              18 (prompt_centric_layout)
                      214 LOAD_NAME               14 (SaeVisLayoutConfig)
                      216 LOAD_NAME                6 (__annotations__)
                      218 LOAD_CONST              11 ('prompt_centric_layout')
                      220 STORE_SUBSCR
          
-         382         224 LOAD_CONST              12 (0)
+         396         224 LOAD_CONST              12 (0)
                      226 STORE_NAME              19 (seed)
                      228 LOAD_NAME                4 (Optional)
                      230 LOAD_NAME                8 (int)
                      232 BINARY_SUBSCR
                      242 LOAD_NAME                6 (__annotations__)
                      244 LOAD_CONST              13 ('seed')
                      246 STORE_SUBSCR
          
-         383         250 LOAD_CONST              14 (False)
+         397         250 LOAD_CONST              14 (False)
                      252 STORE_NAME              20 (verbose)
                      254 LOAD_NAME               21 (bool)
                      256 LOAD_NAME                6 (__annotations__)
                      258 LOAD_CONST              15 ('verbose')
                      260 STORE_SUBSCR
          
-         385         264 LOAD_CONST              16 ('return')
+         399         264 LOAD_CONST              16 ('return')
                      266 LOAD_NAME               22 (dict)
                      268 BUILD_TUPLE              2
-                     270 LOAD_CONST              17 (<code object to_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 385>)
+                     270 LOAD_CONST              17 (<code object to_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 399>)
                      272 MAKE_FUNCTION            4 (annotations)
                      274 STORE_NAME              23 (to_dict)
          
-         389         276 LOAD_CONST              20 (('SaeVisConfig',))
+         403         276 LOAD_CONST              20 (('SaeVisConfig',))
                      278 LOAD_CONST              18 ('title')
                      280 LOAD_NAME                5 (str)
                      282 BUILD_TUPLE              2
-                     284 LOAD_CONST              19 (<code object help, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 389>)
+                     284 LOAD_CONST              19 (<code object help, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_config_classes.py", line 403>)
                      286 MAKE_FUNCTION            5 (defaults, annotations)
                      288 STORE_NAME              24 (help)
                      290 LOAD_CONST               1 (None)
                      292 RETURN_VALUE
          consts
             'SaeVisConfig'
             None
@@ -2638,28 +2722,28 @@
             'return'
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x970064015300
-               385           0 RESUME                   0
+               399           0 RESUME                   0
                
-               387           2 LOAD_CONST               1 (None)
+               401           2 LOAD_CONST               1 (None)
                              4 RETURN_VALUE
                consts
                   'Used for type hinting (the actual method comes from the `dataclass_json` decorator).'
                   None
                names      ()
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'to_dict'
-               firstlineno 385
+               firstlineno 399
                lnotab 0x0202
             'title'
             code
                argcount  : 2
                nlocals   : 9
                stacksize : 8
                flags     : 3
@@ -2676,119 +2760,119 @@
                   02a00600000000000000000000000000000000000000007c037c08640c7c
                   049b00640b9d03a6030000ab03000000000000000001008c74740f000000
                   000000000000007c02a6010000ab01000000000000000001007c006a0800
                   00000000000000a009000000000000000000000000000000000000000064
                   0d640eac0fa6020000ab02000000000000000001007c006a0a0000000000
                   000000a00900000000000000000000000000000000000000006410640eac
                   0fa6020000ab020000000000000000010064115300
-               389           0 RESUME                   0
+               403           0 RESUME                   0
                
-               394           2 LOAD_GLOBAL              1 (NULL + Table)
+               408           2 LOAD_GLOBAL              1 (NULL + Table)
                             14 LOAD_CONST               1 ('Param')
                             16 LOAD_CONST               2 ('Value (default)')
                             18 LOAD_CONST               3 ('Description')
                             20 LOAD_FAST                1 (title)
                             22 LOAD_CONST               4 (True)
                             24 KW_NAMES                 5
                             26 PRECALL                  5
                             30 CALL                     5
                             40 STORE_FAST               2 (table)
                
-               397          42 LOAD_GLOBAL              2 (SAE_CONFIG_DICT)
+               411          42 LOAD_GLOBAL              2 (SAE_CONFIG_DICT)
                             54 LOAD_METHOD              2 (items)
                             76 PRECALL                  0
                             80 CALL                     0
                             90 GET_ITER
                        >>   92 FOR_ITER               115 (to 324)
                             94 UNPACK_SEQUENCE          2
                             98 STORE_FAST               3 (param)
                            100 STORE_FAST               4 (desc)
                
-               398         102 LOAD_GLOBAL              7 (NULL + getattr)
+               412         102 LOAD_GLOBAL              7 (NULL + getattr)
                            114 LOAD_FAST                0 (self)
                            116 LOAD_FAST                3 (param)
                            118 PRECALL                  2
                            122 CALL                     2
                            132 STORE_FAST               5 (value)
                
-               399         134 LOAD_GLOBAL              7 (NULL + getattr)
+               413         134 LOAD_GLOBAL              7 (NULL + getattr)
                            146 LOAD_FAST                0 (self)
                            148 LOAD_ATTR                4 (__class__)
                            158 LOAD_FAST                3 (param)
                            160 LOAD_CONST               6 ('no default')
                            162 PRECALL                  3
                            166 CALL                     3
                            176 STORE_FAST               6 (value_default)
                
-               400         178 LOAD_FAST                5 (value)
+               414         178 LOAD_FAST                5 (value)
                            180 LOAD_FAST                6 (value_default)
                            182 COMPARE_OP               3 (!=)
                            188 POP_JUMP_FORWARD_IF_FALSE    33 (to 256)
                
-               401         190 LOAD_FAST                6 (value_default)
+               415         190 LOAD_FAST                6 (value_default)
                            192 LOAD_CONST               6 ('no default')
                            194 COMPARE_OP               2 (==)
                            200 POP_JUMP_FORWARD_IF_FALSE     2 (to 206)
                            202 LOAD_CONST               6 ('no default')
                            204 JUMP_FORWARD            14 (to 234)
                        >>  206 LOAD_GLOBAL             11 (NULL + repr)
                            218 LOAD_FAST                6 (value_default)
                            220 PRECALL                  1
                            224 CALL                     1
                        >>  234 STORE_FAST               7 (value_default_repr)
                
-               402         236 LOAD_CONST               7 ('[b dark_orange]')
+               416         236 LOAD_CONST               7 ('[b dark_orange]')
                            238 LOAD_FAST                5 (value)
                            240 FORMAT_VALUE             2 (repr)
                            242 LOAD_CONST               8 ('[/]\n(')
                            244 LOAD_FAST                7 (value_default_repr)
                            246 FORMAT_VALUE             0
                            248 LOAD_CONST               9 (')')
                            250 BUILD_STRING             5
                            252 STORE_FAST               8 (value_str)
                            254 JUMP_FORWARD             6 (to 268)
                
-               404     >>  256 LOAD_CONST              10 ('[b #00aa00]')
+               418     >>  256 LOAD_CONST              10 ('[b #00aa00]')
                            258 LOAD_FAST                5 (value)
                            260 FORMAT_VALUE             2 (repr)
                            262 LOAD_CONST              11 ('[/]')
                            264 BUILD_STRING             3
                            266 STORE_FAST               8 (value_str)
                
-               405     >>  268 LOAD_FAST                2 (table)
+               419     >>  268 LOAD_FAST                2 (table)
                            270 LOAD_METHOD              6 (add_row)
                            292 LOAD_FAST                3 (param)
                            294 LOAD_FAST                8 (value_str)
                            296 LOAD_CONST              12 ('[i]')
                            298 LOAD_FAST                4 (desc)
                            300 FORMAT_VALUE             0
                            302 LOAD_CONST              11 ('[/]')
                            304 BUILD_STRING             3
                            306 PRECALL                  3
                            310 CALL                     3
                            320 POP_TOP
                            322 JUMP_BACKWARD          116 (to 92)
                
-               408     >>  324 LOAD_GLOBAL             15 (NULL + rprint)
+               422     >>  324 LOAD_GLOBAL             15 (NULL + rprint)
                            336 LOAD_FAST                2 (table)
                            338 PRECALL                  1
                            342 CALL                     1
                            352 POP_TOP
                
-               409         354 LOAD_FAST                0 (self)
+               423         354 LOAD_FAST                0 (self)
                            356 LOAD_ATTR                8 (feature_centric_layout)
                            366 LOAD_METHOD              9 (help)
                            388 LOAD_CONST              13 ('SaeVisLayoutConfig: feature-centric vis')
                            390 LOAD_CONST              14 (False)
                            392 KW_NAMES                15
                            394 PRECALL                  2
                            398 CALL                     2
                            408 POP_TOP
                
-               410         410 LOAD_FAST                0 (self)
+               424         410 LOAD_FAST                0 (self)
                            412 LOAD_ATTR               10 (prompt_centric_layout)
                            422 LOAD_METHOD              9 (help)
                            444 LOAD_CONST              16 ('SaeVisLayoutConfig: prompt-centric vis')
                            446 LOAD_CONST              14 (False)
                            448 KW_NAMES                15
                            450 PRECALL                  2
                            454 CALL                     2
@@ -2816,35 +2900,35 @@
                   None
                names      ('Table', 'SAE_CONFIG_DICT', 'items', 'getattr', '__class__', 'repr', 'add_row', 'rprint', 'feature_centric_layout', 'help', 'prompt_centric_layout')
                varnames   ('self', 'title', 'table', 'param', 'desc', 'value', 'value_default', 'value_default_repr', 'value_str')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
                name       'help'
-               firstlineno 389
+               firstlineno 403
                lnotab 0x020528033c0120012c010c012e0114020c0138031e013801
             ('SaeVisConfig',)
          names      ('__name__', '__module__', '__qualname__', 'hook_point', 'Optional', 'str', '__annotations__', 'features', 'int', 'Iterable', 'batch_size', 'minibatch_size_features', 'minibatch_size_tokens', 'field', 'SaeVisLayoutConfig', 'default_feature_centric_layout', 'feature_centric_layout', 'default_prompt_centric_layout', 'prompt_centric_layout', 'seed', 'verbose', 'bool', 'dict', 'to_dict', 'help')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
          name       'SaeVisConfig'
-         firstlineno 366
+         firstlineno 380
          lnotab 0x0c051a012c011a010e010e032c012c031a010e020c04
       'SaeVisConfig'
       None
    names      ('dataclasses', 'dataclass', 'asdict', 'field', 'dataclasses_json', 'dataclass_json', 'config', 'typing', 'Optional', 'Iterable', 'Union', 'Literal', 'Iterator', 'Any', 'rich', 'print', 'rprint', 'rich.tree', 'Tree', 'rich.table', 'Table', 'dict', 'SEQUENCES_CONFIG_HELP', 'ACTIVATIONS_HISTOGRAM_CONFIG_HELP', 'LOGITS_HISTOGRAM_CONFIG_HELP', 'LOGITS_TABLE_CONFIG_HELP', 'FEATURE_TABLES_CONFIG_HELP', 'BaseComponentConfig', 'PromptConfig', 'SequencesConfig', 'ActsHistogramConfig', 'LogitsHistogramConfig', 'LogitsTableConfig', 'FeatureTablesConfig', 'GenericComponentConfig', 'Column', 'SaeVisLayoutConfig', 'KEY_LAYOUT_VIS', 'SAE_CONFIG_DICT', 'SaeVisConfig')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_config_classes.py'
    name       '<module>'
    firstlineno 1
    lnotab
       0x00ff02011401100120010c010c010c0304010202020202020201020102
-      01020302f31210040102ff1204040102ff1204040102ff1204040102ff12
-      04020118ff0e01021402011aff0e01020402011aff0e01021f02011aff0e
-      01020c02011aff0e01020c02011aff0e01020c02011aff0e01020c020102
-      01020102010201020102fb02ff0c091a150201020118ff0eff0e02027f00
-      230408040102010201020202020201020102f7120d0201020118ff0eff0e
-      02
+      01020302f31210040102ff1204040102ff1204040102ff12040401020102
+      010201020102fb1208020118ff0e01021402011aff0e01020402011aff0e
+      01021f02011aff0e01020c02011aff0e01020c02011aff0e01020c02011a
+      ff0e01021602010201020102010201020102fb02ff0c091a150201020118
+      ff0eff0e02027f00230408040102010201020202020201020102f7120d02
+      01020118ff0eff0e02
```

### Comparing `sae-vis-0.2.7/sae_vis/__pycache__/data_fetching_fns.cpython-311.pyc` & `sae-vis-0.2.8/sae_vis/__pycache__/data_fetching_fns.cpython-311.pyc`

 * *Files 5% similar despite different names*

#### Python bytecode

```diff
@@ -1,72 +1,73 @@
 magic:    0xa70d0d0a
-moddate:  0xfc450966 (Sun Mar 31 11:16:12 2024 UTC)
-files sz: 47062
+moddate:  0x146c1166 (Sat Apr  6 15:36:52 2024 UTC)
+files sz: 49956
 code
    argcount  : 0
    nlocals   : 0
-   stacksize : 30
+   stacksize : 32
    flags     : 0
    code
       0x9700640064016c005a00640064016c015a02640064016c035a03640064
       016c045a04640064026c046d055a050100640064036c066d065a06010064
       0064046c076d085a086d095a090100640064016c0a6d0b630201006d0c5a
       0d0100640064016c0e5a0e640064056c0f6d105a106d115a110100640064
       066c126d135a140100640064076c156d165a160100640064086c176d185a
       180100640064096c196d1a5a1a6d1b5a1b01006400640a6c1c6d1d5a1d01
       0065026a1e00000000000000005a1f6400640b6c206d215a216d225a226d
       235a2301006400640c6c246d255a256d265a266d275a276d285a286d295a
       296d2a5a2a01006400640d6c2b6d2c5a2c6d2d5a2d6d2e5a2e6d2f5a2f6d
       305a306d315a316d325a326d335a336d345a3401006400640e6c356d365a
       366d375a376d385a38010002006529a6000000ab0000000000000000005a
-      39090009000900643e640f65106505641066021900000000000000000064
-      116511650564126602190000000000000000006413652164146508652119
-      00000000000000000064156508652a190000000000000000006416650865
-      2a1900000000000000000064176510650564186602190000000000000000
-      00660e641984055a3a020065046a3b0000000000000000a6000000ab0000
-      000000000000000900090009000900643f641a65116505641b6602190000
-      00000000000000641c6509653c653d653c19000000000000000000660219
-      000000000000000000641d65106505641e66021900000000000000000064
-      1f6510650564206602190000000000000000006421651065056422660219
-      000000000000000000642365106505642466021900000000000000000064
-      256537642665086510650564276602190000000000000000001900000000
-      000000000064156508652a1900000000000000000064166508652a190000
-      0000000000000064286508653d651d190000000000000000001900000000
-      00000000006417653e6531653f6540654166021900000000000000000066
-      0219000000000000000000661864298405a6000000ab0000000000000000
-      005a42020065046a3b0000000000000000a6000000ab0000000000000000
-      00090064406413652164146508652119000000000000000000642a652264
-      1a65116505641b660219000000000000000000641c6509653c653d653c19
-      000000000000000000660219000000000000000000642565376428650865
-      3d651d19000000000000000000190000000000000000006417653e653165
-      3f6540654166021900000000000000000066021900000000000000000066
-      10642b8405a6000000ab0000000000000000005a43020065046a3b000000
-      0000000000a6000000ab0000000000000000000900644064136521642a65
-      1b641a65116505641b660219000000000000000000642565376414650865
-      211900000000000000000064176531660c642c8405a6000000ab00000000
-      00000000005a44020065046a3b0000000000000000a6000000ab00000000
-      0000000000641a65116505641b660219000000000000000000642d651065
-      05641b660219000000000000000000642e65106505642f66021900000000
-      00000000006430651065056431660219000000000000000000641f651065
-      056432660219000000000000000000642365106505642466021900000000
-      0000000000643365386417652e661064348404a6000000ab000000000000
-      0000005a45020065046a3b0000000000000000a6000000ab000000000000
-      000000090009006441641a65116505641b66021900000000000000000064
-      36653d65401900000000000000000064376531642d651065056438660219
-      000000000000000000641f65106505642066021900000000000000000064
-      306510650564396602190000000000000000006423651065056424660219
-      00000000000000000064116508653d653c19000000000000000000190000
-      00000000000000643a653c6417653f6540653e653d653c19000000000000
-      000000653d65401900000000000000000066021900000000000000000066
-      02190000000000000000006614643b8405a6000000ab0000000000000000
-      005a46020065046a3b0000000000000000a6000000ab0000000000000000
-      0064376531643c6540643a653c6417653f6540653e653d653c1900000000
-      0000000000653d6540190000000000000000006602190000000000000000
-      006602190000000000000000006608643d8404a6000000ab000000000000
-      0000005a4764015300
+      390900090009000900643f640f6510650564106602190000000000000000
+      006411651165056412660219000000000000000000641365216414650865
+      211900000000000000000064156508652a19000000000000000000641665
+      08652a1900000000000000000064176508652a1900000000000000000064
+      186510650564196602190000000000000000006610641a84055a3a020065
+      046a3b0000000000000000a6000000ab0000000000000000000900090009
+      00090009006440641b65116505641c660219000000000000000000641d65
+      09653c653d653c1900000000000000000066021900000000000000000064
+      1e65106505641f6602190000000000000000006420651065056421660219
+      000000000000000000642265106505642366021900000000000000000064
+      246510650564256602190000000000000000006426653764276508651065
+      056428660219000000000000000000190000000000000000006415650865
+      2a1900000000000000000064166508652a19000000000000000000641765
+      08652a1900000000000000000064296508653d651d190000000000000000
+      00190000000000000000006418653e6531653f6540654166021900000000
+      0000000000660219000000000000000000661a642a8405a6000000ab0000
+      000000000000005a42020065046a3b0000000000000000a6000000ab0000
+      000000000000000900644164136521641465086521190000000000000000
+      00642b6522641b65116505641c660219000000000000000000641d650965
+      3c653d653c19000000000000000000660219000000000000000000642665
+      3764296508653d651d190000000000000000001900000000000000000064
+      18653e6531653f6540654166021900000000000000000066021900000000
+      00000000006610642c8405a6000000ab0000000000000000005a43020065
+      046a3b0000000000000000a6000000ab0000000000000000000900644164
+      136521642b651b641b65116505641c660219000000000000000000642665
+      376414650865211900000000000000000064186531660c642d8405a60000
+      00ab0000000000000000005a44020065046a3b0000000000000000a60000
+      00ab000000000000000000641b65116505641c6602190000000000000000
+      00642e65106505641c660219000000000000000000642f65106505643066
+      021900000000000000000064316510650564326602190000000000000000
+      006420651065056433660219000000000000000000642465106505642566
+      0219000000000000000000643465386418652e661064358404a6000000ab
+      0000000000000000005a45020065046a3b0000000000000000a6000000ab
+      000000000000000000090009006442641b65116505641c66021900000000
+      00000000006437653d65401900000000000000000064386531642e651065
+      056439660219000000000000000000642065106505642166021900000000
+      0000000000643165106505643a6602190000000000000000006424651065
+      05642566021900000000000000000064116508653d653c19000000000000
+      00000019000000000000000000643b653c6418653f6540653e653d653c19
+      000000000000000000653d65401900000000000000000066021900000000
+      00000000006602190000000000000000006614643c8405a6000000ab0000
+      000000000000005a46020065046a3b0000000000000000a6000000ab0000
+      0000000000000064386531643d6540643b653c6418653f6540653e653d65
+      3c19000000000000000000653d6540190000000000000000006602190000
+      000000000000006602190000000000000000006608643e8404a6000000ab
+      0000000000000000005a4764015300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (None)
                  6 IMPORT_NAME              0 (time)
                  8 STORE_NAME               0 (time)
    
@@ -243,521 +244,537 @@
    
     59         330 NOP
    
     60         332 NOP
    
     61         334 NOP
    
-    55         336 LOAD_CONST              62 ((None, None, None))
-               338 LOAD_CONST              15 ('model_acts')
+    62         336 NOP
    
-    56         340 LOAD_NAME               16 (Float)
-               342 LOAD_NAME                5 (Tensor)
-               344 LOAD_CONST              16 ('batch seq d_in')
-               346 BUILD_TUPLE              2
-               348 BINARY_SUBSCR
+    55         338 LOAD_CONST              63 ((None, None, None, None))
+               340 LOAD_CONST              15 ('model_acts')
    
-    55         358 LOAD_CONST              17 ('feature_idx')
+    56         342 LOAD_NAME               16 (Float)
+               344 LOAD_NAME                5 (Tensor)
+               346 LOAD_CONST              16 ('batch seq d_in')
+               348 BUILD_TUPLE              2
+               350 BINARY_SUBSCR
    
-    57         360 LOAD_NAME               17 (Int)
-               362 LOAD_NAME                5 (Tensor)
-               364 LOAD_CONST              18 ('feats')
-               366 BUILD_TUPLE              2
-               368 BINARY_SUBSCR
+    55         360 LOAD_CONST              17 ('feature_idx')
    
-    55         378 LOAD_CONST              19 ('encoder')
+    57         362 LOAD_NAME               17 (Int)
+               364 LOAD_NAME                5 (Tensor)
+               366 LOAD_CONST              18 ('feats')
+               368 BUILD_TUPLE              2
+               370 BINARY_SUBSCR
    
-    58         380 LOAD_NAME               33 (AutoEncoder)
+    55         380 LOAD_CONST              19 ('encoder')
    
-    55         382 LOAD_CONST              20 ('encoder_B')
+    58         382 LOAD_NAME               33 (AutoEncoder)
    
-    59         384 LOAD_NAME                8 (Optional)
-               386 LOAD_NAME               33 (AutoEncoder)
-               388 BINARY_SUBSCR
+    55         384 LOAD_CONST              20 ('encoder_B')
    
-    55         398 LOAD_CONST              21 ('corrcoef_neurons')
+    59         386 LOAD_NAME                8 (Optional)
+               388 LOAD_NAME               33 (AutoEncoder)
+               390 BINARY_SUBSCR
    
-    60         400 LOAD_NAME                8 (Optional)
-               402 LOAD_NAME               42 (BatchedCorrCoef)
-               404 BINARY_SUBSCR
+    55         400 LOAD_CONST              21 ('corrcoef_neurons')
    
-    55         414 LOAD_CONST              22 ('corrcoef_encoder_B')
+    60         402 LOAD_NAME                8 (Optional)
+               404 LOAD_NAME               42 (BatchedCorrCoef)
+               406 BINARY_SUBSCR
    
-    61         416 LOAD_NAME                8 (Optional)
-               418 LOAD_NAME               42 (BatchedCorrCoef)
-               420 BINARY_SUBSCR
+    55         416 LOAD_CONST              22 ('corrcoef_encoder')
    
-    55         430 LOAD_CONST              23 ('return')
+    61         418 LOAD_NAME                8 (Optional)
+               420 LOAD_NAME               42 (BatchedCorrCoef)
+               422 BINARY_SUBSCR
    
-    62         432 LOAD_NAME               16 (Float)
-               434 LOAD_NAME                5 (Tensor)
-               436 LOAD_CONST              24 ('batch seq feats')
-               438 BUILD_TUPLE              2
-               440 BINARY_SUBSCR
+    55         432 LOAD_CONST              23 ('corrcoef_encoder_B')
    
-    55         450 BUILD_TUPLE             14
-               452 LOAD_CONST              25 (<code object compute_feat_acts, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 55>)
-               454 MAKE_FUNCTION            5 (defaults, annotations)
-               456 STORE_NAME              58 (compute_feat_acts)
+    62         434 LOAD_NAME                8 (Optional)
+               436 LOAD_NAME               42 (BatchedCorrCoef)
+               438 BINARY_SUBSCR
    
-   115         458 PUSH_NULL
-               460 LOAD_NAME                4 (torch)
-               462 LOAD_ATTR               59 (inference_mode)
-               472 PRECALL                  0
-               476 CALL                     0
+    55         448 LOAD_CONST              24 ('return')
    
-   124         486 NOP
+    63         450 LOAD_NAME               16 (Float)
+               452 LOAD_NAME                5 (Tensor)
+               454 LOAD_CONST              25 ('batch seq feats')
+               456 BUILD_TUPLE              2
+               458 BINARY_SUBSCR
    
-   125         488 NOP
+    55         468 BUILD_TUPLE             16
+               470 LOAD_CONST              26 (<code object compute_feat_acts, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 55>)
+               472 MAKE_FUNCTION            5 (defaults, annotations)
+               474 STORE_NAME              58 (compute_feat_acts)
    
-   126         490 NOP
+   125         476 PUSH_NULL
+               478 LOAD_NAME                4 (torch)
+               480 LOAD_ATTR               59 (inference_mode)
+               490 PRECALL                  0
+               494 CALL                     0
    
-   127         492 NOP
+   134         504 NOP
    
-   116         494 LOAD_CONST              63 ((None, None, None, None))
-               496 LOAD_CONST              26 ('tokens')
+   135         506 NOP
    
-   117         498 LOAD_NAME               17 (Int)
-               500 LOAD_NAME                5 (Tensor)
-               502 LOAD_CONST              27 ('batch seq')
-               504 BUILD_TUPLE              2
-               506 BINARY_SUBSCR
+   136         508 NOP
    
-   116         516 LOAD_CONST              28 ('feature_indices')
+   137         510 NOP
    
-   118         518 LOAD_NAME                9 (Union)
-               520 LOAD_NAME               60 (int)
-               522 LOAD_NAME               61 (list)
-               524 LOAD_NAME               60 (int)
+   138         512 NOP
+   
+   126         514 LOAD_CONST              64 ((None, None, None, None, None))
+               516 LOAD_CONST              27 ('tokens')
+   
+   127         518 LOAD_NAME               17 (Int)
+               520 LOAD_NAME                5 (Tensor)
+               522 LOAD_CONST              28 ('batch seq')
+               524 BUILD_TUPLE              2
                526 BINARY_SUBSCR
-               536 BUILD_TUPLE              2
-               538 BINARY_SUBSCR
    
-   116         548 LOAD_CONST              29 ('all_feat_acts')
+   126         536 LOAD_CONST              29 ('feature_indices')
    
-   119         550 LOAD_NAME               16 (Float)
-               552 LOAD_NAME                5 (Tensor)
-               554 LOAD_CONST              30 ('... feats')
+   128         538 LOAD_NAME                9 (Union)
+               540 LOAD_NAME               60 (int)
+               542 LOAD_NAME               61 (list)
+               544 LOAD_NAME               60 (int)
+               546 BINARY_SUBSCR
                556 BUILD_TUPLE              2
                558 BINARY_SUBSCR
    
-   116         568 LOAD_CONST              31 ('feature_resid_dir')
+   126         568 LOAD_CONST              30 ('all_feat_acts')
    
-   120         570 LOAD_NAME               16 (Float)
+   129         570 LOAD_NAME               16 (Float)
                572 LOAD_NAME                5 (Tensor)
-               574 LOAD_CONST              32 ('feats d_model')
+               574 LOAD_CONST              31 ('... feats')
                576 BUILD_TUPLE              2
                578 BINARY_SUBSCR
    
-   116         588 LOAD_CONST              33 ('all_resid_post')
+   126         588 LOAD_CONST              32 ('feature_resid_dir')
    
-   121         590 LOAD_NAME               16 (Float)
+   130         590 LOAD_NAME               16 (Float)
                592 LOAD_NAME                5 (Tensor)
-               594 LOAD_CONST              34 ('... d_model')
+               594 LOAD_CONST              33 ('feats d_model')
                596 BUILD_TUPLE              2
                598 BINARY_SUBSCR
    
-   116         608 LOAD_CONST              35 ('W_U')
+   126         608 LOAD_CONST              34 ('all_resid_post')
    
-   122         610 LOAD_NAME               16 (Float)
+   131         610 LOAD_NAME               16 (Float)
                612 LOAD_NAME                5 (Tensor)
-               614 LOAD_CONST              36 ('d_model d_vocab')
+               614 LOAD_CONST              35 ('... d_model')
                616 BUILD_TUPLE              2
                618 BINARY_SUBSCR
    
-   116         628 LOAD_CONST              37 ('cfg')
+   126         628 LOAD_CONST              36 ('W_U')
    
-   123         630 LOAD_NAME               55 (SaeVisConfig)
+   132         630 LOAD_NAME               16 (Float)
+               632 LOAD_NAME                5 (Tensor)
+               634 LOAD_CONST              37 ('d_model d_vocab')
+               636 BUILD_TUPLE              2
+               638 BINARY_SUBSCR
    
-   116         632 LOAD_CONST              38 ('feature_out_dir')
+   126         648 LOAD_CONST              38 ('cfg')
    
-   124         634 LOAD_NAME                8 (Optional)
-               636 LOAD_NAME               16 (Float)
-               638 LOAD_NAME                5 (Tensor)
-               640 LOAD_CONST              39 ('feats d_out')
-               642 BUILD_TUPLE              2
-               644 BINARY_SUBSCR
-               654 BINARY_SUBSCR
-   
-   116         664 LOAD_CONST              21 ('corrcoef_neurons')
-   
-   125         666 LOAD_NAME                8 (Optional)
-               668 LOAD_NAME               42 (BatchedCorrCoef)
-               670 BINARY_SUBSCR
-   
-   116         680 LOAD_CONST              22 ('corrcoef_encoder_B')
-   
-   126         682 LOAD_NAME                8 (Optional)
-               684 LOAD_NAME               42 (BatchedCorrCoef)
-               686 BINARY_SUBSCR
-   
-   116         696 LOAD_CONST              40 ('progress')
-   
-   127         698 LOAD_NAME                8 (Optional)
-               700 LOAD_NAME               61 (list)
-               702 LOAD_NAME               29 (tqdm)
-               704 BINARY_SUBSCR
-               714 BINARY_SUBSCR
-   
-   116         724 LOAD_CONST              23 ('return')
-   
-   128         726 LOAD_NAME               62 (tuple)
-               728 LOAD_NAME               49 (SaeVisData)
-               730 LOAD_NAME               63 (dict)
-               732 LOAD_NAME               64 (str)
-               734 LOAD_NAME               65 (float)
-               736 BUILD_TUPLE              2
-               738 BINARY_SUBSCR
-               748 BUILD_TUPLE              2
-               750 BINARY_SUBSCR
+   133         650 LOAD_NAME               55 (SaeVisConfig)
    
-   116         760 BUILD_TUPLE             24
-               762 LOAD_CONST              41 (<code object parse_feature_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 115>)
-               764 MAKE_FUNCTION            5 (defaults, annotations)
+   126         652 LOAD_CONST              39 ('feature_out_dir')
    
-   115         766 PRECALL                  0
-               770 CALL                     0
+   134         654 LOAD_NAME                8 (Optional)
+               656 LOAD_NAME               16 (Float)
+               658 LOAD_NAME                5 (Tensor)
+               660 LOAD_CONST              40 ('feats d_out')
+               662 BUILD_TUPLE              2
+               664 BINARY_SUBSCR
+               674 BINARY_SUBSCR
    
-   116         780 STORE_NAME              66 (parse_feature_data)
+   126         684 LOAD_CONST              21 ('corrcoef_neurons')
    
-   335         782 PUSH_NULL
-               784 LOAD_NAME                4 (torch)
-               786 LOAD_ATTR               59 (inference_mode)
-               796 PRECALL                  0
-               800 CALL                     0
+   135         686 LOAD_NAME                8 (Optional)
+               688 LOAD_NAME               42 (BatchedCorrCoef)
+               690 BINARY_SUBSCR
    
-   343         810 NOP
+   126         700 LOAD_CONST              22 ('corrcoef_encoder')
    
-   336         812 LOAD_CONST              64 ((None,))
-               814 LOAD_CONST              19 ('encoder')
+   136         702 LOAD_NAME                8 (Optional)
+               704 LOAD_NAME               42 (BatchedCorrCoef)
+               706 BINARY_SUBSCR
    
-   337         816 LOAD_NAME               33 (AutoEncoder)
+   126         716 LOAD_CONST              23 ('corrcoef_encoder_B')
    
-   336         818 LOAD_CONST              20 ('encoder_B')
+   137         718 LOAD_NAME                8 (Optional)
+               720 LOAD_NAME               42 (BatchedCorrCoef)
+               722 BINARY_SUBSCR
    
-   338         820 LOAD_NAME                8 (Optional)
-               822 LOAD_NAME               33 (AutoEncoder)
-               824 BINARY_SUBSCR
+   126         732 LOAD_CONST              41 ('progress')
    
-   336         834 LOAD_CONST              42 ('model')
+   138         734 LOAD_NAME                8 (Optional)
+               736 LOAD_NAME               61 (list)
+               738 LOAD_NAME               29 (tqdm)
+               740 BINARY_SUBSCR
+               750 BINARY_SUBSCR
    
-   339         836 LOAD_NAME               34 (TransformerLensWrapper)
+   126         760 LOAD_CONST              24 ('return')
    
-   336         838 LOAD_CONST              26 ('tokens')
+   139         762 LOAD_NAME               62 (tuple)
+               764 LOAD_NAME               49 (SaeVisData)
+               766 LOAD_NAME               63 (dict)
+               768 LOAD_NAME               64 (str)
+               770 LOAD_NAME               65 (float)
+               772 BUILD_TUPLE              2
+               774 BINARY_SUBSCR
+               784 BUILD_TUPLE              2
+               786 BINARY_SUBSCR
    
-   340         840 LOAD_NAME               17 (Int)
-               842 LOAD_NAME                5 (Tensor)
-               844 LOAD_CONST              27 ('batch seq')
-               846 BUILD_TUPLE              2
-               848 BINARY_SUBSCR
+   126         796 BUILD_TUPLE             26
+               798 LOAD_CONST              42 (<code object parse_feature_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 125>)
+               800 MAKE_FUNCTION            5 (defaults, annotations)
    
-   336         858 LOAD_CONST              28 ('feature_indices')
+   125         802 PRECALL                  0
+               806 CALL                     0
    
-   341         860 LOAD_NAME                9 (Union)
-               862 LOAD_NAME               60 (int)
-               864 LOAD_NAME               61 (list)
-               866 LOAD_NAME               60 (int)
-               868 BINARY_SUBSCR
-               878 BUILD_TUPLE              2
-               880 BINARY_SUBSCR
+   126         816 STORE_NAME              66 (parse_feature_data)
    
-   336         890 LOAD_CONST              37 ('cfg')
+   381         818 PUSH_NULL
+               820 LOAD_NAME                4 (torch)
+               822 LOAD_ATTR               59 (inference_mode)
+               832 PRECALL                  0
+               836 CALL                     0
    
-   342         892 LOAD_NAME               55 (SaeVisConfig)
+   389         846 NOP
    
-   336         894 LOAD_CONST              40 ('progress')
+   382         848 LOAD_CONST              65 ((None,))
+               850 LOAD_CONST              19 ('encoder')
    
-   343         896 LOAD_NAME                8 (Optional)
-               898 LOAD_NAME               61 (list)
-               900 LOAD_NAME               29 (tqdm)
-               902 BINARY_SUBSCR
-               912 BINARY_SUBSCR
+   383         852 LOAD_NAME               33 (AutoEncoder)
    
-   336         922 LOAD_CONST              23 ('return')
+   382         854 LOAD_CONST              20 ('encoder_B')
    
-   344         924 LOAD_NAME               62 (tuple)
-               926 LOAD_NAME               49 (SaeVisData)
-               928 LOAD_NAME               63 (dict)
-               930 LOAD_NAME               64 (str)
-               932 LOAD_NAME               65 (float)
-               934 BUILD_TUPLE              2
-               936 BINARY_SUBSCR
-               946 BUILD_TUPLE              2
-               948 BINARY_SUBSCR
+   384         856 LOAD_NAME                8 (Optional)
+               858 LOAD_NAME               33 (AutoEncoder)
+               860 BINARY_SUBSCR
+   
+   382         870 LOAD_CONST              43 ('model')
+   
+   385         872 LOAD_NAME               34 (TransformerLensWrapper)
+   
+   382         874 LOAD_CONST              27 ('tokens')
+   
+   386         876 LOAD_NAME               17 (Int)
+               878 LOAD_NAME                5 (Tensor)
+               880 LOAD_CONST              28 ('batch seq')
+               882 BUILD_TUPLE              2
+               884 BINARY_SUBSCR
+   
+   382         894 LOAD_CONST              29 ('feature_indices')
    
-   336         958 BUILD_TUPLE             16
-               960 LOAD_CONST              43 (<code object _get_feature_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 335>)
-               962 MAKE_FUNCTION            5 (defaults, annotations)
+   387         896 LOAD_NAME                9 (Union)
+               898 LOAD_NAME               60 (int)
+               900 LOAD_NAME               61 (list)
+               902 LOAD_NAME               60 (int)
+               904 BINARY_SUBSCR
+               914 BUILD_TUPLE              2
+               916 BINARY_SUBSCR
    
-   335         964 PRECALL                  0
-               968 CALL                     0
+   382         926 LOAD_CONST              38 ('cfg')
    
-   336         978 STORE_NAME              67 (_get_feature_data)
+   388         928 LOAD_NAME               55 (SaeVisConfig)
    
-   470         980 PUSH_NULL
-               982 LOAD_NAME                4 (torch)
-               984 LOAD_ATTR               59 (inference_mode)
-               994 PRECALL                  0
-               998 CALL                     0
+   382         930 LOAD_CONST              41 ('progress')
    
-   476        1008 NOP
+   389         932 LOAD_NAME                8 (Optional)
+               934 LOAD_NAME               61 (list)
+               936 LOAD_NAME               29 (tqdm)
+               938 BINARY_SUBSCR
+               948 BINARY_SUBSCR
+   
+   382         958 LOAD_CONST              24 ('return')
+   
+   390         960 LOAD_NAME               62 (tuple)
+               962 LOAD_NAME               49 (SaeVisData)
+               964 LOAD_NAME               63 (dict)
+               966 LOAD_NAME               64 (str)
+               968 LOAD_NAME               65 (float)
+               970 BUILD_TUPLE              2
+               972 BINARY_SUBSCR
+               982 BUILD_TUPLE              2
+               984 BINARY_SUBSCR
    
-   471        1010 LOAD_CONST              64 ((None,))
-              1012 LOAD_CONST              19 ('encoder')
+   382         994 BUILD_TUPLE             16
+               996 LOAD_CONST              44 (<code object _get_feature_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 381>)
+               998 MAKE_FUNCTION            5 (defaults, annotations)
    
-   472        1014 LOAD_NAME               33 (AutoEncoder)
+   381        1000 PRECALL                  0
+              1004 CALL                     0
    
-   471        1016 LOAD_CONST              42 ('model')
+   382        1014 STORE_NAME              67 (_get_feature_data)
    
-   473        1018 LOAD_NAME               27 (HookedTransformer)
+   526        1016 PUSH_NULL
+              1018 LOAD_NAME                4 (torch)
+              1020 LOAD_ATTR               59 (inference_mode)
+              1030 PRECALL                  0
+              1034 CALL                     0
    
-   471        1020 LOAD_CONST              26 ('tokens')
+   532        1044 NOP
    
-   474        1022 LOAD_NAME               17 (Int)
-              1024 LOAD_NAME                5 (Tensor)
-              1026 LOAD_CONST              27 ('batch seq')
-              1028 BUILD_TUPLE              2
-              1030 BINARY_SUBSCR
+   527        1046 LOAD_CONST              65 ((None,))
+              1048 LOAD_CONST              19 ('encoder')
    
-   471        1040 LOAD_CONST              37 ('cfg')
+   528        1050 LOAD_NAME               33 (AutoEncoder)
    
-   475        1042 LOAD_NAME               55 (SaeVisConfig)
+   527        1052 LOAD_CONST              43 ('model')
    
-   471        1044 LOAD_CONST              20 ('encoder_B')
+   529        1054 LOAD_NAME               27 (HookedTransformer)
    
-   476        1046 LOAD_NAME                8 (Optional)
-              1048 LOAD_NAME               33 (AutoEncoder)
-              1050 BINARY_SUBSCR
+   527        1056 LOAD_CONST              27 ('tokens')
    
-   471        1060 LOAD_CONST              23 ('return')
+   530        1058 LOAD_NAME               17 (Int)
+              1060 LOAD_NAME                5 (Tensor)
+              1062 LOAD_CONST              28 ('batch seq')
+              1064 BUILD_TUPLE              2
+              1066 BINARY_SUBSCR
    
-   477        1062 LOAD_NAME               49 (SaeVisData)
+   527        1076 LOAD_CONST              38 ('cfg')
    
-   471        1064 BUILD_TUPLE             12
-              1066 LOAD_CONST              44 (<code object get_feature_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 470>)
-              1068 MAKE_FUNCTION            5 (defaults, annotations)
+   531        1078 LOAD_NAME               55 (SaeVisConfig)
    
-   470        1070 PRECALL                  0
-              1074 CALL                     0
+   527        1080 LOAD_CONST              20 ('encoder_B')
    
-   471        1084 STORE_NAME              68 (get_feature_data)
+   532        1082 LOAD_NAME                8 (Optional)
+              1084 LOAD_NAME               33 (AutoEncoder)
+              1086 BINARY_SUBSCR
    
-   558        1086 PUSH_NULL
-              1088 LOAD_NAME                4 (torch)
-              1090 LOAD_ATTR               59 (inference_mode)
-              1100 PRECALL                  0
-              1104 CALL                     0
+   527        1096 LOAD_CONST              24 ('return')
    
-   559        1114 LOAD_CONST              26 ('tokens')
+   533        1098 LOAD_NAME               49 (SaeVisData)
    
-   560        1116 LOAD_NAME               17 (Int)
-              1118 LOAD_NAME                5 (Tensor)
-              1120 LOAD_CONST              27 ('batch seq')
-              1122 BUILD_TUPLE              2
-              1124 BINARY_SUBSCR
+   527        1100 BUILD_TUPLE             12
+              1102 LOAD_CONST              45 (<code object get_feature_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 526>)
+              1104 MAKE_FUNCTION            5 (defaults, annotations)
    
-   559        1134 LOAD_CONST              45 ('feat_acts')
+   526        1106 PRECALL                  0
+              1110 CALL                     0
    
-   561        1136 LOAD_NAME               16 (Float)
-              1138 LOAD_NAME                5 (Tensor)
-              1140 LOAD_CONST              27 ('batch seq')
-              1142 BUILD_TUPLE              2
-              1144 BINARY_SUBSCR
+   527        1120 STORE_NAME              68 (get_feature_data)
    
-   559        1154 LOAD_CONST              46 ('feat_logits')
+   614        1122 PUSH_NULL
+              1124 LOAD_NAME                4 (torch)
+              1126 LOAD_ATTR               59 (inference_mode)
+              1136 PRECALL                  0
+              1140 CALL                     0
    
-   562        1156 LOAD_NAME               16 (Float)
-              1158 LOAD_NAME                5 (Tensor)
-              1160 LOAD_CONST              47 ('d_vocab')
-              1162 BUILD_TUPLE              2
-              1164 BINARY_SUBSCR
+   615        1150 LOAD_CONST              27 ('tokens')
    
-   559        1174 LOAD_CONST              48 ('resid_post')
+   616        1152 LOAD_NAME               17 (Int)
+              1154 LOAD_NAME                5 (Tensor)
+              1156 LOAD_CONST              28 ('batch seq')
+              1158 BUILD_TUPLE              2
+              1160 BINARY_SUBSCR
    
-   563        1176 LOAD_NAME               16 (Float)
-              1178 LOAD_NAME                5 (Tensor)
-              1180 LOAD_CONST              49 ('batch seq d_model')
-              1182 BUILD_TUPLE              2
-              1184 BINARY_SUBSCR
+   615        1170 LOAD_CONST              46 ('feat_acts')
    
-   559        1194 LOAD_CONST              31 ('feature_resid_dir')
+   617        1172 LOAD_NAME               16 (Float)
+              1174 LOAD_NAME                5 (Tensor)
+              1176 LOAD_CONST              28 ('batch seq')
+              1178 BUILD_TUPLE              2
+              1180 BINARY_SUBSCR
    
-   564        1196 LOAD_NAME               16 (Float)
-              1198 LOAD_NAME                5 (Tensor)
-              1200 LOAD_CONST              50 ('d_model')
-              1202 BUILD_TUPLE              2
-              1204 BINARY_SUBSCR
+   615        1190 LOAD_CONST              47 ('feat_logits')
    
-   559        1214 LOAD_CONST              35 ('W_U')
+   618        1192 LOAD_NAME               16 (Float)
+              1194 LOAD_NAME                5 (Tensor)
+              1196 LOAD_CONST              48 ('d_vocab')
+              1198 BUILD_TUPLE              2
+              1200 BINARY_SUBSCR
    
-   565        1216 LOAD_NAME               16 (Float)
-              1218 LOAD_NAME                5 (Tensor)
-              1220 LOAD_CONST              36 ('d_model d_vocab')
-              1222 BUILD_TUPLE              2
-              1224 BINARY_SUBSCR
+   615        1210 LOAD_CONST              49 ('resid_post')
    
-   559        1234 LOAD_CONST              51 ('seq_cfg')
+   619        1212 LOAD_NAME               16 (Float)
+              1214 LOAD_NAME                5 (Tensor)
+              1216 LOAD_CONST              50 ('batch seq d_model')
+              1218 BUILD_TUPLE              2
+              1220 BINARY_SUBSCR
    
-   566        1236 LOAD_NAME               56 (SequencesConfig)
+   615        1230 LOAD_CONST              32 ('feature_resid_dir')
    
-   559        1238 LOAD_CONST              23 ('return')
+   620        1232 LOAD_NAME               16 (Float)
+              1234 LOAD_NAME                5 (Tensor)
+              1236 LOAD_CONST              51 ('d_model')
+              1238 BUILD_TUPLE              2
+              1240 BINARY_SUBSCR
    
-   567        1240 LOAD_NAME               46 (SequenceMultiGroupData)
+   615        1250 LOAD_CONST              36 ('W_U')
    
-   559        1242 BUILD_TUPLE             16
-              1244 LOAD_CONST              52 (<code object get_sequences_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 558>)
-              1246 MAKE_FUNCTION            4 (annotations)
+   621        1252 LOAD_NAME               16 (Float)
+              1254 LOAD_NAME                5 (Tensor)
+              1256 LOAD_CONST              37 ('d_model d_vocab')
+              1258 BUILD_TUPLE              2
+              1260 BINARY_SUBSCR
    
-   558        1248 PRECALL                  0
-              1252 CALL                     0
+   615        1270 LOAD_CONST              52 ('seq_cfg')
    
-   559        1262 STORE_NAME              69 (get_sequences_data)
+   622        1272 LOAD_NAME               56 (SequencesConfig)
    
-   707        1264 PUSH_NULL
-              1266 LOAD_NAME                4 (torch)
-              1268 LOAD_ATTR               59 (inference_mode)
-              1278 PRECALL                  0
-              1282 CALL                     0
+   615        1274 LOAD_CONST              24 ('return')
    
-   716        1292 NOP
+   623        1276 LOAD_NAME               46 (SequenceMultiGroupData)
    
-   717        1294 NOP
+   615        1278 BUILD_TUPLE             16
+              1280 LOAD_CONST              53 (<code object get_sequences_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 614>)
+              1282 MAKE_FUNCTION            4 (annotations)
    
-   708        1296 LOAD_CONST              65 ((None, 10))
-              1298 LOAD_CONST              26 ('tokens')
+   614        1284 PRECALL                  0
+              1288 CALL                     0
    
-   709        1300 LOAD_NAME               17 (Int)
-              1302 LOAD_NAME                5 (Tensor)
-              1304 LOAD_CONST              27 ('batch seq')
-              1306 BUILD_TUPLE              2
-              1308 BINARY_SUBSCR
+   615        1298 STORE_NAME              69 (get_sequences_data)
    
-   708        1318 LOAD_CONST              54 ('str_toks')
+   763        1300 PUSH_NULL
+              1302 LOAD_NAME                4 (torch)
+              1304 LOAD_ATTR               59 (inference_mode)
+              1314 PRECALL                  0
+              1318 CALL                     0
    
-   710        1320 LOAD_NAME               61 (list)
-              1322 LOAD_NAME               64 (str)
-              1324 BINARY_SUBSCR
+   772        1328 NOP
    
-   708        1334 LOAD_CONST              55 ('sae_vis_data')
+   773        1330 NOP
    
-   711        1336 LOAD_NAME               49 (SaeVisData)
+   764        1332 LOAD_CONST              66 ((None, 10))
+              1334 LOAD_CONST              27 ('tokens')
    
-   708        1338 LOAD_CONST              45 ('feat_acts')
+   765        1336 LOAD_NAME               17 (Int)
+              1338 LOAD_NAME                5 (Tensor)
+              1340 LOAD_CONST              28 ('batch seq')
+              1342 BUILD_TUPLE              2
+              1344 BINARY_SUBSCR
    
-   712        1340 LOAD_NAME               16 (Float)
-              1342 LOAD_NAME                5 (Tensor)
-              1344 LOAD_CONST              56 ('seq feats')
-              1346 BUILD_TUPLE              2
-              1348 BINARY_SUBSCR
+   764        1354 LOAD_CONST              55 ('str_toks')
    
-   708        1358 LOAD_CONST              31 ('feature_resid_dir')
+   766        1356 LOAD_NAME               61 (list)
+              1358 LOAD_NAME               64 (str)
+              1360 BINARY_SUBSCR
    
-   713        1360 LOAD_NAME               16 (Float)
-              1362 LOAD_NAME                5 (Tensor)
-              1364 LOAD_CONST              32 ('feats d_model')
-              1366 BUILD_TUPLE              2
-              1368 BINARY_SUBSCR
+   764        1370 LOAD_CONST              56 ('sae_vis_data')
    
-   708        1378 LOAD_CONST              48 ('resid_post')
+   767        1372 LOAD_NAME               49 (SaeVisData)
    
-   714        1380 LOAD_NAME               16 (Float)
-              1382 LOAD_NAME                5 (Tensor)
-              1384 LOAD_CONST              57 ('seq d_model')
-              1386 BUILD_TUPLE              2
-              1388 BINARY_SUBSCR
+   764        1374 LOAD_CONST              46 ('feat_acts')
    
-   708        1398 LOAD_CONST              35 ('W_U')
+   768        1376 LOAD_NAME               16 (Float)
+              1378 LOAD_NAME                5 (Tensor)
+              1380 LOAD_CONST              57 ('seq feats')
+              1382 BUILD_TUPLE              2
+              1384 BINARY_SUBSCR
    
-   715        1400 LOAD_NAME               16 (Float)
-              1402 LOAD_NAME                5 (Tensor)
-              1404 LOAD_CONST              36 ('d_model d_vocab')
-              1406 BUILD_TUPLE              2
-              1408 BINARY_SUBSCR
+   764        1394 LOAD_CONST              32 ('feature_resid_dir')
    
-   708        1418 LOAD_CONST              17 ('feature_idx')
+   769        1396 LOAD_NAME               16 (Float)
+              1398 LOAD_NAME                5 (Tensor)
+              1400 LOAD_CONST              33 ('feats d_model')
+              1402 BUILD_TUPLE              2
+              1404 BINARY_SUBSCR
    
-   716        1420 LOAD_NAME                8 (Optional)
-              1422 LOAD_NAME               61 (list)
-              1424 LOAD_NAME               60 (int)
-              1426 BINARY_SUBSCR
-              1436 BINARY_SUBSCR
+   764        1414 LOAD_CONST              49 ('resid_post')
    
-   708        1446 LOAD_CONST              58 ('num_top_features')
+   770        1416 LOAD_NAME               16 (Float)
+              1418 LOAD_NAME                5 (Tensor)
+              1420 LOAD_CONST              58 ('seq d_model')
+              1422 BUILD_TUPLE              2
+              1424 BINARY_SUBSCR
    
-   717        1448 LOAD_NAME               60 (int)
+   764        1434 LOAD_CONST              36 ('W_U')
    
-   708        1450 LOAD_CONST              23 ('return')
+   771        1436 LOAD_NAME               16 (Float)
+              1438 LOAD_NAME                5 (Tensor)
+              1440 LOAD_CONST              37 ('d_model d_vocab')
+              1442 BUILD_TUPLE              2
+              1444 BINARY_SUBSCR
    
-   718        1452 LOAD_NAME               63 (dict)
-              1454 LOAD_NAME               64 (str)
-              1456 LOAD_NAME               62 (tuple)
+   764        1454 LOAD_CONST              17 ('feature_idx')
+   
+   772        1456 LOAD_NAME                8 (Optional)
               1458 LOAD_NAME               61 (list)
               1460 LOAD_NAME               60 (int)
               1462 BINARY_SUBSCR
-              1472 LOAD_NAME               61 (list)
-              1474 LOAD_NAME               64 (str)
-              1476 BINARY_SUBSCR
-              1486 BUILD_TUPLE              2
-              1488 BINARY_SUBSCR
-              1498 BUILD_TUPLE              2
-              1500 BINARY_SUBSCR
-   
-   708        1510 BUILD_TUPLE             20
-              1512 LOAD_CONST              59 (<code object parse_prompt_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 707>)
-              1514 MAKE_FUNCTION            5 (defaults, annotations)
-   
-   707        1516 PRECALL                  0
-              1520 CALL                     0
-   
-   708        1530 STORE_NAME              70 (parse_prompt_data)
-   
-   869        1532 PUSH_NULL
-              1534 LOAD_NAME                4 (torch)
-              1536 LOAD_ATTR               59 (inference_mode)
-              1546 PRECALL                  0
-              1550 CALL                     0
-   
-   870        1560 LOAD_CONST              55 ('sae_vis_data')
-   
-   871        1562 LOAD_NAME               49 (SaeVisData)
-   
-   870        1564 LOAD_CONST              60 ('prompt')
-   
-   872        1566 LOAD_NAME               64 (str)
-   
-   870        1568 LOAD_CONST              58 ('num_top_features')
-   
-   873        1570 LOAD_NAME               60 (int)
-   
-   870        1572 LOAD_CONST              23 ('return')
-   
-   874        1574 LOAD_NAME               63 (dict)
-              1576 LOAD_NAME               64 (str)
-              1578 LOAD_NAME               62 (tuple)
-              1580 LOAD_NAME               61 (list)
-              1582 LOAD_NAME               60 (int)
-              1584 BINARY_SUBSCR
-              1594 LOAD_NAME               61 (list)
-              1596 LOAD_NAME               64 (str)
-              1598 BINARY_SUBSCR
-              1608 BUILD_TUPLE              2
-              1610 BINARY_SUBSCR
-              1620 BUILD_TUPLE              2
-              1622 BINARY_SUBSCR
-   
-   870        1632 BUILD_TUPLE              8
-              1634 LOAD_CONST              61 (<code object get_prompt_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 869>)
-              1636 MAKE_FUNCTION            4 (annotations)
-   
-   869        1638 PRECALL                  0
-              1642 CALL                     0
-   
-   870        1652 STORE_NAME              71 (get_prompt_data)
-              1654 LOAD_CONST               1 (None)
-              1656 RETURN_VALUE
+              1472 BINARY_SUBSCR
+   
+   764        1482 LOAD_CONST              59 ('num_top_features')
+   
+   773        1484 LOAD_NAME               60 (int)
+   
+   764        1486 LOAD_CONST              24 ('return')
+   
+   774        1488 LOAD_NAME               63 (dict)
+              1490 LOAD_NAME               64 (str)
+              1492 LOAD_NAME               62 (tuple)
+              1494 LOAD_NAME               61 (list)
+              1496 LOAD_NAME               60 (int)
+              1498 BINARY_SUBSCR
+              1508 LOAD_NAME               61 (list)
+              1510 LOAD_NAME               64 (str)
+              1512 BINARY_SUBSCR
+              1522 BUILD_TUPLE              2
+              1524 BINARY_SUBSCR
+              1534 BUILD_TUPLE              2
+              1536 BINARY_SUBSCR
+   
+   764        1546 BUILD_TUPLE             20
+              1548 LOAD_CONST              60 (<code object parse_prompt_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 763>)
+              1550 MAKE_FUNCTION            5 (defaults, annotations)
+   
+   763        1552 PRECALL                  0
+              1556 CALL                     0
+   
+   764        1566 STORE_NAME              70 (parse_prompt_data)
+   
+   925        1568 PUSH_NULL
+              1570 LOAD_NAME                4 (torch)
+              1572 LOAD_ATTR               59 (inference_mode)
+              1582 PRECALL                  0
+              1586 CALL                     0
+   
+   926        1596 LOAD_CONST              56 ('sae_vis_data')
+   
+   927        1598 LOAD_NAME               49 (SaeVisData)
+   
+   926        1600 LOAD_CONST              61 ('prompt')
+   
+   928        1602 LOAD_NAME               64 (str)
+   
+   926        1604 LOAD_CONST              59 ('num_top_features')
+   
+   929        1606 LOAD_NAME               60 (int)
+   
+   926        1608 LOAD_CONST              24 ('return')
+   
+   930        1610 LOAD_NAME               63 (dict)
+              1612 LOAD_NAME               64 (str)
+              1614 LOAD_NAME               62 (tuple)
+              1616 LOAD_NAME               61 (list)
+              1618 LOAD_NAME               60 (int)
+              1620 BINARY_SUBSCR
+              1630 LOAD_NAME               61 (list)
+              1632 LOAD_NAME               64 (str)
+              1634 BINARY_SUBSCR
+              1644 BUILD_TUPLE              2
+              1646 BINARY_SUBSCR
+              1656 BUILD_TUPLE              2
+              1658 BINARY_SUBSCR
+   
+   926        1668 BUILD_TUPLE              8
+              1670 LOAD_CONST              62 (<code object get_prompt_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 925>)
+              1672 MAKE_FUNCTION            4 (annotations)
+   
+   925        1674 PRECALL                  0
+              1678 CALL                     0
+   
+   926        1688 STORE_NAME              71 (get_prompt_data)
+              1690 LOAD_CONST               1 (None)
+              1692 RETURN_VALUE
    consts
       0
       None
       ('Tensor',)
       ('eindex',)
       ('Optional', 'Union')
       ('Float', 'Int')
@@ -773,190 +790,219 @@
       'model_acts'
       'batch seq d_in'
       'feature_idx'
       'feats'
       'encoder'
       'encoder_B'
       'corrcoef_neurons'
+      'corrcoef_encoder'
       'corrcoef_encoder_B'
       'return'
       'batch seq feats'
       code
-         argcount  : 6
-         nlocals   : 14
+         argcount  : 7
+         nlocals   : 15
          stacksize : 7
          flags     : 3
          code
             0x97007c026a0000000000000000006401640185027c0166021900000000
-            00000000007d067c026a0100000000000000007c01190000000000000000
-            007d077c007c026a0200000000000000007a0a00007d0874070000000000
-            00000000006a0400000000000000007c087c066402a6030000ab03000000
-            00000000007d09740b000000000000000000006a0600000000000000007c
-            097c077a000000a6010000ab0100000000000000007d0a7c04813c7c04a0
+            00000000007d077c026a0100000000000000007c01190000000000000000
+            007d087c007c026a0200000000000000007a0a00007d0974070000000000
+            00000000006a0400000000000000007c097c076402a6030000ab03000000
+            00000000007d0a740b000000000000000000006a0600000000000000007c
+            0a7c087a000000a6010000ab0100000000000000007d0b7c04813c7c04a0
             070000000000000000000000000000000000000000740700000000000000
-            0000006a0800000000000000007c0a6403a6020000ab0200000000000000
+            0000006a0800000000000000007c0b6403a6020000ab0200000000000000
             007407000000000000000000006a0800000000000000007c006404a60200
             00ab020000000000000000a6020000ab02000000000000000001007c0581
-            897c03800a4a006405a6000000ab00000000000000000082017c007c036a
-            0200000000000000007a0a00007d0b7407000000000000000000006a0400
-            000000000000007c0b7c036a0000000000000000006406a6030000ab0300
-            000000000000007d0c740b000000000000000000006a0600000000000000
-            007c0c7c026a0100000000000000007a000000a6010000ab010000000000
-            0000007d0d7c05a007000000000000000000000000000000000000000074
-            07000000000000000000006a0800000000000000007c0a6403a6020000ab
-            0200000000000000007407000000000000000000006a0800000000000000
-            007c0d6407a6020000ab020000000000000000a6020000ab020000000000
-            00000001007c0a5300
+            3c7c05a00700000000000000000000000000000000000000007407000000
+            000000000000006a0800000000000000007c0b6403a6020000ab02000000
+            00000000007407000000000000000000006a0800000000000000007c0b64
+            03a6020000ab020000000000000000a6020000ab02000000000000000001
+            007c0681897c03800a4a006405a6000000ab00000000000000000082017c
+            007c036a0200000000000000007a0a00007d0c7407000000000000000000
+            006a0400000000000000007c0c7c036a0000000000000000006406a60300
+            00ab0300000000000000007d0d740b000000000000000000006a06000000
+            00000000007c0d7c026a0100000000000000007a000000a6010000ab0100
+            000000000000007d0e7c06a0070000000000000000000000000000000000
+            0000007407000000000000000000006a0800000000000000007c0b6403a6
+            020000ab0200000000000000007407000000000000000000006a08000000
+            00000000007c0e6407a6020000ab020000000000000000a6020000ab0200
+            0000000000000001007c0b5300
           55           0 RESUME                   0
          
-          82           2 LOAD_FAST                2 (encoder)
+          85           2 LOAD_FAST                2 (encoder)
                        4 LOAD_ATTR                0 (W_enc)
                       14 LOAD_CONST               1 (None)
                       16 LOAD_CONST               1 (None)
                       18 BUILD_SLICE              2
                       20 LOAD_FAST                1 (feature_idx)
                       22 BUILD_TUPLE              2
                       24 BINARY_SUBSCR
-                      34 STORE_FAST               6 (feature_act_dir)
+                      34 STORE_FAST               7 (feature_act_dir)
          
-          83          36 LOAD_FAST                2 (encoder)
+          86          36 LOAD_FAST                2 (encoder)
                       38 LOAD_ATTR                1 (b_enc)
                       48 LOAD_FAST                1 (feature_idx)
                       50 BINARY_SUBSCR
-                      60 STORE_FAST               7 (feature_bias)
+                      60 STORE_FAST               8 (feature_bias)
          
-          86          62 LOAD_FAST                0 (model_acts)
+          89          62 LOAD_FAST                0 (model_acts)
                       64 LOAD_FAST                2 (encoder)
                       66 LOAD_ATTR                2 (b_dec)
                       76 BINARY_OP               10 (-)
-                      80 STORE_FAST               8 (x_cent)
+                      80 STORE_FAST               9 (x_cent)
          
-          87          82 LOAD_GLOBAL              7 (NULL + einops)
+          90          82 LOAD_GLOBAL              7 (NULL + einops)
                       94 LOAD_ATTR                4 (einsum)
-                     104 LOAD_FAST                8 (x_cent)
-                     106 LOAD_FAST                6 (feature_act_dir)
+                     104 LOAD_FAST                9 (x_cent)
+                     106 LOAD_FAST                7 (feature_act_dir)
                      108 LOAD_CONST               2 ('batch seq d_in, d_in feats -> batch seq feats')
                      110 PRECALL                  3
                      114 CALL                     3
-                     124 STORE_FAST               9 (feat_acts_pre)
+                     124 STORE_FAST              10 (feat_acts_pre)
          
-          88         126 LOAD_GLOBAL             11 (NULL + F)
+          91         126 LOAD_GLOBAL             11 (NULL + F)
                      138 LOAD_ATTR                6 (relu)
-                     148 LOAD_FAST                9 (feat_acts_pre)
-                     150 LOAD_FAST                7 (feature_bias)
+                     148 LOAD_FAST               10 (feat_acts_pre)
+                     150 LOAD_FAST                8 (feature_bias)
                      152 BINARY_OP                0 (+)
                      156 PRECALL                  1
                      160 CALL                     1
-                     170 STORE_FAST              10 (feat_acts)
+                     170 STORE_FAST              11 (feat_acts)
          
-          91         172 LOAD_FAST                4 (corrcoef_neurons)
+          94         172 LOAD_FAST                4 (corrcoef_neurons)
                      174 POP_JUMP_FORWARD_IF_NONE    60 (to 296)
          
-          92         176 LOAD_FAST                4 (corrcoef_neurons)
+          95         176 LOAD_FAST                4 (corrcoef_neurons)
                      178 LOAD_METHOD              7 (update)
          
-          93         200 LOAD_GLOBAL              7 (NULL + einops)
+          96         200 LOAD_GLOBAL              7 (NULL + einops)
                      212 LOAD_ATTR                8 (rearrange)
-                     222 LOAD_FAST               10 (feat_acts)
+                     222 LOAD_FAST               11 (feat_acts)
                      224 LOAD_CONST               3 ('batch seq feats -> feats (batch seq)')
                      226 PRECALL                  2
                      230 CALL                     2
          
-          94         240 LOAD_GLOBAL              7 (NULL + einops)
+          97         240 LOAD_GLOBAL              7 (NULL + einops)
                      252 LOAD_ATTR                8 (rearrange)
                      262 LOAD_FAST                0 (model_acts)
                      264 LOAD_CONST               4 ('batch seq d_in -> d_in (batch seq)')
                      266 PRECALL                  2
                      270 CALL                     2
          
-          92         280 PRECALL                  2
+          95         280 PRECALL                  2
                      284 CALL                     2
                      294 POP_TOP
          
-          98     >>  296 LOAD_FAST                5 (corrcoef_encoder_B)
-                     298 POP_JUMP_FORWARD_IF_NONE   137 (to 574)
+         101     >>  296 LOAD_FAST                5 (corrcoef_encoder)
+                     298 POP_JUMP_FORWARD_IF_NONE    60 (to 420)
+         
+         102         300 LOAD_FAST                5 (corrcoef_encoder)
+                     302 LOAD_METHOD              7 (update)
          
-          99         300 LOAD_FAST                3 (encoder_B)
-                     302 POP_JUMP_FORWARD_IF_NOT_NONE    10 (to 324)
-                     304 LOAD_ASSERTION_ERROR
-         
-         100         306 LOAD_CONST               5 ('Error: you need to supply an encoder-B object if you want to calculate encoder-B feature activations.')
-         
-          99         308 PRECALL                  0
-                     312 CALL                     0
-                     322 RAISE_VARARGS            1
-         
-         101     >>  324 LOAD_FAST                0 (model_acts)
-                     326 LOAD_FAST                3 (encoder_B)
-                     328 LOAD_ATTR                2 (b_dec)
-                     338 BINARY_OP               10 (-)
-                     342 STORE_FAST              11 (x_cent_B)
-         
-         102         344 LOAD_GLOBAL              7 (NULL + einops)
-                     356 LOAD_ATTR                4 (einsum)
-                     366 LOAD_FAST               11 (x_cent_B)
-                     368 LOAD_FAST                3 (encoder_B)
-                     370 LOAD_ATTR                0 (W_enc)
-                     380 LOAD_CONST               6 ('batch seq d_in, d_in d_hidden -> batch seq d_hidden')
-                     382 PRECALL                  3
-                     386 CALL                     3
-                     396 STORE_FAST              12 (feat_acts_pre_B)
-         
-         103         398 LOAD_GLOBAL             11 (NULL + F)
-                     410 LOAD_ATTR                6 (relu)
-                     420 LOAD_FAST               12 (feat_acts_pre_B)
-                     422 LOAD_FAST                2 (encoder)
-                     424 LOAD_ATTR                1 (b_enc)
-                     434 BINARY_OP                0 (+)
-                     438 PRECALL                  1
-                     442 CALL                     1
-                     452 STORE_FAST              13 (feat_acts_B)
-         
-         106         454 LOAD_FAST                5 (corrcoef_encoder_B)
-                     456 LOAD_METHOD              7 (update)
-         
-         107         478 LOAD_GLOBAL              7 (NULL + einops)
-                     490 LOAD_ATTR                8 (rearrange)
-                     500 LOAD_FAST               10 (feat_acts)
-                     502 LOAD_CONST               3 ('batch seq feats -> feats (batch seq)')
-                     504 PRECALL                  2
-                     508 CALL                     2
-         
-         108         518 LOAD_GLOBAL              7 (NULL + einops)
-                     530 LOAD_ATTR                8 (rearrange)
-                     540 LOAD_FAST               13 (feat_acts_B)
-                     542 LOAD_CONST               7 ('batch seq d_hidden -> d_hidden (batch seq)')
-                     544 PRECALL                  2
-                     548 CALL                     2
-         
-         106         558 PRECALL                  2
-                     562 CALL                     2
-                     572 POP_TOP
+         103         324 LOAD_GLOBAL              7 (NULL + einops)
+                     336 LOAD_ATTR                8 (rearrange)
+                     346 LOAD_FAST               11 (feat_acts)
+                     348 LOAD_CONST               3 ('batch seq feats -> feats (batch seq)')
+                     350 PRECALL                  2
+                     354 CALL                     2
+         
+         104         364 LOAD_GLOBAL              7 (NULL + einops)
+                     376 LOAD_ATTR                8 (rearrange)
+                     386 LOAD_FAST               11 (feat_acts)
+                     388 LOAD_CONST               3 ('batch seq feats -> feats (batch seq)')
+                     390 PRECALL                  2
+                     394 CALL                     2
+         
+         102         404 PRECALL                  2
+                     408 CALL                     2
+                     418 POP_TOP
+         
+         108     >>  420 LOAD_FAST                6 (corrcoef_encoder_B)
+                     422 POP_JUMP_FORWARD_IF_NONE   137 (to 698)
+         
+         109         424 LOAD_FAST                3 (encoder_B)
+                     426 POP_JUMP_FORWARD_IF_NOT_NONE    10 (to 448)
+                     428 LOAD_ASSERTION_ERROR
+         
+         110         430 LOAD_CONST               5 ('Error: you need to supply an encoder-B object if you want to calculate encoder-B feature activations.')
+         
+         109         432 PRECALL                  0
+                     436 CALL                     0
+                     446 RAISE_VARARGS            1
+         
+         111     >>  448 LOAD_FAST                0 (model_acts)
+                     450 LOAD_FAST                3 (encoder_B)
+                     452 LOAD_ATTR                2 (b_dec)
+                     462 BINARY_OP               10 (-)
+                     466 STORE_FAST              12 (x_cent_B)
+         
+         112         468 LOAD_GLOBAL              7 (NULL + einops)
+                     480 LOAD_ATTR                4 (einsum)
+                     490 LOAD_FAST               12 (x_cent_B)
+                     492 LOAD_FAST                3 (encoder_B)
+                     494 LOAD_ATTR                0 (W_enc)
+                     504 LOAD_CONST               6 ('batch seq d_in, d_in d_hidden -> batch seq d_hidden')
+                     506 PRECALL                  3
+                     510 CALL                     3
+                     520 STORE_FAST              13 (feat_acts_pre_B)
+         
+         113         522 LOAD_GLOBAL             11 (NULL + F)
+                     534 LOAD_ATTR                6 (relu)
+                     544 LOAD_FAST               13 (feat_acts_pre_B)
+                     546 LOAD_FAST                2 (encoder)
+                     548 LOAD_ATTR                1 (b_enc)
+                     558 BINARY_OP                0 (+)
+                     562 PRECALL                  1
+                     566 CALL                     1
+                     576 STORE_FAST              14 (feat_acts_B)
+         
+         116         578 LOAD_FAST                6 (corrcoef_encoder_B)
+                     580 LOAD_METHOD              7 (update)
+         
+         117         602 LOAD_GLOBAL              7 (NULL + einops)
+                     614 LOAD_ATTR                8 (rearrange)
+                     624 LOAD_FAST               11 (feat_acts)
+                     626 LOAD_CONST               3 ('batch seq feats -> feats (batch seq)')
+                     628 PRECALL                  2
+                     632 CALL                     2
+         
+         118         642 LOAD_GLOBAL              7 (NULL + einops)
+                     654 LOAD_ATTR                8 (rearrange)
+                     664 LOAD_FAST               14 (feat_acts_B)
+                     666 LOAD_CONST               7 ('batch seq d_hidden -> d_hidden (batch seq)')
+                     668 PRECALL                  2
+                     672 CALL                     2
+         
+         116         682 PRECALL                  2
+                     686 CALL                     2
+                     696 POP_TOP
          
-         111     >>  574 LOAD_FAST               10 (feat_acts)
-                     576 RETURN_VALUE
+         121     >>  698 LOAD_FAST               11 (feat_acts)
+                     700 RETURN_VALUE
          consts
-            '\n    This function computes the feature activations, given a bunch of model data. It also updates the rolling correlation\n    coefficient objects, if they\'re given.\n\n    Args:\n        model_acts: Float[Tensor, "batch seq d_in"]\n            The activations of the model, which the SAE was trained on.\n        feature_idx: Int[Tensor, "feats"]\n            The features we\'re computing the activations for. This will be used to index the encoder\'s weights.\n        encoder: AutoEncoder\n            The encoder object, which we use to calculate the feature activations.\n        encoder_B: Optional[AutoEncoder]\n            The encoder-B object, which we use to calculate the feature activations.\n        corrcoef_neurons: Optional[BatchedCorrCoef]\n            The object storing the minimal data necessary to compute corrcoef between feature activations & neurons.\n        corrcoef_encoder_B: Optional[BatchedCorrCoef]\n            The object storing minimal data to compute corrcoef between feature activations & encoder-B features.\n    '
+            '\n    This function computes the feature activations, given a bunch of model data. It also updates the rolling correlation\n    coefficient objects, if they\'re given.\n\n    Args:\n        model_acts: Float[Tensor, "batch seq d_in"]\n            The activations of the model, which the SAE was trained on.\n        feature_idx: Int[Tensor, "feats"]\n            The features we\'re computing the activations for. This will be used to index the encoder\'s weights.\n        encoder: AutoEncoder\n            The encoder object, which we use to calculate the feature activations.\n        encoder_B: Optional[AutoEncoder]\n            The encoder-B object, which we use to calculate the feature activations.\n        corrcoef_neurons: Optional[BatchedCorrCoef]\n            The object storing the minimal data necessary to compute corrcoef between feature activations & neurons.\n        corrcoef_encoder: Optional[BatchedCorrCoef]\n            The object storing the minimal data necessary to compute corrcoef between pairwise feature activations.\n        corrcoef_encoder_B: Optional[BatchedCorrCoef]\n            The object storing minimal data to compute corrcoef between feature activations & encoder-B features.\n    '
             None
             'batch seq d_in, d_in feats -> batch seq feats'
             'batch seq feats -> feats (batch seq)'
             'batch seq d_in -> d_in (batch seq)'
             'Error: you need to supply an encoder-B object if you want to calculate encoder-B feature activations.'
             'batch seq d_in, d_in d_hidden -> batch seq d_hidden'
             'batch seq d_hidden -> d_hidden (batch seq)'
          names      ('W_enc', 'b_enc', 'b_dec', 'einops', 'einsum', 'F', 'relu', 'update', 'rearrange')
-         varnames   ('model_acts', 'feature_idx', 'encoder', 'encoder_B', 'corrcoef_neurons', 'corrcoef_encoder_B', 'feature_act_dir', 'feature_bias', 'x_cent', 'feat_acts_pre', 'feat_acts', 'x_cent_B', 'feat_acts_pre_B', 'feat_acts_B')
+         varnames   ('model_acts', 'feature_idx', 'encoder', 'encoder_B', 'corrcoef_neurons', 'corrcoef_encoder', 'corrcoef_encoder_B', 'feature_act_dir', 'feature_bias', 'x_cent', 'feat_acts_pre', 'feat_acts', 'x_cent_B', 'feat_acts_pre_B', 'feat_acts_B')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
          name       'compute_feat_acts'
          firstlineno 55
          lnotab
-            0x021b22011a0314012c012e0304011801280128fe10060401060102ff10
-            021401360138031801280128fe1005
+            0x021e22011a0314012c012e0304011801280128fe100604011801280128
+            fe10060401060102ff10021401360138031801280128fe1005
       'tokens'
       'batch seq'
       'feature_indices'
       'all_feat_acts'
       '... feats'
       'feature_resid_dir'
       'feats d_model'
@@ -965,789 +1011,983 @@
       'W_U'
       'd_model d_vocab'
       'cfg'
       'feature_out_dir'
       'feats d_out'
       'progress'
       code
-         argcount  : 11
-         nlocals   : 37
-         stacksize : 13
+         argcount  : 12
+         nlocals   : 42
+         stacksize : 10
          flags     : 3
          code
-            0x9700640164016401640164029c047d0b7401000000000000000000006a
-            000000000000000000a6000000ab0000000000000000007d0c7403000000
+            0x9700640164016401640164029c047d0c7401000000000000000000006a
+            000000000000000000a6000000ab0000000000000000007d0d7403000000
             000000000000007c01740400000000000000000000a6020000ab02000000
             000000000072037c0167017d017c036a0300000000000000006403190000
             000000000000007409000000000000000000007c01a6010000ab01000000
             00000000006b020000000073284a0064047c036a03000000000000000064
             03190000000000000000009b0064057409000000000000000000007c01a6
             010000ab0100000000000000009b029d04a6000000ab0000000000000000
             0082017c0781467c076a0300000000000000006403190000000000000000
             007409000000000000000000007c01a6010000ab0100000000000000006b
             020000000073284a0064077c036a03000000000000000064031900000000
             00000000009b0064057409000000000000000000007c01a6010000ab0100
             000000000000009b029d04a6000000ab0000000000000000008201640884
-            007c014400a6000000ab0000000000000000007d0d7c066a050000000000
-            0000007d0e7403000000000000000000007c0e740c000000000000000000
+            007c014400a6000000ab0000000000000000007d0e7c066a050000000000
+            0000007d0f7403000000000000000000007c0f740c000000000000000000
             00a6020000ab020000000000000000731a4a006409740f00000000000000
-            0000007c0ea6010000ab0100000000000000009b009d02a6000000ab0000
-            0000000000000082017c0e6a080000000000000000900181dc7c07900181
-            d97413000000000000000000007c077c0e6a0800000000000000006a0a00
-            00000000000000640aac0ba6030000ab0300000000000000007d0f7c07a0
-            0b0000000000000000000000000000000000000000a6000000ab00000000
-            0000000000a00c0000000000000000000000000000000000000000640c64
-            0aac0da6020000ab0200000000000000007d10741b000000000000000000
-            006a0e00000000000000007c0f6a0f0000000000000000a6010000ab0100
-            000000000000007421000000000000000000006a1100000000000000007c
-            10a6010000ab0100000000000000007a0b00007d11740300000000000000
-            0000007c08742400000000000000000000a6020000ab0200000000000000
-            00731a4a00640e740f000000000000000000007c08a6010000ab01000000
-            00000000009b009d02a6000000ab00000000000000000082017c08a01300
-            000000000000000000000000000000000000007c0e6a0800000000000000
-            006a0a0000000000000000ac0fa6010000ab0100000000000000005c0300
-            007d127d137d14641084007c014400a6000000ab00000000000000000078
-            017d1578017d167d177c0981537403000000000000000000007c09742400
-            000000000000000000a6020000ab020000000000000000731a4a00641174
-            0f000000000000000000007c09a6010000ab0100000000000000009b009d
-            02a6000000ab00000000000000000082017c09a013000000000000000000
-            00000000000000000000007c0e6a0800000000000000006a0a0000000000
-            000000ac0fa6010000ab0100000000000000005c0300007d157d167d1774
-            29000000000000000000007c01a6010000ab01000000000000000044005d
-            9e5c0200007d187d19742b000000000000000000007c0f7c181900000000
-            00000000006a160000000000000000a01700000000000000000000000000
-            00000000000000a6000000ab0000000000000000007c0f7c181900000000
-            00000000006a0f0000000000000000a01700000000000000000000000000
-            00000000000000a6000000ab0000000000000000007c117c181900000000
-            0000000000a0170000000000000000000000000000000000000000a60000
-            00ab0000000000000000007c127c18190000000000000000007c137c1819
-            0000000000000000007c147c18190000000000000000007c157c18190000
-            000000000000007c167c18190000000000000000007c177c181900000000
-            0000000000ac12a6090000ab0900000000000000007c0d7c191900000000
-            00000000005f1800000000000000008c9f7401000000000000000000006a
-            000000000000000000a6000000ab0000000000000000007c0c7a0a00007c
-            0b64133c0000007401000000000000000000006a000000000000000000a6
-            000000ab0000000000000000007d0c7433000000000000000000006a1a00
-            000000000000007c037c056414a6030000ab0300000000000000007d1a74
-            3700000000000000000000641584007c0e6a1c00000000000000007c0e6a
-            1d00000000000000007c0e6a1e000000000000000066034400a6000000ab
-            000000000000000000a6010000ab01000000000000000090017294742900
-            000000000000000000743f000000000000000000007c017c1aa6020000ab
+            0000007c0fa6010000ab0100000000000000009b009d02a6000000ab0000
+            0000000000000082017c0f6a080000000000000000900381717c07900381
+            6e741300000000000000000000741400000000000000000000a6010000ab
+            0100000000000000007d107c0f6a0800000000000000006a0b0000000000
+            000000900172027419000000000000000000007c077c0f6a080000000000
+            0000006a0d0000000000000000640aac0ba6030000ab0300000000000000
+            007d117c07a00e0000000000000000000000000000000000000000a60000
+            00ab000000000000000000a00f0000000000000000000000000000000000
+            000000640c640aac0da6020000ab0200000000000000007d127421000000
+            000000000000006a1100000000000000007c116a120000000000000000a6
+            010000ab0100000000000000007427000000000000000000006a14000000
+            00000000007c12a6010000ab0100000000000000007a0b00007d13742b00
+            0000000000000000007409000000000000000000007c01a6010000ab0100
+            00000000000000a6010000ab01000000000000000044005d727d147c107c
+            1419000000000000000000a0160000000000000000000000000000000000
+            0000007c117c14190000000000000000006a170000000000000000a01800
+            00000000000000000000000000000000000000a6000000ab000000000000
+            0000007c117c14190000000000000000006a120000000000000000a01800
+            00000000000000000000000000000000000000a6000000ab000000000000
+            0000007c137c1419000000000000000000a0180000000000000000000000
+            000000000000000000a6000000ab000000000000000000ac0ea6030000ab
+            03000000000000000001008c737c0f6a0800000000000000006a19000000
+            000000000072a37403000000000000000000007c08743400000000000000
+            000000a6020000ab020000000000000000731a4a00640f740f0000000000
+            00000000007c08a6010000ab0100000000000000009b009d02a6000000ab
+            00000000000000000082017c08a01b000000000000000000000000000000
+            00000000007c0f6a0800000000000000006a0d00000000000000006410ac
+            11a6020000ab0200000000000000005c0300007d157d167d17742b000000
+            000000000000007409000000000000000000007c01a6010000ab01000000
+            0000000000a6010000ab01000000000000000044005d327d147c107c1419
+            000000000000000000a01600000000000000000000000000000000000000
+            007c157c14190000000000000000007c167c14190000000000000000007c
+            177c1419000000000000000000ac12a6030000ab03000000000000000001
+            008c337c0f6a0800000000000000006a1c000000000000000072a3740300
+            0000000000000000007c09743400000000000000000000a6020000ab0200
+            00000000000000731a4a006413740f000000000000000000007c09a60100
+            00ab0100000000000000009b009d02a6000000ab00000000000000000082
+            017c09a01b00000000000000000000000000000000000000007c0f6a0800
+            000000000000006a0d0000000000000000640aac11a6020000ab02000000
+            00000000005c0300007d187d197d1a742b00000000000000000000740900
+            0000000000000000007c01a6010000ab010000000000000000a6010000ab
+            01000000000000000044005d327d147c107c1419000000000000000000a0
+            1600000000000000000000000000000000000000007c187c141900000000
+            00000000007c197c14190000000000000000007c1a7c1419000000000000
+            000000ac14a6030000ab03000000000000000001008c337c0f6a08000000
+            00000000006a1d000000000000000072af7c0a800a4a006415a6000000ab
+            00000000000000000082017403000000000000000000007c0a7434000000
+            00000000000000a6020000ab020000000000000000731a4a006416740f00
+            0000000000000000007c0aa6010000ab0100000000000000009b009d02a6
+            000000ab00000000000000000082017c0aa01b0000000000000000000000
+            0000000000000000007c0f6a0800000000000000006a0d00000000000000
+            006410ac11a6020000ab0200000000000000005c0300007d1b7d1c7d1d74
+            2b000000000000000000007409000000000000000000007c01a6010000ab
+            010000000000000000a6010000ab01000000000000000044005d327d147c
+            107c1419000000000000000000a016000000000000000000000000000000
+            00000000007c1b7c14190000000000000000007c1c7c1419000000000000
+            0000007c1d7c1419000000000000000000ac17a6030000ab030000000000
+            00000001008c33743d000000000000000000007c01a6010000ab01000000
+            000000000044005d225c0200007d147d1e743f0000000000000000000064
+            2969007c107c1419000000000000000000a4018e017c0e7c1e1900000000
+            00000000005f2000000000000000008c237401000000000000000000006a
+            000000000000000000a6000000ab0000000000000000007c0d7a0a00007c
+            0c64183c0000007401000000000000000000006a000000000000000000a6
+            000000ab0000000000000000007d0d7443000000000000000000006a2200
+            000000000000007c037c056419a6030000ab0300000000000000007d1f74
+            4700000000000000000000641a84007c0f6a2400000000000000007c0f6a
+            2500000000000000007c0f6a26000000000000000066034400a6000000ab
+            000000000000000000a6010000ab01000000000000000090017294743d00
+            000000000000000000744f000000000000000000007c017c1fa6020000ab
             020000000000000000a6010000ab010000000000000000440090015d755c
-            0200007d185c0200007d197d1b7c0e6a1d0000000000000000812d744100
-            0000000000000000006a2100000000000000007c1b7c0e6a1d0000000000
-            0000006a22000000000000000064166406ac17a6040000ab040000000000
-            0000007c0d7c19190000000000000000005f2300000000000000007c0e6a
-            1c000000000000000081707c0264187c186602190000000000000000007d
-            1c7c1c7c1c64036b0400000000190000000000000000007d1d7c1da02400
+            0200007d145c0200007d1e7d207c0f6a250000000000000000812d745100
+            0000000000000000006a2900000000000000007c207c0f6a250000000000
+            0000006a2a0000000000000000641b6406ac1ca6040000ab040000000000
+            0000007c0e7c1e190000000000000000005f2b00000000000000007c0f6a
+            24000000000000000081707c02641d7c146602190000000000000000007d
+            217c217c2164036b0400000000190000000000000000007d227c22a02c00
             00000000000000000000000000000000000000a6000000ab000000000000
-            0000007c1ca0240000000000000000000000000000000000000000a60000
-            00ab0000000000000000007a0b00007d1e744b000000000000000000006a
-            2100000000000000007c1d7c0e6a1c00000000000000006a220000000000
-            000000641664197c1e641a9b049d02ac17a6040000ab0400000000000000
-            007c0d7c19190000000000000000005f2600000000000000007c0e6a1e00
-            0000000000000081ba7413000000000000000000007c1b7c0e6a1e000000
-            00000000006a0a0000000000000000640aac1ba6030000ab030000000000
-            0000007d1f7413000000000000000000007c1b7c0e6a1e00000000000000
-            006a0a0000000000000000641cac1ba6030000ab0300000000000000007d
-            207c1f6a0f0000000000000000a017000000000000000000000000000000
-            0000000000a6000000ab0000000000000000007c1f6a1600000000000000
-            00a0170000000000000000000000000000000000000000a6000000ab0000
-            000000000000007d217d1f7c206a0f0000000000000000a0170000000000
+            0000007c21a02c0000000000000000000000000000000000000000a60000
+            00ab0000000000000000007a0b00007d23745b000000000000000000006a
+            2900000000000000007c227c0f6a2400000000000000006a2a0000000000
+            000000641b641e7c23641f9b049d02ac1ca6040000ab0400000000000000
+            007c0e7c1e190000000000000000005f2e00000000000000007c0f6a2600
+            0000000000000081ba7419000000000000000000007c207c0f6a26000000
+            00000000006a0d0000000000000000640aac20a6030000ab030000000000
+            0000007d247419000000000000000000007c207c0f6a2600000000000000
+            006a0d00000000000000006410ac20a6030000ab0300000000000000007d
+            257c246a120000000000000000a018000000000000000000000000000000
+            0000000000a6000000ab0000000000000000007c246a1700000000000000
+            00a0180000000000000000000000000000000000000000a6000000ab0000
+            000000000000007d267d247c256a120000000000000000a0180000000000
             000000000000000000000000000000a6000000ab0000000000000000007c
-            206a160000000000000000a0170000000000000000000000000000000000
-            000000a6000000ab0000000000000000007d227d20744f00000000000000
-            0000007c207c227c1f7c21ac1da6040000ab0400000000000000007c0d7c
-            19190000000000000000005f28000000000000000090018c777401000000
+            256a170000000000000000a0180000000000000000000000000000000000
+            000000a6000000ab0000000000000000007d277d25745f00000000000000
+            0000007c257c277c247c26ac21a6040000ab0400000000000000007c0e7c
+            1e190000000000000000005f30000000000000000090018c777401000000
             000000000000006a000000000000000000a6000000ab0000000000000000
-            007c0c7a0a00007c0b641e3c0000007401000000000000000000006a0000
-            00000000000000a6000000ab0000000000000000007d0c7c0e6a29000000
-            0000000000816c7429000000000000000000007c01a6010000ab01000000
-            000000000044005d5c5c0200007d187d197455000000000000000000007c
-            007c0264187c186602190000000000000000007c1a7c1819000000000000
-            0000007c047c037c18190000000000000000007c057c0e6a290000000000
-            000000ac1fa6070000ab0700000000000000007c0d7c1919000000000000
-            0000005f2b00000000000000007c0a811b7c0a6420190000000000000000
-            00a02c00000000000000000000000000000000000000006420a6010000ab
+            007c0d7a0a00007c0c64223c0000007401000000000000000000006a0000
+            00000000000000a6000000ab0000000000000000007d0d7c0f6a31000000
+            0000000000816c743d000000000000000000007c01a6010000ab01000000
+            000000000044005d5c5c0200007d147d1e7465000000000000000000007c
+            007c02641d7c146602190000000000000000007c1f7c1419000000000000
+            0000007c047c037c14190000000000000000007c057c0f6a310000000000
+            000000ac23a6070000ab0700000000000000007c0e7c1e19000000000000
+            0000005f3300000000000000007c0b811b7c0b6424190000000000000000
+            00a01600000000000000000000000000000000000000006424a6010000ab
             01000000000000000001008c5d7401000000000000000000006a00000000
-            0000000000a6000000ab0000000000000000007c0c7a0a00007c0b64213c
+            0000000000a6000000ab0000000000000000007c0d7a0a00007c0c64253c
             0000007401000000000000000000006a000000000000000000a6000000ab
-            0000000000000000007d0c745b000000000000000000006a210000000000
-            0000007433000000000000000000006a2e00000000000000007c026422a6
-            020000ab020000000000000000ac23a6010000ab0100000000000000007d
-            237401000000000000000000006a000000000000000000a6000000ab0000
-            000000000000007c0c7a0a00007c0b64243c000000740100000000000000
-            0000006a000000000000000000a6000000ab0000000000000000007d0c74
-            5f000000000000000000007c0d7c237c06a6030000ab0300000000000000
-            007d247c247c0b66025300
-         115           0 RESUME                   0
+            0000000000000000007d0d7469000000000000000000006a290000000000
+            0000007443000000000000000000006a3500000000000000007c026426a6
+            020000ab020000000000000000ac27a6010000ab0100000000000000007d
+            287401000000000000000000006a000000000000000000a6000000ab0000
+            000000000000007c0d7a0a00007c0c64283c000000740100000000000000
+            0000006a000000000000000000a6000000ab0000000000000000007d0d74
+            6d000000000000000000007c0e7c287c06a6030000ab0300000000000000
+            007d297c297c0c66025300
+         125           0 RESUME                   0
          
-         184           2 LOAD_CONST               1 (0.0)
+         198           2 LOAD_CONST               1 (0.0)
          
-         185           4 LOAD_CONST               1 (0.0)
+         199           4 LOAD_CONST               1 (0.0)
          
-         186           6 LOAD_CONST               1 (0.0)
+         200           6 LOAD_CONST               1 (0.0)
          
-         187           8 LOAD_CONST               1 (0.0)
+         201           8 LOAD_CONST               1 (0.0)
          
-         183          10 LOAD_CONST               2 (('(4) Getting data for tables', '(5) Getting data for histograms', '(6) Getting data for sequences', '(7) Getting data for quantiles'))
+         197          10 LOAD_CONST               2 (('(4) Getting data for tables', '(5) Getting data for histograms', '(6) Getting data for sequences', '(7) Getting data for quantiles'))
                       12 BUILD_CONST_KEY_MAP      4
-                      14 STORE_FAST              11 (time_logs)
+                      14 STORE_FAST              12 (time_logs)
          
-         189          16 LOAD_GLOBAL              1 (NULL + time)
+         203          16 LOAD_GLOBAL              1 (NULL + time)
                       28 LOAD_ATTR                0 (time)
                       38 PRECALL                  0
                       42 CALL                     0
-                      52 STORE_FAST              12 (t0)
+                      52 STORE_FAST              13 (t0)
          
-         192          54 LOAD_GLOBAL              3 (NULL + isinstance)
+         206          54 LOAD_GLOBAL              3 (NULL + isinstance)
                       66 LOAD_FAST                1 (feature_indices)
                       68 LOAD_GLOBAL              4 (int)
                       80 PRECALL                  2
                       84 CALL                     2
                       94 POP_JUMP_FORWARD_IF_FALSE     3 (to 102)
                       96 LOAD_FAST                1 (feature_indices)
                       98 BUILD_LIST               1
                      100 STORE_FAST               1 (feature_indices)
          
-         194     >>  102 LOAD_FAST                3 (feature_resid_dir)
+         208     >>  102 LOAD_FAST                3 (feature_resid_dir)
                      104 LOAD_ATTR                3 (shape)
                      114 LOAD_CONST               3 (0)
                      116 BINARY_SUBSCR
                      126 LOAD_GLOBAL              9 (NULL + len)
                      138 LOAD_FAST                1 (feature_indices)
                      140 PRECALL                  1
                      144 CALL                     1
                      154 COMPARE_OP               2 (==)
                      160 POP_JUMP_FORWARD_IF_TRUE    40 (to 242)
                      162 LOAD_ASSERTION_ERROR
          
-         195         164 LOAD_CONST               4 ('Num features in feature_resid_dir (')
+         209         164 LOAD_CONST               4 ('Num features in feature_resid_dir (')
                      166 LOAD_FAST                3 (feature_resid_dir)
                      168 LOAD_ATTR                3 (shape)
                      178 LOAD_CONST               3 (0)
                      180 BINARY_SUBSCR
                      190 FORMAT_VALUE             0
                      192 LOAD_CONST               5 (") doesn't match len(feature_indices)=")
                      194 LOAD_GLOBAL              9 (NULL + len)
                      206 LOAD_FAST                1 (feature_indices)
                      208 PRECALL                  1
                      212 CALL                     1
                      222 FORMAT_VALUE             2 (repr)
                      224 BUILD_STRING             4
          
-         194         226 PRECALL                  0
+         208         226 PRECALL                  0
                      230 CALL                     0
                      240 RAISE_VARARGS            1
          
-         197     >>  242 LOAD_FAST                7 (feature_out_dir)
+         211     >>  242 LOAD_FAST                7 (feature_out_dir)
                      244 POP_JUMP_FORWARD_IF_NONE    70 (to 386)
          
-         198         246 LOAD_FAST                7 (feature_out_dir)
+         212         246 LOAD_FAST                7 (feature_out_dir)
                      248 LOAD_ATTR                3 (shape)
                      258 LOAD_CONST               3 (0)
                      260 BINARY_SUBSCR
                      270 LOAD_GLOBAL              9 (NULL + len)
                      282 LOAD_FAST                1 (feature_indices)
                      284 PRECALL                  1
                      288 CALL                     1
                      298 COMPARE_OP               2 (==)
                      304 POP_JUMP_FORWARD_IF_TRUE    40 (to 386)
                      306 LOAD_ASSERTION_ERROR
          
-         199         308 LOAD_CONST               7 ('Num features in feature_out_dir (')
+         213         308 LOAD_CONST               7 ('Num features in feature_out_dir (')
                      310 LOAD_FAST                3 (feature_resid_dir)
                      312 LOAD_ATTR                3 (shape)
                      322 LOAD_CONST               3 (0)
                      324 BINARY_SUBSCR
                      334 FORMAT_VALUE             0
                      336 LOAD_CONST               5 (") doesn't match len(feature_indices)=")
                      338 LOAD_GLOBAL              9 (NULL + len)
                      350 LOAD_FAST                1 (feature_indices)
                      352 PRECALL                  1
                      356 CALL                     1
                      366 FORMAT_VALUE             2 (repr)
                      368 BUILD_STRING             4
          
-         198         370 PRECALL                  0
+         212         370 PRECALL                  0
                      374 CALL                     0
                      384 RAISE_VARARGS            1
          
-         202     >>  386 LOAD_CONST               8 (<code object <dictcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 202>)
+         216     >>  386 LOAD_CONST               8 (<code object <dictcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 216>)
                      388 MAKE_FUNCTION            0
                      390 LOAD_FAST                1 (feature_indices)
                      392 GET_ITER
                      394 PRECALL                  0
                      398 CALL                     0
-                     408 STORE_FAST              13 (feature_data_dict)
+                     408 STORE_FAST              14 (feature_data_dict)
          
-         205         410 LOAD_FAST                6 (cfg)
+         219         410 LOAD_FAST                6 (cfg)
                      412 LOAD_ATTR                5 (feature_centric_layout)
-                     422 STORE_FAST              14 (layout)
+                     422 STORE_FAST              15 (layout)
          
-         206         424 LOAD_GLOBAL              3 (NULL + isinstance)
-                     436 LOAD_FAST               14 (layout)
+         220         424 LOAD_GLOBAL              3 (NULL + isinstance)
+                     436 LOAD_FAST               15 (layout)
                      438 LOAD_GLOBAL             12 (SaeVisLayoutConfig)
                      450 PRECALL                  2
                      454 CALL                     2
                      464 POP_JUMP_FORWARD_IF_TRUE    26 (to 518)
                      466 LOAD_ASSERTION_ERROR
          
-         207         468 LOAD_CONST               9 ('Error: cfg.feature_centric_layout must be a SaeVisLayoutConfig object, got ')
+         221         468 LOAD_CONST               9 ('Error: cfg.feature_centric_layout must be a SaeVisLayoutConfig object, got ')
                      470 LOAD_GLOBAL             15 (NULL + type)
-                     482 LOAD_FAST               14 (layout)
+                     482 LOAD_FAST               15 (layout)
                      484 PRECALL                  1
                      488 CALL                     1
                      498 FORMAT_VALUE             0
                      500 BUILD_STRING             2
          
-         206         502 PRECALL                  0
+         220         502 PRECALL                  0
                      506 CALL                     0
                      516 RAISE_VARARGS            1
          
-         212     >>  518 LOAD_FAST               14 (layout)
-                     520 LOAD_ATTR                8 (feat_tables_cfg)
-                     530 EXTENDED_ARG             1
-                     532 POP_JUMP_FORWARD_IF_NONE   476 (to 1486)
+         226     >>  518 LOAD_FAST               15 (layout)
+                     520 LOAD_ATTR                8 (feature_tables_cfg)
+                     530 EXTENDED_ARG             3
+                     532 POP_JUMP_FORWARD_IF_NONE   881 (to 2296)
                      534 LOAD_FAST                7 (feature_out_dir)
-                     536 EXTENDED_ARG             1
-                     538 POP_JUMP_FORWARD_IF_NONE   473 (to 1486)
+                     536 EXTENDED_ARG             3
+                     538 POP_JUMP_FORWARD_IF_NONE   878 (to 2296)
          
-         215         540 LOAD_GLOBAL             19 (NULL + TopK)
-                     552 LOAD_FAST                7 (feature_out_dir)
-                     554 LOAD_FAST               14 (layout)
-                     556 LOAD_ATTR                8 (feat_tables_cfg)
-                     566 LOAD_ATTR               10 (n_rows)
-                     576 LOAD_CONST              10 (True)
-                     578 KW_NAMES                11
-                     580 PRECALL                  3
-                     584 CALL                     3
-                     594 STORE_FAST              15 (top3_neurons_aligned)
-         
-         216         596 LOAD_FAST                7 (feature_out_dir)
-                     598 LOAD_METHOD             11 (abs)
-                     620 PRECALL                  0
-                     624 CALL                     0
-                     634 LOAD_METHOD             12 (sum)
-                     656 LOAD_CONST              12 (-1)
-                     658 LOAD_CONST              10 (True)
-                     660 KW_NAMES                13
-                     662 PRECALL                  2
-                     666 CALL                     2
-                     676 STORE_FAST              16 (feature_out_l1_norm)
-         
-         217         678 LOAD_GLOBAL             27 (NULL + np)
-                     690 LOAD_ATTR               14 (absolute)
-                     700 LOAD_FAST               15 (top3_neurons_aligned)
-                     702 LOAD_ATTR               15 (values)
-                     712 PRECALL                  1
-                     716 CALL                     1
-                     726 LOAD_GLOBAL             33 (NULL + utils)
-                     738 LOAD_ATTR               17 (to_numpy)
-                     748 LOAD_FAST               16 (feature_out_l1_norm)
-                     750 PRECALL                  1
-                     754 CALL                     1
-                     764 BINARY_OP               11 (/)
-                     768 STORE_FAST              17 (pct_of_l1)
-         
-         220         770 LOAD_GLOBAL              3 (NULL + isinstance)
-                     782 LOAD_FAST                8 (corrcoef_neurons)
-                     784 LOAD_GLOBAL             36 (BatchedCorrCoef)
-                     796 PRECALL                  2
-                     800 CALL                     2
-                     810 POP_JUMP_FORWARD_IF_TRUE    26 (to 864)
-                     812 LOAD_ASSERTION_ERROR
-         
-         221         814 LOAD_CONST              14 ('Error: corrcoef_neurons should be of type BatchedCorrCoef, instead we got ')
-                     816 LOAD_GLOBAL             15 (NULL + type)
-                     828 LOAD_FAST                8 (corrcoef_neurons)
-                     830 PRECALL                  1
-                     834 CALL                     1
-                     844 FORMAT_VALUE             0
-                     846 BUILD_STRING             2
-         
-         220         848 PRECALL                  0
-                     852 CALL                     0
-                     862 RAISE_VARARGS            1
-         
-         222     >>  864 LOAD_FAST                8 (corrcoef_neurons)
-                     866 LOAD_METHOD             19 (topk_pearson)
-                     888 LOAD_FAST               14 (layout)
-                     890 LOAD_ATTR                8 (feat_tables_cfg)
-                     900 LOAD_ATTR               10 (n_rows)
-                     910 KW_NAMES                15
-                     912 PRECALL                  1
-                     916 CALL                     1
-                     926 UNPACK_SEQUENCE          3
-                     930 STORE_FAST              18 (neuron_indices)
-                     932 STORE_FAST              19 (neuron_pearson)
-                     934 STORE_FAST              20 (neuron_cossim)
-         
-         226         936 LOAD_CONST              16 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 226>)
-                     938 MAKE_FUNCTION            0
-                     940 LOAD_FAST                1 (feature_indices)
-                     942 GET_ITER
-                     944 PRECALL                  0
-                     948 CALL                     0
-                     958 COPY                     1
-                     960 STORE_FAST              21 (encB_indices)
-                     962 COPY                     1
-                     964 STORE_FAST              22 (encB_pearson)
-                     966 STORE_FAST              23 (encB_cossim)
-         
-         227         968 LOAD_FAST                9 (corrcoef_encoder_B)
-                     970 POP_JUMP_FORWARD_IF_NONE    83 (to 1138)
-         
-         228         972 LOAD_GLOBAL              3 (NULL + isinstance)
-                     984 LOAD_FAST                9 (corrcoef_encoder_B)
-                     986 LOAD_GLOBAL             36 (BatchedCorrCoef)
-                     998 PRECALL                  2
-                    1002 CALL                     2
-                    1012 POP_JUMP_FORWARD_IF_TRUE    26 (to 1066)
-                    1014 LOAD_ASSERTION_ERROR
-         
-         229        1016 LOAD_CONST              17 ('Error: corrcoef_encoder_B should be of type BatchedCorrCoef, instead we got ')
-                    1018 LOAD_GLOBAL             15 (NULL + type)
-                    1030 LOAD_FAST                9 (corrcoef_encoder_B)
-                    1032 PRECALL                  1
-                    1036 CALL                     1
-                    1046 FORMAT_VALUE             0
-                    1048 BUILD_STRING             2
-         
-         228        1050 PRECALL                  0
-                    1054 CALL                     0
-                    1064 RAISE_VARARGS            1
-         
-         230     >> 1066 LOAD_FAST                9 (corrcoef_encoder_B)
-                    1068 LOAD_METHOD             19 (topk_pearson)
-                    1090 LOAD_FAST               14 (layout)
-                    1092 LOAD_ATTR                8 (feat_tables_cfg)
-                    1102 LOAD_ATTR               10 (n_rows)
-                    1112 KW_NAMES                15
-                    1114 PRECALL                  1
-                    1118 CALL                     1
-                    1128 UNPACK_SEQUENCE          3
-                    1132 STORE_FAST              21 (encB_indices)
-                    1134 STORE_FAST              22 (encB_pearson)
-                    1136 STORE_FAST              23 (encB_cossim)
-         
-         233     >> 1138 LOAD_GLOBAL             41 (NULL + enumerate)
-                    1150 LOAD_FAST                1 (feature_indices)
-                    1152 PRECALL                  1
-                    1156 CALL                     1
-                    1166 GET_ITER
-                 >> 1168 FOR_ITER               158 (to 1486)
-                    1170 UNPACK_SEQUENCE          2
-                    1174 STORE_FAST              24 (i)
-                    1176 STORE_FAST              25 (feat)
-         
-         234        1178 LOAD_GLOBAL             43 (NULL + FeatureTablesData)
-         
-         235        1190 LOAD_FAST               15 (top3_neurons_aligned)
-                    1192 LOAD_FAST               24 (i)
-                    1194 BINARY_SUBSCR
-                    1204 LOAD_ATTR               22 (indices)
-                    1214 LOAD_METHOD             23 (tolist)
-                    1236 PRECALL                  0
-                    1240 CALL                     0
-         
-         236        1250 LOAD_FAST               15 (top3_neurons_aligned)
-                    1252 LOAD_FAST               24 (i)
-                    1254 BINARY_SUBSCR
-                    1264 LOAD_ATTR               15 (values)
-                    1274 LOAD_METHOD             23 (tolist)
-                    1296 PRECALL                  0
-                    1300 CALL                     0
-         
-         237        1310 LOAD_FAST               17 (pct_of_l1)
-                    1312 LOAD_FAST               24 (i)
-                    1314 BINARY_SUBSCR
-                    1324 LOAD_METHOD             23 (tolist)
-                    1346 PRECALL                  0
-                    1350 CALL                     0
-         
-         238        1360 LOAD_FAST               18 (neuron_indices)
-                    1362 LOAD_FAST               24 (i)
-                    1364 BINARY_SUBSCR
+         229         540 LOAD_GLOBAL             19 (NULL + defaultdict)
+                     552 LOAD_GLOBAL             20 (dict)
+                     564 PRECALL                  1
+                     568 CALL                     1
+                     578 STORE_FAST              16 (feature_tables_data_kwargs)
+         
+         232         580 LOAD_FAST               15 (layout)
+                     582 LOAD_ATTR                8 (feature_tables_cfg)
+                     592 LOAD_ATTR               11 (neuron_alignment_table)
+                     602 EXTENDED_ARG             1
+                     604 POP_JUMP_FORWARD_IF_FALSE   258 (to 1122)
+         
+         233         606 LOAD_GLOBAL             25 (NULL + TopK)
+                     618 LOAD_FAST                7 (feature_out_dir)
+                     620 LOAD_FAST               15 (layout)
+                     622 LOAD_ATTR                8 (feature_tables_cfg)
+                     632 LOAD_ATTR               13 (n_rows)
+                     642 LOAD_CONST              10 (True)
+                     644 KW_NAMES                11
+                     646 PRECALL                  3
+                     650 CALL                     3
+                     660 STORE_FAST              17 (top3_neurons_aligned)
+         
+         234         662 LOAD_FAST                7 (feature_out_dir)
+                     664 LOAD_METHOD             14 (abs)
+                     686 PRECALL                  0
+                     690 CALL                     0
+                     700 LOAD_METHOD             15 (sum)
+                     722 LOAD_CONST              12 (-1)
+                     724 LOAD_CONST              10 (True)
+                     726 KW_NAMES                13
+                     728 PRECALL                  2
+                     732 CALL                     2
+                     742 STORE_FAST              18 (feature_out_l1_norm)
+         
+         235         744 LOAD_GLOBAL             33 (NULL + np)
+                     756 LOAD_ATTR               17 (absolute)
+                     766 LOAD_FAST               17 (top3_neurons_aligned)
+                     768 LOAD_ATTR               18 (values)
+                     778 PRECALL                  1
+                     782 CALL                     1
+                     792 LOAD_GLOBAL             39 (NULL + utils)
+                     804 LOAD_ATTR               20 (to_numpy)
+                     814 LOAD_FAST               18 (feature_out_l1_norm)
+                     816 PRECALL                  1
+                     820 CALL                     1
+                     830 BINARY_OP               11 (/)
+                     834 STORE_FAST              19 (pct_of_l1)
+         
+         236         836 LOAD_GLOBAL             43 (NULL + range)
+                     848 LOAD_GLOBAL              9 (NULL + len)
+                     860 LOAD_FAST                1 (feature_indices)
+                     862 PRECALL                  1
+                     866 CALL                     1
+                     876 PRECALL                  1
+                     880 CALL                     1
+                     890 GET_ITER
+                 >>  892 FOR_ITER               114 (to 1122)
+                     894 STORE_FAST              20 (i)
+         
+         237         896 LOAD_FAST               16 (feature_tables_data_kwargs)
+                     898 LOAD_FAST               20 (i)
+                     900 BINARY_SUBSCR
+                     910 LOAD_METHOD             22 (update)
+         
+         238         932 LOAD_FAST               17 (top3_neurons_aligned)
+                     934 LOAD_FAST               20 (i)
+                     936 BINARY_SUBSCR
+                     946 LOAD_ATTR               23 (indices)
+                     956 LOAD_METHOD             24 (tolist)
+                     978 PRECALL                  0
+                     982 CALL                     0
+         
+         239         992 LOAD_FAST               17 (top3_neurons_aligned)
+                     994 LOAD_FAST               20 (i)
+                     996 BINARY_SUBSCR
+                    1006 LOAD_ATTR               18 (values)
+                    1016 LOAD_METHOD             24 (tolist)
+                    1038 PRECALL                  0
+                    1042 CALL                     0
+         
+         240        1052 LOAD_FAST               19 (pct_of_l1)
+                    1054 LOAD_FAST               20 (i)
+                    1056 BINARY_SUBSCR
+                    1066 LOAD_METHOD             24 (tolist)
+                    1088 PRECALL                  0
+                    1092 CALL                     0
+         
+         237        1102 KW_NAMES                14
+                    1104 PRECALL                  3
+                    1108 CALL                     3
+                    1118 POP_TOP
+                    1120 JUMP_BACKWARD          115 (to 892)
+         
+         244     >> 1122 LOAD_FAST               15 (layout)
+                    1124 LOAD_ATTR                8 (feature_tables_cfg)
+                    1134 LOAD_ATTR               25 (correlated_neurons_table)
+                    1144 POP_JUMP_FORWARD_IF_FALSE   163 (to 1472)
+         
+         245        1146 LOAD_GLOBAL              3 (NULL + isinstance)
+                    1158 LOAD_FAST                8 (corrcoef_neurons)
+                    1160 LOAD_GLOBAL             52 (BatchedCorrCoef)
+                    1172 PRECALL                  2
+                    1176 CALL                     2
+                    1186 POP_JUMP_FORWARD_IF_TRUE    26 (to 1240)
+                    1188 LOAD_ASSERTION_ERROR
+         
+         246        1190 LOAD_CONST              15 ('Error: corrcoef_neurons should be of type BatchedCorrCoef, instead we got ')
+                    1192 LOAD_GLOBAL             15 (NULL + type)
+                    1204 LOAD_FAST                8 (corrcoef_neurons)
+                    1206 PRECALL                  1
+                    1210 CALL                     1
+                    1220 FORMAT_VALUE             0
+                    1222 BUILD_STRING             2
+         
+         245        1224 PRECALL                  0
+                    1228 CALL                     0
+                    1238 RAISE_VARARGS            1
+         
+         247     >> 1240 LOAD_FAST                8 (corrcoef_neurons)
+                    1242 LOAD_METHOD             27 (topk_pearson)
+         
+         248        1264 LOAD_FAST               15 (layout)
+                    1266 LOAD_ATTR                8 (feature_tables_cfg)
+                    1276 LOAD_ATTR               13 (n_rows)
+                    1286 LOAD_CONST              16 (False)
+         
+         247        1288 KW_NAMES                17
+                    1290 PRECALL                  2
+                    1294 CALL                     2
+                    1304 UNPACK_SEQUENCE          3
+                    1308 STORE_FAST              21 (neuron_indices)
+                    1310 STORE_FAST              22 (neuron_pearson)
+                    1312 STORE_FAST              23 (neuron_cossim)
+         
+         250        1314 LOAD_GLOBAL             43 (NULL + range)
+                    1326 LOAD_GLOBAL              9 (NULL + len)
+                    1338 LOAD_FAST                1 (feature_indices)
+                    1340 PRECALL                  1
+                    1344 CALL                     1
+                    1354 PRECALL                  1
+                    1358 CALL                     1
+                    1368 GET_ITER
+                 >> 1370 FOR_ITER                50 (to 1472)
+                    1372 STORE_FAST              20 (i)
          
-         239        1374 LOAD_FAST               19 (neuron_pearson)
-                    1376 LOAD_FAST               24 (i)
+         251        1374 LOAD_FAST               16 (feature_tables_data_kwargs)
+                    1376 LOAD_FAST               20 (i)
                     1378 BINARY_SUBSCR
+                    1388 LOAD_METHOD             22 (update)
+         
+         252        1410 LOAD_FAST               21 (neuron_indices)
+                    1412 LOAD_FAST               20 (i)
+                    1414 BINARY_SUBSCR
+         
+         253        1424 LOAD_FAST               22 (neuron_pearson)
+                    1426 LOAD_FAST               20 (i)
+                    1428 BINARY_SUBSCR
+         
+         254        1438 LOAD_FAST               23 (neuron_cossim)
+                    1440 LOAD_FAST               20 (i)
+                    1442 BINARY_SUBSCR
+         
+         251        1452 KW_NAMES                18
+                    1454 PRECALL                  3
+                    1458 CALL                     3
+                    1468 POP_TOP
+                    1470 JUMP_BACKWARD           51 (to 1370)
          
-         240        1388 LOAD_FAST               20 (neuron_cossim)
-                    1390 LOAD_FAST               24 (i)
-                    1392 BINARY_SUBSCR
-         
-         241        1402 LOAD_FAST               21 (encB_indices)
-                    1404 LOAD_FAST               24 (i)
-                    1406 BINARY_SUBSCR
-         
-         242        1416 LOAD_FAST               22 (encB_pearson)
-                    1418 LOAD_FAST               24 (i)
-                    1420 BINARY_SUBSCR
-         
-         243        1430 LOAD_FAST               23 (encB_cossim)
-                    1432 LOAD_FAST               24 (i)
-                    1434 BINARY_SUBSCR
-         
-         234        1444 KW_NAMES                18
-                    1446 PRECALL                  9
-                    1450 CALL                     9
-                    1460 LOAD_FAST               13 (feature_data_dict)
-                    1462 LOAD_FAST               25 (feat)
-                    1464 BINARY_SUBSCR
-                    1474 STORE_ATTR              24 (feature_tables_data)
-                    1484 JUMP_BACKWARD          159 (to 1168)
-         
-         246     >> 1486 LOAD_GLOBAL              1 (NULL + time)
-                    1498 LOAD_ATTR                0 (time)
-                    1508 PRECALL                  0
-                    1512 CALL                     0
-                    1522 LOAD_FAST               12 (t0)
-                    1524 BINARY_OP               10 (-)
-                    1528 LOAD_FAST               11 (time_logs)
-                    1530 LOAD_CONST              19 ('(4) Getting data for tables')
-                    1532 STORE_SUBSCR
-         
-         247        1536 LOAD_GLOBAL              1 (NULL + time)
-                    1548 LOAD_ATTR                0 (time)
-                    1558 PRECALL                  0
-                    1562 CALL                     0
-                    1572 STORE_FAST              12 (t0)
-         
-         253        1574 LOAD_GLOBAL             51 (NULL + einops)
-                    1586 LOAD_ATTR               26 (einsum)
-                    1596 LOAD_FAST                3 (feature_resid_dir)
-                    1598 LOAD_FAST                5 (W_U)
-                    1600 LOAD_CONST              20 ('feats d_model, d_model d_vocab -> feats d_vocab')
-                    1602 PRECALL                  3
-                    1606 CALL                     3
-                    1616 STORE_FAST              26 (logits)
-         
-         254        1618 LOAD_GLOBAL             55 (NULL + any)
-                    1630 LOAD_CONST              21 (<code object <genexpr>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 254>)
-                    1632 MAKE_FUNCTION            0
-                    1634 LOAD_FAST               14 (layout)
-                    1636 LOAD_ATTR               28 (act_hist_cfg)
-                    1646 LOAD_FAST               14 (layout)
-                    1648 LOAD_ATTR               29 (logits_hist_cfg)
-                    1658 LOAD_FAST               14 (layout)
-                    1660 LOAD_ATTR               30 (logits_table_cfg)
-                    1670 BUILD_TUPLE              3
-                    1672 GET_ITER
-                    1674 PRECALL                  0
-                    1678 CALL                     0
-                    1688 PRECALL                  1
-                    1692 CALL                     1
-                    1702 EXTENDED_ARG             1
-                    1704 POP_JUMP_FORWARD_IF_FALSE   404 (to 2514)
-         
-         256        1706 LOAD_GLOBAL             41 (NULL + enumerate)
-                    1718 LOAD_GLOBAL             63 (NULL + zip)
-                    1730 LOAD_FAST                1 (feature_indices)
-                    1732 LOAD_FAST               26 (logits)
-                    1734 PRECALL                  2
-                    1738 CALL                     2
-                    1748 PRECALL                  1
-                    1752 CALL                     1
-                    1762 GET_ITER
-                 >> 1764 EXTENDED_ARG             1
-                    1766 FOR_ITER               373 (to 2514)
-                    1768 UNPACK_SEQUENCE          2
-                    1772 STORE_FAST              24 (i)
-                    1774 UNPACK_SEQUENCE          2
-                    1778 STORE_FAST              25 (feat)
-                    1780 STORE_FAST              27 (logit_vector)
-         
-         259        1782 LOAD_FAST               14 (layout)
-                    1784 LOAD_ATTR               29 (logits_hist_cfg)
-                    1794 POP_JUMP_FORWARD_IF_NONE    45 (to 1886)
-         
-         260        1796 LOAD_GLOBAL             65 (NULL + LogitsHistogramData)
-                    1808 LOAD_ATTR               33 (from_data)
-         
-         261        1818 LOAD_FAST               27 (logit_vector)
-         
-         262        1820 LOAD_FAST               14 (layout)
-                    1822 LOAD_ATTR               29 (logits_hist_cfg)
-                    1832 LOAD_ATTR               34 (n_bins)
-         
-         263        1842 LOAD_CONST              22 ('5 ticks')
-         
-         264        1844 LOAD_CONST               6 (None)
-         
-         260        1846 KW_NAMES                23
-                    1848 PRECALL                  4
-                    1852 CALL                     4
-                    1862 LOAD_FAST               13 (feature_data_dict)
-                    1864 LOAD_FAST               25 (feat)
-                    1866 BINARY_SUBSCR
-                    1876 STORE_ATTR              35 (logits_histogram_data)
-         
-         268     >> 1886 LOAD_FAST               14 (layout)
-                    1888 LOAD_ATTR               28 (act_hist_cfg)
-                    1898 POP_JUMP_FORWARD_IF_NONE   112 (to 2124)
-         
-         269        1900 LOAD_FAST                2 (all_feat_acts)
-                    1902 LOAD_CONST              24 (Ellipsis)
-                    1904 LOAD_FAST               24 (i)
-                    1906 BUILD_TUPLE              2
-                    1908 BINARY_SUBSCR
-                    1918 STORE_FAST              28 (feat_acts)
-         
-         270        1920 LOAD_FAST               28 (feat_acts)
-                    1922 LOAD_FAST               28 (feat_acts)
-                    1924 LOAD_CONST               3 (0)
-                    1926 COMPARE_OP               4 (>)
-                    1932 BINARY_SUBSCR
-                    1942 STORE_FAST              29 (nonzero_feat_acts)
-         
-         271        1944 LOAD_FAST               29 (nonzero_feat_acts)
-                    1946 LOAD_METHOD             36 (numel)
-                    1968 PRECALL                  0
-                    1972 CALL                     0
-                    1982 LOAD_FAST               28 (feat_acts)
-                    1984 LOAD_METHOD             36 (numel)
-                    2006 PRECALL                  0
-                    2010 CALL                     0
-                    2020 BINARY_OP               11 (/)
-                    2024 STORE_FAST              30 (frac_nonzero)
-         
-         272        2026 LOAD_GLOBAL             75 (NULL + ActsHistogramData)
-                    2038 LOAD_ATTR               33 (from_data)
-         
-         273        2048 LOAD_FAST               29 (nonzero_feat_acts)
-         
-         274        2050 LOAD_FAST               14 (layout)
-                    2052 LOAD_ATTR               28 (act_hist_cfg)
-                    2062 LOAD_ATTR               34 (n_bins)
-         
-         275        2072 LOAD_CONST              22 ('5 ticks')
-         
-         276        2074 LOAD_CONST              25 ('ACTIVATIONS<br>DENSITY = ')
-                    2076 LOAD_FAST               30 (frac_nonzero)
-                    2078 LOAD_CONST              26 ('.3%')
-                    2080 FORMAT_VALUE             4 (with format)
-                    2082 BUILD_STRING             2
-         
-         272        2084 KW_NAMES                23
-                    2086 PRECALL                  4
-                    2090 CALL                     4
-                    2100 LOAD_FAST               13 (feature_data_dict)
-                    2102 LOAD_FAST               25 (feat)
-                    2104 BINARY_SUBSCR
-                    2114 STORE_ATTR              38 (acts_histogram_data)
-         
-         279     >> 2124 LOAD_FAST               14 (layout)
-                    2126 LOAD_ATTR               30 (logits_table_cfg)
-                    2136 POP_JUMP_FORWARD_IF_NONE   186 (to 2510)
-         
-         281        2138 LOAD_GLOBAL             19 (NULL + TopK)
-                    2150 LOAD_FAST               27 (logit_vector)
-                    2152 LOAD_FAST               14 (layout)
-                    2154 LOAD_ATTR               30 (logits_table_cfg)
-                    2164 LOAD_ATTR               10 (n_rows)
-                    2174 LOAD_CONST              10 (True)
-                    2176 KW_NAMES                27
+         258     >> 1472 LOAD_FAST               15 (layout)
+                    1474 LOAD_ATTR                8 (feature_tables_cfg)
+                    1484 LOAD_ATTR               28 (correlated_features_table)
+                    1494 POP_JUMP_FORWARD_IF_FALSE   163 (to 1822)
+         
+         259        1496 LOAD_GLOBAL              3 (NULL + isinstance)
+                    1508 LOAD_FAST                9 (corrcoef_encoder)
+                    1510 LOAD_GLOBAL             52 (BatchedCorrCoef)
+                    1522 PRECALL                  2
+                    1526 CALL                     2
+                    1536 POP_JUMP_FORWARD_IF_TRUE    26 (to 1590)
+                    1538 LOAD_ASSERTION_ERROR
+         
+         260        1540 LOAD_CONST              19 ('Error: corrcoef_encoder should be of type BatchedCorrCoef, instead we got ')
+                    1542 LOAD_GLOBAL             15 (NULL + type)
+                    1554 LOAD_FAST                9 (corrcoef_encoder)
+                    1556 PRECALL                  1
+                    1560 CALL                     1
+                    1570 FORMAT_VALUE             0
+                    1572 BUILD_STRING             2
+         
+         259        1574 PRECALL                  0
+                    1578 CALL                     0
+                    1588 RAISE_VARARGS            1
+         
+         261     >> 1590 LOAD_FAST                9 (corrcoef_encoder)
+                    1592 LOAD_METHOD             27 (topk_pearson)
+         
+         262        1614 LOAD_FAST               15 (layout)
+                    1616 LOAD_ATTR                8 (feature_tables_cfg)
+                    1626 LOAD_ATTR               13 (n_rows)
+                    1636 LOAD_CONST              10 (True)
+         
+         261        1638 KW_NAMES                17
+                    1640 PRECALL                  2
+                    1644 CALL                     2
+                    1654 UNPACK_SEQUENCE          3
+                    1658 STORE_FAST              24 (enc_indices)
+                    1660 STORE_FAST              25 (enc_pearson)
+                    1662 STORE_FAST              26 (enc_cossim)
+         
+         264        1664 LOAD_GLOBAL             43 (NULL + range)
+                    1676 LOAD_GLOBAL              9 (NULL + len)
+                    1688 LOAD_FAST                1 (feature_indices)
+                    1690 PRECALL                  1
+                    1694 CALL                     1
+                    1704 PRECALL                  1
+                    1708 CALL                     1
+                    1718 GET_ITER
+                 >> 1720 FOR_ITER                50 (to 1822)
+                    1722 STORE_FAST              20 (i)
+         
+         265        1724 LOAD_FAST               16 (feature_tables_data_kwargs)
+                    1726 LOAD_FAST               20 (i)
+                    1728 BINARY_SUBSCR
+                    1738 LOAD_METHOD             22 (update)
+         
+         266        1760 LOAD_FAST               24 (enc_indices)
+                    1762 LOAD_FAST               20 (i)
+                    1764 BINARY_SUBSCR
+         
+         267        1774 LOAD_FAST               25 (enc_pearson)
+                    1776 LOAD_FAST               20 (i)
+                    1778 BINARY_SUBSCR
+         
+         268        1788 LOAD_FAST               26 (enc_cossim)
+                    1790 LOAD_FAST               20 (i)
+                    1792 BINARY_SUBSCR
+         
+         265        1802 KW_NAMES                20
+                    1804 PRECALL                  3
+                    1808 CALL                     3
+                    1818 POP_TOP
+                    1820 JUMP_BACKWARD           51 (to 1720)
+         
+         273     >> 1822 LOAD_FAST               15 (layout)
+                    1824 LOAD_ATTR                8 (feature_tables_cfg)
+                    1834 LOAD_ATTR               29 (correlated_b_features_table)
+                    1844 POP_JUMP_FORWARD_IF_FALSE   175 (to 2196)
+         
+         274        1846 LOAD_FAST               10 (corrcoef_encoder_B)
+                    1848 POP_JUMP_FORWARD_IF_NOT_NONE    10 (to 1870)
+                    1850 LOAD_ASSERTION_ERROR
+         
+         275        1852 LOAD_CONST              21 ("Error: encoder_B is None, but you've set `correlated_b_features_table=True` in the layout.")
+         
+         274        1854 PRECALL                  0
+                    1858 CALL                     0
+                    1868 RAISE_VARARGS            1
+         
+         276     >> 1870 LOAD_GLOBAL              3 (NULL + isinstance)
+                    1882 LOAD_FAST               10 (corrcoef_encoder_B)
+                    1884 LOAD_GLOBAL             52 (BatchedCorrCoef)
+                    1896 PRECALL                  2
+                    1900 CALL                     2
+                    1910 POP_JUMP_FORWARD_IF_TRUE    26 (to 1964)
+                    1912 LOAD_ASSERTION_ERROR
+         
+         277        1914 LOAD_CONST              22 ('Error: corrcoef_encoder_B should be of type BatchedCorrCoef, instead we got ')
+                    1916 LOAD_GLOBAL             15 (NULL + type)
+                    1928 LOAD_FAST               10 (corrcoef_encoder_B)
+                    1930 PRECALL                  1
+                    1934 CALL                     1
+                    1944 FORMAT_VALUE             0
+                    1946 BUILD_STRING             2
+         
+         276        1948 PRECALL                  0
+                    1952 CALL                     0
+                    1962 RAISE_VARARGS            1
+         
+         278     >> 1964 LOAD_FAST               10 (corrcoef_encoder_B)
+                    1966 LOAD_METHOD             27 (topk_pearson)
+         
+         279        1988 LOAD_FAST               15 (layout)
+                    1990 LOAD_ATTR                8 (feature_tables_cfg)
+                    2000 LOAD_ATTR               13 (n_rows)
+                    2010 LOAD_CONST              16 (False)
+         
+         278        2012 KW_NAMES                17
+                    2014 PRECALL                  2
+                    2018 CALL                     2
+                    2028 UNPACK_SEQUENCE          3
+                    2032 STORE_FAST              27 (encB_indices)
+                    2034 STORE_FAST              28 (encB_pearson)
+                    2036 STORE_FAST              29 (encB_cossim)
+         
+         281        2038 LOAD_GLOBAL             43 (NULL + range)
+                    2050 LOAD_GLOBAL              9 (NULL + len)
+                    2062 LOAD_FAST                1 (feature_indices)
+                    2064 PRECALL                  1
+                    2068 CALL                     1
+                    2078 PRECALL                  1
+                    2082 CALL                     1
+                    2092 GET_ITER
+                 >> 2094 FOR_ITER                50 (to 2196)
+                    2096 STORE_FAST              20 (i)
+         
+         282        2098 LOAD_FAST               16 (feature_tables_data_kwargs)
+                    2100 LOAD_FAST               20 (i)
+                    2102 BINARY_SUBSCR
+                    2112 LOAD_METHOD             22 (update)
+         
+         283        2134 LOAD_FAST               27 (encB_indices)
+                    2136 LOAD_FAST               20 (i)
+                    2138 BINARY_SUBSCR
+         
+         284        2148 LOAD_FAST               28 (encB_pearson)
+                    2150 LOAD_FAST               20 (i)
+                    2152 BINARY_SUBSCR
+         
+         285        2162 LOAD_FAST               29 (encB_cossim)
+                    2164 LOAD_FAST               20 (i)
+                    2166 BINARY_SUBSCR
+         
+         282        2176 KW_NAMES                23
                     2178 PRECALL                  3
                     2182 CALL                     3
-                    2192 STORE_FAST              31 (top_logits)
+                    2192 POP_TOP
+                    2194 JUMP_BACKWARD           51 (to 2094)
          
-         282        2194 LOAD_GLOBAL             19 (NULL + TopK)
-                    2206 LOAD_FAST               27 (logit_vector)
-                    2208 LOAD_FAST               14 (layout)
-                    2210 LOAD_ATTR               30 (logits_table_cfg)
-                    2220 LOAD_ATTR               10 (n_rows)
-                    2230 LOAD_CONST              28 (False)
-                    2232 KW_NAMES                27
-                    2234 PRECALL                  3
-                    2238 CALL                     3
-                    2248 STORE_FAST              32 (bottom_logits)
-         
-         284        2250 LOAD_FAST               31 (top_logits)
-                    2252 LOAD_ATTR               15 (values)
-                    2262 LOAD_METHOD             23 (tolist)
-                    2284 PRECALL                  0
-                    2288 CALL                     0
-                    2298 LOAD_FAST               31 (top_logits)
-                    2300 LOAD_ATTR               22 (indices)
-                    2310 LOAD_METHOD             23 (tolist)
-                    2332 PRECALL                  0
-                    2336 CALL                     0
-                    2346 STORE_FAST              33 (top_token_ids)
-                    2348 STORE_FAST              31 (top_logits)
-         
-         285        2350 LOAD_FAST               32 (bottom_logits)
-                    2352 LOAD_ATTR               15 (values)
-                    2362 LOAD_METHOD             23 (tolist)
-                    2384 PRECALL                  0
-                    2388 CALL                     0
-                    2398 LOAD_FAST               32 (bottom_logits)
-                    2400 LOAD_ATTR               22 (indices)
-                    2410 LOAD_METHOD             23 (tolist)
-                    2432 PRECALL                  0
-                    2436 CALL                     0
-                    2446 STORE_FAST              34 (bottom_token_ids)
-                    2448 STORE_FAST              32 (bottom_logits)
-         
-         288        2450 LOAD_GLOBAL             79 (NULL + LogitsTableData)
-         
-         289        2462 LOAD_FAST               32 (bottom_logits)
-         
-         290        2464 LOAD_FAST               34 (bottom_token_ids)
-         
-         291        2466 LOAD_FAST               31 (top_logits)
-         
-         292        2468 LOAD_FAST               33 (top_token_ids)
-         
-         288        2470 KW_NAMES                29
-                    2472 PRECALL                  4
-                    2476 CALL                     4
-                    2486 LOAD_FAST               13 (feature_data_dict)
-                    2488 LOAD_FAST               25 (feat)
-                    2490 BINARY_SUBSCR
-                    2500 STORE_ATTR              40 (logits_table_data)
-                 >> 2510 EXTENDED_ARG             1
-                    2512 JUMP_BACKWARD          375 (to 1764)
-         
-         295     >> 2514 LOAD_GLOBAL              1 (NULL + time)
-                    2526 LOAD_ATTR                0 (time)
-                    2536 PRECALL                  0
-                    2540 CALL                     0
-                    2550 LOAD_FAST               12 (t0)
-                    2552 BINARY_OP               10 (-)
-                    2556 LOAD_FAST               11 (time_logs)
-                    2558 LOAD_CONST              30 ('(5) Getting data for histograms')
-                    2560 STORE_SUBSCR
-         
-         296        2564 LOAD_GLOBAL              1 (NULL + time)
-                    2576 LOAD_ATTR                0 (time)
-                    2586 PRECALL                  0
-                    2590 CALL                     0
-                    2600 STORE_FAST              12 (t0)
-         
-         301        2602 LOAD_FAST               14 (layout)
-                    2604 LOAD_ATTR               41 (seq_cfg)
-                    2614 POP_JUMP_FORWARD_IF_NONE   108 (to 2832)
-         
-         302        2616 LOAD_GLOBAL             41 (NULL + enumerate)
-                    2628 LOAD_FAST                1 (feature_indices)
-                    2630 PRECALL                  1
-                    2634 CALL                     1
-                    2644 GET_ITER
-                 >> 2646 FOR_ITER                92 (to 2832)
-                    2648 UNPACK_SEQUENCE          2
-                    2652 STORE_FAST              24 (i)
-                    2654 STORE_FAST              25 (feat)
-         
-         305        2656 LOAD_GLOBAL             85 (NULL + get_sequences_data)
-         
-         306        2668 LOAD_FAST                0 (tokens)
-         
-         307        2670 LOAD_FAST                2 (all_feat_acts)
-                    2672 LOAD_CONST              24 (Ellipsis)
-                    2674 LOAD_FAST               24 (i)
-                    2676 BUILD_TUPLE              2
-                    2678 BINARY_SUBSCR
-         
-         308        2688 LOAD_FAST               26 (logits)
-                    2690 LOAD_FAST               24 (i)
-                    2692 BINARY_SUBSCR
-         
-         309        2702 LOAD_FAST                4 (all_resid_post)
-         
-         310        2704 LOAD_FAST                3 (feature_resid_dir)
-                    2706 LOAD_FAST               24 (i)
-                    2708 BINARY_SUBSCR
-         
-         311        2718 LOAD_FAST                5 (W_U)
-         
-         312        2720 LOAD_FAST               14 (layout)
-                    2722 LOAD_ATTR               41 (seq_cfg)
-         
-         305        2732 KW_NAMES                31
-                    2734 PRECALL                  7
-                    2738 CALL                     7
-                    2748 LOAD_FAST               13 (feature_data_dict)
-                    2750 LOAD_FAST               25 (feat)
-                    2752 BINARY_SUBSCR
-                    2762 STORE_ATTR              43 (sequence_data)
-         
-         315        2772 LOAD_FAST               10 (progress)
-                    2774 POP_JUMP_FORWARD_IF_NONE    27 (to 2830)
-         
-         316        2776 LOAD_FAST               10 (progress)
-                    2778 LOAD_CONST              32 (1)
-                    2780 BINARY_SUBSCR
-                    2790 LOAD_METHOD             44 (update)
-                    2812 LOAD_CONST              32 (1)
-                    2814 PRECALL                  1
-                    2818 CALL                     1
-                    2828 POP_TOP
-                 >> 2830 JUMP_BACKWARD           93 (to 2646)
-         
-         318     >> 2832 LOAD_GLOBAL              1 (NULL + time)
-                    2844 LOAD_ATTR                0 (time)
-                    2854 PRECALL                  0
-                    2858 CALL                     0
-                    2868 LOAD_FAST               12 (t0)
-                    2870 BINARY_OP               10 (-)
-                    2874 LOAD_FAST               11 (time_logs)
-                    2876 LOAD_CONST              33 ('(6) Getting data for sequences')
-                    2878 STORE_SUBSCR
-         
-         319        2882 LOAD_GLOBAL              1 (NULL + time)
-                    2894 LOAD_ATTR                0 (time)
-                    2904 PRECALL                  0
-                    2908 CALL                     0
-                    2918 STORE_FAST              12 (t0)
-         
-         323        2920 LOAD_GLOBAL             91 (NULL + QuantileCalculator)
-                    2932 LOAD_ATTR               33 (from_data)
-                    2942 LOAD_GLOBAL             51 (NULL + einops)
-                    2954 LOAD_ATTR               46 (rearrange)
-                    2964 LOAD_FAST                2 (all_feat_acts)
-                    2966 LOAD_CONST              34 ('b s feats -> feats (b s)')
-                    2968 PRECALL                  2
-                    2972 CALL                     2
-                    2982 KW_NAMES                35
-                    2984 PRECALL                  1
-                    2988 CALL                     1
-                    2998 STORE_FAST              35 (feature_act_quantiles)
-         
-         324        3000 LOAD_GLOBAL              1 (NULL + time)
-                    3012 LOAD_ATTR                0 (time)
-                    3022 PRECALL                  0
-                    3026 CALL                     0
-                    3036 LOAD_FAST               12 (t0)
-                    3038 BINARY_OP               10 (-)
-                    3042 LOAD_FAST               11 (time_logs)
-                    3044 LOAD_CONST              36 ('(7) Getting data for quantiles')
-                    3046 STORE_SUBSCR
-         
-         325        3050 LOAD_GLOBAL              1 (NULL + time)
-                    3062 LOAD_ATTR                0 (time)
-                    3072 PRECALL                  0
-                    3076 CALL                     0
-                    3086 STORE_FAST              12 (t0)
-         
-         329        3088 LOAD_GLOBAL             95 (NULL + SaeVisData)
-                    3100 LOAD_FAST               13 (feature_data_dict)
-                    3102 LOAD_FAST               35 (feature_act_quantiles)
-                    3104 LOAD_FAST                6 (cfg)
-                    3106 PRECALL                  3
-                    3110 CALL                     3
-                    3120 STORE_FAST              36 (sae_vis_data)
-         
-         330        3122 LOAD_FAST               36 (sae_vis_data)
-                    3124 LOAD_FAST               11 (time_logs)
-                    3126 BUILD_TUPLE              2
-                    3128 RETURN_VALUE
+         289     >> 2196 LOAD_GLOBAL             61 (NULL + enumerate)
+                    2208 LOAD_FAST                1 (feature_indices)
+                    2210 PRECALL                  1
+                    2214 CALL                     1
+                    2224 GET_ITER
+                 >> 2226 FOR_ITER                34 (to 2296)
+                    2228 UNPACK_SEQUENCE          2
+                    2232 STORE_FAST              20 (i)
+                    2234 STORE_FAST              30 (feat)
+         
+         290        2236 LOAD_GLOBAL             63 (NULL + FeatureTablesData)
+                    2248 LOAD_CONST              41 (())
+                    2250 BUILD_MAP                0
+                    2252 LOAD_FAST               16 (feature_tables_data_kwargs)
+                    2254 LOAD_FAST               20 (i)
+                    2256 BINARY_SUBSCR
+                    2266 DICT_MERGE               1
+                    2268 CALL_FUNCTION_EX         1
+                    2270 LOAD_FAST               14 (feature_data_dict)
+                    2272 LOAD_FAST               30 (feat)
+                    2274 BINARY_SUBSCR
+                    2284 STORE_ATTR              32 (feature_tables_data)
+                    2294 JUMP_BACKWARD           35 (to 2226)
+         
+         292     >> 2296 LOAD_GLOBAL              1 (NULL + time)
+                    2308 LOAD_ATTR                0 (time)
+                    2318 PRECALL                  0
+                    2322 CALL                     0
+                    2332 LOAD_FAST               13 (t0)
+                    2334 BINARY_OP               10 (-)
+                    2338 LOAD_FAST               12 (time_logs)
+                    2340 LOAD_CONST              24 ('(4) Getting data for tables')
+                    2342 STORE_SUBSCR
+         
+         293        2346 LOAD_GLOBAL              1 (NULL + time)
+                    2358 LOAD_ATTR                0 (time)
+                    2368 PRECALL                  0
+                    2372 CALL                     0
+                    2382 STORE_FAST              13 (t0)
+         
+         299        2384 LOAD_GLOBAL             67 (NULL + einops)
+                    2396 LOAD_ATTR               34 (einsum)
+                    2406 LOAD_FAST                3 (feature_resid_dir)
+                    2408 LOAD_FAST                5 (W_U)
+                    2410 LOAD_CONST              25 ('feats d_model, d_model d_vocab -> feats d_vocab')
+                    2412 PRECALL                  3
+                    2416 CALL                     3
+                    2426 STORE_FAST              31 (logits)
+         
+         300        2428 LOAD_GLOBAL             71 (NULL + any)
+                    2440 LOAD_CONST              26 (<code object <genexpr>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 300>)
+                    2442 MAKE_FUNCTION            0
+                    2444 LOAD_FAST               15 (layout)
+                    2446 LOAD_ATTR               36 (act_hist_cfg)
+                    2456 LOAD_FAST               15 (layout)
+                    2458 LOAD_ATTR               37 (logits_hist_cfg)
+                    2468 LOAD_FAST               15 (layout)
+                    2470 LOAD_ATTR               38 (logits_table_cfg)
+                    2480 BUILD_TUPLE              3
+                    2482 GET_ITER
+                    2484 PRECALL                  0
+                    2488 CALL                     0
+                    2498 PRECALL                  1
+                    2502 CALL                     1
+                    2512 EXTENDED_ARG             1
+                    2514 POP_JUMP_FORWARD_IF_FALSE   404 (to 3324)
+         
+         302        2516 LOAD_GLOBAL             61 (NULL + enumerate)
+                    2528 LOAD_GLOBAL             79 (NULL + zip)
+                    2540 LOAD_FAST                1 (feature_indices)
+                    2542 LOAD_FAST               31 (logits)
+                    2544 PRECALL                  2
+                    2548 CALL                     2
+                    2558 PRECALL                  1
+                    2562 CALL                     1
+                    2572 GET_ITER
+                 >> 2574 EXTENDED_ARG             1
+                    2576 FOR_ITER               373 (to 3324)
+                    2578 UNPACK_SEQUENCE          2
+                    2582 STORE_FAST              20 (i)
+                    2584 UNPACK_SEQUENCE          2
+                    2588 STORE_FAST              30 (feat)
+                    2590 STORE_FAST              32 (logit_vector)
+         
+         305        2592 LOAD_FAST               15 (layout)
+                    2594 LOAD_ATTR               37 (logits_hist_cfg)
+                    2604 POP_JUMP_FORWARD_IF_NONE    45 (to 2696)
+         
+         306        2606 LOAD_GLOBAL             81 (NULL + LogitsHistogramData)
+                    2618 LOAD_ATTR               41 (from_data)
+         
+         307        2628 LOAD_FAST               32 (logit_vector)
+         
+         308        2630 LOAD_FAST               15 (layout)
+                    2632 LOAD_ATTR               37 (logits_hist_cfg)
+                    2642 LOAD_ATTR               42 (n_bins)
+         
+         309        2652 LOAD_CONST              27 ('5 ticks')
+         
+         310        2654 LOAD_CONST               6 (None)
+         
+         306        2656 KW_NAMES                28
+                    2658 PRECALL                  4
+                    2662 CALL                     4
+                    2672 LOAD_FAST               14 (feature_data_dict)
+                    2674 LOAD_FAST               30 (feat)
+                    2676 BINARY_SUBSCR
+                    2686 STORE_ATTR              43 (logits_histogram_data)
+         
+         314     >> 2696 LOAD_FAST               15 (layout)
+                    2698 LOAD_ATTR               36 (act_hist_cfg)
+                    2708 POP_JUMP_FORWARD_IF_NONE   112 (to 2934)
+         
+         315        2710 LOAD_FAST                2 (all_feat_acts)
+                    2712 LOAD_CONST              29 (Ellipsis)
+                    2714 LOAD_FAST               20 (i)
+                    2716 BUILD_TUPLE              2
+                    2718 BINARY_SUBSCR
+                    2728 STORE_FAST              33 (feat_acts)
+         
+         316        2730 LOAD_FAST               33 (feat_acts)
+                    2732 LOAD_FAST               33 (feat_acts)
+                    2734 LOAD_CONST               3 (0)
+                    2736 COMPARE_OP               4 (>)
+                    2742 BINARY_SUBSCR
+                    2752 STORE_FAST              34 (nonzero_feat_acts)
+         
+         317        2754 LOAD_FAST               34 (nonzero_feat_acts)
+                    2756 LOAD_METHOD             44 (numel)
+                    2778 PRECALL                  0
+                    2782 CALL                     0
+                    2792 LOAD_FAST               33 (feat_acts)
+                    2794 LOAD_METHOD             44 (numel)
+                    2816 PRECALL                  0
+                    2820 CALL                     0
+                    2830 BINARY_OP               11 (/)
+                    2834 STORE_FAST              35 (frac_nonzero)
+         
+         318        2836 LOAD_GLOBAL             91 (NULL + ActsHistogramData)
+                    2848 LOAD_ATTR               41 (from_data)
+         
+         319        2858 LOAD_FAST               34 (nonzero_feat_acts)
+         
+         320        2860 LOAD_FAST               15 (layout)
+                    2862 LOAD_ATTR               36 (act_hist_cfg)
+                    2872 LOAD_ATTR               42 (n_bins)
+         
+         321        2882 LOAD_CONST              27 ('5 ticks')
+         
+         322        2884 LOAD_CONST              30 ('ACTIVATIONS<br>DENSITY = ')
+                    2886 LOAD_FAST               35 (frac_nonzero)
+                    2888 LOAD_CONST              31 ('.3%')
+                    2890 FORMAT_VALUE             4 (with format)
+                    2892 BUILD_STRING             2
+         
+         318        2894 KW_NAMES                28
+                    2896 PRECALL                  4
+                    2900 CALL                     4
+                    2910 LOAD_FAST               14 (feature_data_dict)
+                    2912 LOAD_FAST               30 (feat)
+                    2914 BINARY_SUBSCR
+                    2924 STORE_ATTR              46 (acts_histogram_data)
+         
+         325     >> 2934 LOAD_FAST               15 (layout)
+                    2936 LOAD_ATTR               38 (logits_table_cfg)
+                    2946 POP_JUMP_FORWARD_IF_NONE   186 (to 3320)
+         
+         327        2948 LOAD_GLOBAL             25 (NULL + TopK)
+                    2960 LOAD_FAST               32 (logit_vector)
+                    2962 LOAD_FAST               15 (layout)
+                    2964 LOAD_ATTR               38 (logits_table_cfg)
+                    2974 LOAD_ATTR               13 (n_rows)
+                    2984 LOAD_CONST              10 (True)
+                    2986 KW_NAMES                32
+                    2988 PRECALL                  3
+                    2992 CALL                     3
+                    3002 STORE_FAST              36 (top_logits)
+         
+         328        3004 LOAD_GLOBAL             25 (NULL + TopK)
+                    3016 LOAD_FAST               32 (logit_vector)
+                    3018 LOAD_FAST               15 (layout)
+                    3020 LOAD_ATTR               38 (logits_table_cfg)
+                    3030 LOAD_ATTR               13 (n_rows)
+                    3040 LOAD_CONST              16 (False)
+                    3042 KW_NAMES                32
+                    3044 PRECALL                  3
+                    3048 CALL                     3
+                    3058 STORE_FAST              37 (bottom_logits)
+         
+         330        3060 LOAD_FAST               36 (top_logits)
+                    3062 LOAD_ATTR               18 (values)
+                    3072 LOAD_METHOD             24 (tolist)
+                    3094 PRECALL                  0
+                    3098 CALL                     0
+                    3108 LOAD_FAST               36 (top_logits)
+                    3110 LOAD_ATTR               23 (indices)
+                    3120 LOAD_METHOD             24 (tolist)
+                    3142 PRECALL                  0
+                    3146 CALL                     0
+                    3156 STORE_FAST              38 (top_token_ids)
+                    3158 STORE_FAST              36 (top_logits)
+         
+         331        3160 LOAD_FAST               37 (bottom_logits)
+                    3162 LOAD_ATTR               18 (values)
+                    3172 LOAD_METHOD             24 (tolist)
+                    3194 PRECALL                  0
+                    3198 CALL                     0
+                    3208 LOAD_FAST               37 (bottom_logits)
+                    3210 LOAD_ATTR               23 (indices)
+                    3220 LOAD_METHOD             24 (tolist)
+                    3242 PRECALL                  0
+                    3246 CALL                     0
+                    3256 STORE_FAST              39 (bottom_token_ids)
+                    3258 STORE_FAST              37 (bottom_logits)
+         
+         334        3260 LOAD_GLOBAL             95 (NULL + LogitsTableData)
+         
+         335        3272 LOAD_FAST               37 (bottom_logits)
+         
+         336        3274 LOAD_FAST               39 (bottom_token_ids)
+         
+         337        3276 LOAD_FAST               36 (top_logits)
+         
+         338        3278 LOAD_FAST               38 (top_token_ids)
+         
+         334        3280 KW_NAMES                33
+                    3282 PRECALL                  4
+                    3286 CALL                     4
+                    3296 LOAD_FAST               14 (feature_data_dict)
+                    3298 LOAD_FAST               30 (feat)
+                    3300 BINARY_SUBSCR
+                    3310 STORE_ATTR              48 (logits_table_data)
+                 >> 3320 EXTENDED_ARG             1
+                    3322 JUMP_BACKWARD          375 (to 2574)
+         
+         341     >> 3324 LOAD_GLOBAL              1 (NULL + time)
+                    3336 LOAD_ATTR                0 (time)
+                    3346 PRECALL                  0
+                    3350 CALL                     0
+                    3360 LOAD_FAST               13 (t0)
+                    3362 BINARY_OP               10 (-)
+                    3366 LOAD_FAST               12 (time_logs)
+                    3368 LOAD_CONST              34 ('(5) Getting data for histograms')
+                    3370 STORE_SUBSCR
+         
+         342        3374 LOAD_GLOBAL              1 (NULL + time)
+                    3386 LOAD_ATTR                0 (time)
+                    3396 PRECALL                  0
+                    3400 CALL                     0
+                    3410 STORE_FAST              13 (t0)
+         
+         347        3412 LOAD_FAST               15 (layout)
+                    3414 LOAD_ATTR               49 (seq_cfg)
+                    3424 POP_JUMP_FORWARD_IF_NONE   108 (to 3642)
+         
+         348        3426 LOAD_GLOBAL             61 (NULL + enumerate)
+                    3438 LOAD_FAST                1 (feature_indices)
+                    3440 PRECALL                  1
+                    3444 CALL                     1
+                    3454 GET_ITER
+                 >> 3456 FOR_ITER                92 (to 3642)
+                    3458 UNPACK_SEQUENCE          2
+                    3462 STORE_FAST              20 (i)
+                    3464 STORE_FAST              30 (feat)
+         
+         351        3466 LOAD_GLOBAL            101 (NULL + get_sequences_data)
+         
+         352        3478 LOAD_FAST                0 (tokens)
+         
+         353        3480 LOAD_FAST                2 (all_feat_acts)
+                    3482 LOAD_CONST              29 (Ellipsis)
+                    3484 LOAD_FAST               20 (i)
+                    3486 BUILD_TUPLE              2
+                    3488 BINARY_SUBSCR
+         
+         354        3498 LOAD_FAST               31 (logits)
+                    3500 LOAD_FAST               20 (i)
+                    3502 BINARY_SUBSCR
+         
+         355        3512 LOAD_FAST                4 (all_resid_post)
+         
+         356        3514 LOAD_FAST                3 (feature_resid_dir)
+                    3516 LOAD_FAST               20 (i)
+                    3518 BINARY_SUBSCR
+         
+         357        3528 LOAD_FAST                5 (W_U)
+         
+         358        3530 LOAD_FAST               15 (layout)
+                    3532 LOAD_ATTR               49 (seq_cfg)
+         
+         351        3542 KW_NAMES                35
+                    3544 PRECALL                  7
+                    3548 CALL                     7
+                    3558 LOAD_FAST               14 (feature_data_dict)
+                    3560 LOAD_FAST               30 (feat)
+                    3562 BINARY_SUBSCR
+                    3572 STORE_ATTR              51 (sequence_data)
+         
+         361        3582 LOAD_FAST               11 (progress)
+                    3584 POP_JUMP_FORWARD_IF_NONE    27 (to 3640)
+         
+         362        3586 LOAD_FAST               11 (progress)
+                    3588 LOAD_CONST              36 (1)
+                    3590 BINARY_SUBSCR
+                    3600 LOAD_METHOD             22 (update)
+                    3622 LOAD_CONST              36 (1)
+                    3624 PRECALL                  1
+                    3628 CALL                     1
+                    3638 POP_TOP
+                 >> 3640 JUMP_BACKWARD           93 (to 3456)
+         
+         364     >> 3642 LOAD_GLOBAL              1 (NULL + time)
+                    3654 LOAD_ATTR                0 (time)
+                    3664 PRECALL                  0
+                    3668 CALL                     0
+                    3678 LOAD_FAST               13 (t0)
+                    3680 BINARY_OP               10 (-)
+                    3684 LOAD_FAST               12 (time_logs)
+                    3686 LOAD_CONST              37 ('(6) Getting data for sequences')
+                    3688 STORE_SUBSCR
+         
+         365        3692 LOAD_GLOBAL              1 (NULL + time)
+                    3704 LOAD_ATTR                0 (time)
+                    3714 PRECALL                  0
+                    3718 CALL                     0
+                    3728 STORE_FAST              13 (t0)
+         
+         369        3730 LOAD_GLOBAL            105 (NULL + QuantileCalculator)
+                    3742 LOAD_ATTR               41 (from_data)
+                    3752 LOAD_GLOBAL             67 (NULL + einops)
+                    3764 LOAD_ATTR               53 (rearrange)
+                    3774 LOAD_FAST                2 (all_feat_acts)
+                    3776 LOAD_CONST              38 ('b s feats -> feats (b s)')
+                    3778 PRECALL                  2
+                    3782 CALL                     2
+                    3792 KW_NAMES                39
+                    3794 PRECALL                  1
+                    3798 CALL                     1
+                    3808 STORE_FAST              40 (feature_act_quantiles)
+         
+         370        3810 LOAD_GLOBAL              1 (NULL + time)
+                    3822 LOAD_ATTR                0 (time)
+                    3832 PRECALL                  0
+                    3836 CALL                     0
+                    3846 LOAD_FAST               13 (t0)
+                    3848 BINARY_OP               10 (-)
+                    3852 LOAD_FAST               12 (time_logs)
+                    3854 LOAD_CONST              40 ('(7) Getting data for quantiles')
+                    3856 STORE_SUBSCR
+         
+         371        3860 LOAD_GLOBAL              1 (NULL + time)
+                    3872 LOAD_ATTR                0 (time)
+                    3882 PRECALL                  0
+                    3886 CALL                     0
+                    3896 STORE_FAST              13 (t0)
+         
+         375        3898 LOAD_GLOBAL            109 (NULL + SaeVisData)
+                    3910 LOAD_FAST               14 (feature_data_dict)
+                    3912 LOAD_FAST               40 (feature_act_quantiles)
+                    3914 LOAD_FAST                6 (cfg)
+                    3916 PRECALL                  3
+                    3920 CALL                     3
+                    3930 STORE_FAST              41 (sae_vis_data)
+         
+         376        3932 LOAD_FAST               41 (sae_vis_data)
+                    3934 LOAD_FAST               12 (time_logs)
+                    3936 BUILD_TUPLE              2
+                    3938 RETURN_VALUE
          consts
-            'Convert generic activation data into a SaeVisData object, which can be used to create the feature-centric vis.\n\n    This function exists so that feature dashboards can be generated without using our AutoEncoder or\n    TransformerLens(Wrapper) classes. We pass through W_U & other data needed for computing the logit lens, so we don\'t\n    need the models.\n\n    Args:\n        tokens: Int[Tensor, "batch seq"]\n            The tokens we\'ll be using to get the feature activations.\n        \n        feature_indices: Union[int, list[int]]\n            The features we\'re actually computing. These might just be a subset of the model\'s full features.\n        \n        all_feat_acts: Float[Tensor, "... feats"]\n            The activations values of the features across the batch & sequence.\n        \n        feature_resid_dir: Float[Tensor, "feats d_model"]\n            The directions that each feature writes to the residual stream.\n            For example, feature_resid_dir = encoder.W_dec[feature_indices] # [feats d_autoencoder]\n        \n        all_resid_post: Float[Tensor, "... d_model"]\n            The activations of the final layer of the model before the unembed. \n        \n        W_U: Float[Tensor, "d_model d_vocab"]\n            The model\'s unembed weights for the logit lens.\n        \n        cfg: SaeVisConfig\n            Feature visualization parameters, containing a bunch of other stuff. See the SaeVisConfig docstring for\n            more information.\n        \n        feature_out_dir: Optional[Float[Tensor, "feats d_out"]]\n            The directions that each SAE feature writes to the residual stream. This will be the same as \n            feature_resid_dir if the SAE is in the residual stream (as we will assume if it not provided)\n            For example, feature_out_dir = encoder.W_dec[feature_indices] # [feats d_autoencoder]\n        \n        corrcoef_neurons: Optional[BatchedCorrCoef]\n            The object storing the minimal data necessary to compute corrcoef between feature activations & neurons.\n\n        corrcoef_encoder_B: Optional[BatchedCorrCoef]\n            The object storing minimal data to compute corrcoef between feature activations & encoder-B features.\n\n        progress: Optional[list[tqdm]]\n            An optional list containing progress bars for the forward passes and the sequence data. This is used to\n            update the progress bars as the computation runs.\n    \n    Returns:\n        sae_vis_data: SaeVisData\n            Containing data for creating each feature visualization, as well as data for rank-ordering the feature\n            visualizations when it comes time to make the prompt-centric view (the `feature_act_quantiles` attribute).\n\n        time_logs: dict[str, float]\n            A dictionary containing the time taken for each step of the computation. This is optionally printed at the\n            end of the `get_feature_data` function, if `cfg.verbose` is set to True.\n    '
+            'Convert generic activation data into a SaeVisData object, which can be used to create the feature-centric vis.\n\n    This function exists so that feature dashboards can be generated without using our AutoEncoder or\n    TransformerLens(Wrapper) classes. We pass through W_U & other data needed for computing the logit lens, so we don\'t\n    need the models.\n\n    Args:\n        tokens: Int[Tensor, "batch seq"]\n            The tokens we\'ll be using to get the feature activations.\n        \n        feature_indices: Union[int, list[int]]\n            The features we\'re actually computing. These might just be a subset of the model\'s full features.\n        \n        all_feat_acts: Float[Tensor, "... feats"]\n            The activations values of the features across the batch & sequence.\n        \n        feature_resid_dir: Float[Tensor, "feats d_model"]\n            The directions that each feature writes to the residual stream.\n            For example, feature_resid_dir = encoder.W_dec[feature_indices] # [feats d_autoencoder]\n        \n        all_resid_post: Float[Tensor, "... d_model"]\n            The activations of the final layer of the model before the unembed. \n        \n        W_U: Float[Tensor, "d_model d_vocab"]\n            The model\'s unembed weights for the logit lens.\n        \n        cfg: SaeVisConfig\n            Feature visualization parameters, containing a bunch of other stuff. See the SaeVisConfig docstring for\n            more information.\n        \n        feature_out_dir: Optional[Float[Tensor, "feats d_out"]]\n            The directions that each SAE feature writes to the residual stream. This will be the same as \n            feature_resid_dir if the SAE is in the residual stream (as we will assume if it not provided)\n            For example, feature_out_dir = encoder.W_dec[feature_indices] # [feats d_autoencoder]\n        \n        corrcoef_neurons: Optional[BatchedCorrCoef]\n            The object storing the minimal data necessary to compute corrcoef between feature activations & neurons.\n        \n        corrcoef_encoder: Optional[BatchedCorrCoef]\n            The object storing the minimal data necessary to compute corrcoef between feature activations (pairwise).\n\n        corrcoef_encoder_B: Optional[BatchedCorrCoef]\n            The object storing minimal data to compute corrcoef between feature activations & encoder-B features.\n\n        progress: Optional[list[tqdm]]\n            An optional list containing progress bars for the forward passes and the sequence data. This is used to\n            update the progress bars as the computation runs.\n    \n    Returns:\n        sae_vis_data: SaeVisData\n            Containing data for creating each feature visualization, as well as data for rank-ordering the feature\n            visualizations when it comes time to make the prompt-centric view (the `feature_act_quantiles` attribute).\n\n        time_logs: dict[str, float]\n            A dictionary containing the time taken for each step of the computation. This is optionally printed at the\n            end of the `get_feature_data` function, if `cfg.verbose` is set to True.\n    '
             0.0
             ('(4) Getting data for tables', '(5) Getting data for histograms', '(6) Getting data for sequences', '(7) Getting data for quantiles')
             0
             'Num features in feature_resid_dir ('
             ") doesn't match len(feature_indices)="
             None
             'Num features in feature_out_dir ('
@@ -1755,15 +1995,15 @@
                argcount  : 1
                nlocals   : 2
                stacksize : 5
                flags     : 19
                code
                   0x970069007c005d117d017c01740100000000000000000000a6000000ab
                   00000000000000000093028c125300
-               202           0 RESUME                   0
+               216           0 RESUME                   0
                              2 BUILD_MAP                0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                17 (to 42)
                              8 STORE_FAST               1 (feat)
                             10 LOAD_FAST                1 (feat)
                             12 LOAD_GLOBAL              1 (NULL + FeatureData)
                             24 PRECALL                  0
@@ -1772,62 +2012,44 @@
                             40 JUMP_BACKWARD           18 (to 6)
                        >>   42 RETURN_VALUE
                consts
                names      ('FeatureData',)
                varnames   ('.0', 'feat')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<dictcomp>'
-               firstlineno 202
+               firstlineno 216
                lnotab 0x
             'Error: cfg.feature_centric_layout must be a SaeVisLayoutConfig object, got '
             True
             ('tensor', 'k', 'largest')
             -1
             ('dim', 'keepdim')
+            ('neuron_alignment_indices', 'neuron_alignment_values', 'neuron_alignment_l1')
             'Error: corrcoef_neurons should be of type BatchedCorrCoef, instead we got '
-            ('k',)
-            code
-               argcount  : 1
-               nlocals   : 2
-               stacksize : 3
-               flags     : 19
-               code 0x970067007c005d047d01670091028c055300
-               226           0 RESUME                   0
-                             2 BUILD_LIST               0
-                             4 LOAD_FAST                0 (.0)
-                       >>    6 FOR_ITER                 4 (to 16)
-                             8 STORE_FAST               1 (_)
-                            10 BUILD_LIST               0
-                            12 LIST_APPEND              2
-                            14 JUMP_BACKWARD            5 (to 6)
-                       >>   16 RETURN_VALUE
-               consts
-               names      ()
-               varnames   ('.0', '_')
-               freevars   ()
-               cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
-               name       '<listcomp>'
-               firstlineno 226
-               lnotab 0x
+            False
+            ('k', 'exclude_diag')
+            ('correlated_neurons_indices', 'correlated_neurons_pearson', 'correlated_neurons_cossim')
+            'Error: corrcoef_encoder should be of type BatchedCorrCoef, instead we got '
+            ('correlated_features_indices', 'correlated_features_pearson', 'correlated_features_cossim')
+            "Error: encoder_B is None, but you've set `correlated_b_features_table=True` in the layout."
             'Error: corrcoef_encoder_B should be of type BatchedCorrCoef, instead we got '
-            ('neuron_alignment_indices', 'neuron_alignment_values', 'neuron_alignment_l1', 'correlated_neurons_indices', 'correlated_neurons_pearson', 'correlated_neurons_cossim', 'correlated_features_indices', 'correlated_features_pearson', 'correlated_features_cossim')
+            ('correlated_b_features_indices', 'correlated_b_features_pearson', 'correlated_b_features_cossim')
             '(4) Getting data for tables'
             'feats d_model, d_model d_vocab -> feats d_vocab'
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 3
                flags     : 51
                code
                   0x4b00010097007c005d087d017c01640075015600970101008c09640053
                   00
-               254           0 RETURN_GENERATOR
+               300           0 RETURN_GENERATOR
                              2 POP_TOP
                              4 RESUME                   0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                 8 (to 26)
                             10 STORE_FAST               1 (x)
                             12 LOAD_FAST                1 (x)
                             14 LOAD_CONST               0 (None)
@@ -1840,410 +2062,430 @@
                             28 RETURN_VALUE
                consts
                   None
                names      ()
                varnames   ('.0', 'x')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<genexpr>'
-               firstlineno 254
+               firstlineno 300
                lnotab 0x
             '5 ticks'
             ('data', 'n_bins', 'tickmode', 'title')
             Ellipsis
             'ACTIVATIONS<br>DENSITY = '
             '.3%'
             ('k', 'largest')
-            False
             ('bottom_logits', 'bottom_token_ids', 'top_logits', 'top_token_ids')
             '(5) Getting data for histograms'
             ('tokens', 'feat_acts', 'feat_logits', 'resid_post', 'feature_resid_dir', 'W_U', 'seq_cfg')
             1
             '(6) Getting data for sequences'
             'b s feats -> feats (b s)'
             ('data',)
             '(7) Getting data for quantiles'
-         names      ('time', 'isinstance', 'int', 'shape', 'len', 'feature_centric_layout', 'SaeVisLayoutConfig', 'type', 'feat_tables_cfg', 'TopK', 'n_rows', 'abs', 'sum', 'np', 'absolute', 'values', 'utils', 'to_numpy', 'BatchedCorrCoef', 'topk_pearson', 'enumerate', 'FeatureTablesData', 'indices', 'tolist', 'feature_tables_data', 'einops', 'einsum', 'any', 'act_hist_cfg', 'logits_hist_cfg', 'logits_table_cfg', 'zip', 'LogitsHistogramData', 'from_data', 'n_bins', 'logits_histogram_data', 'numel', 'ActsHistogramData', 'acts_histogram_data', 'LogitsTableData', 'logits_table_data', 'seq_cfg', 'get_sequences_data', 'sequence_data', 'update', 'QuantileCalculator', 'rearrange', 'SaeVisData')
-         varnames   ('tokens', 'feature_indices', 'all_feat_acts', 'feature_resid_dir', 'all_resid_post', 'W_U', 'cfg', 'feature_out_dir', 'corrcoef_neurons', 'corrcoef_encoder_B', 'progress', 'time_logs', 't0', 'feature_data_dict', 'layout', 'top3_neurons_aligned', 'feature_out_l1_norm', 'pct_of_l1', 'neuron_indices', 'neuron_pearson', 'neuron_cossim', 'encB_indices', 'encB_pearson', 'encB_cossim', 'i', 'feat', 'logits', 'logit_vector', 'feat_acts', 'nonzero_feat_acts', 'frac_nonzero', 'top_logits', 'bottom_logits', 'top_token_ids', 'bottom_token_ids', 'feature_act_quantiles', 'sae_vis_data')
+            ()
+         names      ('time', 'isinstance', 'int', 'shape', 'len', 'feature_centric_layout', 'SaeVisLayoutConfig', 'type', 'feature_tables_cfg', 'defaultdict', 'dict', 'neuron_alignment_table', 'TopK', 'n_rows', 'abs', 'sum', 'np', 'absolute', 'values', 'utils', 'to_numpy', 'range', 'update', 'indices', 'tolist', 'correlated_neurons_table', 'BatchedCorrCoef', 'topk_pearson', 'correlated_features_table', 'correlated_b_features_table', 'enumerate', 'FeatureTablesData', 'feature_tables_data', 'einops', 'einsum', 'any', 'act_hist_cfg', 'logits_hist_cfg', 'logits_table_cfg', 'zip', 'LogitsHistogramData', 'from_data', 'n_bins', 'logits_histogram_data', 'numel', 'ActsHistogramData', 'acts_histogram_data', 'LogitsTableData', 'logits_table_data', 'seq_cfg', 'get_sequences_data', 'sequence_data', 'QuantileCalculator', 'rearrange', 'SaeVisData')
+         varnames   ('tokens', 'feature_indices', 'all_feat_acts', 'feature_resid_dir', 'all_resid_post', 'W_U', 'cfg', 'feature_out_dir', 'corrcoef_neurons', 'corrcoef_encoder', 'corrcoef_encoder_B', 'progress', 'time_logs', 't0', 'feature_data_dict', 'layout', 'feature_tables_data_kwargs', 'top3_neurons_aligned', 'feature_out_l1_norm', 'pct_of_l1', 'i', 'neuron_indices', 'neuron_pearson', 'neuron_cossim', 'enc_indices', 'enc_pearson', 'enc_cossim', 'encB_indices', 'encB_pearson', 'encB_cossim', 'feat', 'logits', 'logit_vector', 'feat_acts', 'nonzero_feat_acts', 'frac_nonzero', 'top_logits', 'bottom_logits', 'top_token_ids', 'bottom_token_ids', 'feature_act_quantiles', 'sae_vis_data')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
          name       'parse_feature_data'
-         firstlineno 115
+         firstlineno 125
          lnotab
-            0x024502010201020102fc0606260330023e013eff100304013e013eff10
-            0418030e012c0122ff10061603380152015c032c0122ff10024804200104
-            012c0122ff1002480328010c013c013c0132010e010e010e010e010e010e
-            f72a0c320126062c0158024c030e01160102011601020102fc28080e0114
+            0x024902010201020102fc0606260330023e013eff100304013e013eff10
+            0418030e012c0122ff1006160328031a01380152015c013c0124013c013c
+            0132fd140718012c0122ff1002180118ff1a033c0124010e010e010efd14
+            0718012c0122ff1002180118ff1a033c0124010e010e010efd1408180106
+            0102ff10022c0122ff1002180118ff1a033c0124010e010e010efd140728
+            013c02320126062c0158024c030e01160102011601020102fc28080e0114
             011801520116010201160102010afc28070e0238013802640164030c0102
             010201020102fc2c07320126050e0128030c01020112010e0102010e0102
             010cf9280a04013802320126045001320126042201
       'model'
       code
          argcount  : 7
-         nlocals   : 23
-         stacksize : 13
+         nlocals   : 24
+         stacksize : 14
          flags     : 3
          code
             0x970064016401640164029c037d077401000000000000000000006a0000
             00000000000000a6000000ab0000000000000000007d0874030000000000
             00000000007c04740400000000000000000000a6020000ab020000000000
             00000072037c0467017d047407000000000000000000006a040000000000
             0000007c04740a00000000000000000000ac03a6020000ab020000000000
             0000007d097c056a06000000000000000080037c0366016e197c03a00700
             000000000000000000000000000000000000007c056a0600000000000000
             00a6010000ab0100000000000000007d0a640584007c0a4400a6000000ab
             0000000000000000007d0a67007d0b67007d0c7411000000000000000000
-            00a6000000ab0000000000000000007d0d7c01810e741100000000000000
-            000000a6000000ab0000000000000000006e0164047d0e7c006a09000000
-            00000000007c04190000000000000000007d0f7415000000000000000000
-            007c0f7c02a6020000ab0200000000000000007d10740100000000000000
-            0000006a000000000000000000a6000000ab0000000000000000007c087a
-            0a00007c0764063c0000007c0a44005de57d117401000000000000000000
-            006a000000000000000000a6000000ab0000000000000000007d087c02a0
-            0b00000000000000000000000000000000000000007c116407ac08a60200
-            00ab0200000000000000005c0200007d127d137c07640978027802190000
-            000000000000007401000000000000000000006a000000000000000000a6
-            000000ab0000000000000000007c087a0a00007a0d0000630363023c0000
-            007401000000000000000000006a000000000000000000a6000000ab0000
-            000000000000007d087419000000000000000000007c137c097c007c017c
-            0d7c0ea6060000ab0600000000000000007d147c07640a78027802190000
-            000000000000007401000000000000000000006a000000000000000000a6
-            000000ab0000000000000000007c087a0a00007a0d0000630363023c0000
-            007c0ca00d00000000000000000000000000000000000000007c14a60100
-            00ab01000000000000000001007c0ba00d00000000000000000000000000
-            000000000000007c12a6010000ab01000000000000000001007c06811b7c
-            06640b19000000000000000000a00e000000000000000000000000000000
-            0000000000640ca6010000ab01000000000000000001008ce67407000000
-            000000000000006a0f00000000000000007c0c640bac0da6020000ab0200
-            000000000000007d0c7407000000000000000000006a0f00000000000000
-            007c0b640bac0da6020000ab0200000000000000007d0b74210000000000
-            00000000007c037c047c0c7c107c0b7c026a1100000000000000007c057c
-            0f7c0d7c0e7c06ac0ea60b0000ab0b00000000000000005c0200007d157d
-            167425000000000000000000007c07a01300000000000000000000000000
-            00000000000000a6000000ab000000000000000000a6010000ab01000000
-            00000000007425000000000000000000007c16a013000000000000000000
+            00a6000000ab0000000000000000007d0d741100000000000000000000a6
+            000000ab0000000000000000007d0e7c01810e7411000000000000000000
+            00a6000000ab0000000000000000006e0164047d0f7c006a090000000000
+            0000007c04190000000000000000007d107415000000000000000000007c
+            107c02a6020000ab0200000000000000007d117401000000000000000000
+            006a000000000000000000a6000000ab0000000000000000007c087a0a00
+            007c0764063c0000007c0a44005de77d127401000000000000000000006a
+            000000000000000000a6000000ab0000000000000000007d087c02a00b00
+            000000000000000000000000000000000000007c126407ac08a6020000ab
+            0200000000000000005c0200007d137d147c076409780278021900000000
+            00000000007401000000000000000000006a000000000000000000a60000
+            00ab0000000000000000007c087a0a00007a0d0000630363023c00000074
+            01000000000000000000006a000000000000000000a6000000ab00000000
+            00000000007d087419000000000000000000007c147c097c007c017c0d7c
+            0e7c0fac0aa6070000ab0700000000000000007d157c07640b7802780219
+            0000000000000000007401000000000000000000006a0000000000000000
+            00a6000000ab0000000000000000007c087a0a00007a0d0000630363023c
+            0000007c0ca00d00000000000000000000000000000000000000007c15a6
+            010000ab01000000000000000001007c0ba00d0000000000000000000000
+            0000000000000000007c13a6010000ab01000000000000000001007c0681
+            1b7c06640c19000000000000000000a00e00000000000000000000000000
+            00000000000000640da6010000ab01000000000000000001008ce8740700
+            0000000000000000006a0f00000000000000007c0c640cac0ea6020000ab
+            0200000000000000007d0c7407000000000000000000006a0f0000000000
+            0000007c0b640cac0ea6020000ab0200000000000000007d0b7421000000
+            000000000000007c037c047c0c7c117c0b7c026a1100000000000000007c
+            057c107c0d7c0e7c0f7c06ac0fa60c0000ab0c00000000000000005c0200
+            007d167d177425000000000000000000007c07a013000000000000000000
             0000000000000000000000a6000000ab000000000000000000a6010000ab
-            0100000000000000007a010000742500000000000000000000a6000000ab
-            0000000000000000006b0200000000734f4a00640f742500000000000000
-            0000007c07a0130000000000000000000000000000000000000000a60000
-            00ab000000000000000000a6010000ab0100000000000000007425000000
-            000000000000007c16a01300000000000000000000000000000000000000
-            00a6000000ab000000000000000000a6010000ab0100000000000000007a
-            0100009b0064109d03a6000000ab00000000000000000082017c07a00e00
-            000000000000000000000000000000000000007c16a6010000ab01000000
-            000000000001007c157c0766025300
-         335           0 RESUME                   0
+            0100000000000000007425000000000000000000007c17a0130000000000
+            000000000000000000000000000000a6000000ab000000000000000000a6
+            010000ab0100000000000000007a010000742500000000000000000000a6
+            000000ab0000000000000000006b0200000000734f4a0064107425000000
+            000000000000007c07a01300000000000000000000000000000000000000
+            00a6000000ab000000000000000000a6010000ab01000000000000000074
+            25000000000000000000007c17a013000000000000000000000000000000
+            0000000000a6000000ab000000000000000000a6010000ab010000000000
+            0000007a0100009b0064119d03a6000000ab00000000000000000082017c
+            07a00e00000000000000000000000000000000000000007c17a6010000ab
+            01000000000000000001007c167c0766025300
+         381           0 RESUME                   0
          
-         389           2 LOAD_CONST               1 (0.0)
+         435           2 LOAD_CONST               1 (0.0)
          
-         390           4 LOAD_CONST               1 (0.0)
+         436           4 LOAD_CONST               1 (0.0)
          
-         391           6 LOAD_CONST               1 (0.0)
+         437           6 LOAD_CONST               1 (0.0)
          
-         388           8 LOAD_CONST               2 (('(1) Initialization', '(2) Forward passes to gather model activations', '(3) Computing feature acts from model acts'))
+         434           8 LOAD_CONST               2 (('(1) Initialization', '(2) Forward passes to gather model activations', '(3) Computing feature acts from model acts'))
                       10 BUILD_CONST_KEY_MAP      3
                       12 STORE_FAST               7 (time_logs)
          
-         394          14 LOAD_GLOBAL              1 (NULL + time)
+         440          14 LOAD_GLOBAL              1 (NULL + time)
                       26 LOAD_ATTR                0 (time)
                       36 PRECALL                  0
                       40 CALL                     0
                       50 STORE_FAST               8 (t0)
          
-         397          52 LOAD_GLOBAL              3 (NULL + isinstance)
+         443          52 LOAD_GLOBAL              3 (NULL + isinstance)
                       64 LOAD_FAST                4 (feature_indices)
                       66 LOAD_GLOBAL              4 (int)
                       78 PRECALL                  2
                       82 CALL                     2
                       92 POP_JUMP_FORWARD_IF_FALSE     3 (to 100)
                       94 LOAD_FAST                4 (feature_indices)
                       96 BUILD_LIST               1
                       98 STORE_FAST               4 (feature_indices)
          
-         398     >>  100 LOAD_GLOBAL              7 (NULL + torch)
+         444     >>  100 LOAD_GLOBAL              7 (NULL + torch)
                      112 LOAD_ATTR                4 (tensor)
                      122 LOAD_FAST                4 (feature_indices)
                      124 LOAD_GLOBAL             10 (device)
                      136 KW_NAMES                 3
                      138 PRECALL                  2
                      142 CALL                     2
                      152 STORE_FAST               9 (feature_idx_tensor)
          
-         401         154 LOAD_FAST                5 (cfg)
+         447         154 LOAD_FAST                5 (cfg)
                      156 LOAD_ATTR                6 (minibatch_size_tokens)
                      166 POP_JUMP_FORWARD_IF_NOT_NONE     3 (to 174)
                      168 LOAD_FAST                3 (tokens)
                      170 BUILD_TUPLE              1
                      172 JUMP_FORWARD            25 (to 224)
                  >>  174 LOAD_FAST                3 (tokens)
                      176 LOAD_METHOD              7 (split)
                      198 LOAD_FAST                5 (cfg)
                      200 LOAD_ATTR                6 (minibatch_size_tokens)
                      210 PRECALL                  1
                      214 CALL                     1
                  >>  224 STORE_FAST              10 (token_minibatches)
          
-         402         226 LOAD_CONST               5 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 402>)
+         448         226 LOAD_CONST               5 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 448>)
                      228 MAKE_FUNCTION            0
                      230 LOAD_FAST               10 (token_minibatches)
                      232 GET_ITER
                      234 PRECALL                  0
                      238 CALL                     0
                      248 STORE_FAST              10 (token_minibatches)
          
-         407         250 BUILD_LIST               0
+         453         250 BUILD_LIST               0
                      252 STORE_FAST              11 (all_resid_post)
          
-         408         254 BUILD_LIST               0
+         454         254 BUILD_LIST               0
                      256 STORE_FAST              12 (all_feat_acts)
          
-         411         258 LOAD_GLOBAL             17 (NULL + BatchedCorrCoef)
+         457         258 LOAD_GLOBAL             17 (NULL + BatchedCorrCoef)
                      270 PRECALL                  0
                      274 CALL                     0
                      284 STORE_FAST              13 (corrcoef_neurons)
          
-         412         286 LOAD_FAST                1 (encoder_B)
-                     288 POP_JUMP_FORWARD_IF_NONE    14 (to 318)
-                     290 LOAD_GLOBAL             17 (NULL + BatchedCorrCoef)
-                     302 PRECALL                  0
-                     306 CALL                     0
-                     316 JUMP_FORWARD             1 (to 320)
-                 >>  318 LOAD_CONST               4 (None)
-                 >>  320 STORE_FAST              14 (corrcoef_encoder_B)
-         
-         415         322 LOAD_FAST                0 (encoder)
-                     324 LOAD_ATTR                9 (W_dec)
-                     334 LOAD_FAST                4 (feature_indices)
-                     336 BINARY_SUBSCR
-                     346 STORE_FAST              15 (feature_out_dir)
-         
-         416         348 LOAD_GLOBAL             21 (NULL + to_resid_dir)
-                     360 LOAD_FAST               15 (feature_out_dir)
-                     362 LOAD_FAST                2 (model)
-                     364 PRECALL                  2
-                     368 CALL                     2
-                     378 STORE_FAST              16 (feature_resid_dir)
+         458         286 LOAD_GLOBAL             17 (NULL + BatchedCorrCoef)
+                     298 PRECALL                  0
+                     302 CALL                     0
+                     312 STORE_FAST              14 (corrcoef_encoder)
+         
+         459         314 LOAD_FAST                1 (encoder_B)
+                     316 POP_JUMP_FORWARD_IF_NONE    14 (to 346)
+                     318 LOAD_GLOBAL             17 (NULL + BatchedCorrCoef)
+                     330 PRECALL                  0
+                     334 CALL                     0
+                     344 JUMP_FORWARD             1 (to 348)
+                 >>  346 LOAD_CONST               4 (None)
+                 >>  348 STORE_FAST              15 (corrcoef_encoder_B)
+         
+         462         350 LOAD_FAST                0 (encoder)
+                     352 LOAD_ATTR                9 (W_dec)
+                     362 LOAD_FAST                4 (feature_indices)
+                     364 BINARY_SUBSCR
+                     374 STORE_FAST              16 (feature_out_dir)
+         
+         463         376 LOAD_GLOBAL             21 (NULL + to_resid_dir)
+                     388 LOAD_FAST               16 (feature_out_dir)
+                     390 LOAD_FAST                2 (model)
+                     392 PRECALL                  2
+                     396 CALL                     2
+                     406 STORE_FAST              17 (feature_resid_dir)
+         
+         465         408 LOAD_GLOBAL              1 (NULL + time)
+                     420 LOAD_ATTR                0 (time)
+                     430 PRECALL                  0
+                     434 CALL                     0
+                     444 LOAD_FAST                8 (t0)
+                     446 BINARY_OP               10 (-)
+                     450 LOAD_FAST                7 (time_logs)
+                     452 LOAD_CONST               6 ('(1) Initialization')
+                     454 STORE_SUBSCR
+         
+         469         458 LOAD_FAST               10 (token_minibatches)
+                     460 GET_ITER
+                 >>  462 FOR_ITER               231 (to 926)
+                     464 STORE_FAST              18 (minibatch)
+         
+         472         466 LOAD_GLOBAL              1 (NULL + time)
+                     478 LOAD_ATTR                0 (time)
+                     488 PRECALL                  0
+                     492 CALL                     0
+                     502 STORE_FAST               8 (t0)
+         
+         473         504 LOAD_FAST                2 (model)
+                     506 LOAD_METHOD             11 (forward)
+                     528 LOAD_FAST               18 (minibatch)
+                     530 LOAD_CONST               7 (False)
+                     532 KW_NAMES                 8
+                     534 PRECALL                  2
+                     538 CALL                     2
+                     548 UNPACK_SEQUENCE          2
+                     552 STORE_FAST              19 (residual)
+                     554 STORE_FAST              20 (model_acts)
+         
+         474         556 LOAD_FAST                7 (time_logs)
+                     558 LOAD_CONST               9 ('(2) Forward passes to gather model activations')
+                     560 COPY                     2
+                     562 COPY                     2
+                     564 BINARY_SUBSCR
+                     574 LOAD_GLOBAL              1 (NULL + time)
+                     586 LOAD_ATTR                0 (time)
+                     596 PRECALL                  0
+                     600 CALL                     0
+                     610 LOAD_FAST                8 (t0)
+                     612 BINARY_OP               10 (-)
+                     616 BINARY_OP               13 (+=)
+                     620 SWAP                     3
+                     622 SWAP                     2
+                     624 STORE_SUBSCR
+         
+         477         628 LOAD_GLOBAL              1 (NULL + time)
+                     640 LOAD_ATTR                0 (time)
+                     650 PRECALL                  0
+                     654 CALL                     0
+                     664 STORE_FAST               8 (t0)
+         
+         478         666 LOAD_GLOBAL             25 (NULL + compute_feat_acts)
+         
+         479         678 LOAD_FAST               20 (model_acts)
+         
+         480         680 LOAD_FAST                9 (feature_idx_tensor)
+         
+         481         682 LOAD_FAST                0 (encoder)
+         
+         482         684 LOAD_FAST                1 (encoder_B)
+         
+         483         686 LOAD_FAST               13 (corrcoef_neurons)
+         
+         484         688 LOAD_FAST               14 (corrcoef_encoder)
+         
+         485         690 LOAD_FAST               15 (corrcoef_encoder_B)
+         
+         478         692 KW_NAMES                10
+                     694 PRECALL                  7
+                     698 CALL                     7
+                     708 STORE_FAST              21 (feat_acts)
+         
+         487         710 LOAD_FAST                7 (time_logs)
+                     712 LOAD_CONST              11 ('(3) Computing feature acts from model acts')
+                     714 COPY                     2
+                     716 COPY                     2
+                     718 BINARY_SUBSCR
+                     728 LOAD_GLOBAL              1 (NULL + time)
+                     740 LOAD_ATTR                0 (time)
+                     750 PRECALL                  0
+                     754 CALL                     0
+                     764 LOAD_FAST                8 (t0)
+                     766 BINARY_OP               10 (-)
+                     770 BINARY_OP               13 (+=)
+                     774 SWAP                     3
+                     776 SWAP                     2
+                     778 STORE_SUBSCR
+         
+         490         782 LOAD_FAST               12 (all_feat_acts)
+                     784 LOAD_METHOD             13 (append)
+                     806 LOAD_FAST               21 (feat_acts)
+                     808 PRECALL                  1
+                     812 CALL                     1
+                     822 POP_TOP
+         
+         491         824 LOAD_FAST               11 (all_resid_post)
+                     826 LOAD_METHOD             13 (append)
+                     848 LOAD_FAST               19 (residual)
+                     850 PRECALL                  1
+                     854 CALL                     1
+                     864 POP_TOP
+         
+         494         866 LOAD_FAST                6 (progress)
+                     868 POP_JUMP_FORWARD_IF_NONE    27 (to 924)
+         
+         495         870 LOAD_FAST                6 (progress)
+                     872 LOAD_CONST              12 (0)
+                     874 BINARY_SUBSCR
+                     884 LOAD_METHOD             14 (update)
+                     906 LOAD_CONST              13 (1)
+                     908 PRECALL                  1
+                     912 CALL                     1
+                     922 POP_TOP
+                 >>  924 JUMP_BACKWARD          232 (to 462)
+         
+         497     >>  926 LOAD_GLOBAL              7 (NULL + torch)
+                     938 LOAD_ATTR               15 (cat)
+                     948 LOAD_FAST               12 (all_feat_acts)
+                     950 LOAD_CONST              12 (0)
+                     952 KW_NAMES                14
+                     954 PRECALL                  2
+                     958 CALL                     2
+                     968 STORE_FAST              12 (all_feat_acts)
+         
+         498         970 LOAD_GLOBAL              7 (NULL + torch)
+                     982 LOAD_ATTR               15 (cat)
+                     992 LOAD_FAST               11 (all_resid_post)
+                     994 LOAD_CONST              12 (0)
+                     996 KW_NAMES                14
+                     998 PRECALL                  2
+                    1002 CALL                     2
+                    1012 STORE_FAST              11 (all_resid_post)
          
-         418         380 LOAD_GLOBAL              1 (NULL + time)
-                     392 LOAD_ATTR                0 (time)
-                     402 PRECALL                  0
-                     406 CALL                     0
-                     416 LOAD_FAST                8 (t0)
-                     418 BINARY_OP               10 (-)
-                     422 LOAD_FAST                7 (time_logs)
-                     424 LOAD_CONST               6 ('(1) Initialization')
-                     426 STORE_SUBSCR
-         
-         422         430 LOAD_FAST               10 (token_minibatches)
-                     432 GET_ITER
-                 >>  434 FOR_ITER               229 (to 894)
-                     436 STORE_FAST              17 (minibatch)
-         
-         425         438 LOAD_GLOBAL              1 (NULL + time)
-                     450 LOAD_ATTR                0 (time)
-                     460 PRECALL                  0
-                     464 CALL                     0
-                     474 STORE_FAST               8 (t0)
-         
-         426         476 LOAD_FAST                2 (model)
-                     478 LOAD_METHOD             11 (forward)
-                     500 LOAD_FAST               17 (minibatch)
-                     502 LOAD_CONST               7 (False)
-                     504 KW_NAMES                 8
-                     506 PRECALL                  2
-                     510 CALL                     2
-                     520 UNPACK_SEQUENCE          2
-                     524 STORE_FAST              18 (residual)
-                     526 STORE_FAST              19 (model_acts)
-         
-         427         528 LOAD_FAST                7 (time_logs)
-                     530 LOAD_CONST               9 ('(2) Forward passes to gather model activations')
-                     532 COPY                     2
-                     534 COPY                     2
-                     536 BINARY_SUBSCR
-                     546 LOAD_GLOBAL              1 (NULL + time)
-                     558 LOAD_ATTR                0 (time)
-                     568 PRECALL                  0
-                     572 CALL                     0
-                     582 LOAD_FAST                8 (t0)
-                     584 BINARY_OP               10 (-)
-                     588 BINARY_OP               13 (+=)
-                     592 SWAP                     3
-                     594 SWAP                     2
-                     596 STORE_SUBSCR
-         
-         430         600 LOAD_GLOBAL              1 (NULL + time)
-                     612 LOAD_ATTR                0 (time)
-                     622 PRECALL                  0
-                     626 CALL                     0
-                     636 STORE_FAST               8 (t0)
-         
-         431         638 LOAD_GLOBAL             25 (NULL + compute_feat_acts)
-                     650 LOAD_FAST               19 (model_acts)
-                     652 LOAD_FAST                9 (feature_idx_tensor)
-                     654 LOAD_FAST                0 (encoder)
-                     656 LOAD_FAST                1 (encoder_B)
-                     658 LOAD_FAST               13 (corrcoef_neurons)
-                     660 LOAD_FAST               14 (corrcoef_encoder_B)
-                     662 PRECALL                  6
-                     666 CALL                     6
-                     676 STORE_FAST              20 (feat_acts)
-         
-         432         678 LOAD_FAST                7 (time_logs)
-                     680 LOAD_CONST              10 ('(3) Computing feature acts from model acts')
-                     682 COPY                     2
-                     684 COPY                     2
-                     686 BINARY_SUBSCR
-                     696 LOAD_GLOBAL              1 (NULL + time)
-                     708 LOAD_ATTR                0 (time)
-                     718 PRECALL                  0
-                     722 CALL                     0
-                     732 LOAD_FAST                8 (t0)
-                     734 BINARY_OP               10 (-)
-                     738 BINARY_OP               13 (+=)
-                     742 SWAP                     3
-                     744 SWAP                     2
-                     746 STORE_SUBSCR
-         
-         435         750 LOAD_FAST               12 (all_feat_acts)
-                     752 LOAD_METHOD             13 (append)
-                     774 LOAD_FAST               20 (feat_acts)
-                     776 PRECALL                  1
-                     780 CALL                     1
-                     790 POP_TOP
-         
-         436         792 LOAD_FAST               11 (all_resid_post)
-                     794 LOAD_METHOD             13 (append)
-                     816 LOAD_FAST               18 (residual)
-                     818 PRECALL                  1
-                     822 CALL                     1
-                     832 POP_TOP
-         
-         439         834 LOAD_FAST                6 (progress)
-                     836 POP_JUMP_FORWARD_IF_NONE    27 (to 892)
-         
-         440         838 LOAD_FAST                6 (progress)
-                     840 LOAD_CONST              11 (0)
-                     842 BINARY_SUBSCR
-                     852 LOAD_METHOD             14 (update)
-                     874 LOAD_CONST              12 (1)
-                     876 PRECALL                  1
-                     880 CALL                     1
-                     890 POP_TOP
-                 >>  892 JUMP_BACKWARD          230 (to 434)
+         501        1014 LOAD_GLOBAL             33 (NULL + parse_feature_data)
+         
+         502        1026 LOAD_FAST                3 (tokens)
+         
+         503        1028 LOAD_FAST                4 (feature_indices)
          
-         442     >>  894 LOAD_GLOBAL              7 (NULL + torch)
-                     906 LOAD_ATTR               15 (cat)
-                     916 LOAD_FAST               12 (all_feat_acts)
-                     918 LOAD_CONST              11 (0)
-                     920 KW_NAMES                13
-                     922 PRECALL                  2
-                     926 CALL                     2
-                     936 STORE_FAST              12 (all_feat_acts)
-         
-         443         938 LOAD_GLOBAL              7 (NULL + torch)
-                     950 LOAD_ATTR               15 (cat)
-                     960 LOAD_FAST               11 (all_resid_post)
-                     962 LOAD_CONST              11 (0)
-                     964 KW_NAMES                13
-                     966 PRECALL                  2
-                     970 CALL                     2
-                     980 STORE_FAST              11 (all_resid_post)
-         
-         446         982 LOAD_GLOBAL             33 (NULL + parse_feature_data)
-         
-         447         994 LOAD_FAST                3 (tokens)
-         
-         448         996 LOAD_FAST                4 (feature_indices)
-         
-         449         998 LOAD_FAST               12 (all_feat_acts)
-         
-         450        1000 LOAD_FAST               16 (feature_resid_dir)
-         
-         451        1002 LOAD_FAST               11 (all_resid_post)
-         
-         452        1004 LOAD_FAST                2 (model)
-                    1006 LOAD_ATTR               17 (W_U)
-         
-         453        1016 LOAD_FAST                5 (cfg)
-         
-         454        1018 LOAD_FAST               15 (feature_out_dir)
-         
-         455        1020 LOAD_FAST               13 (corrcoef_neurons)
-         
-         456        1022 LOAD_FAST               14 (corrcoef_encoder_B)
-         
-         457        1024 LOAD_FAST                6 (progress)
-         
-         446        1026 KW_NAMES                14
-                    1028 PRECALL                 11
-                    1032 CALL                    11
-                    1042 UNPACK_SEQUENCE          2
-                    1046 STORE_FAST              21 (sae_vis_data)
-                    1048 STORE_FAST              22 (_time_logs)
-         
-         460        1050 LOAD_GLOBAL             37 (NULL + set)
-                    1062 LOAD_FAST                7 (time_logs)
-                    1064 LOAD_METHOD             19 (keys)
-                    1086 PRECALL                  0
-                    1090 CALL                     0
-                    1100 PRECALL                  1
-                    1104 CALL                     1
-                    1114 LOAD_GLOBAL             37 (NULL + set)
-                    1126 LOAD_FAST               22 (_time_logs)
-                    1128 LOAD_METHOD             19 (keys)
-                    1150 PRECALL                  0
-                    1154 CALL                     0
-                    1164 PRECALL                  1
-                    1168 CALL                     1
-                    1178 BINARY_OP                1 (&)
-                    1182 LOAD_GLOBAL             37 (NULL + set)
-                    1194 PRECALL                  0
-                    1198 CALL                     0
-                    1208 COMPARE_OP               2 (==)
-                    1214 POP_JUMP_FORWARD_IF_TRUE    79 (to 1374)
-                    1216 LOAD_ASSERTION_ERROR
-         
-         461        1218 LOAD_CONST              15 ('Invalid keys: ')
-                    1220 LOAD_GLOBAL             37 (NULL + set)
-                    1232 LOAD_FAST                7 (time_logs)
-                    1234 LOAD_METHOD             19 (keys)
-                    1256 PRECALL                  0
-                    1260 CALL                     0
-                    1270 PRECALL                  1
-                    1274 CALL                     1
-                    1284 LOAD_GLOBAL             37 (NULL + set)
-                    1296 LOAD_FAST               22 (_time_logs)
-                    1298 LOAD_METHOD             19 (keys)
-                    1320 PRECALL                  0
-                    1324 CALL                     0
-                    1334 PRECALL                  1
-                    1338 CALL                     1
-                    1348 BINARY_OP                1 (&)
-                    1352 FORMAT_VALUE             0
-                    1354 LOAD_CONST              16 (' should have zero overlap')
-                    1356 BUILD_STRING             3
-         
-         460        1358 PRECALL                  0
-                    1362 CALL                     0
-                    1372 RAISE_VARARGS            1
-         
-         463     >> 1374 LOAD_FAST                7 (time_logs)
-                    1376 LOAD_METHOD             14 (update)
-                    1398 LOAD_FAST               22 (_time_logs)
-                    1400 PRECALL                  1
-                    1404 CALL                     1
-                    1414 POP_TOP
-         
-         465        1416 LOAD_FAST               21 (sae_vis_data)
-                    1418 LOAD_FAST                7 (time_logs)
-                    1420 BUILD_TUPLE              2
-                    1422 RETURN_VALUE
+         504        1030 LOAD_FAST               12 (all_feat_acts)
+         
+         505        1032 LOAD_FAST               17 (feature_resid_dir)
+         
+         506        1034 LOAD_FAST               11 (all_resid_post)
+         
+         507        1036 LOAD_FAST                2 (model)
+                    1038 LOAD_ATTR               17 (W_U)
+         
+         508        1048 LOAD_FAST                5 (cfg)
+         
+         509        1050 LOAD_FAST               16 (feature_out_dir)
+         
+         510        1052 LOAD_FAST               13 (corrcoef_neurons)
+         
+         511        1054 LOAD_FAST               14 (corrcoef_encoder)
+         
+         512        1056 LOAD_FAST               15 (corrcoef_encoder_B)
+         
+         513        1058 LOAD_FAST                6 (progress)
+         
+         501        1060 KW_NAMES                15
+                    1062 PRECALL                 12
+                    1066 CALL                    12
+                    1076 UNPACK_SEQUENCE          2
+                    1080 STORE_FAST              22 (sae_vis_data)
+                    1082 STORE_FAST              23 (_time_logs)
+         
+         516        1084 LOAD_GLOBAL             37 (NULL + set)
+                    1096 LOAD_FAST                7 (time_logs)
+                    1098 LOAD_METHOD             19 (keys)
+                    1120 PRECALL                  0
+                    1124 CALL                     0
+                    1134 PRECALL                  1
+                    1138 CALL                     1
+                    1148 LOAD_GLOBAL             37 (NULL + set)
+                    1160 LOAD_FAST               23 (_time_logs)
+                    1162 LOAD_METHOD             19 (keys)
+                    1184 PRECALL                  0
+                    1188 CALL                     0
+                    1198 PRECALL                  1
+                    1202 CALL                     1
+                    1212 BINARY_OP                1 (&)
+                    1216 LOAD_GLOBAL             37 (NULL + set)
+                    1228 PRECALL                  0
+                    1232 CALL                     0
+                    1242 COMPARE_OP               2 (==)
+                    1248 POP_JUMP_FORWARD_IF_TRUE    79 (to 1408)
+                    1250 LOAD_ASSERTION_ERROR
+         
+         517        1252 LOAD_CONST              16 ('Invalid keys: ')
+                    1254 LOAD_GLOBAL             37 (NULL + set)
+                    1266 LOAD_FAST                7 (time_logs)
+                    1268 LOAD_METHOD             19 (keys)
+                    1290 PRECALL                  0
+                    1294 CALL                     0
+                    1304 PRECALL                  1
+                    1308 CALL                     1
+                    1318 LOAD_GLOBAL             37 (NULL + set)
+                    1330 LOAD_FAST               23 (_time_logs)
+                    1332 LOAD_METHOD             19 (keys)
+                    1354 PRECALL                  0
+                    1358 CALL                     0
+                    1368 PRECALL                  1
+                    1372 CALL                     1
+                    1382 BINARY_OP                1 (&)
+                    1386 FORMAT_VALUE             0
+                    1388 LOAD_CONST              17 (' should have zero overlap')
+                    1390 BUILD_STRING             3
+         
+         516        1392 PRECALL                  0
+                    1396 CALL                     0
+                    1406 RAISE_VARARGS            1
+         
+         519     >> 1408 LOAD_FAST                7 (time_logs)
+                    1410 LOAD_METHOD             14 (update)
+                    1432 LOAD_FAST               23 (_time_logs)
+                    1434 PRECALL                  1
+                    1438 CALL                     1
+                    1448 POP_TOP
+         
+         521        1450 LOAD_FAST               22 (sae_vis_data)
+                    1452 LOAD_FAST                7 (time_logs)
+                    1454 BUILD_TUPLE              2
+                    1456 RETURN_VALUE
          consts
             '\n    Gets data that will be used to create the sequences in the feature-centric HTML visualisation.\n    \n    Note - this function isn\'t called directly by the user, it actually gets called by the `get_feature_data` function\n    which does exactly the same thing except it also batches this computation by features (in accordance with the\n    arguments `features` and `minibatch_size_features` from the SaeVisConfig object).\n\n    Args:\n        encoder: AutoEncoder\n            The encoder whose features we\'ll be analyzing.\n\n        encoder_B: AutoEncoder\n            The encoder we\'ll be using as a reference (i.e. finding the B-features with the highest correlation). This\n            is only necessary if we\'re generating the left-hand tables (i.e. cfg.include_left_tables=True).\n\n        model: TransformerLensWrapper\n            The model we\'ll be using to get the feature activations. It\'s a wrapping of the base TransformerLens model.\n\n        tokens: Int[Tensor, "batch seq"]\n            The tokens we\'ll be using to get the feature activations.\n\n        feature_indices: Union[int, list[int]]\n            The features we\'re actually computing. These might just be a subset of the model\'s full features.\n\n        cfg: SaeVisConfig\n            Feature visualization parameters, containing a bunch of other stuff. See the SaeVisConfig docstring for\n            more information.\n\n        progress: Optional[list[tqdm]]\n            An optional list containing progress bars for the forward passes and the sequence data. This is used to\n            update the progress bars as the computation runs.\n\n    Returns:\n        sae_vis_data: SaeVisData\n            Containing data for creating each feature visualization, as well as data for rank-ordering the feature\n            visualizations when it comes time to make the prompt-centric view (the `feature_act_quantiles` attribute).\n\n        time_log: dict[str, float]\n            A dictionary containing the time taken for each step of the computation. This is optionally printed at the\n            end of the `get_feature_data` function, if `cfg.verbose` is set to True.\n    '
             0.0
             ('(1) Initialization', '(2) Forward passes to gather model activations', '(3) Computing feature acts from model acts')
             ('device',)
             None
             code
@@ -2251,15 +2493,15 @@
                nlocals   : 2
                stacksize : 5
                flags     : 19
                code
                   0x970067007c005d1c7d017c01a000000000000000000000000000000000
                   0000000000740200000000000000000000a6010000ab0100000000000000
                   0091028c1d5300
-               402           0 RESUME                   0
+               448           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                28 (to 64)
                              8 STORE_FAST               1 (tok)
                             10 LOAD_FAST                1 (tok)
                             12 LOAD_METHOD              0 (to)
                             34 LOAD_GLOBAL              2 (device)
@@ -2269,41 +2511,42 @@
                             62 JUMP_BACKWARD           29 (to 6)
                        >>   64 RETURN_VALUE
                consts
                names      ('to', 'device')
                varnames   ('.0', 'tok')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 402
+               firstlineno 448
                lnotab 0x
             '(1) Initialization'
             False
             ('return_logits',)
             '(2) Forward passes to gather model activations'
+            ('model_acts', 'feature_idx', 'encoder', 'encoder_B', 'corrcoef_neurons', 'corrcoef_encoder', 'corrcoef_encoder_B')
             '(3) Computing feature acts from model acts'
             0
             1
             ('dim',)
-            ('tokens', 'feature_indices', 'all_feat_acts', 'feature_resid_dir', 'all_resid_post', 'W_U', 'cfg', 'feature_out_dir', 'corrcoef_neurons', 'corrcoef_encoder_B', 'progress')
+            ('tokens', 'feature_indices', 'all_feat_acts', 'feature_resid_dir', 'all_resid_post', 'W_U', 'cfg', 'feature_out_dir', 'corrcoef_neurons', 'corrcoef_encoder', 'corrcoef_encoder_B', 'progress')
             'Invalid keys: '
             ' should have zero overlap'
          names      ('time', 'isinstance', 'int', 'torch', 'tensor', 'device', 'minibatch_size_tokens', 'split', 'BatchedCorrCoef', 'W_dec', 'to_resid_dir', 'forward', 'compute_feat_acts', 'append', 'update', 'cat', 'parse_feature_data', 'W_U', 'set', 'keys')
-         varnames   ('encoder', 'encoder_B', 'model', 'tokens', 'feature_indices', 'cfg', 'progress', 'time_logs', 't0', 'feature_idx_tensor', 'token_minibatches', 'all_resid_post', 'all_feat_acts', 'corrcoef_neurons', 'corrcoef_encoder_B', 'feature_out_dir', 'feature_resid_dir', 'minibatch', 'residual', 'model_acts', 'feat_acts', 'sae_vis_data', '_time_logs')
+         varnames   ('encoder', 'encoder_B', 'model', 'tokens', 'feature_indices', 'cfg', 'progress', 'time_logs', 't0', 'feature_idx_tensor', 'token_minibatches', 'all_resid_post', 'all_feat_acts', 'corrcoef_neurons', 'corrcoef_encoder', 'corrcoef_encoder_B', 'feature_out_dir', 'feature_resid_dir', 'minibatch', 'residual', 'model_acts', 'feat_acts', 'sae_vis_data', '_time_logs')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
          name       '_get_feature_data'
-         firstlineno 335
+         firstlineno 381
          lnotab
-            0x02360201020102fd060626033001360348011805040104031c0124031a
-            012002320408032601340148032601280148032a012a03040138022c012c
-            030c01020102010201020102010c01020102010201020102f5180ea8018c
-            ff10032a02
+            0x02360201020102fd060626033001360348011805040104031c011c0124
+            031a0120023204080326013401480326010c010201020102010201020102
+            0102f9120948032a012a03040138022c012c030c01020102010201020102
+            010c010201020102010201020102f4180fa8018cff10032a02
       code
          argcount  : 5
          nlocals   : 23
          stacksize : 10
          flags     : 3
          code
             0x97007c036a000000000000000000813d7403000000000000000000006a
@@ -2353,102 +2596,102 @@
             007d13744900000000000000000000640a640b640ca6030000ab03000000
             00000000007d147c06a01f00000000000000000000000000000000000000
             00a6000000ab00000000000000000044005d255c0200007d157d167c14a0
             2500000000000000000000000000000000000000007c157c16640d9b0464
             0e9d027c167c137a0b0000640f9b04a6030000ab03000000000000000001
             008c26744d000000000000000000007c14a6010000ab0100000000000000
             0001007c055300
-         470           0 RESUME                   0
+         526           0 RESUME                   0
          
-         489           2 LOAD_FAST                3 (cfg)
+         545           2 LOAD_FAST                3 (cfg)
                        4 LOAD_ATTR                0 (seed)
                       14 POP_JUMP_FORWARD_IF_NONE    61 (to 138)
          
-         490          16 LOAD_GLOBAL              3 (NULL + torch)
+         546          16 LOAD_GLOBAL              3 (NULL + torch)
                       28 LOAD_ATTR                2 (manual_seed)
                       38 LOAD_FAST                3 (cfg)
                       40 LOAD_ATTR                0 (seed)
                       50 PRECALL                  1
                       54 CALL                     1
                       64 POP_TOP
          
-         491          66 LOAD_GLOBAL              6 (np)
+         547          66 LOAD_GLOBAL              6 (np)
                       78 LOAD_ATTR                4 (random)
                       88 LOAD_METHOD              0 (seed)
                      110 LOAD_FAST                3 (cfg)
                      112 LOAD_ATTR                0 (seed)
                      122 PRECALL                  1
                      126 CALL                     1
                      136 POP_TOP
          
-         494     >>  138 LOAD_GLOBAL             11 (NULL + SaeVisData)
+         550     >>  138 LOAD_GLOBAL             11 (NULL + SaeVisData)
                      150 PRECALL                  0
                      154 CALL                     0
                      164 STORE_FAST               5 (sae_vis_data)
          
-         495         166 LOAD_GLOBAL             13 (NULL + defaultdict)
+         551         166 LOAD_GLOBAL             13 (NULL + defaultdict)
                      178 LOAD_GLOBAL             14 (float)
                      190 PRECALL                  1
                      194 CALL                     1
                      204 STORE_FAST               6 (time_logs)
          
-         498         206 LOAD_FAST                3 (cfg)
+         554         206 LOAD_FAST                3 (cfg)
                      208 LOAD_ATTR                8 (batch_size)
                      218 POP_JUMP_FORWARD_IF_NOT_NONE     3 (to 226)
          
-         499         220 LOAD_FAST                2 (tokens)
+         555         220 LOAD_FAST                2 (tokens)
                      222 STORE_FAST               2 (tokens)
                      224 JUMP_FORWARD            15 (to 256)
          
-         501     >>  226 LOAD_FAST                2 (tokens)
+         557     >>  226 LOAD_FAST                2 (tokens)
                      228 LOAD_CONST               1 (None)
                      230 LOAD_FAST                3 (cfg)
                      232 LOAD_ATTR                8 (batch_size)
                      242 BUILD_SLICE              2
                      244 BINARY_SUBSCR
                      254 STORE_FAST               2 (tokens)
          
-         504     >>  256 LOAD_FAST                3 (cfg)
+         560     >>  256 LOAD_FAST                3 (cfg)
                      258 LOAD_ATTR                9 (features)
                      268 POP_JUMP_FORWARD_IF_NOT_NONE    39 (to 348)
          
-         505         270 LOAD_GLOBAL             21 (NULL + list)
+         561         270 LOAD_GLOBAL             21 (NULL + list)
                      282 LOAD_GLOBAL             23 (NULL + range)
                      294 LOAD_FAST                0 (encoder)
                      296 LOAD_ATTR               12 (cfg)
                      306 LOAD_ATTR               13 (d_hidden)
                      316 PRECALL                  1
                      320 CALL                     1
                      330 PRECALL                  1
                      334 CALL                     1
                      344 STORE_FAST               7 (features_list)
                      346 JUMP_FORWARD            55 (to 458)
          
-         506     >>  348 LOAD_GLOBAL             29 (NULL + isinstance)
+         562     >>  348 LOAD_GLOBAL             29 (NULL + isinstance)
                      360 LOAD_FAST                3 (cfg)
                      362 LOAD_ATTR                9 (features)
                      372 LOAD_GLOBAL             30 (int)
                      384 PRECALL                  2
                      388 CALL                     2
                      398 POP_JUMP_FORWARD_IF_FALSE     9 (to 418)
          
-         507         400 LOAD_FAST                3 (cfg)
+         563         400 LOAD_FAST                3 (cfg)
                      402 LOAD_ATTR                9 (features)
                      412 BUILD_LIST               1
                      414 STORE_FAST               7 (features_list)
                      416 JUMP_FORWARD            20 (to 458)
          
-         509     >>  418 LOAD_GLOBAL             21 (NULL + list)
+         565     >>  418 LOAD_GLOBAL             21 (NULL + list)
                      430 LOAD_FAST                3 (cfg)
                      432 LOAD_ATTR                9 (features)
                      442 PRECALL                  1
                      446 CALL                     1
                      456 STORE_FAST               7 (features_list)
          
-         512     >>  458 LOAD_CONST               2 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 512>)
+         568     >>  458 LOAD_CONST               2 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 568>)
                      460 MAKE_FUNCTION            0
                      462 LOAD_GLOBAL              3 (NULL + torch)
                      474 LOAD_ATTR               16 (tensor)
                      484 LOAD_FAST                7 (features_list)
                      486 PRECALL                  1
                      490 CALL                     1
                      500 LOAD_METHOD             17 (split)
@@ -2457,15 +2700,15 @@
                      534 PRECALL                  1
                      538 CALL                     1
                      548 GET_ITER
                      550 PRECALL                  0
                      554 CALL                     0
                      564 STORE_FAST               8 (feature_batches)
          
-         514         566 LOAD_FAST                3 (cfg)
+         570         566 LOAD_FAST                3 (cfg)
                      568 LOAD_ATTR               19 (minibatch_size_tokens)
                      578 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 584)
                      580 LOAD_CONST               3 (1)
                      582 JUMP_FORWARD            40 (to 664)
                  >>  584 LOAD_GLOBAL             41 (NULL + math)
                      596 LOAD_ATTR               21 (ceil)
                      606 LOAD_GLOBAL             45 (NULL + len)
@@ -2475,186 +2718,186 @@
                      634 LOAD_FAST                3 (cfg)
                      636 LOAD_ATTR               19 (minibatch_size_tokens)
                      646 BINARY_OP               11 (/)
                      650 PRECALL                  1
                      654 CALL                     1
                  >>  664 STORE_FAST               9 (n_token_batches)
          
-         516         666 LOAD_FAST                9 (n_token_batches)
+         572         666 LOAD_FAST                9 (n_token_batches)
                      668 LOAD_GLOBAL             45 (NULL + len)
                      680 LOAD_FAST                8 (feature_batches)
                      682 PRECALL                  1
                      686 CALL                     1
                      696 BINARY_OP                5 (*)
                      700 LOAD_GLOBAL             45 (NULL + len)
                      712 LOAD_FAST                7 (features_list)
                      714 PRECALL                  1
                      718 CALL                     1
                      728 BUILD_TUPLE              2
                      730 STORE_FAST              10 (totals)
          
-         519         732 LOAD_FAST                3 (cfg)
+         575         732 LOAD_FAST                3 (cfg)
                      734 LOAD_ATTR               23 (verbose)
                      744 POP_JUMP_FORWARD_IF_FALSE    47 (to 840)
          
-         521         746 LOAD_GLOBAL             49 (NULL + tqdm)
+         577         746 LOAD_GLOBAL             49 (NULL + tqdm)
                      758 LOAD_FAST               10 (totals)
                      760 LOAD_CONST               4 (0)
                      762 BINARY_SUBSCR
                      772 LOAD_CONST               5 ('Forward passes to cache data for vis')
                      774 KW_NAMES                 6
                      776 PRECALL                  2
                      780 CALL                     2
          
-         522         790 LOAD_GLOBAL             49 (NULL + tqdm)
+         578         790 LOAD_GLOBAL             49 (NULL + tqdm)
                      802 LOAD_FAST               10 (totals)
                      804 LOAD_CONST               3 (1)
                      806 BINARY_SUBSCR
                      816 LOAD_CONST               7 ('Extracting vis data from cached data')
                      818 KW_NAMES                 6
                      820 PRECALL                  2
                      824 CALL                     2
          
-         520         834 BUILD_LIST               2
+         576         834 BUILD_LIST               2
                      836 STORE_FAST              11 (progress)
                      838 JUMP_FORWARD             2 (to 844)
          
-         525     >>  840 LOAD_CONST               1 (None)
+         581     >>  840 LOAD_CONST               1 (None)
                      842 STORE_FAST              11 (progress)
          
-         528     >>  844 LOAD_GLOBAL             29 (NULL + isinstance)
+         584     >>  844 LOAD_GLOBAL             29 (NULL + isinstance)
                      856 LOAD_FAST                1 (model)
                      858 LOAD_GLOBAL             50 (HookedTransformer)
                      870 PRECALL                  2
                      874 CALL                     2
                      884 POP_JUMP_FORWARD_IF_TRUE    10 (to 906)
                      886 LOAD_ASSERTION_ERROR
                      888 LOAD_CONST               8 ('Error: non-HookedTransformer models are not yet supported.')
                      890 PRECALL                  0
                      894 CALL                     0
                      904 RAISE_VARARGS            1
          
-         529     >>  906 LOAD_GLOBAL             29 (NULL + isinstance)
+         585     >>  906 LOAD_GLOBAL             29 (NULL + isinstance)
                      918 LOAD_FAST                3 (cfg)
                      920 LOAD_ATTR               26 (hook_point)
                      930 LOAD_GLOBAL             54 (str)
                      942 PRECALL                  2
                      946 CALL                     2
                      956 POP_JUMP_FORWARD_IF_TRUE    10 (to 978)
                      958 LOAD_ASSERTION_ERROR
                      960 LOAD_CONST               9 ('Error: cfg.hook_point must be a string')
                      962 PRECALL                  0
                      966 CALL                     0
                      976 RAISE_VARARGS            1
          
-         530     >>  978 LOAD_GLOBAL             57 (NULL + TransformerLensWrapper)
+         586     >>  978 LOAD_GLOBAL             57 (NULL + TransformerLensWrapper)
                      990 LOAD_FAST                1 (model)
                      992 LOAD_FAST                3 (cfg)
                      994 LOAD_ATTR               26 (hook_point)
                     1004 PRECALL                  2
                     1008 CALL                     2
                     1018 STORE_FAST              12 (model_wrapper)
          
-         533        1020 LOAD_FAST                8 (feature_batches)
+         589        1020 LOAD_FAST                8 (feature_batches)
                     1022 GET_ITER
                  >> 1024 FOR_ITER                89 (to 1204)
                     1026 STORE_FAST              13 (features)
          
-         534        1028 LOAD_GLOBAL             59 (NULL + _get_feature_data)
+         590        1028 LOAD_GLOBAL             59 (NULL + _get_feature_data)
          
-         535        1040 LOAD_FAST                0 (encoder)
+         591        1040 LOAD_FAST                0 (encoder)
                     1042 LOAD_FAST                4 (encoder_B)
                     1044 LOAD_FAST               12 (model_wrapper)
                     1046 LOAD_FAST                2 (tokens)
                     1048 LOAD_FAST               13 (features)
                     1050 LOAD_FAST                3 (cfg)
                     1052 LOAD_FAST               11 (progress)
          
-         534        1054 PRECALL                  7
+         590        1054 PRECALL                  7
                     1058 CALL                     7
                     1068 UNPACK_SEQUENCE          2
                     1072 STORE_FAST              14 (new_feature_data)
                     1074 STORE_FAST              15 (new_time_logs)
          
-         537        1076 LOAD_FAST                5 (sae_vis_data)
+         593        1076 LOAD_FAST                5 (sae_vis_data)
                     1078 LOAD_METHOD             30 (update)
                     1100 LOAD_FAST               14 (new_feature_data)
                     1102 PRECALL                  1
                     1106 CALL                     1
                     1116 POP_TOP
          
-         538        1118 LOAD_FAST               15 (new_time_logs)
+         594        1118 LOAD_FAST               15 (new_time_logs)
                     1120 LOAD_METHOD             31 (items)
                     1142 PRECALL                  0
                     1146 CALL                     0
                     1156 GET_ITER
                  >> 1158 FOR_ITER                21 (to 1202)
                     1160 UNPACK_SEQUENCE          2
                     1164 STORE_FAST              16 (key)
                     1166 STORE_FAST              17 (value)
          
-         539        1168 LOAD_FAST                6 (time_logs)
+         595        1168 LOAD_FAST                6 (time_logs)
                     1170 LOAD_FAST               16 (key)
                     1172 COPY                     2
                     1174 COPY                     2
                     1176 BINARY_SUBSCR
                     1186 LOAD_FAST               17 (value)
                     1188 BINARY_OP               13 (+=)
                     1192 SWAP                     3
                     1194 SWAP                     2
                     1196 STORE_SUBSCR
                     1200 JUMP_BACKWARD           22 (to 1158)
          
-         538     >> 1202 JUMP_BACKWARD           90 (to 1024)
+         594     >> 1202 JUMP_BACKWARD           90 (to 1024)
          
-         542     >> 1204 LOAD_FAST               11 (progress)
+         598     >> 1204 LOAD_FAST               11 (progress)
                     1206 POP_JUMP_FORWARD_IF_NONE    17 (to 1242)
          
-         543        1208 LOAD_FAST               11 (progress)
+         599        1208 LOAD_FAST               11 (progress)
                     1210 GET_ITER
                  >> 1212 FOR_ITER                14 (to 1242)
                     1214 STORE_FAST              18 (pbar)
                     1216 LOAD_FAST               18 (pbar)
                     1218 LOAD_ATTR               32 (total)
                     1228 LOAD_FAST               18 (pbar)
                     1230 STORE_ATTR              33 (n)
                     1240 JUMP_BACKWARD           15 (to 1212)
          
-         546     >> 1242 LOAD_FAST                3 (cfg)
+         602     >> 1242 LOAD_FAST                3 (cfg)
                     1244 LOAD_ATTR               23 (verbose)
                     1254 POP_JUMP_FORWARD_IF_FALSE   123 (to 1502)
          
-         547        1256 LOAD_GLOBAL             69 (NULL + sum)
+         603        1256 LOAD_GLOBAL             69 (NULL + sum)
                     1268 LOAD_FAST                6 (time_logs)
                     1270 LOAD_METHOD             35 (values)
                     1292 PRECALL                  0
                     1296 CALL                     0
                     1306 PRECALL                  1
                     1310 CALL                     1
                     1320 STORE_FAST              19 (total_time)
          
-         548        1322 LOAD_GLOBAL             73 (NULL + Table)
+         604        1322 LOAD_GLOBAL             73 (NULL + Table)
                     1334 LOAD_CONST              10 ('Task')
                     1336 LOAD_CONST              11 ('Time')
                     1338 LOAD_CONST              12 ('Pct %')
                     1340 PRECALL                  3
                     1344 CALL                     3
                     1354 STORE_FAST              20 (table)
          
-         549        1356 LOAD_FAST                6 (time_logs)
+         605        1356 LOAD_FAST                6 (time_logs)
                     1358 LOAD_METHOD             31 (items)
                     1380 PRECALL                  0
                     1384 CALL                     0
                     1394 GET_ITER
                  >> 1396 FOR_ITER                37 (to 1472)
                     1398 UNPACK_SEQUENCE          2
                     1402 STORE_FAST              21 (task)
                     1404 STORE_FAST              22 (duration)
          
-         550        1406 LOAD_FAST               20 (table)
+         606        1406 LOAD_FAST               20 (table)
                     1408 LOAD_METHOD             37 (add_row)
                     1430 LOAD_FAST               21 (task)
                     1432 LOAD_FAST               22 (duration)
                     1434 LOAD_CONST              13 ('.2f')
                     1436 FORMAT_VALUE             4 (with format)
                     1438 LOAD_CONST              14 ('s')
                     1440 BUILD_STRING             2
@@ -2664,34 +2907,34 @@
                     1450 LOAD_CONST              15 ('.1%')
                     1452 FORMAT_VALUE             4 (with format)
                     1454 PRECALL                  3
                     1458 CALL                     3
                     1468 POP_TOP
                     1470 JUMP_BACKWARD           38 (to 1396)
          
-         551     >> 1472 LOAD_GLOBAL             77 (NULL + rprint)
+         607     >> 1472 LOAD_GLOBAL             77 (NULL + rprint)
                     1484 LOAD_FAST               20 (table)
                     1486 PRECALL                  1
                     1490 CALL                     1
                     1500 POP_TOP
          
-         553     >> 1502 LOAD_FAST                5 (sae_vis_data)
+         609     >> 1502 LOAD_FAST                5 (sae_vis_data)
                     1504 RETURN_VALUE
          consts
             "\n    This is the main function which users will run to generate the feature visualization data. It batches this\n    computation over features, in accordance with the arguments in the SaeVisConfig object (we don't want to compute all\n    the features at once, since might give OOMs).\n\n    See the `_get_feature_data` function for an explanation of the arguments, as well as a more detailed explanation\n    of what this function is doing.\n\n    The return object is the merged SaeVisData objects returned by the `_get_feature_data` function.\n    "
             None
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 19
                code
                   0x970067007c005d167d017c01a000000000000000000000000000000000
                   0000000000a6000000ab00000000000000000091028c175300
-               512           0 RESUME                   0
+               568           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                22 (to 52)
                              8 STORE_FAST               1 (x)
                             10 LOAD_FAST                1 (x)
                             12 LOAD_METHOD              0 (tolist)
                             34 PRECALL                  0
@@ -2700,17 +2943,17 @@
                             50 JUMP_BACKWARD           23 (to 6)
                        >>   52 RETURN_VALUE
                consts
                names      ('tolist',)
                varnames   ('.0', 'x')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 512
+               firstlineno 568
                lnotab 0x
             1
             0
             'Forward passes to cache data for vis'
             ('total', 'desc')
             'Extracting vis data from cached data'
             'Error: non-HookedTransformer models are not yet supported.'
@@ -2721,17 +2964,17 @@
             '.2f'
             's'
             '.1%'
          names      ('seed', 'torch', 'manual_seed', 'np', 'random', 'SaeVisData', 'defaultdict', 'float', 'batch_size', 'features', 'list', 'range', 'cfg', 'd_hidden', 'isinstance', 'int', 'tensor', 'split', 'minibatch_size_features', 'minibatch_size_tokens', 'math', 'ceil', 'len', 'verbose', 'tqdm', 'HookedTransformer', 'hook_point', 'str', 'TransformerLensWrapper', '_get_feature_data', 'update', 'items', 'total', 'n', 'sum', 'values', 'Table', 'add_row', 'rprint')
          varnames   ('encoder', 'model', 'tokens', 'cfg', 'encoder_B', 'sae_vis_data', 'time_logs', 'features_list', 'feature_batches', 'n_token_batches', 'totals', 'progress', 'model_wrapper', 'features', 'new_feature_data', 'new_time_logs', 'key', 'value', 'pbar', 'total_time', 'table', 'task', 'duration')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
          name       'get_feature_data'
-         firstlineno 470
+         firstlineno 526
          lnotab
             0x02130e01320148031c0128030e0106021e030e014e013401120228036c
             02640242030e022c012cfe060504033e0148012a0308010c010eff16032a
             01320122ff0204040122030e0142012201320142011e02
       'feat_acts'
       'feat_logits'
       'd_vocab'
@@ -2830,59 +3073,59 @@
                        0 MAKE_CELL                2 (feat_logits)
                        2 MAKE_CELL               34 (bottom_contribution_to_logits)
                        4 MAKE_CELL               35 (feat_acts_coloring)
                        6 MAKE_CELL               36 (loss_contribution)
                        8 MAKE_CELL               37 (token_ids)
                       10 MAKE_CELL               38 (top_contribution_to_logits)
          
-         558          12 RESUME                   0
+         614          12 RESUME                   0
          
-         607          14 LOAD_FAST                6 (seq_cfg)
+         663          14 LOAD_FAST                6 (seq_cfg)
                       16 LOAD_ATTR                0 (buffer)
                       26 LOAD_CONST               1 (0)
                       28 BINARY_SUBSCR
                       38 LOAD_CONST               2 (1)
                       40 BINARY_OP                0 (+)
                       44 LOAD_FAST                6 (seq_cfg)
                       46 LOAD_ATTR                0 (buffer)
                       56 LOAD_CONST               2 (1)
                       58 BINARY_SUBSCR
                       68 UNARY_NEGATIVE
                       70 BUILD_TUPLE              2
                       72 STORE_FAST               7 (buffer)
          
-         610          74 LOAD_GLOBAL              3 (NULL + k_largest_indices)
+         666          74 LOAD_GLOBAL              3 (NULL + k_largest_indices)
                       86 LOAD_FAST                1 (feat_acts)
                       88 LOAD_FAST                6 (seq_cfg)
                       90 LOAD_ATTR                2 (top_acts_group_size)
                      100 LOAD_FAST                7 (buffer)
                      102 KW_NAMES                 3
                      104 PRECALL                  3
                      108 CALL                     3
                      118 STORE_FAST               8 (indices)
          
-         611         120 LOAD_CONST               4 ('TOP ACTIVATIONS<br>MAX = ')
+         667         120 LOAD_CONST               4 ('TOP ACTIVATIONS<br>MAX = ')
                      122 LOAD_FAST                1 (feat_acts)
                      124 LOAD_METHOD              3 (max)
                      146 PRECALL                  0
                      150 CALL                     0
                      160 LOAD_CONST               5 ('.3f')
                      162 FORMAT_VALUE             4 (with format)
                      164 BUILD_STRING             2
                      166 LOAD_FAST                8 (indices)
                      168 BUILD_MAP                1
                      170 STORE_FAST               9 (indices_dict)
          
-         615         172 LOAD_FAST                6 (seq_cfg)
+         671         172 LOAD_FAST                6 (seq_cfg)
                      174 LOAD_ATTR                4 (n_quantiles)
                      184 LOAD_CONST               1 (0)
                      186 COMPARE_OP               4 (>)
                      192 POP_JUMP_FORWARD_IF_FALSE   220 (to 634)
          
-         616         194 LOAD_GLOBAL             11 (NULL + torch)
+         672         194 LOAD_GLOBAL             11 (NULL + torch)
                      206 LOAD_ATTR                6 (linspace)
                      216 LOAD_CONST               1 (0)
                      218 LOAD_FAST                1 (feat_acts)
                      220 LOAD_METHOD              3 (max)
                      242 PRECALL                  0
                      246 CALL                     0
                      256 LOAD_METHOD              7 (item)
@@ -2892,70 +3135,70 @@
                      294 LOAD_ATTR                4 (n_quantiles)
                      304 LOAD_CONST               2 (1)
                      306 BINARY_OP                0 (+)
                      310 PRECALL                  3
                      314 CALL                     3
                      324 STORE_FAST              10 (quantiles)
          
-         617         326 LOAD_GLOBAL             17 (NULL + range)
+         673         326 LOAD_GLOBAL             17 (NULL + range)
                      338 LOAD_FAST                6 (seq_cfg)
                      340 LOAD_ATTR                4 (n_quantiles)
                      350 LOAD_CONST               2 (1)
                      352 BINARY_OP               10 (-)
                      356 LOAD_CONST               6 (-1)
                      358 LOAD_CONST               6 (-1)
                      360 PRECALL                  3
                      364 CALL                     3
                      374 GET_ITER
                  >>  376 FOR_ITER               128 (to 634)
                      378 STORE_FAST              11 (i)
          
-         618         380 LOAD_FAST               10 (quantiles)
+         674         380 LOAD_FAST               10 (quantiles)
                      382 LOAD_FAST               11 (i)
                      384 LOAD_FAST               11 (i)
                      386 LOAD_CONST               7 (2)
                      388 BINARY_OP                0 (+)
                      392 BUILD_SLICE              2
                      394 BINARY_SUBSCR
                      404 LOAD_METHOD              9 (tolist)
                      426 PRECALL                  0
                      430 CALL                     0
                      440 UNPACK_SEQUENCE          2
                      444 STORE_FAST              12 (lower)
                      446 STORE_FAST              13 (upper)
          
-         619         448 LOAD_FAST                1 (feat_acts)
+         675         448 LOAD_FAST                1 (feat_acts)
                      450 LOAD_FAST               12 (lower)
                      452 COMPARE_OP               5 (>=)
                      458 LOAD_FAST                1 (feat_acts)
                      460 LOAD_FAST               13 (upper)
                      462 COMPARE_OP               1 (<=)
                      468 BINARY_OP                1 (&)
                      472 LOAD_METHOD             10 (float)
                      494 PRECALL                  0
                      498 CALL                     0
                      508 LOAD_METHOD             11 (mean)
                      530 PRECALL                  0
                      534 CALL                     0
                      544 STORE_FAST              14 (pct)
          
-         620         546 LOAD_GLOBAL             25 (NULL + random_range_indices)
+         676         546 LOAD_GLOBAL             25 (NULL + random_range_indices)
                      558 LOAD_FAST                1 (feat_acts)
                      560 LOAD_FAST                6 (seq_cfg)
                      562 LOAD_ATTR               13 (quantile_group_size)
                      572 LOAD_FAST               12 (lower)
                      574 LOAD_FAST               13 (upper)
                      576 BUILD_TUPLE              2
                      578 LOAD_FAST                7 (buffer)
                      580 KW_NAMES                 8
                      582 PRECALL                  4
                      586 CALL                     4
                      596 STORE_FAST               8 (indices)
          
-         621         598 LOAD_FAST                8 (indices)
+         677         598 LOAD_FAST                8 (indices)
                      600 LOAD_FAST                9 (indices_dict)
                      602 LOAD_CONST               9 ('INTERVAL ')
                      604 LOAD_FAST               12 (lower)
                      606 LOAD_CONST               5 ('.3f')
                      608 FORMAT_VALUE             4 (with format)
                      610 LOAD_CONST              10 (' - ')
                      612 LOAD_FAST               13 (upper)
@@ -2965,15 +3208,15 @@
                      620 LOAD_FAST               14 (pct)
                      622 LOAD_CONST              12 ('.3%')
                      624 FORMAT_VALUE             4 (with format)
                      626 BUILD_STRING             6
                      628 STORE_SUBSCR
                      632 JUMP_BACKWARD          129 (to 376)
          
-         624     >>  634 LOAD_GLOBAL             11 (NULL + torch)
+         680     >>  634 LOAD_GLOBAL             11 (NULL + torch)
                      646 LOAD_ATTR               14 (concat)
                      656 LOAD_GLOBAL             31 (NULL + list)
                      668 LOAD_FAST                9 (indices_dict)
                      670 LOAD_METHOD             16 (values)
                      692 PRECALL                  0
                      696 CALL                     0
                      706 PRECALL                  1
@@ -2981,15 +3224,15 @@
                      720 PRECALL                  1
                      724 CALL                     1
                      734 LOAD_METHOD             17 (cpu)
                      756 PRECALL                  0
                      760 CALL                     0
                      770 STORE_FAST              15 (indices_bold)
          
-         631         772 LOAD_GLOBAL             11 (NULL + torch)
+         687         772 LOAD_GLOBAL             11 (NULL + torch)
                      784 LOAD_ATTR               18 (arange)
                      794 LOAD_FAST                6 (seq_cfg)
                      796 LOAD_ATTR                0 (buffer)
                      806 LOAD_CONST               1 (0)
                      808 BINARY_SUBSCR
                      818 UNARY_NEGATIVE
                      820 LOAD_CONST               2 (1)
@@ -3003,15 +3246,15 @@
                      856 LOAD_FAST               15 (indices_bold)
                      858 LOAD_ATTR               19 (device)
                      868 KW_NAMES                13
                      870 PRECALL                  3
                      874 CALL                     3
                      884 STORE_FAST              16 (buffer_tensor)
          
-         632         886 LOAD_GLOBAL             41 (NULL + einops)
+         688         886 LOAD_GLOBAL             41 (NULL + einops)
                      898 LOAD_ATTR               21 (repeat)
                      908 LOAD_FAST               15 (indices_bold)
                      910 LOAD_CONST              14 ('batch two -> batch seq two')
                      912 LOAD_FAST                6 (seq_cfg)
                      914 LOAD_ATTR                0 (buffer)
                      924 LOAD_CONST               1 (0)
                      926 BINARY_SUBSCR
@@ -3023,15 +3266,15 @@
                      964 LOAD_CONST               7 (2)
                      966 BINARY_OP                0 (+)
                      970 KW_NAMES                15
                      972 PRECALL                  3
                      976 CALL                     3
                      986 STORE_FAST              17 (indices_buf)
          
-         633         988 LOAD_GLOBAL             11 (NULL + torch)
+         689         988 LOAD_GLOBAL             11 (NULL + torch)
                     1000 LOAD_ATTR               22 (stack)
                     1010 LOAD_FAST               17 (indices_buf)
                     1012 LOAD_CONST              16 ((Ellipsis, 0))
                     1014 BINARY_SUBSCR
                     1024 LOAD_FAST               17 (indices_buf)
                     1026 LOAD_CONST              17 ((Ellipsis, 1))
                     1028 BINARY_SUBSCR
@@ -3040,15 +3283,15 @@
                     1044 BUILD_LIST               2
                     1046 LOAD_CONST               6 (-1)
                     1048 KW_NAMES                18
                     1050 PRECALL                  2
                     1054 CALL                     2
                     1064 STORE_FAST              17 (indices_buf)
          
-         639        1066 LOAD_GLOBAL             47 (NULL + eindex)
+         695        1066 LOAD_GLOBAL             47 (NULL + eindex)
                     1078 LOAD_FAST                0 (tokens)
                     1080 LOAD_FAST               17 (indices_buf)
                     1082 LOAD_CONST              19 (None)
                     1084 LOAD_CONST              19 (None)
                     1086 BUILD_SLICE              2
                     1088 LOAD_CONST               2 (1)
                     1090 LOAD_CONST              19 (None)
@@ -3056,49 +3299,49 @@
                     1094 BUILD_TUPLE              2
                     1096 BINARY_SUBSCR
                     1106 LOAD_CONST              20 ('[batch seq 0] [batch seq 1]')
                     1108 PRECALL                  3
                     1112 CALL                     3
                     1122 STORE_DEREF             37 (token_ids)
          
-         645        1124 LOAD_FAST                6 (seq_cfg)
+         701        1124 LOAD_FAST                6 (seq_cfg)
                     1126 LOAD_ATTR               24 (compute_buffer)
                     1136 POP_JUMP_FORWARD_IF_FALSE    77 (to 1292)
          
-         646        1138 LOAD_GLOBAL             47 (NULL + eindex)
+         702        1138 LOAD_GLOBAL             47 (NULL + eindex)
                     1150 LOAD_FAST                1 (feat_acts)
                     1152 LOAD_FAST               17 (indices_buf)
                     1154 LOAD_CONST              21 ('[batch buf_plus1 0] [batch buf_plus1 1]')
                     1156 PRECALL                  3
                     1160 CALL                     3
                     1170 STORE_FAST              18 (feat_acts_buf)
          
-         647        1172 LOAD_FAST               18 (feat_acts_buf)
+         703        1172 LOAD_FAST               18 (feat_acts_buf)
                     1174 LOAD_CONST              19 (None)
                     1176 LOAD_CONST              19 (None)
                     1178 BUILD_SLICE              2
                     1180 LOAD_CONST              19 (None)
                     1182 LOAD_CONST               6 (-1)
                     1184 BUILD_SLICE              2
                     1186 BUILD_TUPLE              2
                     1188 BINARY_SUBSCR
                     1198 STORE_FAST              19 (feat_acts_pre_ablation)
          
-         648        1200 LOAD_FAST               18 (feat_acts_buf)
+         704        1200 LOAD_FAST               18 (feat_acts_buf)
                     1202 LOAD_CONST              19 (None)
                     1204 LOAD_CONST              19 (None)
                     1206 BUILD_SLICE              2
                     1208 LOAD_CONST               2 (1)
                     1210 LOAD_CONST              19 (None)
                     1212 BUILD_SLICE              2
                     1214 BUILD_TUPLE              2
                     1216 BINARY_SUBSCR
                     1226 STORE_DEREF             35 (feat_acts_coloring)
          
-         649        1228 LOAD_GLOBAL             47 (NULL + eindex)
+         705        1228 LOAD_GLOBAL             47 (NULL + eindex)
                     1240 LOAD_FAST                3 (resid_post)
                     1242 LOAD_FAST               17 (indices_buf)
                     1244 LOAD_CONST              19 (None)
                     1246 LOAD_CONST              19 (None)
                     1248 BUILD_SLICE              2
                     1250 LOAD_CONST              19 (None)
                     1252 LOAD_CONST               6 (-1)
@@ -3106,46 +3349,46 @@
                     1256 BUILD_TUPLE              2
                     1258 BINARY_SUBSCR
                     1268 LOAD_CONST              22 ('[batch buf 0] [batch buf 1] d_model')
                     1270 PRECALL                  3
                     1274 CALL                     3
                     1284 STORE_FAST              20 (resid_post_pre_ablation)
          
-         651        1286 LOAD_DEREF              37 (token_ids)
+         707        1286 LOAD_DEREF              37 (token_ids)
                     1288 STORE_FAST              21 (correct_tokens)
                     1290 JUMP_FORWARD           157 (to 1606)
          
-         653     >> 1292 LOAD_GLOBAL             47 (NULL + eindex)
+         709     >> 1292 LOAD_GLOBAL             47 (NULL + eindex)
                     1304 LOAD_FAST                1 (feat_acts)
                     1306 LOAD_FAST               15 (indices_bold)
                     1308 LOAD_CONST              23 ('[batch 0] [batch 1]')
                     1310 PRECALL                  3
                     1314 CALL                     3
                     1324 LOAD_METHOD             25 (unsqueeze)
                     1346 LOAD_CONST               2 (1)
                     1348 PRECALL                  1
                     1352 CALL                     1
                     1362 STORE_FAST              19 (feat_acts_pre_ablation)
          
-         654        1364 LOAD_FAST               19 (feat_acts_pre_ablation)
+         710        1364 LOAD_FAST               19 (feat_acts_pre_ablation)
                     1366 STORE_DEREF             35 (feat_acts_coloring)
          
-         655        1368 LOAD_GLOBAL             47 (NULL + eindex)
+         711        1368 LOAD_GLOBAL             47 (NULL + eindex)
                     1380 LOAD_FAST                3 (resid_post)
                     1382 LOAD_FAST               15 (indices_bold)
                     1384 LOAD_CONST              24 ('[batch 0] [batch 1] d_model')
                     1386 PRECALL                  3
                     1390 CALL                     3
                     1400 LOAD_METHOD             25 (unsqueeze)
                     1422 LOAD_CONST               2 (1)
                     1424 PRECALL                  1
                     1428 CALL                     1
                     1438 STORE_FAST              20 (resid_post_pre_ablation)
          
-         657        1440 LOAD_GLOBAL             11 (NULL + torch)
+         713        1440 LOAD_GLOBAL             11 (NULL + torch)
                     1452 LOAD_ATTR               22 (stack)
                     1462 LOAD_FAST               15 (indices_bold)
                     1464 LOAD_CONST              19 (None)
                     1466 LOAD_CONST              19 (None)
                     1468 BUILD_SLICE              2
                     1470 LOAD_CONST               1 (0)
                     1472 BUILD_TUPLE              2
@@ -3162,126 +3405,126 @@
                     1512 BUILD_LIST               2
                     1514 LOAD_CONST               6 (-1)
                     1516 KW_NAMES                18
                     1518 PRECALL                  2
                     1522 CALL                     2
                     1532 STORE_FAST              22 (indices_bold_next)
          
-         658        1534 LOAD_GLOBAL             47 (NULL + eindex)
+         714        1534 LOAD_GLOBAL             47 (NULL + eindex)
                     1546 LOAD_FAST                0 (tokens)
                     1548 LOAD_FAST               22 (indices_bold_next)
                     1550 LOAD_CONST              23 ('[batch 0] [batch 1]')
                     1552 PRECALL                  3
                     1556 CALL                     3
                     1566 LOAD_METHOD             25 (unsqueeze)
                     1588 LOAD_CONST               2 (1)
                     1590 PRECALL                  1
                     1594 CALL                     1
                     1604 STORE_FAST              21 (correct_tokens)
          
-         664     >> 1606 LOAD_FAST               19 (feat_acts_pre_ablation)
+         720     >> 1606 LOAD_FAST               19 (feat_acts_pre_ablation)
                     1608 LOAD_CONST              25 ((Ellipsis, None))
                     1610 BINARY_SUBSCR
                     1620 LOAD_FAST                4 (feature_resid_dir)
                     1622 BINARY_OP                5 (*)
                     1626 STORE_FAST              23 (resid_post_feature_effect)
          
-         667        1628 LOAD_FAST               20 (resid_post_pre_ablation)
+         723        1628 LOAD_FAST               20 (resid_post_pre_ablation)
                     1630 LOAD_FAST               23 (resid_post_feature_effect)
                     1632 BINARY_OP               10 (-)
                     1636 STORE_FAST              24 (new_resid_post)
          
-         668        1638 LOAD_FAST               24 (new_resid_post)
+         724        1638 LOAD_FAST               24 (new_resid_post)
                     1640 LOAD_FAST               24 (new_resid_post)
                     1642 LOAD_METHOD             26 (std)
                     1664 LOAD_CONST               6 (-1)
                     1666 LOAD_CONST              26 (True)
                     1668 KW_NAMES                27
                     1670 PRECALL                  2
                     1674 CALL                     2
                     1684 BINARY_OP               11 (/)
                     1688 LOAD_FAST                5 (W_U)
                     1690 BINARY_OP                4 (@)
                     1694 STORE_FAST              25 (new_logits)
          
-         669        1696 LOAD_FAST               20 (resid_post_pre_ablation)
+         725        1696 LOAD_FAST               20 (resid_post_pre_ablation)
                     1698 LOAD_FAST               20 (resid_post_pre_ablation)
                     1700 LOAD_METHOD             26 (std)
                     1722 LOAD_CONST               6 (-1)
                     1724 LOAD_CONST              26 (True)
                     1726 KW_NAMES                27
                     1728 PRECALL                  2
                     1732 CALL                     2
                     1742 BINARY_OP               11 (/)
                     1746 LOAD_FAST                5 (W_U)
                     1748 BINARY_OP                4 (@)
                     1752 STORE_FAST              26 (orig_logits)
          
-         670        1754 LOAD_FAST               26 (orig_logits)
+         726        1754 LOAD_FAST               26 (orig_logits)
                     1756 LOAD_METHOD             27 (log_softmax)
                     1778 LOAD_CONST               6 (-1)
                     1780 KW_NAMES                18
                     1782 PRECALL                  1
                     1786 CALL                     1
                     1796 LOAD_FAST               25 (new_logits)
                     1798 LOAD_METHOD             27 (log_softmax)
                     1820 LOAD_CONST               6 (-1)
                     1822 KW_NAMES                18
                     1824 PRECALL                  1
                     1828 CALL                     1
                     1838 BINARY_OP               10 (-)
                     1842 STORE_FAST              27 (contribution_to_logprobs)
          
-         674        1844 LOAD_FAST               19 (feat_acts_pre_ablation)
+         730        1844 LOAD_FAST               19 (feat_acts_pre_ablation)
                     1846 LOAD_METHOD             28 (abs)
                     1868 PRECALL                  0
                     1872 CALL                     0
                     1882 LOAD_CONST              28 (1e-05)
                     1884 COMPARE_OP               4 (>)
                     1890 STORE_FAST              28 (acts_nonzero)
          
-         675        1892 LOAD_GLOBAL             59 (NULL + TopK)
+         731        1892 LOAD_GLOBAL             59 (NULL + TopK)
                     1904 LOAD_FAST               27 (contribution_to_logprobs)
                     1906 LOAD_FAST                6 (seq_cfg)
                     1908 LOAD_ATTR               30 (top_logits_hoverdata)
                     1918 LOAD_CONST              26 (True)
                     1920 LOAD_FAST               28 (acts_nonzero)
                     1922 KW_NAMES                29
                     1924 PRECALL                  4
                     1928 CALL                     4
                     1938 STORE_DEREF             38 (top_contribution_to_logits)
          
-         676        1940 LOAD_GLOBAL             59 (NULL + TopK)
+         732        1940 LOAD_GLOBAL             59 (NULL + TopK)
                     1952 LOAD_FAST               27 (contribution_to_logprobs)
                     1954 LOAD_FAST                6 (seq_cfg)
                     1956 LOAD_ATTR               30 (top_logits_hoverdata)
                     1966 LOAD_CONST              30 (False)
                     1968 LOAD_FAST               28 (acts_nonzero)
                     1970 KW_NAMES                29
                     1972 PRECALL                  4
                     1976 CALL                     4
                     1986 STORE_DEREF             34 (bottom_contribution_to_logits)
          
-         680        1988 LOAD_GLOBAL             47 (NULL + eindex)
+         736        1988 LOAD_GLOBAL             47 (NULL + eindex)
                     2000 LOAD_FAST               27 (contribution_to_logprobs)
                     2002 UNARY_NEGATIVE
                     2004 LOAD_FAST               21 (correct_tokens)
                     2006 LOAD_CONST              31 ('batch seq [batch seq]')
                     2008 PRECALL                  3
                     2012 CALL                     3
                     2022 STORE_DEREF             36 (loss_contribution)
          
-         686        2024 BUILD_LIST               0
+         742        2024 BUILD_LIST               0
                     2026 STORE_FAST              29 (sequence_groups_data)
          
-         687        2028 LOAD_GLOBAL             63 (NULL + np)
+         743        2028 LOAD_GLOBAL             63 (NULL + np)
                     2040 LOAD_ATTR               32 (cumsum)
                     2050 LOAD_CONST               1 (0)
                     2052 BUILD_LIST               1
-                    2054 LOAD_CONST              32 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 687>)
+                    2054 LOAD_CONST              32 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 743>)
                     2056 MAKE_FUNCTION            0
                     2058 LOAD_FAST                9 (indices_dict)
                     2060 LOAD_METHOD             16 (values)
                     2082 PRECALL                  0
                     2086 CALL                     0
                     2096 GET_ITER
                     2098 PRECALL                  0
@@ -3290,67 +3533,67 @@
                     2116 PRECALL                  1
                     2120 CALL                     1
                     2130 LOAD_METHOD              9 (tolist)
                     2152 PRECALL                  0
                     2156 CALL                     0
                     2166 STORE_FAST              30 (group_sizes_cumsum)
          
-         688        2168 LOAD_GLOBAL             67 (NULL + enumerate)
+         744        2168 LOAD_GLOBAL             67 (NULL + enumerate)
                     2180 LOAD_FAST                9 (indices_dict)
                     2182 LOAD_METHOD             34 (keys)
                     2204 PRECALL                  0
                     2208 CALL                     0
                     2218 PRECALL                  1
                     2222 CALL                     1
                     2232 GET_ITER
                  >> 2234 FOR_ITER                88 (to 2412)
                     2236 UNPACK_SEQUENCE          2
                     2240 STORE_FAST              31 (group_idx)
                     2242 STORE_FAST              32 (group_name)
          
-         689        2244 LOAD_CLOSURE            34 (bottom_contribution_to_logits)
+         745        2244 LOAD_CLOSURE            34 (bottom_contribution_to_logits)
                     2246 LOAD_CLOSURE            35 (feat_acts_coloring)
                     2248 LOAD_CLOSURE             2 (feat_logits)
                     2250 LOAD_CLOSURE            36 (loss_contribution)
                     2252 LOAD_CLOSURE            37 (token_ids)
                     2254 LOAD_CLOSURE            38 (top_contribution_to_logits)
                     2256 BUILD_TUPLE              6
-                    2258 LOAD_CONST              33 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 689>)
+                    2258 LOAD_CONST              33 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 745>)
                     2260 MAKE_FUNCTION            8 (closure)
          
-         700        2262 LOAD_GLOBAL             17 (NULL + range)
+         756        2262 LOAD_GLOBAL             17 (NULL + range)
                     2274 LOAD_FAST               30 (group_sizes_cumsum)
                     2276 LOAD_FAST               31 (group_idx)
                     2278 BINARY_SUBSCR
                     2288 LOAD_FAST               30 (group_sizes_cumsum)
                     2290 LOAD_FAST               31 (group_idx)
                     2292 LOAD_CONST               2 (1)
                     2294 BINARY_OP                0 (+)
                     2298 BINARY_SUBSCR
                     2308 PRECALL                  2
                     2312 CALL                     2
          
-         689        2322 GET_ITER
+         745        2322 GET_ITER
                     2324 PRECALL                  0
                     2328 CALL                     0
                     2338 STORE_FAST              33 (seq_data)
          
-         702        2340 LOAD_FAST               29 (sequence_groups_data)
+         758        2340 LOAD_FAST               29 (sequence_groups_data)
                     2342 LOAD_METHOD             35 (append)
                     2364 LOAD_GLOBAL             73 (NULL + SequenceGroupData)
                     2376 LOAD_FAST               32 (group_name)
                     2378 LOAD_FAST               33 (seq_data)
                     2380 PRECALL                  2
                     2384 CALL                     2
                     2394 PRECALL                  1
                     2398 CALL                     1
                     2408 POP_TOP
                     2410 JUMP_BACKWARD           89 (to 2234)
          
-         704     >> 2412 LOAD_GLOBAL             75 (NULL + SequenceMultiGroupData)
+         760     >> 2412 LOAD_GLOBAL             75 (NULL + SequenceMultiGroupData)
                     2424 LOAD_FAST               29 (sequence_groups_data)
                     2426 PRECALL                  1
                     2430 CALL                     1
                     2440 RETURN_VALUE
          consts
             "\n    This function returns the data which is used to create the sequence visualizations (i.e. the right-hand column of\n    the visualization). This is a multi-step process (the 4 steps are annotated in the code):\n\n        (1) Find all the token groups (i.e. topk, bottomk, and quantile groups of activations). These are bold tokens.\n        (2) Get the indices of all tokens we'll need data from, which includes a buffer around each bold token.\n        (3) Extract the token IDs, feature activations & residual stream values for those positions\n        (4) Compute the logit effect if this feature is ablated\n            (4A) Use this to compute the most affected tokens by this feature (i.e. the vis hoverdata)\n            (4B) Use this to compute the loss effect if this feature is ablated (i.e. the blue/red underlining)\n        (5) Return all this data as a SequenceMultiGroupData object\n\n    Args:\n        tokens:\n            The tokens we'll be extracting sequence data from.\n        feat_acts:\n            The activations of the feature we're interested in, for each token in the batch.\n        feat_logits:\n            The logit vector for this feature (used to generate histogram, and is needed here for the line-on-hover).\n        resid_post:\n            The residual stream values before final layernorm, for each token in the batch.\n        feature_resid_dir:\n            The direction this feature writes to the logit output (i.e. the direction we'll be erasing from resid_post).\n        W_U:\n            The model's unembedding matrix, which we'll use to get the logits.\n        cfg:\n            Feature visualization parameters, containing some important params e.g. num sequences per group.\n\n    Returns:\n        SequenceMultiGroupData\n            This is a dataclass which contains a dict of SequenceGroupData objects, where each SequenceGroupData object\n            contains the data for a particular group of sequences (i.e. the top-k, bottom-k, and the quantile groups).\n    "
             0
@@ -3388,15 +3631,15 @@
                argcount  : 1
                nlocals   : 2
                stacksize : 5
                flags     : 19
                code
                   0x970067007c005d117d017401000000000000000000007c01a6010000ab
                   01000000000000000091028c125300
-               687           0 RESUME                   0
+               743           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                17 (to 42)
                              8 STORE_FAST               1 (indices)
                             10 LOAD_GLOBAL              1 (NULL + len)
                             22 LOAD_FAST                1 (indices)
                             24 PRECALL                  1
@@ -3405,17 +3648,17 @@
                             40 JUMP_BACKWARD           18 (to 6)
                        >>   42 RETURN_VALUE
                consts
                names      ('len',)
                varnames   ('.0', 'indices')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 687
+               firstlineno 743
                lnotab 0x
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 13
                flags     : 19
                code
@@ -3435,107 +3678,107 @@
                   0119000000000000000000a0010000000000000000000000000000000000
                   000000a6000000ab00000000000000000089026a0300000000000000007c
                   0119000000000000000000a0010000000000000000000000000000000000
                   000000a6000000ab000000000000000000ac01a6080000ab080000000000
                   00000091028cfe5300
                              0 COPY_FREE_VARS           6
                
-               689           2 RESUME                   0
+               745           2 RESUME                   0
                              4 BUILD_LIST               0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER               253 (to 516)
                
-               700          10 STORE_FAST               1 (i)
+               756          10 STORE_FAST               1 (i)
                
-               690          12 LOAD_GLOBAL              1 (NULL + SequenceData)
+               746          12 LOAD_GLOBAL              1 (NULL + SequenceData)
                
-               691          24 LOAD_DEREF               6 (token_ids)
+               747          24 LOAD_DEREF               6 (token_ids)
                             26 LOAD_FAST                1 (i)
                             28 BINARY_SUBSCR
                             38 LOAD_METHOD              1 (tolist)
                             60 PRECALL                  0
                             64 CALL                     0
                
-               692          74 LOAD_CONST               0 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 692>)
+               748          74 LOAD_CONST               0 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 748>)
                             76 MAKE_FUNCTION            0
                             78 LOAD_DEREF               3 (feat_acts_coloring)
                             80 LOAD_FAST                1 (i)
                             82 BINARY_SUBSCR
                             92 LOAD_METHOD              1 (tolist)
                            114 PRECALL                  0
                            118 CALL                     0
                            128 GET_ITER
                            130 PRECALL                  0
                            134 CALL                     0
                
-               693         144 LOAD_DEREF               5 (loss_contribution)
+               749         144 LOAD_DEREF               5 (loss_contribution)
                            146 LOAD_FAST                1 (i)
                            148 BINARY_SUBSCR
                            158 LOAD_METHOD              1 (tolist)
                            180 PRECALL                  0
                            184 CALL                     0
                
-               694         194 LOAD_DEREF               4 (feat_logits)
+               750         194 LOAD_DEREF               4 (feat_logits)
                            196 LOAD_DEREF               6 (token_ids)
                            198 LOAD_FAST                1 (i)
                            200 BINARY_SUBSCR
                            210 BINARY_SUBSCR
                            220 LOAD_METHOD              1 (tolist)
                            242 PRECALL                  0
                            246 CALL                     0
                
-               695         256 LOAD_DEREF               7 (top_contribution_to_logits)
+               751         256 LOAD_DEREF               7 (top_contribution_to_logits)
                            258 LOAD_ATTR                2 (indices)
                            268 LOAD_FAST                1 (i)
                            270 BINARY_SUBSCR
                            280 LOAD_METHOD              1 (tolist)
                            302 PRECALL                  0
                            306 CALL                     0
                
-               696         316 LOAD_DEREF               7 (top_contribution_to_logits)
+               752         316 LOAD_DEREF               7 (top_contribution_to_logits)
                            318 LOAD_ATTR                3 (values)
                            328 LOAD_FAST                1 (i)
                            330 BINARY_SUBSCR
                            340 LOAD_METHOD              1 (tolist)
                            362 PRECALL                  0
                            366 CALL                     0
                
-               697         376 LOAD_DEREF               2 (bottom_contribution_to_logits)
+               753         376 LOAD_DEREF               2 (bottom_contribution_to_logits)
                            378 LOAD_ATTR                2 (indices)
                            388 LOAD_FAST                1 (i)
                            390 BINARY_SUBSCR
                            400 LOAD_METHOD              1 (tolist)
                            422 PRECALL                  0
                            426 CALL                     0
                
-               698         436 LOAD_DEREF               2 (bottom_contribution_to_logits)
+               754         436 LOAD_DEREF               2 (bottom_contribution_to_logits)
                            438 LOAD_ATTR                3 (values)
                            448 LOAD_FAST                1 (i)
                            450 BINARY_SUBSCR
                            460 LOAD_METHOD              1 (tolist)
                            482 PRECALL                  0
                            486 CALL                     0
                
-               690         496 KW_NAMES                 1
+               746         496 KW_NAMES                 1
                            498 PRECALL                  8
                            502 CALL                     8
                
-               689         512 LIST_APPEND              2
+               745         512 LIST_APPEND              2
                            514 JUMP_BACKWARD          254 (to 8)
                        >>  516 RETURN_VALUE
                consts
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 6
                      flags     : 19
                      code
                         0x970067007c005d127d017401000000000000000000007c016400a60200
                         00ab02000000000000000091028c135300
-                     692           0 RESUME                   0
+                     748           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                18 (to 44)
                                    8 STORE_FAST               1 (f)
                                   10 LOAD_GLOBAL              1 (NULL + round)
                                   22 LOAD_FAST                1 (f)
                                   24 LOAD_CONST               0 (4)
@@ -3546,34 +3789,34 @@
                              >>   44 RETURN_VALUE
                      consts
                         4
                      names      ('round',)
                      varnames   ('.0', 'f')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                      name       '<listcomp>'
-                     firstlineno 692
+                     firstlineno 748
                      lnotab 0x
                   ('token_ids', 'feat_acts', 'loss_contribution', 'token_logits', 'top_token_ids', 'top_logits', 'bottom_token_ids', 'bottom_logits')
                names      ('SequenceData', 'tolist', 'indices', 'values')
                varnames   ('.0', 'i')
                freevars   ('bottom_contribution_to_logits', 'feat_acts_coloring', 'feat_logits', 'loss_contribution', 'token_ids', 'top_contribution_to_logits')
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 689
+               firstlineno 745
                lnotab 0x0a0b02f60c013201460132013e013c013c013c013cf810ff
          names      ('buffer', 'k_largest_indices', 'top_acts_group_size', 'max', 'n_quantiles', 'torch', 'linspace', 'item', 'range', 'tolist', 'float', 'mean', 'random_range_indices', 'quantile_group_size', 'concat', 'list', 'values', 'cpu', 'arange', 'device', 'einops', 'repeat', 'stack', 'eindex', 'compute_buffer', 'unsqueeze', 'std', 'log_softmax', 'abs', 'TopK', 'top_logits_hoverdata', 'np', 'cumsum', 'enumerate', 'keys', 'append', 'SequenceGroupData', 'SequenceMultiGroupData')
          varnames   ('tokens', 'feat_acts', 'feat_logits', 'resid_post', 'feature_resid_dir', 'W_U', 'seq_cfg', 'buffer', 'indices', 'indices_dict', 'quantiles', 'i', 'lower', 'upper', 'pct', 'indices_bold', 'buffer_tensor', 'indices_buf', 'feat_acts_buf', 'feat_acts_pre_ablation', 'resid_post_pre_ablation', 'correct_tokens', 'indices_bold_next', 'resid_post_feature_effect', 'new_resid_post', 'new_logits', 'orig_logits', 'contribution_to_logprobs', 'acts_nonzero', 'sequence_groups_data', 'group_sizes_cumsum', 'group_idx', 'group_name', 'seq_data')
          freevars   ()
          cellvars   ('feat_logits', 'bottom_contribution_to_logits', 'feat_acts_coloring', 'loss_contribution', 'token_ids', 'top_contribution_to_logits')
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
          name       'get_sequences_data'
-         firstlineno 558
+         firstlineno 614
          lnotab
             0x0e313c032e01340416018401360144016201340124038a07720166014e
             063a060e0122011c011c013a0206024801040148025e01480616030a013a
             013a015a04300130013004240604018c014c01120b3cf5120d4802
       10
       'str_toks'
       'sae_vis_data'
@@ -3677,36 +3920,36 @@
             276a12000000000000000019000000000000000000a01100000000000000
             00000000000000000000000000a6000000ab0000000000000000007d1f64
             1c84007c276a1300000000000000004400a6000000ab0000000000000000
             007d207c1f7c2066027c16641d7c189b009d023c00000090028c5d7c1653
             00
                        0 MAKE_CELL               40 (act_precision)
          
-         707           2 RESUME                   0
+         763           2 RESUME                   0
          
-         768           4 LOAD_FAST                7 (feature_idx)
+         824           4 LOAD_FAST                7 (feature_idx)
                        6 POP_JUMP_FORWARD_IF_NOT_NONE    38 (to 84)
          
-         769           8 LOAD_GLOBAL              1 (NULL + list)
+         825           8 LOAD_GLOBAL              1 (NULL + list)
                       20 LOAD_FAST                2 (sae_vis_data)
                       22 LOAD_ATTR                1 (feature_data_dict)
                       32 LOAD_METHOD              2 (keys)
                       54 PRECALL                  0
                       58 CALL                     0
                       68 PRECALL                  1
                       72 CALL                     1
                       82 STORE_FAST               7 (feature_idx)
          
-         770     >>   84 LOAD_GLOBAL              7 (NULL + len)
+         826     >>   84 LOAD_GLOBAL              7 (NULL + len)
                       96 LOAD_FAST                7 (feature_idx)
                       98 PRECALL                  1
                      102 CALL                     1
                      112 STORE_FAST               9 (n_feats)
          
-         771         114 LOAD_FAST                4 (feature_resid_dir)
+         827         114 LOAD_FAST                4 (feature_resid_dir)
                      116 LOAD_ATTR                4 (shape)
                      126 LOAD_CONST               2 (0)
                      128 BINARY_SUBSCR
                      138 LOAD_FAST                9 (n_feats)
                      140 COMPARE_OP               2 (==)
                      146 POP_JUMP_FORWARD_IF_TRUE    28 (to 204)
                      148 LOAD_ASSERTION_ERROR
@@ -3721,15 +3964,15 @@
                      182 FORMAT_VALUE             0
                      184 LOAD_CONST               5 (')')
                      186 BUILD_STRING             5
                      188 PRECALL                  0
                      192 CALL                     0
                      202 RAISE_VARARGS            1
          
-         773     >>  204 LOAD_FAST                3 (feat_acts)
+         829     >>  204 LOAD_FAST                3 (feat_acts)
                      206 LOAD_ATTR                4 (shape)
                      216 LOAD_CONST               6 (1)
                      218 BINARY_SUBSCR
                      228 LOAD_FAST                9 (n_feats)
                      230 COMPARE_OP               2 (==)
                      236 POP_JUMP_FORWARD_IF_TRUE    28 (to 294)
                      238 LOAD_ASSERTION_ERROR
@@ -3744,15 +3987,15 @@
                      272 FORMAT_VALUE             0
                      274 LOAD_CONST               5 (')')
                      276 BUILD_STRING             5
                      278 PRECALL                  0
                      282 CALL                     0
                      292 RAISE_VARARGS            1
          
-         775     >>  294 LOAD_GLOBAL             11 (NULL + torch)
+         831     >>  294 LOAD_GLOBAL             11 (NULL + torch)
                      306 LOAD_ATTR                6 (empty)
                      316 LOAD_FAST                9 (n_feats)
                      318 LOAD_FAST                0 (tokens)
                      320 LOAD_ATTR                4 (shape)
                      330 LOAD_CONST               6 (1)
                      332 BINARY_SUBSCR
                      342 LOAD_CONST               6 (1)
@@ -3760,44 +4003,44 @@
                      348 BUILD_TUPLE              2
                      350 LOAD_GLOBAL             14 (device)
                      362 KW_NAMES                 8
                      364 PRECALL                  2
                      368 CALL                     2
                      378 STORE_FAST              10 (feats_loss_contribution)
          
-         778         380 LOAD_FAST                5 (resid_post)
+         834         380 LOAD_FAST                5 (resid_post)
                      382 LOAD_FAST                5 (resid_post)
                      384 LOAD_METHOD              8 (std)
                      406 LOAD_CONST               9 (-1)
                      408 LOAD_CONST              10 (True)
                      410 KW_NAMES                11
                      412 PRECALL                  2
                      416 CALL                     2
                      426 BINARY_OP               11 (/)
                      430 LOAD_FAST                6 (W_U)
                      432 BINARY_OP                4 (@)
                      436 STORE_FAST              11 (orig_logits)
          
-         779         438 LOAD_FAST                4 (feature_resid_dir)
+         835         438 LOAD_FAST                4 (feature_resid_dir)
                      440 LOAD_FAST                6 (W_U)
                      442 BINARY_OP                4 (@)
                      446 STORE_FAST              12 (raw_logits)
          
-         781         448 LOAD_GLOBAL             19 (NULL + enumerate)
+         837         448 LOAD_GLOBAL             19 (NULL + enumerate)
                      460 LOAD_FAST                7 (feature_idx)
                      462 PRECALL                  1
                      466 CALL                     1
                      476 GET_ITER
                  >>  478 EXTENDED_ARG             1
                      480 FOR_ITER               492 (to 1466)
                      482 UNPACK_SEQUENCE          2
                      486 STORE_FAST              13 (i)
                      488 STORE_FAST              14 (feat)
          
-         786         490 LOAD_GLOBAL             21 (NULL + einops)
+         842         490 LOAD_GLOBAL             21 (NULL + einops)
                      502 LOAD_ATTR               11 (einsum)
                      512 LOAD_FAST                3 (feat_acts)
                      514 LOAD_CONST               1 (None)
                      516 LOAD_CONST               1 (None)
                      518 BUILD_SLICE              2
                      520 LOAD_FAST               13 (i)
                      522 BUILD_TUPLE              2
@@ -3806,73 +4049,73 @@
                      536 LOAD_FAST               13 (i)
                      538 BINARY_SUBSCR
                      548 LOAD_CONST              12 ('seq, d_model -> seq d_model')
                      550 PRECALL                  3
                      554 CALL                     3
                      564 STORE_FAST              15 (resid_post_feature_effect)
          
-         789         566 LOAD_FAST                5 (resid_post)
+         845         566 LOAD_FAST                5 (resid_post)
                      568 LOAD_FAST               15 (resid_post_feature_effect)
                      570 BINARY_OP               10 (-)
                      574 STORE_FAST              16 (new_resid_post)
          
-         790         576 LOAD_FAST               16 (new_resid_post)
+         846         576 LOAD_FAST               16 (new_resid_post)
                      578 LOAD_FAST               16 (new_resid_post)
                      580 LOAD_METHOD              8 (std)
                      602 LOAD_CONST               9 (-1)
                      604 LOAD_CONST              10 (True)
                      606 KW_NAMES                11
                      608 PRECALL                  2
                      612 CALL                     2
                      622 BINARY_OP               11 (/)
                      626 LOAD_FAST                6 (W_U)
                      628 BINARY_OP                4 (@)
                      632 STORE_FAST              17 (new_logits)
          
-         793         634 LOAD_FAST               11 (orig_logits)
+         849         634 LOAD_FAST               11 (orig_logits)
                      636 LOAD_METHOD             12 (log_softmax)
                      658 LOAD_CONST               9 (-1)
                      660 KW_NAMES                13
                      662 PRECALL                  1
                      666 CALL                     1
                      676 LOAD_FAST               17 (new_logits)
                      678 LOAD_METHOD             12 (log_softmax)
                      700 LOAD_CONST               9 (-1)
                      702 KW_NAMES                13
                      704 PRECALL                  1
                      708 CALL                     1
                      718 BINARY_OP               10 (-)
                      722 STORE_FAST              18 (contribution_to_logprobs)
          
-         794         724 LOAD_GLOBAL             27 (NULL + TopK)
+         850         724 LOAD_GLOBAL             27 (NULL + TopK)
                      736 LOAD_FAST               18 (contribution_to_logprobs)
                      738 LOAD_CONST               1 (None)
                      740 LOAD_CONST               9 (-1)
                      742 BUILD_SLICE              2
                      744 BINARY_SUBSCR
                      754 LOAD_CONST              14 (5)
                      756 KW_NAMES                15
                      758 PRECALL                  2
                      762 CALL                     2
                      772 STORE_FAST              19 (top_contribution_to_logits)
          
-         795         774 LOAD_GLOBAL             27 (NULL + TopK)
+         851         774 LOAD_GLOBAL             27 (NULL + TopK)
                      786 LOAD_FAST               18 (contribution_to_logprobs)
                      788 LOAD_CONST               1 (None)
                      790 LOAD_CONST               9 (-1)
                      792 BUILD_SLICE              2
                      794 BINARY_SUBSCR
                      804 LOAD_CONST              14 (5)
                      806 LOAD_CONST              16 (False)
                      808 KW_NAMES                17
                      810 PRECALL                  3
                      814 CALL                     3
                      824 STORE_FAST              20 (bottom_contribution_to_logits)
          
-         798         826 LOAD_GLOBAL             29 (NULL + eindex)
+         854         826 LOAD_GLOBAL             29 (NULL + eindex)
                      838 LOAD_FAST               18 (contribution_to_logprobs)
                      840 LOAD_CONST               1 (None)
                      842 LOAD_CONST               9 (-1)
                      844 BUILD_SLICE              2
                      846 BINARY_SUBSCR
                      856 UNARY_NEGATIVE
                      858 LOAD_FAST                0 (tokens)
@@ -3883,35 +4126,35 @@
                      868 BUILD_TUPLE              2
                      870 BINARY_SUBSCR
                      880 LOAD_CONST              18 ('seq [seq]')
                      882 PRECALL                  3
                      886 CALL                     3
                      896 STORE_FAST              21 (loss_contribution)
          
-         799         898 LOAD_FAST               21 (loss_contribution)
+         855         898 LOAD_FAST               21 (loss_contribution)
                      900 LOAD_FAST               10 (feats_loss_contribution)
                      902 LOAD_FAST               13 (i)
                      904 LOAD_CONST               1 (None)
                      906 LOAD_CONST               1 (None)
                      908 BUILD_SLICE              2
                      910 BUILD_TUPLE              2
                      912 STORE_SUBSCR
          
-         802         916 LOAD_GLOBAL             31 (NULL + SequenceData)
+         858         916 LOAD_GLOBAL             31 (NULL + SequenceData)
          
-         803         928 LOAD_FAST                0 (tokens)
+         859         928 LOAD_FAST                0 (tokens)
                      930 LOAD_METHOD             16 (squeeze)
                      952 LOAD_CONST               2 (0)
                      954 PRECALL                  1
                      958 CALL                     1
                      968 LOAD_METHOD             17 (tolist)
                      990 PRECALL                  0
                      994 CALL                     0
          
-         804        1004 LOAD_CONST              19 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 804>)
+         860        1004 LOAD_CONST              19 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 860>)
                     1006 MAKE_FUNCTION            0
                     1008 LOAD_FAST                3 (feat_acts)
                     1010 LOAD_CONST               1 (None)
                     1012 LOAD_CONST               1 (None)
                     1014 BUILD_SLICE              2
                     1016 LOAD_FAST               13 (i)
                     1018 BUILD_TUPLE              2
@@ -3919,75 +4162,75 @@
                     1030 LOAD_METHOD             17 (tolist)
                     1052 PRECALL                  0
                     1056 CALL                     0
                     1066 GET_ITER
                     1068 PRECALL                  0
                     1072 CALL                     0
          
-         805        1082 LOAD_CONST              20 (0.0)
+         861        1082 LOAD_CONST              20 (0.0)
                     1084 BUILD_LIST               1
                     1086 LOAD_FAST               21 (loss_contribution)
                     1088 LOAD_METHOD             17 (tolist)
                     1110 PRECALL                  0
                     1114 CALL                     0
                     1124 BINARY_OP                0 (+)
          
-         806        1128 LOAD_FAST               12 (raw_logits)
+         862        1128 LOAD_FAST               12 (raw_logits)
                     1130 LOAD_FAST               13 (i)
                     1132 LOAD_FAST                0 (tokens)
                     1134 LOAD_METHOD             16 (squeeze)
                     1156 LOAD_CONST               2 (0)
                     1158 PRECALL                  1
                     1162 CALL                     1
                     1172 BUILD_TUPLE              2
                     1174 BINARY_SUBSCR
                     1184 LOAD_METHOD             17 (tolist)
                     1206 PRECALL                  0
                     1210 CALL                     0
          
-         807        1220 LOAD_FAST               19 (top_contribution_to_logits)
+         863        1220 LOAD_FAST               19 (top_contribution_to_logits)
                     1222 LOAD_ATTR               18 (indices)
                     1232 LOAD_METHOD             17 (tolist)
                     1254 PRECALL                  0
                     1258 CALL                     0
          
-         808        1268 LOAD_FAST               19 (top_contribution_to_logits)
+         864        1268 LOAD_FAST               19 (top_contribution_to_logits)
                     1270 LOAD_ATTR               19 (values)
                     1280 LOAD_METHOD             17 (tolist)
                     1302 PRECALL                  0
                     1306 CALL                     0
          
-         809        1316 LOAD_FAST               20 (bottom_contribution_to_logits)
+         865        1316 LOAD_FAST               20 (bottom_contribution_to_logits)
                     1318 LOAD_ATTR               18 (indices)
                     1328 LOAD_METHOD             17 (tolist)
                     1350 PRECALL                  0
                     1354 CALL                     0
          
-         810        1364 LOAD_FAST               20 (bottom_contribution_to_logits)
+         866        1364 LOAD_FAST               20 (bottom_contribution_to_logits)
                     1366 LOAD_ATTR               19 (values)
                     1376 LOAD_METHOD             17 (tolist)
                     1398 PRECALL                  0
                     1402 CALL                     0
          
-         802        1412 KW_NAMES                21
+         858        1412 KW_NAMES                21
                     1414 PRECALL                  8
                     1418 CALL                     8
                     1428 LOAD_FAST                2 (sae_vis_data)
                     1430 LOAD_ATTR                1 (feature_data_dict)
                     1440 LOAD_FAST               14 (feat)
                     1442 BINARY_SUBSCR
                     1452 STORE_ATTR              20 (prompt_data)
                     1462 EXTENDED_ARG             1
                     1464 JUMP_BACKWARD          494 (to 478)
          
-         816     >> 1466 BUILD_MAP                0
+         872     >> 1466 BUILD_MAP                0
                     1468 STORE_FAST              22 (scores_dict)
          
-         818        1470 LOAD_GLOBAL             19 (NULL + enumerate)
-                    1482 LOAD_CONST              22 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 818>)
+         874        1470 LOAD_GLOBAL             19 (NULL + enumerate)
+                    1482 LOAD_CONST              22 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 874>)
                     1484 MAKE_FUNCTION            0
                     1486 LOAD_GLOBAL             19 (NULL + enumerate)
                     1498 LOAD_FAST                1 (str_toks)
                     1500 PRECALL                  1
                     1504 CALL                     1
                     1514 GET_ITER
                     1516 PRECALL                  0
@@ -3997,268 +4240,268 @@
                     1544 GET_ITER
                  >> 1546 EXTENDED_ARG             2
                     1548 FOR_ITER               603 (to 2756)
                     1550 UNPACK_SEQUENCE          2
                     1554 STORE_FAST              23 (seq_pos)
                     1556 STORE_FAST              24 (seq_key)
          
-         821        1558 LOAD_GLOBAL             43 (NULL + utils)
+         877        1558 LOAD_GLOBAL             43 (NULL + utils)
                     1570 LOAD_ATTR               22 (to_numpy)
                     1580 LOAD_FAST                3 (feat_acts)
                     1582 LOAD_FAST               23 (seq_pos)
                     1584 BINARY_SUBSCR
                     1594 LOAD_CONST               2 (0)
                     1596 COMPARE_OP               4 (>)
                     1602 PRECALL                  1
                     1606 CALL                     1
                     1616 STORE_FAST              25 (feat_acts_nonzero_filter)
          
-         822        1618 LOAD_GLOBAL             47 (NULL + np)
+         878        1618 LOAD_GLOBAL             47 (NULL + np)
                     1630 LOAD_ATTR               24 (nonzero)
                     1640 LOAD_FAST               25 (feat_acts_nonzero_filter)
                     1642 PRECALL                  1
                     1646 CALL                     1
                     1656 LOAD_CONST               2 (0)
                     1658 BINARY_SUBSCR
                     1668 LOAD_METHOD             17 (tolist)
                     1690 PRECALL                  0
                     1694 CALL                     0
                     1704 STORE_FAST              26 (feat_acts_nonzero_locations)
          
-         823        1706 LOAD_FAST                3 (feat_acts)
+         879        1706 LOAD_FAST                3 (feat_acts)
                     1708 LOAD_FAST               23 (seq_pos)
                     1710 LOAD_FAST               25 (feat_acts_nonzero_filter)
                     1712 BUILD_TUPLE              2
                     1714 BINARY_SUBSCR
                     1724 STORE_FAST              27 (_feat_acts)
          
-         824        1726 LOAD_GLOBAL             47 (NULL + np)
+         880        1726 LOAD_GLOBAL             47 (NULL + np)
                     1738 LOAD_ATTR               25 (array)
                     1748 LOAD_FAST                7 (feature_idx)
                     1750 PRECALL                  1
                     1754 CALL                     1
                     1764 LOAD_FAST               25 (feat_acts_nonzero_filter)
                     1766 BINARY_SUBSCR
                     1776 STORE_FAST              28 (_feature_idx)
          
-         826        1778 LOAD_FAST               25 (feat_acts_nonzero_filter)
+         882        1778 LOAD_FAST               25 (feat_acts_nonzero_filter)
                     1780 LOAD_METHOD             26 (sum)
                     1802 PRECALL                  0
                     1806 CALL                     0
                     1816 LOAD_CONST               2 (0)
                     1818 COMPARE_OP               4 (>)
                     1824 POP_JUMP_FORWARD_IF_FALSE   249 (to 2324)
          
-         827        1826 LOAD_GLOBAL             55 (NULL + min)
+         883        1826 LOAD_GLOBAL             55 (NULL + min)
                     1838 LOAD_FAST                8 (num_top_features)
                     1840 LOAD_FAST               27 (_feat_acts)
                     1842 LOAD_METHOD             28 (numel)
                     1864 PRECALL                  0
                     1868 CALL                     0
                     1878 PRECALL                  2
                     1882 CALL                     2
                     1892 STORE_FAST              29 (k)
          
-         831        1894 LOAD_GLOBAL             27 (NULL + TopK)
+         887        1894 LOAD_GLOBAL             27 (NULL + TopK)
                     1906 LOAD_FAST               27 (_feat_acts)
                     1908 LOAD_FAST               29 (k)
                     1910 LOAD_CONST              10 (True)
                     1912 KW_NAMES                17
                     1914 PRECALL                  3
                     1918 CALL                     3
                     1928 STORE_FAST              30 (act_size_topk)
          
-         832        1930 LOAD_FAST               28 (_feature_idx)
+         888        1930 LOAD_FAST               28 (_feature_idx)
                     1932 LOAD_FAST               30 (act_size_topk)
                     1934 LOAD_ATTR               18 (indices)
                     1944 BINARY_SUBSCR
                     1954 LOAD_METHOD             17 (tolist)
                     1976 PRECALL                  0
                     1980 CALL                     0
                     1990 STORE_FAST              31 (top_features)
          
-         833        1992 LOAD_CONST              23 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 833>)
+         889        1992 LOAD_CONST              23 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 889>)
                     1994 MAKE_FUNCTION            0
                     1996 LOAD_FAST               30 (act_size_topk)
                     1998 LOAD_ATTR               19 (values)
                     2008 GET_ITER
                     2010 PRECALL                  0
                     2014 CALL                     0
                     2024 STORE_FAST              32 (formatted_scores)
          
-         834        2026 LOAD_FAST               31 (top_features)
+         890        2026 LOAD_FAST               31 (top_features)
                     2028 LOAD_FAST               32 (formatted_scores)
                     2030 BUILD_TUPLE              2
                     2032 LOAD_FAST               22 (scores_dict)
                     2034 LOAD_CONST              24 ('act_size|')
                     2036 LOAD_FAST               24 (seq_key)
                     2038 FORMAT_VALUE             0
                     2040 BUILD_STRING             2
                     2042 STORE_SUBSCR
          
-         840        2046 LOAD_FAST                2 (sae_vis_data)
+         896        2046 LOAD_FAST                2 (sae_vis_data)
                     2048 LOAD_ATTR               29 (feature_act_quantiles)
                     2058 LOAD_METHOD             30 (get_quantile)
                     2080 LOAD_FAST               27 (_feat_acts)
                     2082 LOAD_FAST               26 (feat_acts_nonzero_locations)
                     2084 PRECALL                  2
                     2088 CALL                     2
                     2098 UNPACK_SEQUENCE          2
                     2102 STORE_FAST              33 (act_quantile)
                     2104 STORE_DEREF             40 (act_precision)
          
-         841        2106 LOAD_GLOBAL             27 (NULL + TopK)
+         897        2106 LOAD_GLOBAL             27 (NULL + TopK)
                     2118 LOAD_FAST               33 (act_quantile)
                     2120 LOAD_FAST               29 (k)
                     2122 LOAD_CONST              10 (True)
                     2124 KW_NAMES                17
                     2126 PRECALL                  3
                     2130 CALL                     3
                     2140 STORE_FAST              34 (act_quantile_topk)
          
-         842        2142 LOAD_CLOSURE            40 (act_precision)
+         898        2142 LOAD_CLOSURE            40 (act_precision)
                     2144 BUILD_TUPLE              1
-                    2146 LOAD_CONST              25 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 842>)
+                    2146 LOAD_CONST              25 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 898>)
                     2148 MAKE_FUNCTION            8 (closure)
                     2150 LOAD_FAST               34 (act_quantile_topk)
                     2152 LOAD_ATTR               18 (indices)
                     2162 GET_ITER
                     2164 PRECALL                  0
                     2168 CALL                     0
                     2178 STORE_FAST              35 (act_formatting)
          
-         843        2180 LOAD_FAST               28 (_feature_idx)
+         899        2180 LOAD_FAST               28 (_feature_idx)
                     2182 LOAD_FAST               34 (act_quantile_topk)
                     2184 LOAD_ATTR               18 (indices)
                     2194 BINARY_SUBSCR
                     2204 LOAD_METHOD             17 (tolist)
                     2226 PRECALL                  0
                     2230 CALL                     0
                     2240 STORE_FAST              31 (top_features)
          
-         844        2242 LOAD_CONST              26 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 844>)
+         900        2242 LOAD_CONST              26 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 900>)
                     2244 MAKE_FUNCTION            0
                     2246 LOAD_GLOBAL             63 (NULL + zip)
                     2258 LOAD_FAST               34 (act_quantile_topk)
                     2260 LOAD_ATTR               19 (values)
                     2270 LOAD_FAST               35 (act_formatting)
                     2272 PRECALL                  2
                     2276 CALL                     2
                     2286 GET_ITER
                     2288 PRECALL                  0
                     2292 CALL                     0
                     2302 STORE_FAST              32 (formatted_scores)
          
-         845        2304 LOAD_FAST               31 (top_features)
+         901        2304 LOAD_FAST               31 (top_features)
                     2306 LOAD_FAST               32 (formatted_scores)
                     2308 BUILD_TUPLE              2
                     2310 LOAD_FAST               22 (scores_dict)
                     2312 LOAD_CONST              27 ('act_quantile|')
                     2314 LOAD_FAST               24 (seq_key)
                     2316 FORMAT_VALUE             0
                     2318 BUILD_STRING             2
                     2320 STORE_SUBSCR
          
-         848     >> 2324 LOAD_FAST               23 (seq_pos)
+         904     >> 2324 LOAD_FAST               23 (seq_pos)
                     2326 LOAD_CONST               2 (0)
                     2328 COMPARE_OP               2 (==)
                     2334 POP_JUMP_FORWARD_IF_FALSE     2 (to 2340)
          
-         849        2336 EXTENDED_ARG             1
+         905        2336 EXTENDED_ARG             1
                     2338 JUMP_BACKWARD          397 (to 1546)
          
-         852     >> 2340 LOAD_GLOBAL             43 (NULL + utils)
+         908     >> 2340 LOAD_GLOBAL             43 (NULL + utils)
                     2352 LOAD_ATTR               22 (to_numpy)
                     2362 LOAD_FAST                3 (feat_acts)
                     2364 LOAD_FAST               23 (seq_pos)
                     2366 LOAD_CONST               6 (1)
                     2368 BINARY_OP               10 (-)
                     2372 BINARY_SUBSCR
                     2382 LOAD_CONST               2 (0)
                     2384 COMPARE_OP               4 (>)
                     2390 PRECALL                  1
                     2394 CALL                     1
                     2404 STORE_FAST              36 (prev_feat_acts_nonzero_filter)
          
-         853        2406 LOAD_FAST               10 (feats_loss_contribution)
+         909        2406 LOAD_FAST               10 (feats_loss_contribution)
                     2408 LOAD_FAST               36 (prev_feat_acts_nonzero_filter)
                     2410 LOAD_FAST               23 (seq_pos)
                     2412 LOAD_CONST               6 (1)
                     2414 BINARY_OP               10 (-)
                     2418 BUILD_TUPLE              2
                     2420 BINARY_SUBSCR
                     2430 STORE_FAST              37 (_loss_contribution)
          
-         854        2432 LOAD_GLOBAL             47 (NULL + np)
+         910        2432 LOAD_GLOBAL             47 (NULL + np)
                     2444 LOAD_ATTR               25 (array)
                     2454 LOAD_FAST                7 (feature_idx)
                     2456 PRECALL                  1
                     2460 CALL                     1
                     2470 LOAD_FAST               36 (prev_feat_acts_nonzero_filter)
                     2472 BINARY_SUBSCR
                     2482 STORE_FAST              38 (_feature_idx_prev)
          
-         856        2484 LOAD_FAST               36 (prev_feat_acts_nonzero_filter)
+         912        2484 LOAD_FAST               36 (prev_feat_acts_nonzero_filter)
                     2486 LOAD_METHOD             26 (sum)
                     2508 PRECALL                  0
                     2512 CALL                     0
                     2522 LOAD_CONST               2 (0)
                     2524 COMPARE_OP               4 (>)
                     2530 POP_JUMP_FORWARD_IF_FALSE   110 (to 2752)
          
-         857        2532 LOAD_GLOBAL             55 (NULL + min)
+         913        2532 LOAD_GLOBAL             55 (NULL + min)
                     2544 LOAD_FAST                8 (num_top_features)
                     2546 LOAD_FAST               37 (_loss_contribution)
                     2548 LOAD_METHOD             28 (numel)
                     2570 PRECALL                  0
                     2574 CALL                     0
                     2584 PRECALL                  2
                     2588 CALL                     2
                     2598 STORE_FAST              29 (k)
          
-         862        2600 LOAD_GLOBAL             27 (NULL + TopK)
+         918        2600 LOAD_GLOBAL             27 (NULL + TopK)
                     2612 LOAD_FAST               37 (_loss_contribution)
                     2614 LOAD_FAST               29 (k)
                     2616 LOAD_CONST              16 (False)
                     2618 KW_NAMES                17
                     2620 PRECALL                  3
                     2624 CALL                     3
                     2634 STORE_FAST              39 (loss_contribution_topk)
          
-         863        2636 LOAD_FAST               38 (_feature_idx_prev)
+         919        2636 LOAD_FAST               38 (_feature_idx_prev)
                     2638 LOAD_FAST               39 (loss_contribution_topk)
                     2640 LOAD_ATTR               18 (indices)
                     2650 BINARY_SUBSCR
                     2660 LOAD_METHOD             17 (tolist)
                     2682 PRECALL                  0
                     2686 CALL                     0
                     2696 STORE_FAST              31 (top_features)
          
-         864        2698 LOAD_CONST              28 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 864>)
+         920        2698 LOAD_CONST              28 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_fetching_fns.py", line 920>)
                     2700 MAKE_FUNCTION            0
                     2702 LOAD_FAST               39 (loss_contribution_topk)
                     2704 LOAD_ATTR               19 (values)
                     2714 GET_ITER
                     2716 PRECALL                  0
                     2720 CALL                     0
                     2730 STORE_FAST              32 (formatted_scores)
          
-         865        2732 LOAD_FAST               31 (top_features)
+         921        2732 LOAD_FAST               31 (top_features)
                     2734 LOAD_FAST               32 (formatted_scores)
                     2736 BUILD_TUPLE              2
                     2738 LOAD_FAST               22 (scores_dict)
                     2740 LOAD_CONST              29 ('loss_effect|')
                     2742 LOAD_FAST               24 (seq_key)
                     2744 FORMAT_VALUE             0
                     2746 BUILD_STRING             2
                     2748 STORE_SUBSCR
                  >> 2752 EXTENDED_ARG             2
                     2754 JUMP_BACKWARD          605 (to 1546)
          
-         866     >> 2756 LOAD_FAST               22 (scores_dict)
+         922     >> 2756 LOAD_FAST               22 (scores_dict)
                     2758 RETURN_VALUE
          consts
             '\n    Gets data needed to create the sequences in the prompt-centric vis (displaying dashboards for the most relevant\n    features on a prompt).\n    \n    This function exists so that prompt dashboards can be generated without using our AutoEncoder or\n    TransformerLens(Wrapper) classes. \n    \n    Args:\n        tokens: Int[Tensor, "batch seq"]\n            The tokens we\'ll be using to get the feature activations. Note that we might not be using all of them; the\n            number used is determined by `fvp.total_batch_size`.\n\n        str_toks:  list[str]\n            The tokens as a list of strings, so that they can be visualized in HTML.\n\n        sae_vis_data: SaeVisData\n             The object storing all data for each feature. We\'ll set each `feature_data.prompt_data` to the\n             data we get from `prompt`.\n\n        feat_acts: Float[Tensor, "seq feats"]\n            The activations values of the features across the sequence.\n\n        feature_resid_dir: Float[Tensor, "feats d_model"]\n            The directions that each feature writes to the residual stream.\n\n        resid_post: Float[Tensor, "seq d_model"]\n            The activations of the final layer of the model before the unembed. \n        \n        W_U: Float[Tensor, "d_model d_vocab"]\n            The model\'s unembed weights for the logit lens.\n\n        feature_idx: list[int] or None\n            The features we\'re actually computing. These might just be a subset of the model\'s full features.\n            \n        num_top_features: int\n            The number of top features to display in this view, for any given metric.\n\n    Returns:\n        scores_dict: dict[str, tuple[list[int], list[str]]]\n            A dictionary mapping keys like "act_quantile|\'django\' (0)" to a tuple of lists, where the first list is the\n            feature indices, and the second list is the string-formatted values of the scores.\n\n    As well as returning this dictionary, this function will also set `FeatureData.prompt_data` for each feature in\n    `sae_vis_data` (this is necessary for getting the prompts in the prompt-centric vis). Note this design choice could\n    have been done differently (i.e. have this function return a list of the prompt data for each feature). I chose this\n    way because it means the FeatureData._get_html_data_prompt_centric can work fundamentally the same way as \n    FeatureData._get_html_data_feature_centric, rather than treating the prompt data object as a different kind of\n    component in the vis.\n    '
             None
             0
             'The number of features in feature_resid_dir ('
             ') does not match the number of feature indices ('
@@ -4280,15 +4523,15 @@
                argcount  : 1
                nlocals   : 2
                stacksize : 6
                flags     : 19
                code
                   0x970067007c005d127d017401000000000000000000007c016400a60200
                   00ab02000000000000000091028c135300
-               804           0 RESUME                   0
+               860           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                18 (to 44)
                              8 STORE_FAST               1 (f)
                             10 LOAD_GLOBAL              1 (NULL + round)
                             22 LOAD_FAST                1 (f)
                             24 LOAD_CONST               0 (4)
@@ -4299,29 +4542,29 @@
                        >>   44 RETURN_VALUE
                consts
                   4
                names      ('round',)
                varnames   ('.0', 'f')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 804
+               firstlineno 860
                lnotab 0x
             0.0
             ('token_ids', 'feat_acts', 'loss_contribution', 'token_logits', 'top_token_ids', 'top_logits', 'bottom_token_ids', 'bottom_logits')
             code
                argcount  : 1
                nlocals   : 3
                stacksize : 6
                flags     : 19
                code
                   0x970067007c005d0d5c0200007d017d027c029b0264007c019b0064019d
                   0491028c0e5300
-               818           0 RESUME                   0
+               874           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                13 (to 34)
                              8 UNPACK_SEQUENCE          2
                             12 STORE_FAST               1 (i)
                             14 STORE_FAST               2 (t)
                             16 LOAD_FAST                2 (t)
@@ -4337,25 +4580,25 @@
                consts
                   ' ('
                   ')'
                names      ()
                varnames   ('.0', 'i', 't')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 818
+               firstlineno 874
                lnotab 0x
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 19
                code 0x970067007c005d067d017c0164009b0491028c075300
-               833           0 RESUME                   0
+               889           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                 6 (to 20)
                              8 STORE_FAST               1 (v)
                             10 LOAD_FAST                1 (v)
                             12 LOAD_CONST               0 ('.3f')
                             14 FORMAT_VALUE             4 (with format)
@@ -4364,30 +4607,30 @@
                        >>   20 RETURN_VALUE
                consts
                   '.3f'
                names      ()
                varnames   ('.0', 'v')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 833
+               firstlineno 889
                lnotab 0x
             'act_size|'
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 5
                flags     : 19
                code
                   0x9501970067007c005d117d01640089027c011900000000000000000064
                   017a0a00009b0064029d0391028c125300
                              0 COPY_FREE_VARS           1
                
-               842           2 RESUME                   0
+               898           2 RESUME                   0
                              4 BUILD_LIST               0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                17 (to 44)
                             10 STORE_FAST               1 (i)
                             12 LOAD_CONST               0 ('.')
                             14 LOAD_DEREF               2 (act_precision)
                             16 LOAD_FAST                1 (i)
@@ -4404,27 +4647,27 @@
                   '.'
                   2
                   '%'
                names      ()
                varnames   ('.0', 'i')
                freevars   ('act_precision',)
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 842
+               firstlineno 898
                lnotab 0x
             code
                argcount  : 1
                nlocals   : 3
                stacksize : 4
                flags     : 19
                code
                   0x970067007c005d0a5c0200007d017d027c017c029b009b0491028c0b53
                   00
-               844           0 RESUME                   0
+               900           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                10 (to 28)
                              8 UNPACK_SEQUENCE          2
                             12 STORE_FAST               1 (v)
                             14 STORE_FAST               2 (f)
                             16 LOAD_FAST                1 (v)
@@ -4435,26 +4678,26 @@
                             26 JUMP_BACKWARD           11 (to 6)
                        >>   28 RETURN_VALUE
                consts
                names      ()
                varnames   ('.0', 'v', 'f')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 844
+               firstlineno 900
                lnotab 0x
             'act_quantile|'
             code
                argcount  : 1
                nlocals   : 2
                stacksize : 4
                flags     : 19
                code 0x970067007c005d067d017c0164009b0491028c075300
-               864           0 RESUME                   0
+               920           0 RESUME                   0
                              2 BUILD_LIST               0
                              4 LOAD_FAST                0 (.0)
                        >>    6 FOR_ITER                 6 (to 20)
                              8 STORE_FAST               1 (v)
                             10 LOAD_FAST                1 (v)
                             12 LOAD_CONST               0 ('+.3f')
                             14 FORMAT_VALUE             4 (with format)
@@ -4463,26 +4706,26 @@
                        >>   20 RETURN_VALUE
                consts
                   '+.3f'
                names      ()
                varnames   ('.0', 'v')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
                name       '<listcomp>'
-               firstlineno 864
+               firstlineno 920
                lnotab 0x
             'loss_effect|'
          names      ('list', 'feature_data_dict', 'keys', 'len', 'shape', 'torch', 'empty', 'device', 'std', 'enumerate', 'einops', 'einsum', 'log_softmax', 'TopK', 'eindex', 'SequenceData', 'squeeze', 'tolist', 'indices', 'values', 'prompt_data', 'utils', 'to_numpy', 'np', 'nonzero', 'array', 'sum', 'min', 'numel', 'feature_act_quantiles', 'get_quantile', 'zip')
          varnames   ('tokens', 'str_toks', 'sae_vis_data', 'feat_acts', 'feature_resid_dir', 'resid_post', 'W_U', 'feature_idx', 'num_top_features', 'n_feats', 'feats_loss_contribution', 'orig_logits', 'raw_logits', 'i', 'feat', 'resid_post_feature_effect', 'new_resid_post', 'new_logits', 'contribution_to_logprobs', 'top_contribution_to_logits', 'bottom_contribution_to_logits', 'loss_contribution', 'scores_dict', 'seq_pos', 'seq_key', 'feat_acts_nonzero_filter', 'feat_acts_nonzero_locations', '_feat_acts', '_feature_idx', 'k', 'act_size_topk', 'top_features', 'formatted_scores', 'act_quantile', 'act_quantile_topk', 'act_formatting', 'prev_feat_acts_nonzero_filter', '_loss_contribution', '_feature_idx_prev', 'loss_contribution_topk')
          freevars   ()
          cellvars   ('act_precision',)
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
          name       'parse_prompt_data'
-         firstlineno 707
+         firstlineno 763
          lnotab
             0x043d04014c011e015a025a0256033a010a022a054c030a013a035a0132
             013403480112030c014c014e012e015c0130013001300130f8360e040258
             033c015801140134023001440424013e01220114063c01240126013e013e
             0114030c01040342011a0134023001440524013e0122011801
       'prompt'
       code
@@ -4522,60 +4765,60 @@
             005c0200007d0e7d0f7c0ea01b0000000000000000000000000000000000
             0000006409a6010000ab0100000000000000007d0e743900000000000000
             0000007c0f7c047c05a6030000ab030000000000000000a01b0000000000
             0000000000000000000000000000006409a6010000ab0100000000000000
             007d10743b000000000000000000007c097c087c007c107c0d7c0e7c066a
             1e00000000000000007c037c02ac0aa6090000ab0900000000000000007d
             117c115300
-         869           0 RESUME                   0
+         925           0 RESUME                   0
          
-         896           2 LOAD_GLOBAL              1 (NULL + list)
+         952           2 LOAD_GLOBAL              1 (NULL + list)
                       14 LOAD_FAST                0 (sae_vis_data)
                       16 LOAD_ATTR                1 (feature_data_dict)
                       26 LOAD_METHOD              2 (keys)
                       48 PRECALL                  0
                       52 CALL                     0
                       62 PRECALL                  1
                       66 CALL                     1
                       76 STORE_FAST               3 (feature_idx)
          
-         897          78 LOAD_GLOBAL              7 (NULL + torch)
+         953          78 LOAD_GLOBAL              7 (NULL + torch)
                       90 LOAD_ATTR                4 (tensor)
                      100 LOAD_FAST                3 (feature_idx)
                      102 LOAD_GLOBAL             10 (device)
                      114 KW_NAMES                 1
                      116 PRECALL                  2
                      120 CALL                     2
                      130 STORE_FAST               4 (feature_idx_tensor)
          
-         898         132 LOAD_FAST                0 (sae_vis_data)
+         954         132 LOAD_FAST                0 (sae_vis_data)
                      134 LOAD_ATTR                6 (encoder)
                      144 STORE_FAST               5 (encoder)
                      146 LOAD_GLOBAL             15 (NULL + isinstance)
                      158 LOAD_FAST                5 (encoder)
                      160 LOAD_GLOBAL             16 (AutoEncoder)
                      172 PRECALL                  2
                      176 CALL                     2
                      186 POP_JUMP_FORWARD_IF_TRUE     2 (to 192)
                      188 LOAD_ASSERTION_ERROR
                      190 RAISE_VARARGS            1
          
-         899     >>  192 LOAD_FAST                0 (sae_vis_data)
+         955     >>  192 LOAD_FAST                0 (sae_vis_data)
                      194 LOAD_ATTR                9 (model)
                      204 STORE_FAST               6 (model)
                      206 LOAD_GLOBAL             15 (NULL + isinstance)
                      218 LOAD_FAST                6 (model)
                      220 LOAD_GLOBAL             20 (HookedTransformer)
                      232 PRECALL                  2
                      236 CALL                     2
                      246 POP_JUMP_FORWARD_IF_TRUE     2 (to 252)
                      248 LOAD_ASSERTION_ERROR
                      250 RAISE_VARARGS            1
          
-         900     >>  252 LOAD_FAST                0 (sae_vis_data)
+         956     >>  252 LOAD_FAST                0 (sae_vis_data)
                      254 LOAD_ATTR               11 (cfg)
                      264 STORE_FAST               7 (cfg)
                      266 LOAD_GLOBAL             15 (NULL + isinstance)
                      278 LOAD_FAST                7 (cfg)
                      280 LOAD_ATTR               12 (hook_point)
                      290 LOAD_GLOBAL             26 (str)
                      302 PRECALL                  2
@@ -4588,78 +4831,78 @@
                      334 FORMAT_VALUE             2 (repr)
                      336 LOAD_CONST               3 (', expected a string')
                      338 BUILD_STRING             3
                      340 PRECALL                  0
                      344 CALL                     0
                      354 RAISE_VARARGS            1
          
-         902     >>  356 LOAD_FAST                6 (model)
+         958     >>  356 LOAD_FAST                6 (model)
                      358 LOAD_ATTR               14 (tokenizer)
                      368 LOAD_METHOD             15 (tokenize)
                      390 LOAD_FAST                1 (prompt)
                      392 PRECALL                  1
                      396 CALL                     1
                      406 STORE_FAST               8 (str_toks)
          
-         903         408 LOAD_FAST                6 (model)
+         959         408 LOAD_FAST                6 (model)
                      410 LOAD_ATTR               14 (tokenizer)
                      420 LOAD_METHOD             16 (encode)
                      442 LOAD_FAST                1 (prompt)
                      444 LOAD_CONST               4 ('pt')
                      446 KW_NAMES                 5
                      448 PRECALL                  2
                      452 CALL                     2
                      462 LOAD_METHOD             17 (to)
                      484 LOAD_GLOBAL             10 (device)
                      496 PRECALL                  1
                      500 CALL                     1
                      510 STORE_FAST               9 (tokens)
          
-         904         512 LOAD_GLOBAL             15 (NULL + isinstance)
+         960         512 LOAD_GLOBAL             15 (NULL + isinstance)
                      524 LOAD_FAST                9 (tokens)
                      526 LOAD_GLOBAL              6 (torch)
                      538 LOAD_ATTR               18 (Tensor)
                      548 PRECALL                  2
                      552 CALL                     2
                      562 POP_JUMP_FORWARD_IF_TRUE     2 (to 568)
                      564 LOAD_ASSERTION_ERROR
                      566 RAISE_VARARGS            1
          
-         906     >>  568 LOAD_GLOBAL             39 (NULL + TransformerLensWrapper)
+         962     >>  568 LOAD_GLOBAL             39 (NULL + TransformerLensWrapper)
                      580 LOAD_FAST                6 (model)
                      582 LOAD_FAST                7 (cfg)
                      584 LOAD_ATTR               12 (hook_point)
                      594 PRECALL                  2
                      598 CALL                     2
                      608 STORE_FAST              10 (model_wrapped)
          
-         908         610 LOAD_FAST                5 (encoder)
+         964         610 LOAD_FAST                5 (encoder)
                      612 LOAD_ATTR               20 (W_enc)
                      622 LOAD_CONST               6 (None)
                      624 LOAD_CONST               6 (None)
                      626 BUILD_SLICE              2
                      628 LOAD_FAST                3 (feature_idx)
                      630 BUILD_TUPLE              2
                      632 BINARY_SUBSCR
                      642 STORE_FAST              11 (feature_act_dir)
          
-         909         644 LOAD_FAST                5 (encoder)
+         965         644 LOAD_FAST                5 (encoder)
                      646 LOAD_ATTR               21 (W_dec)
                      656 LOAD_FAST                3 (feature_idx)
                      658 BINARY_SUBSCR
                      668 STORE_FAST              12 (feature_out_dir)
          
-         910         670 LOAD_GLOBAL             45 (NULL + to_resid_dir)
+         966         670 LOAD_GLOBAL             45 (NULL + to_resid_dir)
                      682 LOAD_FAST               12 (feature_out_dir)
                      684 LOAD_FAST               10 (model_wrapped)
                      686 PRECALL                  2
                      690 CALL                     2
                      700 STORE_FAST              13 (feature_resid_dir)
          
-         911         702 LOAD_FAST               11 (feature_act_dir)
+         967         702 LOAD_FAST               11 (feature_act_dir)
                      704 LOAD_ATTR               23 (T)
                      714 LOAD_ATTR               24 (shape)
                      724 LOAD_FAST               12 (feature_out_dir)
                      726 LOAD_ATTR               24 (shape)
                      736 SWAP                     2
                      738 COPY                     2
                      740 COMPARE_OP               2 (==)
@@ -4675,71 +4918,71 @@
                      800 COMPARE_OP               2 (==)
                      806 POP_JUMP_FORWARD_IF_TRUE     4 (to 816)
                      808 JUMP_FORWARD             1 (to 812)
                  >>  810 POP_TOP
                  >>  812 LOAD_ASSERTION_ERROR
                      814 RAISE_VARARGS            1
          
-         915     >>  816 PUSH_NULL
+         971     >>  816 PUSH_NULL
                      818 LOAD_FAST               10 (model_wrapped)
                      820 LOAD_FAST                9 (tokens)
                      822 LOAD_CONST               7 (False)
                      824 KW_NAMES                 8
                      826 PRECALL                  2
                      830 CALL                     2
                      840 UNPACK_SEQUENCE          2
                      844 STORE_FAST              14 (resid_post)
                      846 STORE_FAST              15 (act_post)
          
-         916         848 LOAD_FAST               14 (resid_post)
+         972         848 LOAD_FAST               14 (resid_post)
                      850 LOAD_METHOD             27 (squeeze)
                      872 LOAD_CONST               9 (0)
                      874 PRECALL                  1
                      878 CALL                     1
                      888 STORE_FAST              14 (resid_post)
          
-         917         890 LOAD_GLOBAL             57 (NULL + compute_feat_acts)
+         973         890 LOAD_GLOBAL             57 (NULL + compute_feat_acts)
                      902 LOAD_FAST               15 (act_post)
                      904 LOAD_FAST                4 (feature_idx_tensor)
                      906 LOAD_FAST                5 (encoder)
                      908 PRECALL                  3
                      912 CALL                     3
                      922 LOAD_METHOD             27 (squeeze)
                      944 LOAD_CONST               9 (0)
                      946 PRECALL                  1
                      950 CALL                     1
                      960 STORE_FAST              16 (feat_acts)
          
-         921         962 LOAD_GLOBAL             59 (NULL + parse_prompt_data)
+         977         962 LOAD_GLOBAL             59 (NULL + parse_prompt_data)
          
-         922         974 LOAD_FAST                9 (tokens)
+         978         974 LOAD_FAST                9 (tokens)
          
-         923         976 LOAD_FAST                8 (str_toks)
+         979         976 LOAD_FAST                8 (str_toks)
          
-         924         978 LOAD_FAST                0 (sae_vis_data)
+         980         978 LOAD_FAST                0 (sae_vis_data)
          
-         925         980 LOAD_FAST               16 (feat_acts)
+         981         980 LOAD_FAST               16 (feat_acts)
          
-         926         982 LOAD_FAST               13 (feature_resid_dir)
+         982         982 LOAD_FAST               13 (feature_resid_dir)
          
-         927         984 LOAD_FAST               14 (resid_post)
+         983         984 LOAD_FAST               14 (resid_post)
          
-         928         986 LOAD_FAST                6 (model)
+         984         986 LOAD_FAST                6 (model)
                      988 LOAD_ATTR               30 (W_U)
          
-         929         998 LOAD_FAST                3 (feature_idx)
+         985         998 LOAD_FAST                3 (feature_idx)
          
-         930        1000 LOAD_FAST                2 (num_top_features)
+         986        1000 LOAD_FAST                2 (num_top_features)
          
-         921        1002 KW_NAMES                10
+         977        1002 KW_NAMES                10
                     1004 PRECALL                  9
                     1008 CALL                     9
                     1018 STORE_FAST              17 (scores_dict)
          
-         933        1020 LOAD_FAST               17 (scores_dict)
+         989        1020 LOAD_FAST               17 (scores_dict)
                     1022 RETURN_VALUE
          consts
             '\n    Gets data that will be used to create the sequences in the prompt-centric HTML visualisation, i.e. an object of\n    type SequenceData for each of our features.\n    \n    Args:\n        sae_vis_data:     The object storing all data for each feature. We\'ll set each `feature_data.prompt_data` to the\n                          data we get from `prompt`.\n        prompt:           The prompt we\'ll be using to get the feature activations.#\n        num_top_features: The number of top features we\'ll be getting data for.\n\n    Returns:\n        scores_dict:      A dictionary mapping keys like "act_quantile|0" to a tuple of lists, where the first list is\n                          the feature indices, and the second list is the string-formatted values of the scores.\n\n    As well as returning this dictionary, this function will also set `FeatureData.prompt_data` for each feature in\n    `sae_vis_data`. This is because the prompt-centric vis will call `FeatureData._get_html_data_prompt_centric` on each\n    feature data object, so it\'s useful to have all the data in once place! Even if this will get overwritten next\n    time we call `get_prompt_data` for this same `sae_vis_data` object.\n    '
             ('device',)
             'cfg.hook_point='
             ', expected a string'
             'pt'
@@ -4749,37 +4992,37 @@
             ('return_logits',)
             0
             ('tokens', 'str_toks', 'sae_vis_data', 'feat_acts', 'feature_resid_dir', 'resid_post', 'W_U', 'feature_idx', 'num_top_features')
          names      ('list', 'feature_data_dict', 'keys', 'torch', 'tensor', 'device', 'encoder', 'isinstance', 'AutoEncoder', 'model', 'HookedTransformer', 'cfg', 'hook_point', 'str', 'tokenizer', 'tokenize', 'encode', 'to', 'Tensor', 'TransformerLensWrapper', 'W_enc', 'W_dec', 'to_resid_dir', 'T', 'shape', 'len', 'd_in', 'squeeze', 'compute_feat_acts', 'parse_prompt_data', 'W_U')
          varnames   ('sae_vis_data', 'prompt', 'num_top_features', 'feature_idx', 'feature_idx_tensor', 'encoder', 'model', 'cfg', 'str_toks', 'tokens', 'model_wrapped', 'feature_act_dir', 'feature_out_dir', 'feature_resid_dir', 'resid_post', 'act_post', 'feat_acts', 'scores_dict')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
          name       'get_prompt_data'
-         firstlineno 869
+         firstlineno 925
          lnotab
             0x021b4c0136013c013c0168023401680138022a0222011a012001720420
             012a0148040c010201020102010201020102010c01020102f7120c
-      (None, None, None)
       (None, None, None, None)
+      (None, None, None, None, None)
       (None,)
       (None, 10)
    names      ('time', 'numpy', 'np', 'math', 'torch', 'Tensor', 'eindex', 'typing', 'Optional', 'Union', 'torch.nn.functional', 'nn', 'functional', 'F', 'einops', 'jaxtyping', 'Float', 'Int', 'rich', 'print', 'rprint', 'rich.table', 'Table', 'collections', 'defaultdict', 'transformer_lens', 'utils', 'HookedTransformer', 'tqdm.auto', 'tqdm', 'ndarray', 'Arr', 'sae_vis.model_fns', 'AutoEncoder', 'TransformerLensWrapper', 'to_resid_dir', 'sae_vis.utils_fns', 'k_largest_indices', 'random_range_indices', 'QuantileCalculator', 'TopK', 'get_device', 'BatchedCorrCoef', 'sae_vis.data_storing_fns', 'SequenceData', 'SequenceGroupData', 'SequenceMultiGroupData', 'FeatureTablesData', 'FeatureData', 'SaeVisData', 'ActsHistogramData', 'LogitsHistogramData', 'LogitsTableData', 'sae_vis.data_config_classes', 'SaeVisLayoutConfig', 'SaeVisConfig', 'SequencesConfig', 'device', 'compute_feat_acts', 'inference_mode', 'int', 'list', 'tuple', 'dict', 'str', 'float', 'parse_feature_data', '_get_feature_data', 'get_feature_data', 'get_sequences_data', 'parse_prompt_data', 'get_prompt_data')
    varnames   ()
    freevars   ()
    cellvars   ()
-   filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
+   filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_fetching_fns.py'
    name       '<module>'
    firstlineno 1
    lnotab
       0x00ff020108010801080108010c010c0110011201080110010c010c010c
-      0110010c020e02140520082c0b1406140a0201020102fa040112ff020212
-      fe020302fd02040efc02050efb02060efa020712f9083c1c090201020102
-      0102f5040112ff02021efe020312fd020412fc020512fb020612fa020702
-      f902081ef802090ef7020a0ef6020b1af5020c22f406ff0e01027f005c1c
-      0802f9040102ff02020efe020302fd020412fc02051efb020602fa02071a
-      f9020822f806ff0e01027f00071c0602fb040102ff020202fe020312fd02
-      0402fc02050efb020602fa06ff0e0102571c01020112ff020212fe020312
-      fd020412fc020512fb020612fa020702f9020802f806ff0e01027f00151c
-      09020102f7040112ff02020efe020302fd020412fc020512fb020612fa02
-      0712f902081af8020902f7020a3af606ff0e01027f00221c01020102ff02
-      0202fe020302fd02043afc06ff0e01
+      0110010c020e02140520082c0b1406140a02010201020102f9040112ff02
+      0212fe020302fd02040efc02050efb02060efa02070ef9020812f808461c
+      09020102010201020102f4040112ff02021efe020312fd020412fc020512
+      fb020612fa020702f902081ef802090ef7020a0ef6020b0ef5020c1af402
+      0d22f306ff0e01027f007f00011c0802f9040102ff02020efe020302fd02
+      0412fc02051efb020602fa02071af9020822f806ff0e01027f00111c0602
+      fb040102ff020202fe020312fd020402fc02050efb020602fa06ff0e0102
+      571c01020112ff020212fe020312fd020412fc020512fb020612fa020702
+      f9020802f806ff0e01027f00151c09020102f7040112ff02020efe020302
+      fd020412fc020512fb020612fa020712f902081af8020902f7020a3af606
+      ff0e01027f00221c01020102ff020202fe020302fd02043afc06ff0e01
```

### Comparing `sae-vis-0.2.7/sae_vis/__pycache__/data_storing_fns.cpython-311.pyc` & `sae-vis-0.2.8/sae_vis/__pycache__/data_storing_fns.cpython-311.pyc`

 * *Files 10% similar despite different names*

#### Python bytecode

```diff
@@ -1,45 +1,45 @@
 magic:    0xa70d0d0a
-moddate:  0x7b770866 (Sat Mar 30 20:35:07 2024 UTC)
-files sz: 50059
+moddate:  0xd56b1166 (Sat Apr  6 15:35:49 2024 UTC)
+files sz: 49922
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 7
    flags     : 0
    code
       0x9700640064016c005a01640064016c025a02640064026c036d045a0401
       00640064036c056d065a060100640064046c076d085a086d095a096d0a5a
       0a6d0b5a0b0100640064056c0c6d0d5a0d6d0e5a0e0100640064066c0f6d
       105a100100640064076c116d125a120100640064016c135a13640064086c
       146d155a150100640064016c165a16640064096c176d185a180100640064
-      0a6c196d1a5a1a01006400640b6c1b6d1c5a1c6d1d5a1d6d1e5a1e6d1f5a
-      1f6d205a206d215a2101006400640c6c226d235a236d245a246d255a2501
-      006400640d6c266d275a276d285a286d295a296d2a5a2a6d2b5a2b6d2c5a
-      2c6d2d5a2d6d2e5a2e6d2f5a2f0100640e640f641064119c035a3064125a
-      316510650d02004700641384006414a6020000ab020000000000000000a6
-      000000ab000000000000000000a6000000ab0000000000000000005a3265
-      10650d02004700641584006416651ea6030000ab030000000000000000a6
-      000000ab000000000000000000a6000000ab0000000000000000005a3365
-      10650d02004700641784006418651ea6030000ab030000000000000000a6
-      000000ab000000000000000000a6000000ab0000000000000000005a3465
-      10650d0200470064198400641aa6020000ab020000000000000000a60000
-      00ab000000000000000000a6000000ab0000000000000000005a35651065
-      0d02004700641b8400641ca6020000ab020000000000000000a6000000ab
-      000000000000000000a6000000ab0000000000000000005a366510650d02
-      004700641d8400641ea6020000ab020000000000000000a6000000ab0000
-      00000000000000a6000000ab0000000000000000005a376510650d020047
-      00641f84006420a6020000ab020000000000000000a6000000ab00000000
-      0000000000a6000000ab0000000000000000005a38650965326533653565
-      34653865366606190000000000000000005a39650d020047006421840064
-      22a6020000ab020000000000000000a6000000ab0000000000000000005a
-      3a6510650d02004700642384006424a6020000ab020000000000000000a6
-      000000ab000000000000000000a6000000ab0000000000000000005a3b65
-      0d02004700642584006426a6020000ab020000000000000000a6000000ab
-      0000000000000000005a3c64015300
+      0a6c196d1a5a1a01006400640b6c1b6d1c5a1c01006400640c6c1d6d1e5a
+      1e6d1f5a1f6d205a206d215a216d225a226d235a2301006400640d6c246d
+      255a256d265a266d275a2701006400640e6c286d295a296d2a5a2a6d2b5a
+      2b6d2c5a2c6d2d5a2d6d2e5a2e6d2f5a2f6d305a306d315a310100640f64
+      10641164129c035a3264135a336510650d02004700641484006415a60200
+      00ab020000000000000000a6000000ab000000000000000000a6000000ab
+      0000000000000000005a346510650d020047006416840064176520a60300
+      00ab030000000000000000a6000000ab000000000000000000a6000000ab
+      0000000000000000005a356510650d020047006418840064196520a60300
+      00ab030000000000000000a6000000ab000000000000000000a6000000ab
+      0000000000000000005a366510650d02004700641a8400641ba6020000ab
+      020000000000000000a6000000ab000000000000000000a6000000ab0000
+      000000000000005a376510650d02004700641c8400641da6020000ab0200
+      00000000000000a6000000ab000000000000000000a6000000ab00000000
+      00000000005a386510650d02004700641e8400641fa6020000ab02000000
+      0000000000a6000000ab000000000000000000a6000000ab000000000000
+      0000005a396510650d02004700642084006421a6020000ab020000000000
+      000000a6000000ab000000000000000000a6000000ab0000000000000000
+      005a3a65096534653565376536653a65386606190000000000000000005a
+      3b650d02004700642284006423a6020000ab020000000000000000a60000
+      00ab0000000000000000005a3c6510650d02004700642484006425a60200
+      00ab020000000000000000a6000000ab000000000000000000a6000000ab
+      0000000000000000005a3d650d02004700642684006427a6020000ab0200
+      00000000000000a6000000ab0000000000000000005a3e64015300
      0           0 RESUME                   0
    
      1           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (None)
                  6 IMPORT_NAME              0 (numpy)
                  8 STORE_NAME               1 (np)
    
@@ -111,314 +111,322 @@
                124 POP_TOP
    
     11         126 LOAD_CONST               0 (0)
                128 LOAD_CONST               1 (None)
                130 IMPORT_NAME             22 (json)
                132 STORE_NAME              22 (json)
    
-    13         134 LOAD_CONST               0 (0)
-               136 LOAD_CONST               9 (('HookedTransformer',))
-               138 IMPORT_NAME             23 (transformer_lens)
-               140 IMPORT_FROM             24 (HookedTransformer)
-               142 STORE_NAME              24 (HookedTransformer)
+    12         134 LOAD_CONST               0 (0)
+               136 LOAD_CONST               9 (('tqdm',))
+               138 IMPORT_NAME             23 (tqdm.auto)
+               140 IMPORT_FROM             24 (tqdm)
+               142 STORE_NAME              24 (tqdm)
                144 POP_TOP
    
-    15         146 LOAD_CONST               0 (0)
-               148 LOAD_CONST              10 (('AutoEncoder',))
-               150 IMPORT_NAME             25 (sae_vis.model_fns)
-               152 IMPORT_FROM             26 (AutoEncoder)
-               154 STORE_NAME              26 (AutoEncoder)
+    14         146 LOAD_CONST               0 (0)
+               148 LOAD_CONST              10 (('HookedTransformer',))
+               150 IMPORT_NAME             25 (transformer_lens)
+               152 IMPORT_FROM             26 (HookedTransformer)
+               154 STORE_NAME              26 (HookedTransformer)
                156 POP_TOP
    
-    17         158 LOAD_CONST               0 (0)
-               160 LOAD_CONST              11 (('to_str_tokens', 'QuantileCalculator', 'HistogramData', 'get_decode_html_safe_fn', 'unprocess_str_tok', 'max_or_1'))
-               162 IMPORT_NAME             27 (sae_vis.utils_fns)
-               164 IMPORT_FROM             28 (to_str_tokens)
-               166 STORE_NAME              28 (to_str_tokens)
-               168 IMPORT_FROM             29 (QuantileCalculator)
-               170 STORE_NAME              29 (QuantileCalculator)
-               172 IMPORT_FROM             30 (HistogramData)
-               174 STORE_NAME              30 (HistogramData)
-               176 IMPORT_FROM             31 (get_decode_html_safe_fn)
-               178 STORE_NAME              31 (get_decode_html_safe_fn)
-               180 IMPORT_FROM             32 (unprocess_str_tok)
-               182 STORE_NAME              32 (unprocess_str_tok)
-               184 IMPORT_FROM             33 (max_or_1)
-               186 STORE_NAME              33 (max_or_1)
-               188 POP_TOP
+    16         158 LOAD_CONST               0 (0)
+               160 LOAD_CONST              11 (('AutoEncoder',))
+               162 IMPORT_NAME             27 (sae_vis.model_fns)
+               164 IMPORT_FROM             28 (AutoEncoder)
+               166 STORE_NAME              28 (AutoEncoder)
+               168 POP_TOP
    
-    25         190 LOAD_CONST               0 (0)
-               192 LOAD_CONST              12 (('bgColorMap', 'uColorMap', 'HTML'))
-               194 IMPORT_NAME             34 (sae_vis.html_fns)
-               196 IMPORT_FROM             35 (bgColorMap)
-               198 STORE_NAME              35 (bgColorMap)
-               200 IMPORT_FROM             36 (uColorMap)
-               202 STORE_NAME              36 (uColorMap)
-               204 IMPORT_FROM             37 (HTML)
-               206 STORE_NAME              37 (HTML)
-               208 POP_TOP
+    18         170 LOAD_CONST               0 (0)
+               172 LOAD_CONST              12 (('to_str_tokens', 'QuantileCalculator', 'HistogramData', 'get_decode_html_safe_fn', 'unprocess_str_tok', 'max_or_1'))
+               174 IMPORT_NAME             29 (sae_vis.utils_fns)
+               176 IMPORT_FROM             30 (to_str_tokens)
+               178 STORE_NAME              30 (to_str_tokens)
+               180 IMPORT_FROM             31 (QuantileCalculator)
+               182 STORE_NAME              31 (QuantileCalculator)
+               184 IMPORT_FROM             32 (HistogramData)
+               186 STORE_NAME              32 (HistogramData)
+               188 IMPORT_FROM             33 (get_decode_html_safe_fn)
+               190 STORE_NAME              33 (get_decode_html_safe_fn)
+               192 IMPORT_FROM             34 (unprocess_str_tok)
+               194 STORE_NAME              34 (unprocess_str_tok)
+               196 IMPORT_FROM             35 (max_or_1)
+               198 STORE_NAME              35 (max_or_1)
+               200 POP_TOP
    
-    30         210 LOAD_CONST               0 (0)
-               212 LOAD_CONST              13 (('SaeVisLayoutConfig', 'SaeVisConfig', 'FeatureTablesConfig', 'ActsHistogramConfig', 'LogitsTableConfig', 'LogitsHistogramConfig', 'SequencesConfig', 'PromptConfig', 'GenericComponentConfig'))
-               214 IMPORT_NAME             38 (sae_vis.data_config_classes)
-               216 IMPORT_FROM             39 (SaeVisLayoutConfig)
-               218 STORE_NAME              39 (SaeVisLayoutConfig)
-               220 IMPORT_FROM             40 (SaeVisConfig)
-               222 STORE_NAME              40 (SaeVisConfig)
-               224 IMPORT_FROM             41 (FeatureTablesConfig)
-               226 STORE_NAME              41 (FeatureTablesConfig)
-               228 IMPORT_FROM             42 (ActsHistogramConfig)
-               230 STORE_NAME              42 (ActsHistogramConfig)
-               232 IMPORT_FROM             43 (LogitsTableConfig)
-               234 STORE_NAME              43 (LogitsTableConfig)
-               236 IMPORT_FROM             44 (LogitsHistogramConfig)
-               238 STORE_NAME              44 (LogitsHistogramConfig)
-               240 IMPORT_FROM             45 (SequencesConfig)
-               242 STORE_NAME              45 (SequencesConfig)
-               244 IMPORT_FROM             46 (PromptConfig)
-               246 STORE_NAME              46 (PromptConfig)
-               248 IMPORT_FROM             47 (GenericComponentConfig)
-               250 STORE_NAME              47 (GenericComponentConfig)
-               252 POP_TOP
+    26         202 LOAD_CONST               0 (0)
+               204 LOAD_CONST              13 (('bgColorMap', 'uColorMap', 'HTML'))
+               206 IMPORT_NAME             36 (sae_vis.html_fns)
+               208 IMPORT_FROM             37 (bgColorMap)
+               210 STORE_NAME              37 (bgColorMap)
+               212 IMPORT_FROM             38 (uColorMap)
+               214 STORE_NAME              38 (uColorMap)
+               216 IMPORT_FROM             39 (HTML)
+               218 STORE_NAME              39 (HTML)
+               220 POP_TOP
    
-    43         254 LOAD_CONST              14 ('Activation Size')
+    31         222 LOAD_CONST               0 (0)
+               224 LOAD_CONST              14 (('SaeVisLayoutConfig', 'SaeVisConfig', 'FeatureTablesConfig', 'ActsHistogramConfig', 'LogitsTableConfig', 'LogitsHistogramConfig', 'SequencesConfig', 'PromptConfig', 'GenericComponentConfig'))
+               226 IMPORT_NAME             40 (sae_vis.data_config_classes)
+               228 IMPORT_FROM             41 (SaeVisLayoutConfig)
+               230 STORE_NAME              41 (SaeVisLayoutConfig)
+               232 IMPORT_FROM             42 (SaeVisConfig)
+               234 STORE_NAME              42 (SaeVisConfig)
+               236 IMPORT_FROM             43 (FeatureTablesConfig)
+               238 STORE_NAME              43 (FeatureTablesConfig)
+               240 IMPORT_FROM             44 (ActsHistogramConfig)
+               242 STORE_NAME              44 (ActsHistogramConfig)
+               244 IMPORT_FROM             45 (LogitsTableConfig)
+               246 STORE_NAME              45 (LogitsTableConfig)
+               248 IMPORT_FROM             46 (LogitsHistogramConfig)
+               250 STORE_NAME              46 (LogitsHistogramConfig)
+               252 IMPORT_FROM             47 (SequencesConfig)
+               254 STORE_NAME              47 (SequencesConfig)
+               256 IMPORT_FROM             48 (PromptConfig)
+               258 STORE_NAME              48 (PromptConfig)
+               260 IMPORT_FROM             49 (GenericComponentConfig)
+               262 STORE_NAME              49 (GenericComponentConfig)
+               264 POP_TOP
    
-    44         256 LOAD_CONST              15 ('Activation Quantile')
+    44         266 LOAD_CONST              15 ('Activation Size')
    
-    45         258 LOAD_CONST              16 ('Loss Effect')
+    45         268 LOAD_CONST              16 ('Activation Quantile')
    
-    42         260 LOAD_CONST              17 (('act_size', 'act_quantile', 'loss_effect'))
-               262 BUILD_CONST_KEY_MAP      3
-               264 STORE_NAME              48 (METRIC_TITLES)
+    46         270 LOAD_CONST              17 ('Loss Effect')
    
-    47         266 LOAD_CONST              18 (4)
-               268 STORE_NAME              49 (PRECISION)
+    43         272 LOAD_CONST              18 (('act_size', 'act_quantile', 'loss_effect'))
+               274 BUILD_CONST_KEY_MAP      3
+               276 STORE_NAME              50 (METRIC_TITLES)
    
-    49         270 LOAD_NAME               16 (dataclass_json)
+    48         278 LOAD_CONST              19 (4)
+               280 STORE_NAME              51 (PRECISION)
    
-    50         272 LOAD_NAME               13 (dataclass)
+    50         282 LOAD_NAME               16 (dataclass_json)
    
-    51         274 PUSH_NULL
-               276 LOAD_BUILD_CLASS
-               278 LOAD_CONST              19 (<code object FeatureTablesData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 49>)
-               280 MAKE_FUNCTION            0
-               282 LOAD_CONST              20 ('FeatureTablesData')
-               284 PRECALL                  2
-               288 CALL                     2
+    51         284 LOAD_NAME               13 (dataclass)
    
-    50         298 PRECALL                  0
-               302 CALL                     0
+    52         286 PUSH_NULL
+               288 LOAD_BUILD_CLASS
+               290 LOAD_CONST              20 (<code object FeatureTablesData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 50>)
+               292 MAKE_FUNCTION            0
+               294 LOAD_CONST              21 ('FeatureTablesData')
+               296 PRECALL                  2
+               300 CALL                     2
    
-    49         312 PRECALL                  0
-               316 CALL                     0
+    51         310 PRECALL                  0
+               314 CALL                     0
    
-    51         326 STORE_NAME              50 (FeatureTablesData)
+    50         324 PRECALL                  0
+               328 CALL                     0
    
-   142         328 LOAD_NAME               16 (dataclass_json)
+    52         338 STORE_NAME              52 (FeatureTablesData)
    
-   143         330 LOAD_NAME               13 (dataclass)
+   145         340 LOAD_NAME               16 (dataclass_json)
    
-   144         332 PUSH_NULL
-               334 LOAD_BUILD_CLASS
-               336 LOAD_CONST              21 (<code object ActsHistogramData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 142>)
-               338 MAKE_FUNCTION            0
-               340 LOAD_CONST              22 ('ActsHistogramData')
-               342 LOAD_NAME               30 (HistogramData)
-               344 PRECALL                  3
-               348 CALL                     3
+   146         342 LOAD_NAME               13 (dataclass)
    
-   143         358 PRECALL                  0
-               362 CALL                     0
+   147         344 PUSH_NULL
+               346 LOAD_BUILD_CLASS
+               348 LOAD_CONST              22 (<code object ActsHistogramData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 145>)
+               350 MAKE_FUNCTION            0
+               352 LOAD_CONST              23 ('ActsHistogramData')
+               354 LOAD_NAME               32 (HistogramData)
+               356 PRECALL                  3
+               360 CALL                     3
    
-   142         372 PRECALL                  0
-               376 CALL                     0
+   146         370 PRECALL                  0
+               374 CALL                     0
    
-   144         386 STORE_NAME              51 (ActsHistogramData)
+   145         384 PRECALL                  0
+               388 CALL                     0
    
-   185         388 LOAD_NAME               16 (dataclass_json)
+   147         398 STORE_NAME              53 (ActsHistogramData)
    
-   186         390 LOAD_NAME               13 (dataclass)
+   188         400 LOAD_NAME               16 (dataclass_json)
    
-   187         392 PUSH_NULL
-               394 LOAD_BUILD_CLASS
-               396 LOAD_CONST              23 (<code object LogitsHistogramData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 185>)
-               398 MAKE_FUNCTION            0
-               400 LOAD_CONST              24 ('LogitsHistogramData')
-               402 LOAD_NAME               30 (HistogramData)
-               404 PRECALL                  3
-               408 CALL                     3
+   189         402 LOAD_NAME               13 (dataclass)
    
-   186         418 PRECALL                  0
-               422 CALL                     0
+   190         404 PUSH_NULL
+               406 LOAD_BUILD_CLASS
+               408 LOAD_CONST              24 (<code object LogitsHistogramData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 188>)
+               410 MAKE_FUNCTION            0
+               412 LOAD_CONST              25 ('LogitsHistogramData')
+               414 LOAD_NAME               32 (HistogramData)
+               416 PRECALL                  3
+               420 CALL                     3
    
-   185         432 PRECALL                  0
-               436 CALL                     0
+   189         430 PRECALL                  0
+               434 CALL                     0
    
-   187         446 STORE_NAME              52 (LogitsHistogramData)
+   188         444 PRECALL                  0
+               448 CALL                     0
    
-   222         448 LOAD_NAME               16 (dataclass_json)
+   190         458 STORE_NAME              54 (LogitsHistogramData)
    
-   223         450 LOAD_NAME               13 (dataclass)
+   225         460 LOAD_NAME               16 (dataclass_json)
    
-   224         452 PUSH_NULL
-               454 LOAD_BUILD_CLASS
-               456 LOAD_CONST              25 (<code object LogitsTableData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 222>)
-               458 MAKE_FUNCTION            0
-               460 LOAD_CONST              26 ('LogitsTableData')
-               462 PRECALL                  2
-               466 CALL                     2
+   226         462 LOAD_NAME               13 (dataclass)
    
-   223         476 PRECALL                  0
-               480 CALL                     0
+   227         464 PUSH_NULL
+               466 LOAD_BUILD_CLASS
+               468 LOAD_CONST              26 (<code object LogitsTableData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 225>)
+               470 MAKE_FUNCTION            0
+               472 LOAD_CONST              27 ('LogitsTableData')
+               474 PRECALL                  2
+               478 CALL                     2
    
-   222         490 PRECALL                  0
-               494 CALL                     0
+   226         488 PRECALL                  0
+               492 CALL                     0
    
-   224         504 STORE_NAME              53 (LogitsTableData)
+   225         502 PRECALL                  0
+               506 CALL                     0
    
-   286         506 LOAD_NAME               16 (dataclass_json)
+   227         516 STORE_NAME              55 (LogitsTableData)
    
-   287         508 LOAD_NAME               13 (dataclass)
+   289         518 LOAD_NAME               16 (dataclass_json)
    
-   288         510 PUSH_NULL
-               512 LOAD_BUILD_CLASS
-               514 LOAD_CONST              27 (<code object SequenceData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 286>)
-               516 MAKE_FUNCTION            0
-               518 LOAD_CONST              28 ('SequenceData')
-               520 PRECALL                  2
-               524 CALL                     2
+   290         520 LOAD_NAME               13 (dataclass)
    
-   287         534 PRECALL                  0
-               538 CALL                     0
+   291         522 PUSH_NULL
+               524 LOAD_BUILD_CLASS
+               526 LOAD_CONST              28 (<code object SequenceData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 289>)
+               528 MAKE_FUNCTION            0
+               530 LOAD_CONST              29 ('SequenceData')
+               532 PRECALL                  2
+               536 CALL                     2
    
-   286         548 PRECALL                  0
-               552 CALL                     0
+   290         546 PRECALL                  0
+               550 CALL                     0
    
-   288         562 STORE_NAME              54 (SequenceData)
+   289         560 PRECALL                  0
+               564 CALL                     0
    
-   493         564 LOAD_NAME               16 (dataclass_json)
+   291         574 STORE_NAME              56 (SequenceData)
    
-   494         566 LOAD_NAME               13 (dataclass)
+   496         576 LOAD_NAME               16 (dataclass_json)
    
-   495         568 PUSH_NULL
-               570 LOAD_BUILD_CLASS
-               572 LOAD_CONST              29 (<code object SequenceGroupData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 493>)
-               574 MAKE_FUNCTION            0
-               576 LOAD_CONST              30 ('SequenceGroupData')
-               578 PRECALL                  2
-               582 CALL                     2
+   497         578 LOAD_NAME               13 (dataclass)
    
-   494         592 PRECALL                  0
-               596 CALL                     0
+   498         580 PUSH_NULL
+               582 LOAD_BUILD_CLASS
+               584 LOAD_CONST              30 (<code object SequenceGroupData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 496>)
+               586 MAKE_FUNCTION            0
+               588 LOAD_CONST              31 ('SequenceGroupData')
+               590 PRECALL                  2
+               594 CALL                     2
    
-   493         606 PRECALL                  0
-               610 CALL                     0
+   497         604 PRECALL                  0
+               608 CALL                     0
    
-   495         620 STORE_NAME              55 (SequenceGroupData)
+   496         618 PRECALL                  0
+               622 CALL                     0
    
-   583         622 LOAD_NAME               16 (dataclass_json)
+   498         632 STORE_NAME              57 (SequenceGroupData)
    
-   584         624 LOAD_NAME               13 (dataclass)
+   586         634 LOAD_NAME               16 (dataclass_json)
    
-   585         626 PUSH_NULL
-               628 LOAD_BUILD_CLASS
-               630 LOAD_CONST              31 (<code object SequenceMultiGroupData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 583>)
-               632 MAKE_FUNCTION            0
-               634 LOAD_CONST              32 ('SequenceMultiGroupData')
-               636 PRECALL                  2
-               640 CALL                     2
+   587         636 LOAD_NAME               13 (dataclass)
    
-   584         650 PRECALL                  0
-               654 CALL                     0
+   588         638 PUSH_NULL
+               640 LOAD_BUILD_CLASS
+               642 LOAD_CONST              32 (<code object SequenceMultiGroupData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 586>)
+               644 MAKE_FUNCTION            0
+               646 LOAD_CONST              33 ('SequenceMultiGroupData')
+               648 PRECALL                  2
+               652 CALL                     2
    
-   583         664 PRECALL                  0
-               668 CALL                     0
+   587         662 PRECALL                  0
+               666 CALL                     0
    
-   585         678 STORE_NAME              56 (SequenceMultiGroupData)
+   586         676 PRECALL                  0
+               680 CALL                     0
    
-   660         680 LOAD_NAME                9 (Union)
+   588         690 STORE_NAME              58 (SequenceMultiGroupData)
    
-   661         682 LOAD_NAME               50 (FeatureTablesData)
+   663         692 LOAD_NAME                9 (Union)
    
-   662         684 LOAD_NAME               51 (ActsHistogramData)
+   664         694 LOAD_NAME               52 (FeatureTablesData)
    
-   663         686 LOAD_NAME               53 (LogitsTableData)
+   665         696 LOAD_NAME               53 (ActsHistogramData)
    
-   664         688 LOAD_NAME               52 (LogitsHistogramData)
+   666         698 LOAD_NAME               55 (LogitsTableData)
    
-   665         690 LOAD_NAME               56 (SequenceMultiGroupData)
+   667         700 LOAD_NAME               54 (LogitsHistogramData)
    
-   666         692 LOAD_NAME               54 (SequenceData)
+   668         702 LOAD_NAME               58 (SequenceMultiGroupData)
    
-   661         694 BUILD_TUPLE              6
+   669         704 LOAD_NAME               56 (SequenceData)
    
-   660         696 BINARY_SUBSCR
-               706 STORE_NAME              57 (GenericData)
+   664         706 BUILD_TUPLE              6
    
-   670         708 LOAD_NAME               13 (dataclass)
+   663         708 BINARY_SUBSCR
+               718 STORE_NAME              59 (GenericData)
    
-   671         710 PUSH_NULL
-               712 LOAD_BUILD_CLASS
-               714 LOAD_CONST              33 (<code object FeatureData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 670>)
-               716 MAKE_FUNCTION            0
-               718 LOAD_CONST              34 ('FeatureData')
-               720 PRECALL                  2
-               724 CALL                     2
+   673         720 LOAD_NAME               13 (dataclass)
    
-   670         734 PRECALL                  0
-               738 CALL                     0
+   674         722 PUSH_NULL
+               724 LOAD_BUILD_CLASS
+               726 LOAD_CONST              34 (<code object FeatureData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 673>)
+               728 MAKE_FUNCTION            0
+               730 LOAD_CONST              35 ('FeatureData')
+               732 PRECALL                  2
+               736 CALL                     2
    
-   671         748 STORE_NAME              58 (FeatureData)
+   673         746 PRECALL                  0
+               750 CALL                     0
    
-   815         750 LOAD_NAME               16 (dataclass_json)
+   674         760 STORE_NAME              60 (FeatureData)
    
-   816         752 LOAD_NAME               13 (dataclass)
+   818         762 LOAD_NAME               16 (dataclass_json)
    
-   817         754 PUSH_NULL
-               756 LOAD_BUILD_CLASS
-               758 LOAD_CONST              35 (<code object _SaeVisData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 815>)
-               760 MAKE_FUNCTION            0
-               762 LOAD_CONST              36 ('_SaeVisData')
-               764 PRECALL                  2
-               768 CALL                     2
+   819         764 LOAD_NAME               13 (dataclass)
    
-   816         778 PRECALL                  0
-               782 CALL                     0
+   820         766 PUSH_NULL
+               768 LOAD_BUILD_CLASS
+               770 LOAD_CONST              36 (<code object _SaeVisData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 818>)
+               772 MAKE_FUNCTION            0
+               774 LOAD_CONST              37 ('_SaeVisData')
+               776 PRECALL                  2
+               780 CALL                     2
    
-   815         792 PRECALL                  0
-               796 CALL                     0
+   819         790 PRECALL                  0
+               794 CALL                     0
    
-   817         806 STORE_NAME              59 (_SaeVisData)
+   818         804 PRECALL                  0
+               808 CALL                     0
    
-   835         808 LOAD_NAME               13 (dataclass)
+   820         818 STORE_NAME              61 (_SaeVisData)
    
-   836         810 PUSH_NULL
-               812 LOAD_BUILD_CLASS
-               814 LOAD_CONST              37 (<code object SaeVisData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 835>)
-               816 MAKE_FUNCTION            0
-               818 LOAD_CONST              38 ('SaeVisData')
-               820 PRECALL                  2
-               824 CALL                     2
+   838         820 LOAD_NAME               13 (dataclass)
    
-   835         834 PRECALL                  0
-               838 CALL                     0
+   839         822 PUSH_NULL
+               824 LOAD_BUILD_CLASS
+               826 LOAD_CONST              38 (<code object SaeVisData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 838>)
+               828 MAKE_FUNCTION            0
+               830 LOAD_CONST              39 ('SaeVisData')
+               832 PRECALL                  2
+               836 CALL                     2
    
-   836         848 STORE_NAME              60 (SaeVisData)
-               850 LOAD_CONST               1 (None)
-               852 RETURN_VALUE
+   838         846 PRECALL                  0
+               850 CALL                     0
+   
+   839         860 STORE_NAME              62 (SaeVisData)
+               862 LOAD_CONST               1 (None)
+               864 RETURN_VALUE
    consts
       0
       None
       ('Path',)
       ('Tensor',)
       ('Optional', 'Union', 'Any', 'Callable')
       ('dataclass', 'field')
       ('dataclass_json',)
       ('Int',)
       ('deepcopy',)
+      ('tqdm',)
       ('HookedTransformer',)
       ('AutoEncoder',)
       ('to_str_tokens', 'QuantileCalculator', 'HistogramData', 'get_decode_html_safe_fn', 'unprocess_str_tok', 'max_or_1')
       ('bgColorMap', 'uColorMap', 'HTML')
       ('SaeVisLayoutConfig', 'SaeVisConfig', 'FeatureTablesConfig', 'ActsHistogramConfig', 'LogitsTableConfig', 'LogitsHistogramConfig', 'SequencesConfig', 'PromptConfig', 'GenericComponentConfig')
       'Activation Size'
       'Activation Quantile'
@@ -441,719 +449,715 @@
             010000ab0100000000000000005a0d6505650a1900000000000000000065
             0864073c000000020065046505ac02a6010000ab0100000000000000005a
             0e6505650a19000000000000000000650864083c000000020065046505ac
             02a6010000ab0100000000000000005a0f65056507190000000000000000
             00650864093c000000020065046505ac02a6010000ab0100000000000000
             005a106505650a190000000000000000006508640a3c0000000200650465
             05ac02a6010000ab0100000000000000005a116505650a19000000000000
-            0000006508640b3c00000069006601640c6512640d651365076505650719
-            0000000000000000007a0700006701651465056514190000000000000000
-            007a070000660219000000000000000000640e6514640f65076515650765
-            076602190000000000000000007a07000064106516651465176602190000
-            0000000000000064116518660c641284055a1964135300
-          49           0 RESUME                   0
+            0000006508640b3c000000020065046505ac02a6010000ab010000000000
+            0000005a1265056507190000000000000000006508640c3c000000020065
+            046505ac02a6010000ab0100000000000000005a136505650a1900000000
+            00000000006508640d3c000000020065046505ac02a6010000ab01000000
+            00000000005a146505650a190000000000000000006508640e3c00000069
+            006601640f651564106516650765056507190000000000000000007a0700
+            006701651765056517190000000000000000007a07000066021900000000
+            000000000064116517641265076518650765076602190000000000000000
+            007a070000641365196517651a6602190000000000000000006414651b66
+            0c641584055a1c64165300
+          50           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('FeatureTablesData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-          52          12 LOAD_CONST               1 ("\n    This contains all the data necessary to make the left-hand tables in prompt-centric visualization. See diagram\n    in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Inputs:\n        neuron_alignment...\n            The data for the neuron alignment table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer the encoder feature is most aligned with.\n\n        correlated_neurons...\n            The data for the correlated neurons table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer are most correlated with the encoder feature.\n\n        correlated_features...\n            The data for the correlated features table (each of its 3 columns). In other words, the data containing\n            which features in encoder-B are most correlated with those in the original encoder. Note, this one might be\n            absent if we're not using a B-encoder.\n    ")
+          53          12 LOAD_CONST               1 ("\n    This contains all the data necessary to make the left-hand tables in prompt-centric visualization. See diagram\n    in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Inputs:\n        neuron_alignment...\n            The data for the neuron alignment table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer the encoder feature is most aligned with.\n\n        correlated_neurons...\n            The data for the correlated neurons table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer are most correlated with the encoder feature.\n\n        correlated_features...\n            The data for the correlated features table (each of its 3 columns). In other words, the data containing\n            which features in this encoder are most correlated with each other.\n        \n        correlated_b_features...\n            The data for the correlated features table (each of its 3 columns). In other words, the data containing\n            which features in encoder-B are most correlated with those in the original encoder. Note, this one might be\n            absent if we're not using a B-encoder.\n    ")
                       14 STORE_NAME               3 (__doc__)
          
-          72          16 PUSH_NULL
+          77          16 PUSH_NULL
                       18 LOAD_NAME                4 (field)
                       20 LOAD_NAME                5 (list)
                       22 KW_NAMES                 2
                       24 PRECALL                  1
                       28 CALL                     1
                       38 STORE_NAME               6 (neuron_alignment_indices)
                       40 LOAD_NAME                5 (list)
                       42 LOAD_NAME                7 (int)
                       44 BINARY_SUBSCR
                       54 LOAD_NAME                8 (__annotations__)
                       56 LOAD_CONST               3 ('neuron_alignment_indices')
                       58 STORE_SUBSCR
          
-          73          62 PUSH_NULL
+          78          62 PUSH_NULL
                       64 LOAD_NAME                4 (field)
                       66 LOAD_NAME                5 (list)
                       68 KW_NAMES                 2
                       70 PRECALL                  1
                       74 CALL                     1
                       84 STORE_NAME               9 (neuron_alignment_values)
                       86 LOAD_NAME                5 (list)
                       88 LOAD_NAME               10 (float)
                       90 BINARY_SUBSCR
                      100 LOAD_NAME                8 (__annotations__)
                      102 LOAD_CONST               4 ('neuron_alignment_values')
                      104 STORE_SUBSCR
          
-          74         108 PUSH_NULL
+          79         108 PUSH_NULL
                      110 LOAD_NAME                4 (field)
                      112 LOAD_NAME                5 (list)
                      114 KW_NAMES                 2
                      116 PRECALL                  1
                      120 CALL                     1
                      130 STORE_NAME              11 (neuron_alignment_l1)
                      132 LOAD_NAME                5 (list)
                      134 LOAD_NAME               10 (float)
                      136 BINARY_SUBSCR
                      146 LOAD_NAME                8 (__annotations__)
                      148 LOAD_CONST               5 ('neuron_alignment_l1')
                      150 STORE_SUBSCR
          
-          75         154 PUSH_NULL
+          80         154 PUSH_NULL
                      156 LOAD_NAME                4 (field)
                      158 LOAD_NAME                5 (list)
                      160 KW_NAMES                 2
                      162 PRECALL                  1
                      166 CALL                     1
                      176 STORE_NAME              12 (correlated_neurons_indices)
                      178 LOAD_NAME                5 (list)
                      180 LOAD_NAME                7 (int)
                      182 BINARY_SUBSCR
                      192 LOAD_NAME                8 (__annotations__)
                      194 LOAD_CONST               6 ('correlated_neurons_indices')
                      196 STORE_SUBSCR
          
-          76         200 PUSH_NULL
+          81         200 PUSH_NULL
                      202 LOAD_NAME                4 (field)
                      204 LOAD_NAME                5 (list)
                      206 KW_NAMES                 2
                      208 PRECALL                  1
                      212 CALL                     1
                      222 STORE_NAME              13 (correlated_neurons_pearson)
                      224 LOAD_NAME                5 (list)
                      226 LOAD_NAME               10 (float)
                      228 BINARY_SUBSCR
                      238 LOAD_NAME                8 (__annotations__)
                      240 LOAD_CONST               7 ('correlated_neurons_pearson')
                      242 STORE_SUBSCR
          
-          77         246 PUSH_NULL
+          82         246 PUSH_NULL
                      248 LOAD_NAME                4 (field)
                      250 LOAD_NAME                5 (list)
                      252 KW_NAMES                 2
                      254 PRECALL                  1
                      258 CALL                     1
                      268 STORE_NAME              14 (correlated_neurons_cossim)
                      270 LOAD_NAME                5 (list)
                      272 LOAD_NAME               10 (float)
                      274 BINARY_SUBSCR
                      284 LOAD_NAME                8 (__annotations__)
                      286 LOAD_CONST               8 ('correlated_neurons_cossim')
                      288 STORE_SUBSCR
          
-          78         292 PUSH_NULL
+          83         292 PUSH_NULL
                      294 LOAD_NAME                4 (field)
                      296 LOAD_NAME                5 (list)
                      298 KW_NAMES                 2
                      300 PRECALL                  1
                      304 CALL                     1
                      314 STORE_NAME              15 (correlated_features_indices)
                      316 LOAD_NAME                5 (list)
                      318 LOAD_NAME                7 (int)
                      320 BINARY_SUBSCR
                      330 LOAD_NAME                8 (__annotations__)
                      332 LOAD_CONST               9 ('correlated_features_indices')
                      334 STORE_SUBSCR
          
-          79         338 PUSH_NULL
+          84         338 PUSH_NULL
                      340 LOAD_NAME                4 (field)
                      342 LOAD_NAME                5 (list)
                      344 KW_NAMES                 2
                      346 PRECALL                  1
                      350 CALL                     1
                      360 STORE_NAME              16 (correlated_features_pearson)
                      362 LOAD_NAME                5 (list)
                      364 LOAD_NAME               10 (float)
                      366 BINARY_SUBSCR
                      376 LOAD_NAME                8 (__annotations__)
                      378 LOAD_CONST              10 ('correlated_features_pearson')
                      380 STORE_SUBSCR
          
-          80         384 PUSH_NULL
+          85         384 PUSH_NULL
                      386 LOAD_NAME                4 (field)
                      388 LOAD_NAME                5 (list)
                      390 KW_NAMES                 2
                      392 PRECALL                  1
                      396 CALL                     1
                      406 STORE_NAME              17 (correlated_features_cossim)
                      408 LOAD_NAME                5 (list)
                      410 LOAD_NAME               10 (float)
                      412 BINARY_SUBSCR
                      422 LOAD_NAME                8 (__annotations__)
                      424 LOAD_CONST              11 ('correlated_features_cossim')
                      426 STORE_SUBSCR
          
-          88         430 BUILD_MAP                0
-         
-          82         432 BUILD_TUPLE              1
-                     434 LOAD_CONST              12 ('cfg')
-         
-          84         436 LOAD_NAME               18 (FeatureTablesConfig)
-         
-          82         438 LOAD_CONST              13 ('decode_fn')
-         
-          85         440 LOAD_NAME               19 (Callable)
-                     442 LOAD_NAME                7 (int)
-                     444 LOAD_NAME                5 (list)
-                     446 LOAD_NAME                7 (int)
-                     448 BINARY_SUBSCR
-                     458 BINARY_OP                7 (|)
-                     462 BUILD_LIST               1
-                     464 LOAD_NAME               20 (str)
-                     466 LOAD_NAME                5 (list)
-                     468 LOAD_NAME               20 (str)
-                     470 BINARY_SUBSCR
-                     480 BINARY_OP                7 (|)
-                     484 BUILD_TUPLE              2
-                     486 BINARY_SUBSCR
-         
-          82         496 LOAD_CONST              14 ('id_suffix')
-         
-          86         498 LOAD_NAME               20 (str)
-         
-          82         500 LOAD_CONST              15 ('column')
+          86         430 PUSH_NULL
+                     432 LOAD_NAME                4 (field)
+                     434 LOAD_NAME                5 (list)
+                     436 KW_NAMES                 2
+                     438 PRECALL                  1
+                     442 CALL                     1
+                     452 STORE_NAME              18 (correlated_b_features_indices)
+                     454 LOAD_NAME                5 (list)
+                     456 LOAD_NAME                7 (int)
+                     458 BINARY_SUBSCR
+                     468 LOAD_NAME                8 (__annotations__)
+                     470 LOAD_CONST              12 ('correlated_b_features_indices')
+                     472 STORE_SUBSCR
+         
+          87         476 PUSH_NULL
+                     478 LOAD_NAME                4 (field)
+                     480 LOAD_NAME                5 (list)
+                     482 KW_NAMES                 2
+                     484 PRECALL                  1
+                     488 CALL                     1
+                     498 STORE_NAME              19 (correlated_b_features_pearson)
+                     500 LOAD_NAME                5 (list)
+                     502 LOAD_NAME               10 (float)
+                     504 BINARY_SUBSCR
+                     514 LOAD_NAME                8 (__annotations__)
+                     516 LOAD_CONST              13 ('correlated_b_features_pearson')
+                     518 STORE_SUBSCR
          
-          87         502 LOAD_NAME                7 (int)
-                     504 LOAD_NAME               21 (tuple)
-                     506 LOAD_NAME                7 (int)
-                     508 LOAD_NAME                7 (int)
-                     510 BUILD_TUPLE              2
-                     512 BINARY_SUBSCR
-                     522 BINARY_OP                7 (|)
-         
-          82         526 LOAD_CONST              16 ('component_specific_kwargs')
-         
-          88         528 LOAD_NAME               22 (dict)
-                     530 LOAD_NAME               20 (str)
-                     532 LOAD_NAME               23 (Any)
-                     534 BUILD_TUPLE              2
-                     536 BINARY_SUBSCR
-         
-          82         546 LOAD_CONST              17 ('return')
-         
-          89         548 LOAD_NAME               24 (HTML)
-         
-          82         550 BUILD_TUPLE             12
-                     552 LOAD_CONST              18 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 82>)
-                     554 MAKE_FUNCTION            5 (defaults, annotations)
-                     556 STORE_NAME              25 (_get_html_data)
-                     558 LOAD_CONST              19 (None)
-                     560 RETURN_VALUE
+          88         522 PUSH_NULL
+                     524 LOAD_NAME                4 (field)
+                     526 LOAD_NAME                5 (list)
+                     528 KW_NAMES                 2
+                     530 PRECALL                  1
+                     534 CALL                     1
+                     544 STORE_NAME              20 (correlated_b_features_cossim)
+                     546 LOAD_NAME                5 (list)
+                     548 LOAD_NAME               10 (float)
+                     550 BINARY_SUBSCR
+                     560 LOAD_NAME                8 (__annotations__)
+                     562 LOAD_CONST              14 ('correlated_b_features_cossim')
+                     564 STORE_SUBSCR
+         
+          96         568 BUILD_MAP                0
+         
+          90         570 BUILD_TUPLE              1
+                     572 LOAD_CONST              15 ('cfg')
+         
+          92         574 LOAD_NAME               21 (FeatureTablesConfig)
+         
+          90         576 LOAD_CONST              16 ('decode_fn')
+         
+          93         578 LOAD_NAME               22 (Callable)
+                     580 LOAD_NAME                7 (int)
+                     582 LOAD_NAME                5 (list)
+                     584 LOAD_NAME                7 (int)
+                     586 BINARY_SUBSCR
+                     596 BINARY_OP                7 (|)
+                     600 BUILD_LIST               1
+                     602 LOAD_NAME               23 (str)
+                     604 LOAD_NAME                5 (list)
+                     606 LOAD_NAME               23 (str)
+                     608 BINARY_SUBSCR
+                     618 BINARY_OP                7 (|)
+                     622 BUILD_TUPLE              2
+                     624 BINARY_SUBSCR
+         
+          90         634 LOAD_CONST              17 ('id_suffix')
+         
+          94         636 LOAD_NAME               23 (str)
+         
+          90         638 LOAD_CONST              18 ('column')
+         
+          95         640 LOAD_NAME                7 (int)
+                     642 LOAD_NAME               24 (tuple)
+                     644 LOAD_NAME                7 (int)
+                     646 LOAD_NAME                7 (int)
+                     648 BUILD_TUPLE              2
+                     650 BINARY_SUBSCR
+                     660 BINARY_OP                7 (|)
+         
+          90         664 LOAD_CONST              19 ('component_specific_kwargs')
+         
+          96         666 LOAD_NAME               25 (dict)
+                     668 LOAD_NAME               23 (str)
+                     670 LOAD_NAME               26 (Any)
+                     672 BUILD_TUPLE              2
+                     674 BINARY_SUBSCR
+         
+          90         684 LOAD_CONST              20 ('return')
+         
+          97         686 LOAD_NAME               27 (HTML)
+         
+          90         688 BUILD_TUPLE             12
+                     690 LOAD_CONST              21 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 90>)
+                     692 MAKE_FUNCTION            5 (defaults, annotations)
+                     694 STORE_NAME              28 (_get_html_data)
+                     696 LOAD_CONST              22 (None)
+                     698 RETURN_VALUE
          consts
             'FeatureTablesData'
-            "\n    This contains all the data necessary to make the left-hand tables in prompt-centric visualization. See diagram\n    in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Inputs:\n        neuron_alignment...\n            The data for the neuron alignment table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer the encoder feature is most aligned with.\n\n        correlated_neurons...\n            The data for the correlated neurons table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer are most correlated with the encoder feature.\n\n        correlated_features...\n            The data for the correlated features table (each of its 3 columns). In other words, the data containing\n            which features in encoder-B are most correlated with those in the original encoder. Note, this one might be\n            absent if we're not using a B-encoder.\n    "
+            "\n    This contains all the data necessary to make the left-hand tables in prompt-centric visualization. See diagram\n    in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Inputs:\n        neuron_alignment...\n            The data for the neuron alignment table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer the encoder feature is most aligned with.\n\n        correlated_neurons...\n            The data for the correlated neurons table (each of its 3 columns). In other words, the data containing which\n            neurons in the transformer are most correlated with the encoder feature.\n\n        correlated_features...\n            The data for the correlated features table (each of its 3 columns). In other words, the data containing\n            which features in this encoder are most correlated with each other.\n        \n        correlated_b_features...\n            The data for the correlated features table (each of its 3 columns). In other words, the data containing\n            which features in encoder-B are most correlated with those in the original encoder. Note, this one might be\n            absent if we're not using a B-encoder.\n    "
             ('default_factory',)
             'neuron_alignment_indices'
             'neuron_alignment_values'
             'neuron_alignment_l1'
             'correlated_neurons_indices'
             'correlated_neurons_pearson'
             'correlated_neurons_cossim'
             'correlated_features_indices'
             'correlated_features_pearson'
             'correlated_features_cossim'
+            'correlated_b_features_indices'
+            'correlated_b_features_pearson'
+            'correlated_b_features_cossim'
             'cfg'
             'decode_fn'
             'id_suffix'
             'column'
             'component_specific_kwargs'
             'return'
             code
                argcount  : 6
-               nlocals   : 17
-               stacksize : 7
+               nlocals   : 10
+               stacksize : 11
                flags     : 3
                code
-                  0x97007c016a0000000000000000007403000000000000000000007c006a
-                  020000000000000000a6010000ab0100000000000000006b010000000073
-                  024a0082017c006a02000000000000000064017c016a0000000000000000
-                  008502190000000000000000007d067c006a03000000000000000064017c
-                  016a0000000000000000008502190000000000000000007d077c006a0400
-                  0000000000000064017c016a000000000000000000850219000000000000
-                  0000007d087c006a05000000000000000064017c016a0000000000000000
-                  008502190000000000000000007d097c006a06000000000000000064017c
-                  016a0000000000000000008502190000000000000000007d0a7c006a0700
-                  0000000000000064017c016a000000000000000000850219000000000000
-                  0000007d0b741100000000000000000000741200000000000000000000a6
-                  010000ab0100000000000000006a0a000000000000000064027a0b000064
-                  037a0b0000a00b0000000000000000000000000000000000000000a60000
-                  00ab0000000000000000007d0c7c0ca00c00000000000000000000000000
-                  00000000000000640464057c039b009d02a6020000ab0200000000000000
-                  007d0c64068400741b000000000000000000007c067c077c08a6030000ab
-                  0300000000000000004400a6000000ab0000000000000000006407840074
-                  1b000000000000000000007c097c0a7c0ba6030000ab0300000000000000
-                  004400a6000000ab00000000000000000064089c027d0d74030000000000
-                  00000000007c006a0e0000000000000000a6010000ab0100000000000000
-                  0064096b040000000072697c006a0e000000000000000064017c016a0000
-                  000000000000008502190000000000000000007d0e7c006a0f0000000000
-                  00000064017c016a0000000000000000008502190000000000000000007d
-                  0f7c006a10000000000000000064017c016a000000000000000000850219
-                  0000000000000000007d107c0f81027c10800a4a00640aa6000000ab0000
-                  000000000000008201640b8400741b000000000000000000007c0e7c0f7c
-                  10a6030000ab0300000000000000004400a6000000ab0000000000000000
-                  007c0d640c3c0000006e227423000000000000000000006a120000000000
-                  000000640d640e7c0c7422000000000000000000006a1300000000000000
-                  00ac0fa6040000ab0400000000000000007d0c7429000000000000000000
-                  007c047c0c690164107c037c0d69016901ac11a6020000ab020000000000
-                  0000005300
-                82           0 RESUME                   0
+                  0x9700740100000000000000000000740200000000000000000000a60100
+                  00ab0100000000000000006a02000000000000000064017a0b000064027a
+                  0b0000a0030000000000000000000000000000000000000000a6000000ab
+                  0000000000000000007d067c06a004000000000000000000000000000000
+                  0000000000640364047c039b009d02a6020000ab0200000000000000007d
+                  0669007d07740b000000000000000000007c006a060000000000000000a6
+                  010000ab01000000000000000064056b04000000007254740b0000000000
+                  00000000007c006a060000000000000000a6010000ab0100000000000000
+                  007c016a0700000000000000006b0500000000730a4a006406a6000000ab
+                  0000000000000000008201640784007411000000000000000000007c006a
+                  0600000000000000007c006a0900000000000000007c006a0a0000000000
+                  000000a6030000ab0300000000000000004400a6000000ab000000000000
+                  0000007c0764083c00000074110000000000000000000067006409a20167
+                  00640aa201a6020000ab02000000000000000044005dd45c0200007d087d
+                  09740b000000000000000000007417000000000000000000007c007c089b
+                  00640b9d02a6020000ab020000000000000000a6010000ab010000000000
+                  00000064056b040000000072ab740b000000000000000000007417000000
+                  000000000000007c007c089b00640b9d02a6020000ab0200000000000000
+                  00a6010000ab0100000000000000007c016a0700000000000000006b0500
+                  000000730a4a006406a6000000ab0000000000000000008201640c840074
+                  11000000000000000000007417000000000000000000007c007c089b0064
+                  0b9d02a6020000ab020000000000000000640d7c016a0700000000000000
+                  008502190000000000000000007417000000000000000000007c007c089b
+                  00640e9d02a6020000ab020000000000000000640d7c016a070000000000
+                  0000008502190000000000000000007417000000000000000000007c007c
+                  089b00640f9d02a6020000ab020000000000000000640d7c016a07000000
+                  0000000000850219000000000000000000a6030000ab0300000000000000
+                  004400a6000000ab0000000000000000007c077c093c0000008cd5741900
+                  0000000000000000007c047c06690164107c037c0769016901ac11a60200
+                  00ab0200000000000000005300
+                90           0 RESUME                   0
                
-                97           2 LOAD_FAST                1 (cfg)
-                             4 LOAD_ATTR                0 (n_rows)
-                            14 LOAD_GLOBAL              3 (NULL + len)
-                            26 LOAD_FAST                0 (self)
-                            28 LOAD_ATTR                2 (neuron_alignment_indices)
-                            38 PRECALL                  1
-                            42 CALL                     1
-                            52 COMPARE_OP               1 (<=)
-                            58 POP_JUMP_FORWARD_IF_TRUE     2 (to 64)
-                            60 LOAD_ASSERTION_ERROR
-                            62 RAISE_VARARGS            1
+               105           2 LOAD_GLOBAL              1 (NULL + Path)
+                            14 LOAD_GLOBAL              2 (__file__)
+                            26 PRECALL                  1
+                            30 CALL                     1
+                            40 LOAD_ATTR                2 (parent)
+                            50 LOAD_CONST               1 ('html')
+                            52 BINARY_OP               11 (/)
+                            56 LOAD_CONST               2 ('feature_tables_template.html')
+                            58 BINARY_OP               11 (/)
+                            62 LOAD_METHOD              3 (read_text)
+                            84 PRECALL                  0
+                            88 CALL                     0
+                            98 STORE_FAST               6 (html_str)
                
-                98     >>   64 LOAD_FAST                0 (self)
-                            66 LOAD_ATTR                2 (neuron_alignment_indices)
-                            76 LOAD_CONST               1 (None)
-                            78 LOAD_FAST                1 (cfg)
-                            80 LOAD_ATTR                0 (n_rows)
-                            90 BUILD_SLICE              2
-                            92 BINARY_SUBSCR
-                           102 STORE_FAST               6 (neuron_alignment_indices)
+               106         100 LOAD_FAST                6 (html_str)
+                           102 LOAD_METHOD              4 (replace)
+                           124 LOAD_CONST               3 ('FEATURE_TABLES_ID')
+                           126 LOAD_CONST               4 ('feature-tables-')
+                           128 LOAD_FAST                3 (id_suffix)
+                           130 FORMAT_VALUE             0
+                           132 BUILD_STRING             2
+                           134 PRECALL                  2
+                           138 CALL                     2
+                           148 STORE_FAST               6 (html_str)
                
-                99         104 LOAD_FAST                0 (self)
-                           106 LOAD_ATTR                3 (neuron_alignment_values)
-                           116 LOAD_CONST               1 (None)
-                           118 LOAD_FAST                1 (cfg)
-                           120 LOAD_ATTR                0 (n_rows)
-                           130 BUILD_SLICE              2
-                           132 BINARY_SUBSCR
-                           142 STORE_FAST               7 (neuron_alignment_values)
+               109         150 BUILD_MAP                0
+                           152 STORE_FAST               7 (data)
                
-               100         144 LOAD_FAST                0 (self)
-                           146 LOAD_ATTR                4 (neuron_alignment_l1)
-                           156 LOAD_CONST               1 (None)
-                           158 LOAD_FAST                1 (cfg)
-                           160 LOAD_ATTR                0 (n_rows)
-                           170 BUILD_SLICE              2
-                           172 BINARY_SUBSCR
-                           182 STORE_FAST               8 (neuron_alignment_l1)
+               112         154 LOAD_GLOBAL             11 (NULL + len)
+                           166 LOAD_FAST                0 (self)
+                           168 LOAD_ATTR                6 (neuron_alignment_indices)
+                           178 PRECALL                  1
+                           182 CALL                     1
+                           192 LOAD_CONST               5 (0)
+                           194 COMPARE_OP               4 (>)
+                           200 POP_JUMP_FORWARD_IF_FALSE    84 (to 370)
+               
+               113         202 LOAD_GLOBAL             11 (NULL + len)
+                           214 LOAD_FAST                0 (self)
+                           216 LOAD_ATTR                6 (neuron_alignment_indices)
+                           226 PRECALL                  1
+                           230 CALL                     1
+                           240 LOAD_FAST                1 (cfg)
+                           242 LOAD_ATTR                7 (n_rows)
+                           252 COMPARE_OP               5 (>=)
+                           258 POP_JUMP_FORWARD_IF_TRUE    10 (to 280)
+                           260 LOAD_ASSERTION_ERROR
+                           262 LOAD_CONST               6 ('Not enough rows!')
+                           264 PRECALL                  0
+                           268 CALL                     0
+                           278 RAISE_VARARGS            1
+               
+               114     >>  280 LOAD_CONST               7 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 114>)
+                           282 MAKE_FUNCTION            0
+               
+               116         284 LOAD_GLOBAL             17 (NULL + zip)
+               
+               117         296 LOAD_FAST                0 (self)
+                           298 LOAD_ATTR                6 (neuron_alignment_indices)
+               
+               118         308 LOAD_FAST                0 (self)
+                           310 LOAD_ATTR                9 (neuron_alignment_values)
+               
+               119         320 LOAD_FAST                0 (self)
+                           322 LOAD_ATTR               10 (neuron_alignment_l1)
+               
+               116         332 PRECALL                  3
+                           336 CALL                     3
+               
+               114         346 GET_ITER
+                           348 PRECALL                  0
+                           352 CALL                     0
+                           362 LOAD_FAST                7 (data)
+                           364 LOAD_CONST               8 ('neuronAlignment')
+                           366 STORE_SUBSCR
+               
+               124     >>  370 LOAD_GLOBAL             17 (NULL + zip)
+               
+               125         382 BUILD_LIST               0
+                           384 LOAD_CONST               9 (('correlated_neurons', 'correlated_features', 'correlated_b_features'))
+                           386 LIST_EXTEND              1
+               
+               126         388 BUILD_LIST               0
+                           390 LOAD_CONST              10 (('correlatedNeurons', 'correlatedFeatures', 'correlatedFeaturesB'))
+                           392 LIST_EXTEND              1
                
-               101         184 LOAD_FAST                0 (self)
-                           186 LOAD_ATTR                5 (correlated_neurons_indices)
-                           196 LOAD_CONST               1 (None)
-                           198 LOAD_FAST                1 (cfg)
-                           200 LOAD_ATTR                0 (n_rows)
-                           210 BUILD_SLICE              2
-                           212 BINARY_SUBSCR
-                           222 STORE_FAST               9 (correlated_neurons_indices)
+               124         394 PRECALL                  2
+                           398 CALL                     2
+                           408 GET_ITER
+                       >>  410 FOR_ITER               212 (to 836)
+                           412 UNPACK_SEQUENCE          2
+                           416 STORE_FAST               8 (name)
+                           418 STORE_FAST               9 (js_name)
                
-               102         224 LOAD_FAST                0 (self)
-                           226 LOAD_ATTR                6 (correlated_neurons_pearson)
-                           236 LOAD_CONST               1 (None)
-                           238 LOAD_FAST                1 (cfg)
-                           240 LOAD_ATTR                0 (n_rows)
-                           250 BUILD_SLICE              2
-                           252 BINARY_SUBSCR
-                           262 STORE_FAST              10 (correlated_neurons_pearson)
-               
-               103         264 LOAD_FAST                0 (self)
-                           266 LOAD_ATTR                7 (correlated_neurons_cossim)
-                           276 LOAD_CONST               1 (None)
-                           278 LOAD_FAST                1 (cfg)
-                           280 LOAD_ATTR                0 (n_rows)
-                           290 BUILD_SLICE              2
-                           292 BINARY_SUBSCR
-                           302 STORE_FAST              11 (correlated_neurons_cossim)
-               
-               106         304 LOAD_GLOBAL             17 (NULL + Path)
-                           316 LOAD_GLOBAL             18 (__file__)
-                           328 PRECALL                  1
-                           332 CALL                     1
-                           342 LOAD_ATTR               10 (parent)
-                           352 LOAD_CONST               2 ('html')
-                           354 BINARY_OP               11 (/)
-                           358 LOAD_CONST               3 ('feature_tables_template.html')
-                           360 BINARY_OP               11 (/)
-                           364 LOAD_METHOD             11 (read_text)
-                           386 PRECALL                  0
-                           390 CALL                     0
-                           400 STORE_FAST              12 (html_str)
-               
-               107         402 LOAD_FAST               12 (html_str)
-                           404 LOAD_METHOD             12 (replace)
-                           426 LOAD_CONST               4 ('FEATURE_TABLES_ID')
-                           428 LOAD_CONST               5 ('feature-tables-')
-                           430 LOAD_FAST                3 (id_suffix)
-                           432 FORMAT_VALUE             0
-                           434 BUILD_STRING             2
-                           436 PRECALL                  2
-                           440 CALL                     2
-                           450 STORE_FAST              12 (html_str)
-               
-               111         452 LOAD_CONST               6 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 111>)
-                           454 MAKE_FUNCTION            0
-               
-               113         456 LOAD_GLOBAL             27 (NULL + zip)
-                           468 LOAD_FAST                6 (neuron_alignment_indices)
-                           470 LOAD_FAST                7 (neuron_alignment_values)
-                           472 LOAD_FAST                8 (neuron_alignment_l1)
-                           474 PRECALL                  3
-                           478 CALL                     3
-               
-               111         488 GET_ITER
-                           490 PRECALL                  0
-                           494 CALL                     0
-               
-               115         504 LOAD_CONST               7 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 115>)
-                           506 MAKE_FUNCTION            0
-               
-               117         508 LOAD_GLOBAL             27 (NULL + zip)
-                           520 LOAD_FAST                9 (correlated_neurons_indices)
-                           522 LOAD_FAST               10 (correlated_neurons_pearson)
-                           524 LOAD_FAST               11 (correlated_neurons_cossim)
-                           526 PRECALL                  3
-                           530 CALL                     3
-               
-               115         540 GET_ITER
-                           542 PRECALL                  0
-                           546 CALL                     0
-               
-               110         556 LOAD_CONST               8 (('neuronAlignment', 'correlatedNeurons'))
-                           558 BUILD_CONST_KEY_MAP      2
-                           560 STORE_FAST              13 (data)
-               
-               122         562 LOAD_GLOBAL              3 (NULL + len)
-                           574 LOAD_FAST                0 (self)
-                           576 LOAD_ATTR               14 (correlated_features_indices)
-                           586 PRECALL                  1
-                           590 CALL                     1
-                           600 LOAD_CONST               9 (0)
-                           602 COMPARE_OP               4 (>)
-                           608 POP_JUMP_FORWARD_IF_FALSE   105 (to 820)
-               
-               123         610 LOAD_FAST                0 (self)
-                           612 LOAD_ATTR               14 (correlated_features_indices)
-                           622 LOAD_CONST               1 (None)
-                           624 LOAD_FAST                1 (cfg)
-                           626 LOAD_ATTR                0 (n_rows)
-                           636 BUILD_SLICE              2
-                           638 BINARY_SUBSCR
-                           648 STORE_FAST              14 (correlated_features_indices)
-               
-               124         650 LOAD_FAST                0 (self)
-                           652 LOAD_ATTR               15 (correlated_features_pearson)
-                           662 LOAD_CONST               1 (None)
-                           664 LOAD_FAST                1 (cfg)
-                           666 LOAD_ATTR                0 (n_rows)
-                           676 BUILD_SLICE              2
-                           678 BINARY_SUBSCR
-                           688 STORE_FAST              15 (correlated_features_pearson)
-               
-               125         690 LOAD_FAST                0 (self)
-                           692 LOAD_ATTR               16 (correlated_features_cossim)
-                           702 LOAD_CONST               1 (None)
-                           704 LOAD_FAST                1 (cfg)
-                           706 LOAD_ATTR                0 (n_rows)
-                           716 BUILD_SLICE              2
-                           718 BINARY_SUBSCR
-                           728 STORE_FAST              16 (correlated_features_cossim)
-               
-               127         730 LOAD_FAST               15 (correlated_features_pearson)
-                           732 POP_JUMP_FORWARD_IF_NONE     2 (to 738)
-                           734 LOAD_FAST               16 (correlated_features_cossim)
-                           736 POP_JUMP_FORWARD_IF_NOT_NONE    10 (to 758)
-                       >>  738 LOAD_ASSERTION_ERROR
-                           740 LOAD_CONST              10 ('All or none')
-                           742 PRECALL                  0
-                           746 CALL                     0
-                           756 RAISE_VARARGS            1
-               
-               128     >>  758 LOAD_CONST              11 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 128>)
-                           760 MAKE_FUNCTION            0
-               
-               130         762 LOAD_GLOBAL             27 (NULL + zip)
-                           774 LOAD_FAST               14 (correlated_features_indices)
-                           776 LOAD_FAST               15 (correlated_features_pearson)
-                           778 LOAD_FAST               16 (correlated_features_cossim)
-                           780 PRECALL                  3
-                           784 CALL                     3
-               
-               128         794 GET_ITER
-                           796 PRECALL                  0
-                           800 CALL                     0
-                           810 LOAD_FAST               13 (data)
-                           812 LOAD_CONST              12 ('correlatedFeaturesB')
-                           814 STORE_SUBSCR
-                           818 JUMP_FORWARD            34 (to 888)
-               
-               134     >>  820 LOAD_GLOBAL             35 (NULL + re)
-                           832 LOAD_ATTR               18 (sub)
-                           842 LOAD_CONST              13 ('<h4>CORRELATED FEATURES \\(B-ENCODER\\)</h4>.*?</table>')
-                           844 LOAD_CONST              14 ('')
-                           846 LOAD_FAST               12 (html_str)
-                           848 LOAD_GLOBAL             34 (re)
-                           860 LOAD_ATTR               19 (DOTALL)
-                           870 KW_NAMES                15
-                           872 PRECALL                  4
-                           876 CALL                     4
-                           886 STORE_FAST              12 (html_str)
-               
-               136     >>  888 LOAD_GLOBAL             41 (NULL + HTML)
-               
-               137         900 LOAD_FAST                4 (column)
-                           902 LOAD_FAST               12 (html_str)
-                           904 BUILD_MAP                1
-               
-               138         906 LOAD_CONST              16 ('featureTablesData')
-                           908 LOAD_FAST                3 (id_suffix)
-                           910 LOAD_FAST               13 (data)
-                           912 BUILD_MAP                1
-                           914 BUILD_MAP                1
-               
-               136         916 KW_NAMES                17
-                           918 PRECALL                  2
-                           922 CALL                     2
-                           932 RETURN_VALUE
+               128         420 LOAD_GLOBAL             11 (NULL + len)
+                           432 LOAD_GLOBAL             23 (NULL + getattr)
+                           444 LOAD_FAST                0 (self)
+                           446 LOAD_FAST                8 (name)
+                           448 FORMAT_VALUE             0
+                           450 LOAD_CONST              11 ('_indices')
+                           452 BUILD_STRING             2
+                           454 PRECALL                  2
+                           458 CALL                     2
+                           468 PRECALL                  1
+                           472 CALL                     1
+                           482 LOAD_CONST               5 (0)
+                           484 COMPARE_OP               4 (>)
+                           490 POP_JUMP_FORWARD_IF_FALSE   171 (to 834)
+               
+               129         492 LOAD_GLOBAL             11 (NULL + len)
+                           504 LOAD_GLOBAL             23 (NULL + getattr)
+                           516 LOAD_FAST                0 (self)
+                           518 LOAD_FAST                8 (name)
+                           520 FORMAT_VALUE             0
+                           522 LOAD_CONST              11 ('_indices')
+                           524 BUILD_STRING             2
+                           526 PRECALL                  2
+                           530 CALL                     2
+                           540 PRECALL                  1
+                           544 CALL                     1
+                           554 LOAD_FAST                1 (cfg)
+                           556 LOAD_ATTR                7 (n_rows)
+                           566 COMPARE_OP               5 (>=)
+                           572 POP_JUMP_FORWARD_IF_TRUE    10 (to 594)
+                           574 LOAD_ASSERTION_ERROR
+                           576 LOAD_CONST               6 ('Not enough rows!')
+                           578 PRECALL                  0
+                           582 CALL                     0
+                           592 RAISE_VARARGS            1
+               
+               130     >>  594 LOAD_CONST              12 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 130>)
+                           596 MAKE_FUNCTION            0
+               
+               132         598 LOAD_GLOBAL             17 (NULL + zip)
+               
+               133         610 LOAD_GLOBAL             23 (NULL + getattr)
+                           622 LOAD_FAST                0 (self)
+                           624 LOAD_FAST                8 (name)
+                           626 FORMAT_VALUE             0
+                           628 LOAD_CONST              11 ('_indices')
+                           630 BUILD_STRING             2
+                           632 PRECALL                  2
+                           636 CALL                     2
+                           646 LOAD_CONST              13 (None)
+                           648 LOAD_FAST                1 (cfg)
+                           650 LOAD_ATTR                7 (n_rows)
+                           660 BUILD_SLICE              2
+                           662 BINARY_SUBSCR
+               
+               134         672 LOAD_GLOBAL             23 (NULL + getattr)
+                           684 LOAD_FAST                0 (self)
+                           686 LOAD_FAST                8 (name)
+                           688 FORMAT_VALUE             0
+                           690 LOAD_CONST              14 ('_pearson')
+                           692 BUILD_STRING             2
+                           694 PRECALL                  2
+                           698 CALL                     2
+                           708 LOAD_CONST              13 (None)
+                           710 LOAD_FAST                1 (cfg)
+                           712 LOAD_ATTR                7 (n_rows)
+                           722 BUILD_SLICE              2
+                           724 BINARY_SUBSCR
+               
+               135         734 LOAD_GLOBAL             23 (NULL + getattr)
+                           746 LOAD_FAST                0 (self)
+                           748 LOAD_FAST                8 (name)
+                           750 FORMAT_VALUE             0
+                           752 LOAD_CONST              15 ('_cossim')
+                           754 BUILD_STRING             2
+                           756 PRECALL                  2
+                           760 CALL                     2
+                           770 LOAD_CONST              13 (None)
+                           772 LOAD_FAST                1 (cfg)
+                           774 LOAD_ATTR                7 (n_rows)
+                           784 BUILD_SLICE              2
+                           786 BINARY_SUBSCR
+               
+               132         796 PRECALL                  3
+                           800 CALL                     3
+               
+               130         810 GET_ITER
+                           812 PRECALL                  0
+                           816 CALL                     0
+                           826 LOAD_FAST                7 (data)
+                           828 LOAD_FAST                9 (js_name)
+                           830 STORE_SUBSCR
+                       >>  834 JUMP_BACKWARD          213 (to 410)
+               
+               139     >>  836 LOAD_GLOBAL             25 (NULL + HTML)
+               
+               140         848 LOAD_FAST                4 (column)
+                           850 LOAD_FAST                6 (html_str)
+                           852 BUILD_MAP                1
+               
+               141         854 LOAD_CONST              16 ('featureTablesData')
+                           856 LOAD_FAST                3 (id_suffix)
+                           858 LOAD_FAST                7 (data)
+                           860 BUILD_MAP                1
+                           862 BUILD_MAP                1
+               
+               139         864 KW_NAMES                17
+                           866 PRECALL                  2
+                           870 CALL                     2
+                           880 RETURN_VALUE
                consts
                   "\n        Returns the HTML for the left-hand tables, wrapped in a 'grid-column' div.\n\n        Note, we only ever use this obj in the context of the left-hand column of the feature-centric vis, and it's\n        always the same width & height, which is why there's no customization available for this function.\n        "
-                  None
                   'html'
                   'feature_tables_template.html'
                   'FEATURE_TABLES_ID'
                   'feature-tables-'
+                  0
+                  'Not enough rows!'
                   code
                      argcount  : 1
                      nlocals   : 4
                      stacksize : 6
                      flags     : 19
                      code
                         0x970067007c005d105c0300007d017d027d037c017c0264009b047c0364
                         019b0464029c0391028c115300
-                     111           0 RESUME                   0
+                     114           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                16 (to 40)
                      
-                     113           8 UNPACK_SEQUENCE          3
+                     116           8 UNPACK_SEQUENCE          3
                                   12 STORE_FAST               1 (I)
                                   14 STORE_FAST               2 (V)
                                   16 STORE_FAST               3 (L)
                      
-                     112          18 LOAD_FAST                1 (I)
+                     115          18 LOAD_FAST                1 (I)
                                   20 LOAD_FAST                2 (V)
                                   22 LOAD_CONST               0 ('+.3f')
                                   24 FORMAT_VALUE             4 (with format)
                                   26 LOAD_FAST                3 (L)
                                   28 LOAD_CONST               1 ('.1%')
                                   30 FORMAT_VALUE             4 (with format)
                                   32 LOAD_CONST               2 (('index', 'value', 'percentageL1'))
                                   34 BUILD_CONST_KEY_MAP      3
                      
-                     111          36 LIST_APPEND              2
+                     114          36 LIST_APPEND              2
                                   38 JUMP_BACKWARD           17 (to 6)
                              >>   40 RETURN_VALUE
                      consts
                         '+.3f'
                         '.1%'
                         ('index', 'value', 'percentageL1')
                      names      ()
                      varnames   ('.0', 'I', 'V', 'L')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 111
-                     lnotab 0x08020aff12ff
-                  code
-                     argcount  : 1
-                     nlocals   : 4
-                     stacksize : 6
-                     flags     : 19
-                     code
-                        0x970067007c005d105c0300007d017d027d037c017c0264009b047c0364
-                        009b0464019c0391028c115300
-                     115           0 RESUME                   0
-                                   2 BUILD_LIST               0
-                                   4 LOAD_FAST                0 (.0)
-                             >>    6 FOR_ITER                16 (to 40)
-                     
-                     117           8 UNPACK_SEQUENCE          3
-                                  12 STORE_FAST               1 (I)
-                                  14 STORE_FAST               2 (P)
-                                  16 STORE_FAST               3 (C)
-                     
-                     116          18 LOAD_FAST                1 (I)
-                                  20 LOAD_FAST                2 (P)
-                                  22 LOAD_CONST               0 ('+.3f')
-                                  24 FORMAT_VALUE             4 (with format)
-                                  26 LOAD_FAST                3 (C)
-                                  28 LOAD_CONST               0 ('+.3f')
-                                  30 FORMAT_VALUE             4 (with format)
-                                  32 LOAD_CONST               1 (('index', 'value', 'percentageL1'))
-                                  34 BUILD_CONST_KEY_MAP      3
-                     
-                     115          36 LIST_APPEND              2
-                                  38 JUMP_BACKWARD           17 (to 6)
-                             >>   40 RETURN_VALUE
-                     consts
-                        '+.3f'
-                        ('index', 'value', 'percentageL1')
-                     names      ()
-                     varnames   ('.0', 'I', 'P', 'C')
-                     freevars   ()
-                     cellvars   ()
-                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
-                     name       '<listcomp>'
-                     firstlineno 115
+                     firstlineno 114
                      lnotab 0x08020aff12ff
-                  ('neuronAlignment', 'correlatedNeurons')
-                  0
-                  'All or none'
+                  'neuronAlignment'
+                  ('correlated_neurons', 'correlated_features', 'correlated_b_features')
+                  ('correlatedNeurons', 'correlatedFeatures', 'correlatedFeaturesB')
+                  '_indices'
                   code
                      argcount  : 1
                      nlocals   : 4
                      stacksize : 6
                      flags     : 19
                      code
                         0x970067007c005d105c0300007d017d027d037c017c0264009b047c0364
                         009b0464019c0391028c115300
-                     128           0 RESUME                   0
+                     130           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                16 (to 40)
                      
-                     130           8 UNPACK_SEQUENCE          3
+                     132           8 UNPACK_SEQUENCE          3
                                   12 STORE_FAST               1 (I)
                                   14 STORE_FAST               2 (P)
                                   16 STORE_FAST               3 (C)
                      
-                     129          18 LOAD_FAST                1 (I)
+                     131          18 LOAD_FAST                1 (I)
                                   20 LOAD_FAST                2 (P)
                                   22 LOAD_CONST               0 ('+.3f')
                                   24 FORMAT_VALUE             4 (with format)
                                   26 LOAD_FAST                3 (C)
                                   28 LOAD_CONST               0 ('+.3f')
                                   30 FORMAT_VALUE             4 (with format)
                                   32 LOAD_CONST               1 (('index', 'value', 'percentageL1'))
                                   34 BUILD_CONST_KEY_MAP      3
                      
-                     128          36 LIST_APPEND              2
+                     130          36 LIST_APPEND              2
                                   38 JUMP_BACKWARD           17 (to 6)
                              >>   40 RETURN_VALUE
                      consts
                         '+.3f'
                         ('index', 'value', 'percentageL1')
                      names      ()
                      varnames   ('.0', 'I', 'P', 'C')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 128
+                     firstlineno 130
                      lnotab 0x08020aff12ff
-                  'correlatedFeaturesB'
-                  '<h4>CORRELATED FEATURES \\(B-ENCODER\\)</h4>.*?</table>'
-                  ''
-                  ('flags',)
+                  None
+                  '_pearson'
+                  '_cossim'
                   'featureTablesData'
                   ('html_data', 'js_data')
-               names      ('n_rows', 'len', 'neuron_alignment_indices', 'neuron_alignment_values', 'neuron_alignment_l1', 'correlated_neurons_indices', 'correlated_neurons_pearson', 'correlated_neurons_cossim', 'Path', '__file__', 'parent', 'read_text', 'replace', 'zip', 'correlated_features_indices', 'correlated_features_pearson', 'correlated_features_cossim', 're', 'sub', 'DOTALL', 'HTML')
-               varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'neuron_alignment_indices', 'neuron_alignment_values', 'neuron_alignment_l1', 'correlated_neurons_indices', 'correlated_neurons_pearson', 'correlated_neurons_cossim', 'html_str', 'data', 'correlated_features_indices', 'correlated_features_pearson', 'correlated_features_cossim')
+               names      ('Path', '__file__', 'parent', 'read_text', 'replace', 'len', 'neuron_alignment_indices', 'n_rows', 'zip', 'neuron_alignment_values', 'neuron_alignment_l1', 'getattr', 'HTML')
+               varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'html_str', 'data', 'name', 'js_name')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data'
-               firstlineno 82
+               firstlineno 90
                lnotab
-                  0x020f3e0128012801280128012801280362013204040220fe1004040220
-                  fe10fb060c30012801280128021c01040220fe1a0644020c0106010afe
+                  0x020f62013203040330014e0104020c010c010c010cfd0efe180a0c0106
+                  0106fe1a044801660104020c013e013e013efd0efe1a090c0106010afe
             None
-         names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'list', 'neuron_alignment_indices', 'int', '__annotations__', 'neuron_alignment_values', 'float', 'neuron_alignment_l1', 'correlated_neurons_indices', 'correlated_neurons_pearson', 'correlated_neurons_cossim', 'correlated_features_indices', 'correlated_features_pearson', 'correlated_features_cossim', 'FeatureTablesConfig', 'Callable', 'str', 'tuple', 'dict', 'Any', 'HTML', '_get_html_data')
+         names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'list', 'neuron_alignment_indices', 'int', '__annotations__', 'neuron_alignment_values', 'float', 'neuron_alignment_l1', 'correlated_neurons_indices', 'correlated_neurons_pearson', 'correlated_neurons_cossim', 'correlated_features_indices', 'correlated_features_pearson', 'correlated_features_cossim', 'correlated_b_features_indices', 'correlated_b_features_pearson', 'correlated_b_features_cossim', 'FeatureTablesConfig', 'Callable', 'str', 'tuple', 'dict', 'Any', 'HTML', '_get_html_data')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'FeatureTablesData'
-         firstlineno 49
+         firstlineno 50
          lnotab
-            0x0c0304142e012e012e012e012e012e012e012e012e0802fa040202fe02
-            0338fd020402fc020518fb020612fa020702f9
+            0x0c0304182e012e012e012e012e012e012e012e012e012e012e012e0802
+            fa040202fe020338fd020402fc020518fb020612fa020702f9
       'FeatureTablesData'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 13
          flags     : 0
          code
             0x970065005a0164005a0269006601640165036402650465056506650519
             0000000000000000007a0700006701650765066507190000000000000000
             007a07000066021900000000000000000064036507640465056508650565
             056602190000000000000000007a070000640565096507650a6602190000
             000000000000006406650b660c640784055a0c64085300
-         142           0 RESUME                   0
+         145           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('ActsHistogramData')
                        8 STORE_NAME               2 (__qualname__)
          
-         151          10 BUILD_MAP                0
+         154          10 BUILD_MAP                0
          
-         145          12 BUILD_TUPLE              1
+         148          12 BUILD_TUPLE              1
                       14 LOAD_CONST               1 ('cfg')
          
-         147          16 LOAD_NAME                3 (ActsHistogramConfig)
+         150          16 LOAD_NAME                3 (ActsHistogramConfig)
          
-         145          18 LOAD_CONST               2 ('decode_fn')
+         148          18 LOAD_CONST               2 ('decode_fn')
          
-         148          20 LOAD_NAME                4 (Callable)
+         151          20 LOAD_NAME                4 (Callable)
                       22 LOAD_NAME                5 (int)
                       24 LOAD_NAME                6 (list)
                       26 LOAD_NAME                5 (int)
                       28 BINARY_SUBSCR
                       38 BINARY_OP                7 (|)
                       42 BUILD_LIST               1
                       44 LOAD_NAME                7 (str)
                       46 LOAD_NAME                6 (list)
                       48 LOAD_NAME                7 (str)
                       50 BINARY_SUBSCR
                       60 BINARY_OP                7 (|)
                       64 BUILD_TUPLE              2
                       66 BINARY_SUBSCR
          
-         145          76 LOAD_CONST               3 ('id_suffix')
+         148          76 LOAD_CONST               3 ('id_suffix')
          
-         149          78 LOAD_NAME                7 (str)
+         152          78 LOAD_NAME                7 (str)
          
-         145          80 LOAD_CONST               4 ('column')
+         148          80 LOAD_CONST               4 ('column')
          
-         150          82 LOAD_NAME                5 (int)
+         153          82 LOAD_NAME                5 (int)
                       84 LOAD_NAME                8 (tuple)
                       86 LOAD_NAME                5 (int)
                       88 LOAD_NAME                5 (int)
                       90 BUILD_TUPLE              2
                       92 BINARY_SUBSCR
                      102 BINARY_OP                7 (|)
          
-         145         106 LOAD_CONST               5 ('component_specific_kwargs')
+         148         106 LOAD_CONST               5 ('component_specific_kwargs')
          
-         151         108 LOAD_NAME                9 (dict)
+         154         108 LOAD_NAME                9 (dict)
                      110 LOAD_NAME                7 (str)
                      112 LOAD_NAME               10 (Any)
                      114 BUILD_TUPLE              2
                      116 BINARY_SUBSCR
          
-         145         126 LOAD_CONST               6 ('return')
+         148         126 LOAD_CONST               6 ('return')
          
-         152         128 LOAD_NAME               11 (HTML)
+         155         128 LOAD_NAME               11 (HTML)
          
-         145         130 BUILD_TUPLE             12
-                     132 LOAD_CONST               7 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 145>)
+         148         130 BUILD_TUPLE             12
+                     132 LOAD_CONST               7 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 148>)
                      134 MAKE_FUNCTION            5 (defaults, annotations)
                      136 STORE_NAME              12 (_get_html_data)
                      138 LOAD_CONST               8 (None)
                      140 RETURN_VALUE
          consts
             'ActsHistogramData'
             'cfg'
@@ -1178,98 +1182,98 @@
                   0000007d0889006a06000000000000000089006a05000000000000000089
                   006a0700000000000000007c0864079c047d0989006a0800000000000000
                   00810a89006a0800000000000000007c0964093c00000074130000000000
                   00000000007c047c066901640a7c037c0969016901ac0ba6020000ab0200
                   000000000000005300
                              0 MAKE_CELL                0 (self)
                
-               145           2 RESUME                   0
+               148           2 RESUME                   0
                
-               162           4 LOAD_GLOBAL              1 (NULL + Path)
+               165           4 LOAD_GLOBAL              1 (NULL + Path)
                             16 LOAD_GLOBAL              2 (__file__)
                             28 PRECALL                  1
                             32 CALL                     1
                             42 LOAD_ATTR                2 (parent)
                             52 LOAD_CONST               1 ('html')
                             54 BINARY_OP               11 (/)
                             58 LOAD_CONST               2 ('acts_histogram_template.html')
                             60 BINARY_OP               11 (/)
                             64 LOAD_METHOD              3 (read_text)
                             86 PRECALL                  0
                             90 CALL                     0
                            100 STORE_FAST               6 (html_str)
                
-               163         102 LOAD_FAST                6 (html_str)
+               166         102 LOAD_FAST                6 (html_str)
                            104 LOAD_METHOD              4 (replace)
                            126 LOAD_CONST               3 ('HISTOGRAM_ACTS_ID')
                            128 LOAD_CONST               4 ('histogram-acts-')
                            130 LOAD_FAST                3 (id_suffix)
                            132 FORMAT_VALUE             0
                            134 BUILD_STRING             2
                            136 PRECALL                  2
                            140 CALL                     2
                            150 STORE_FAST               6 (html_str)
                
-               166         152 LOAD_CLOSURE             0 (self)
+               169         152 LOAD_CLOSURE             0 (self)
                            154 BUILD_TUPLE              1
-                           156 LOAD_CONST               5 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 166>)
+                           156 LOAD_CONST               5 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 169>)
                            158 MAKE_FUNCTION            8 (closure)
                            160 LOAD_DEREF               0 (self)
                            162 LOAD_ATTR                5 (bar_values)
                            172 GET_ITER
                            174 PRECALL                  0
                            178 CALL                     0
                            188 STORE_FAST               7 (bar_values_normed)
                
-               167         190 LOAD_CONST               6 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 167>)
+               170         190 LOAD_CONST               6 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 170>)
                            192 MAKE_FUNCTION            0
                            194 LOAD_FAST                7 (bar_values_normed)
                            196 GET_ITER
                            198 PRECALL                  0
                            202 CALL                     0
                            212 STORE_FAST               8 (bar_colors)
                
-               171         214 LOAD_DEREF               0 (self)
+               174         214 LOAD_DEREF               0 (self)
                            216 LOAD_ATTR                6 (bar_heights)
                
-               172         226 LOAD_DEREF               0 (self)
+               175         226 LOAD_DEREF               0 (self)
                            228 LOAD_ATTR                5 (bar_values)
                
-               173         238 LOAD_DEREF               0 (self)
+               176         238 LOAD_DEREF               0 (self)
                            240 LOAD_ATTR                7 (tick_vals)
                
-               174         250 LOAD_FAST                8 (bar_colors)
+               177         250 LOAD_FAST                8 (bar_colors)
                
-               170         252 LOAD_CONST               7 (('y', 'x', 'ticks', 'colors'))
+               173         252 LOAD_CONST               7 (('y', 'x', 'ticks', 'colors'))
                            254 BUILD_CONST_KEY_MAP      4
                            256 STORE_FAST               9 (data)
                
-               176         258 LOAD_DEREF               0 (self)
+               179         258 LOAD_DEREF               0 (self)
                            260 LOAD_ATTR                8 (title)
                            270 POP_JUMP_FORWARD_IF_NONE    10 (to 292)
                
-               177         272 LOAD_DEREF               0 (self)
+               180         272 LOAD_DEREF               0 (self)
                            274 LOAD_ATTR                8 (title)
                            284 LOAD_FAST                9 (data)
                            286 LOAD_CONST               9 ('title')
                            288 STORE_SUBSCR
                
-               179     >>  292 LOAD_GLOBAL             19 (NULL + HTML)
+               182     >>  292 LOAD_GLOBAL             19 (NULL + HTML)
                
-               180         304 LOAD_FAST                4 (column)
+               183         304 LOAD_FAST                4 (column)
                            306 LOAD_FAST                6 (html_str)
                            308 BUILD_MAP                1
                
-               181         310 LOAD_CONST              10 ('actsHistogramData')
+               184         310 LOAD_CONST              10 ('actsHistogramData')
                            312 LOAD_FAST                3 (id_suffix)
                            314 LOAD_FAST                9 (data)
                            316 BUILD_MAP                1
                            318 BUILD_MAP                1
                
-               179         320 KW_NAMES                11
+               182         320 KW_NAMES                11
                            322 PRECALL                  2
                            326 CALL                     2
                            336 RETURN_VALUE
                consts
                   '\n        Converts data -> HTML object, for the feature activations histogram (i.e. the histogram over all sampled tokens,\n        showing the distribution of activations for this feature).\n        '
                   'html'
                   'acts_histogram_template.html'
@@ -1283,15 +1287,15 @@
                      code
                         0x9501970067007c005d347d01640074010000000000000000000089026a
                         010000000000000000a6010000ab0100000000000000007a05000064017c
                         017a0500007a00000074010000000000000000000089026a010000000000
                         000000a6010000ab0100000000000000007a0b000091028c355300
                                    0 COPY_FREE_VARS           1
                      
-                     166           2 RESUME                   0
+                     169           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                52 (to 114)
                                   10 STORE_FAST               1 (v)
                                   12 LOAD_CONST               0 (0.4)
                                   14 LOAD_GLOBAL              1 (NULL + max)
                                   26 LOAD_DEREF               2 (self)
@@ -1317,25 +1321,25 @@
                         0.6
                      names      ('max', 'bar_values')
                      varnames   ('.0', 'v')
                      freevars   ('self',)
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 166
+                     firstlineno 169
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 5
                      flags     : 19
                      code
                         0x970067007c005d117d017401000000000000000000007c01a6010000ab
                         01000000000000000091028c125300
-                     167           0 RESUME                   0
+                     170           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                17 (to 42)
                                    8 STORE_FAST               1 (v)
                                   10 LOAD_GLOBAL              1 (NULL + bgColorMap)
                                   22 LOAD_FAST                1 (v)
                                   24 PRECALL                  1
@@ -1346,110 +1350,110 @@
                      consts
                      names      ('bgColorMap',)
                      varnames   ('.0', 'v')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 167
+                     firstlineno 170
                      lnotab 0x
                   ('y', 'x', 'ticks', 'colors')
                   None
                   'title'
                   'actsHistogramData'
                   ('html_data', 'js_data')
                names      ('Path', '__file__', 'parent', 'read_text', 'replace', 'bar_values', 'bar_heights', 'tick_vals', 'title', 'HTML')
                varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'html_str', 'bar_values_normed', 'bar_colors', 'data')
                freevars   ()
                cellvars   ('self',)
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data'
-               firstlineno 145
+               firstlineno 148
                lnotab
                   0x041162013203260118040c010c010c0102fc06060e0114020c0106010a
                   fe
             None
          names      ('__name__', '__module__', '__qualname__', 'ActsHistogramConfig', 'Callable', 'int', 'list', 'str', 'tuple', 'dict', 'Any', 'HTML', '_get_html_data')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'ActsHistogramData'
-         firstlineno 142
+         firstlineno 145
          lnotab 0x0a0902fa040202fe020338fd020402fc020518fb020612fa020702f9
       'ActsHistogramData'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 13
          flags     : 0
          code
             0x970065005a0164005a0269006601640165036402650465056506650519
             0000000000000000007a0700006701650765066507190000000000000000
             007a07000066021900000000000000000064036507640465056508650565
             056602190000000000000000007a070000640565096507650a6602190000
             000000000000006406650b660c640784055a0c64085300
-         185           0 RESUME                   0
+         188           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('LogitsHistogramData')
                        8 STORE_NAME               2 (__qualname__)
          
-         194          10 BUILD_MAP                0
+         197          10 BUILD_MAP                0
          
-         188          12 BUILD_TUPLE              1
+         191          12 BUILD_TUPLE              1
                       14 LOAD_CONST               1 ('cfg')
          
-         190          16 LOAD_NAME                3 (LogitsHistogramConfig)
+         193          16 LOAD_NAME                3 (LogitsHistogramConfig)
          
-         188          18 LOAD_CONST               2 ('decode_fn')
+         191          18 LOAD_CONST               2 ('decode_fn')
          
-         191          20 LOAD_NAME                4 (Callable)
+         194          20 LOAD_NAME                4 (Callable)
                       22 LOAD_NAME                5 (int)
                       24 LOAD_NAME                6 (list)
                       26 LOAD_NAME                5 (int)
                       28 BINARY_SUBSCR
                       38 BINARY_OP                7 (|)
                       42 BUILD_LIST               1
                       44 LOAD_NAME                7 (str)
                       46 LOAD_NAME                6 (list)
                       48 LOAD_NAME                7 (str)
                       50 BINARY_SUBSCR
                       60 BINARY_OP                7 (|)
                       64 BUILD_TUPLE              2
                       66 BINARY_SUBSCR
          
-         188          76 LOAD_CONST               3 ('id_suffix')
+         191          76 LOAD_CONST               3 ('id_suffix')
          
-         192          78 LOAD_NAME                7 (str)
+         195          78 LOAD_NAME                7 (str)
          
-         188          80 LOAD_CONST               4 ('column')
+         191          80 LOAD_CONST               4 ('column')
          
-         193          82 LOAD_NAME                5 (int)
+         196          82 LOAD_NAME                5 (int)
                       84 LOAD_NAME                8 (tuple)
                       86 LOAD_NAME                5 (int)
                       88 LOAD_NAME                5 (int)
                       90 BUILD_TUPLE              2
                       92 BINARY_SUBSCR
                      102 BINARY_OP                7 (|)
          
-         188         106 LOAD_CONST               5 ('component_specific_kwargs')
+         191         106 LOAD_CONST               5 ('component_specific_kwargs')
          
-         194         108 LOAD_NAME                9 (dict)
+         197         108 LOAD_NAME                9 (dict)
                      110 LOAD_NAME                7 (str)
                      112 LOAD_NAME               10 (Any)
                      114 BUILD_TUPLE              2
                      116 BINARY_SUBSCR
          
-         188         126 LOAD_CONST               6 ('return')
+         191         126 LOAD_CONST               6 ('return')
          
-         195         128 LOAD_NAME               11 (HTML)
+         198         128 LOAD_NAME               11 (HTML)
          
-         188         130 BUILD_TUPLE             12
-                     132 LOAD_CONST               7 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 188>)
+         191         130 BUILD_TUPLE             12
+                     132 LOAD_CONST               7 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 191>)
                      134 MAKE_FUNCTION            5 (defaults, annotations)
                      136 STORE_NAME              12 (_get_html_data)
                      138 LOAD_CONST               8 (None)
                      140 RETURN_VALUE
          consts
             'LogitsHistogramData'
             'cfg'
@@ -1470,77 +1474,77 @@
                   0000000000000000007d067c06a004000000000000000000000000000000
                   0000000000640364047c039b009d02a6020000ab0200000000000000007d
                   067c006a0500000000000000007c006a0600000000000000007c006a0700
                   0000000000000064059c037d077c006a080000000000000000810a7c006a
                   0800000000000000007c0764073c0000007413000000000000000000007c
                   047c06690164087c037c0769016901ac09a6020000ab0200000000000000
                   005300
-               188           0 RESUME                   0
+               191           0 RESUME                   0
                
-               205           2 LOAD_GLOBAL              1 (NULL + Path)
+               208           2 LOAD_GLOBAL              1 (NULL + Path)
                             14 LOAD_GLOBAL              2 (__file__)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 LOAD_ATTR                2 (parent)
                             50 LOAD_CONST               1 ('html')
                             52 BINARY_OP               11 (/)
                             56 LOAD_CONST               2 ('logits_histogram_template.html')
                             58 BINARY_OP               11 (/)
                             62 LOAD_METHOD              3 (read_text)
                             84 PRECALL                  0
                             88 CALL                     0
                             98 STORE_FAST               6 (html_str)
                
-               206         100 LOAD_FAST                6 (html_str)
+               209         100 LOAD_FAST                6 (html_str)
                            102 LOAD_METHOD              4 (replace)
                            124 LOAD_CONST               3 ('HISTOGRAM_LOGITS_ID')
                            126 LOAD_CONST               4 ('histogram-logits-')
                            128 LOAD_FAST                3 (id_suffix)
                            130 FORMAT_VALUE             0
                            132 BUILD_STRING             2
                            134 PRECALL                  2
                            138 CALL                     2
                            148 STORE_FAST               6 (html_str)
                
-               209         150 LOAD_FAST                0 (self)
+               212         150 LOAD_FAST                0 (self)
                            152 LOAD_ATTR                5 (bar_heights)
                
-               210         162 LOAD_FAST                0 (self)
+               213         162 LOAD_FAST                0 (self)
                            164 LOAD_ATTR                6 (bar_values)
                
-               211         174 LOAD_FAST                0 (self)
+               214         174 LOAD_FAST                0 (self)
                            176 LOAD_ATTR                7 (tick_vals)
                
-               208         186 LOAD_CONST               5 (('y', 'x', 'ticks'))
+               211         186 LOAD_CONST               5 (('y', 'x', 'ticks'))
                            188 BUILD_CONST_KEY_MAP      3
                            190 STORE_FAST               7 (data)
                
-               213         192 LOAD_FAST                0 (self)
+               216         192 LOAD_FAST                0 (self)
                            194 LOAD_ATTR                8 (title)
                            204 POP_JUMP_FORWARD_IF_NONE    10 (to 226)
                
-               214         206 LOAD_FAST                0 (self)
+               217         206 LOAD_FAST                0 (self)
                            208 LOAD_ATTR                8 (title)
                            218 LOAD_FAST                7 (data)
                            220 LOAD_CONST               7 ('title')
                            222 STORE_SUBSCR
                
-               216     >>  226 LOAD_GLOBAL             19 (NULL + HTML)
+               219     >>  226 LOAD_GLOBAL             19 (NULL + HTML)
                
-               217         238 LOAD_FAST                4 (column)
+               220         238 LOAD_FAST                4 (column)
                            240 LOAD_FAST                6 (html_str)
                            242 BUILD_MAP                1
                
-               218         244 LOAD_CONST               8 ('logitsHistogramData')
+               221         244 LOAD_CONST               8 ('logitsHistogramData')
                            246 LOAD_FAST                3 (id_suffix)
                            248 LOAD_FAST                7 (data)
                            250 BUILD_MAP                1
                            252 BUILD_MAP                1
                
-               216         254 KW_NAMES                 9
+               219         254 KW_NAMES                 9
                            256 PRECALL                  2
                            260 CALL                     2
                            270 RETURN_VALUE
                consts
                   '\n        Converts data -> HTML object, for the logits histogram (i.e. the histogram over all tokens in the vocab, showing\n        the distribution of direct logit effect on that token).\n        '
                   'html'
                   'logits_histogram_template.html'
@@ -1553,24 +1557,24 @@
                   ('html_data', 'js_data')
                names      ('Path', '__file__', 'parent', 'read_text', 'replace', 'bar_heights', 'bar_values', 'tick_vals', 'title', 'HTML')
                varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'html_str', 'data')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data'
-               firstlineno 188
+               firstlineno 191
                lnotab 0x0211620132030c010c010cfd06050e0114020c0106010afe
             None
          names      ('__name__', '__module__', '__qualname__', 'LogitsHistogramConfig', 'Callable', 'int', 'list', 'str', 'tuple', 'dict', 'Any', 'HTML', '_get_html_data')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'LogitsHistogramData'
-         firstlineno 185
+         firstlineno 188
          lnotab 0x0a0902fa040202fe020338fd020402fc020518fb020612fa020702f9
       'LogitsHistogramData'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 13
          flags     : 0
@@ -1582,129 +1586,129 @@
             000000000000005a0a6504650619000000000000000000650764043c0000
             00020065036504ac01a6010000ab0100000000000000005a0b6504650919
             000000000000000000650764053c000000690066016406650c6407650d65
             0665046506190000000000000000007a0700006701650e6504650e190000
             000000000000007a0700006602190000000000000000006408650e640965
             06650f650665066602190000000000000000007a070000640a6510650e65
             11660219000000000000000000640b6512660c640c84055a13640d5300
-         222           0 RESUME                   0
+         225           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('LogitsTableData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         226          12 PUSH_NULL
+         229          12 PUSH_NULL
                       14 LOAD_NAME                3 (field)
                       16 LOAD_NAME                4 (list)
                       18 KW_NAMES                 1
                       20 PRECALL                  1
                       24 CALL                     1
                       34 STORE_NAME               5 (bottom_token_ids)
                       36 LOAD_NAME                4 (list)
                       38 LOAD_NAME                6 (int)
                       40 BINARY_SUBSCR
                       50 LOAD_NAME                7 (__annotations__)
                       52 LOAD_CONST               2 ('bottom_token_ids')
                       54 STORE_SUBSCR
          
-         227          58 PUSH_NULL
+         230          58 PUSH_NULL
                       60 LOAD_NAME                3 (field)
                       62 LOAD_NAME                4 (list)
                       64 KW_NAMES                 1
                       66 PRECALL                  1
                       70 CALL                     1
                       80 STORE_NAME               8 (bottom_logits)
                       82 LOAD_NAME                4 (list)
                       84 LOAD_NAME                9 (float)
                       86 BINARY_SUBSCR
                       96 LOAD_NAME                7 (__annotations__)
                       98 LOAD_CONST               3 ('bottom_logits')
                      100 STORE_SUBSCR
          
-         228         104 PUSH_NULL
+         231         104 PUSH_NULL
                      106 LOAD_NAME                3 (field)
                      108 LOAD_NAME                4 (list)
                      110 KW_NAMES                 1
                      112 PRECALL                  1
                      116 CALL                     1
                      126 STORE_NAME              10 (top_token_ids)
                      128 LOAD_NAME                4 (list)
                      130 LOAD_NAME                6 (int)
                      132 BINARY_SUBSCR
                      142 LOAD_NAME                7 (__annotations__)
                      144 LOAD_CONST               4 ('top_token_ids')
                      146 STORE_SUBSCR
          
-         229         150 PUSH_NULL
+         232         150 PUSH_NULL
                      152 LOAD_NAME                3 (field)
                      154 LOAD_NAME                4 (list)
                      156 KW_NAMES                 1
                      158 PRECALL                  1
                      162 CALL                     1
                      172 STORE_NAME              11 (top_logits)
                      174 LOAD_NAME                4 (list)
                      176 LOAD_NAME                9 (float)
                      178 BINARY_SUBSCR
                      188 LOAD_NAME                7 (__annotations__)
                      190 LOAD_CONST               5 ('top_logits')
                      192 STORE_SUBSCR
          
-         237         196 BUILD_MAP                0
+         240         196 BUILD_MAP                0
          
-         231         198 BUILD_TUPLE              1
+         234         198 BUILD_TUPLE              1
                      200 LOAD_CONST               6 ('cfg')
          
-         233         202 LOAD_NAME               12 (LogitsTableConfig)
+         236         202 LOAD_NAME               12 (LogitsTableConfig)
          
-         231         204 LOAD_CONST               7 ('decode_fn')
+         234         204 LOAD_CONST               7 ('decode_fn')
          
-         234         206 LOAD_NAME               13 (Callable)
+         237         206 LOAD_NAME               13 (Callable)
                      208 LOAD_NAME                6 (int)
                      210 LOAD_NAME                4 (list)
                      212 LOAD_NAME                6 (int)
                      214 BINARY_SUBSCR
                      224 BINARY_OP                7 (|)
                      228 BUILD_LIST               1
                      230 LOAD_NAME               14 (str)
                      232 LOAD_NAME                4 (list)
                      234 LOAD_NAME               14 (str)
                      236 BINARY_SUBSCR
                      246 BINARY_OP                7 (|)
                      250 BUILD_TUPLE              2
                      252 BINARY_SUBSCR
          
-         231         262 LOAD_CONST               8 ('id_suffix')
+         234         262 LOAD_CONST               8 ('id_suffix')
          
-         235         264 LOAD_NAME               14 (str)
+         238         264 LOAD_NAME               14 (str)
          
-         231         266 LOAD_CONST               9 ('column')
+         234         266 LOAD_CONST               9 ('column')
          
-         236         268 LOAD_NAME                6 (int)
+         239         268 LOAD_NAME                6 (int)
                      270 LOAD_NAME               15 (tuple)
                      272 LOAD_NAME                6 (int)
                      274 LOAD_NAME                6 (int)
                      276 BUILD_TUPLE              2
                      278 BINARY_SUBSCR
                      288 BINARY_OP                7 (|)
          
-         231         292 LOAD_CONST              10 ('component_specific_kwargs')
+         234         292 LOAD_CONST              10 ('component_specific_kwargs')
          
-         237         294 LOAD_NAME               16 (dict)
+         240         294 LOAD_NAME               16 (dict)
                      296 LOAD_NAME               14 (str)
                      298 LOAD_NAME               17 (Any)
                      300 BUILD_TUPLE              2
                      302 BINARY_SUBSCR
          
-         231         312 LOAD_CONST              11 ('return')
+         234         312 LOAD_CONST              11 ('return')
          
-         238         314 LOAD_NAME               18 (HTML)
+         241         314 LOAD_NAME               18 (HTML)
          
-         231         316 BUILD_TUPLE             12
-                     318 LOAD_CONST              12 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 231>)
+         234         316 BUILD_TUPLE             12
+                     318 LOAD_CONST              12 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 234>)
                      320 MAKE_FUNCTION            5 (defaults, annotations)
                      322 STORE_NAME              19 (_get_html_data)
                      324 LOAD_CONST              13 (None)
                      326 RETURN_VALUE
          consts
             'LogitsTableData'
             ('default_factory',)
@@ -1767,65 +1771,65 @@
                   08a6020000ab020000000000000000641074290000000000000000000064
                   0a640b7c0c7c11190000000000000000007a0a00007a050000a6010000ab
                   0100000000000000009b00640c742900000000000000000000640a640b7c
                   0c7c11190000000000000000007a0a00007a050000a6010000ab01000000
                   00000000009b0064119d05640e9c03a6010000ab01000000000000000001
                   0090018c03742b000000000000000000007c047c0f690164127c037c1069
                   016901ac13a6020000ab0200000000000000005300
-               231           0 RESUME                   0
+               234           0 RESUME                   0
                
-               243           2 LOAD_FAST                1 (cfg)
+               246           2 LOAD_FAST                1 (cfg)
                              4 LOAD_ATTR                0 (n_rows)
                             14 LOAD_GLOBAL              3 (NULL + len)
                             26 LOAD_FAST                0 (self)
                             28 LOAD_ATTR                2 (bottom_logits)
                             38 PRECALL                  1
                             42 CALL                     1
                             52 COMPARE_OP               1 (<=)
                             58 POP_JUMP_FORWARD_IF_TRUE     2 (to 64)
                             60 LOAD_ASSERTION_ERROR
                             62 RAISE_VARARGS            1
                
-               244     >>   64 LOAD_FAST                0 (self)
+               247     >>   64 LOAD_FAST                0 (self)
                             66 LOAD_ATTR                3 (bottom_token_ids)
                             76 LOAD_CONST               1 (None)
                             78 LOAD_FAST                1 (cfg)
                             80 LOAD_ATTR                0 (n_rows)
                             90 BUILD_SLICE              2
                             92 BINARY_SUBSCR
                            102 STORE_FAST               6 (bottom_token_ids)
                
-               245         104 LOAD_FAST                0 (self)
+               248         104 LOAD_FAST                0 (self)
                            106 LOAD_ATTR                2 (bottom_logits)
                            116 LOAD_CONST               1 (None)
                            118 LOAD_FAST                1 (cfg)
                            120 LOAD_ATTR                0 (n_rows)
                            130 BUILD_SLICE              2
                            132 BINARY_SUBSCR
                            142 STORE_FAST               7 (bottom_logits)
                
-               246         144 LOAD_FAST                0 (self)
+               249         144 LOAD_FAST                0 (self)
                            146 LOAD_ATTR                4 (top_token_ids)
                            156 LOAD_CONST               1 (None)
                            158 LOAD_FAST                1 (cfg)
                            160 LOAD_ATTR                0 (n_rows)
                            170 BUILD_SLICE              2
                            172 BINARY_SUBSCR
                            182 STORE_FAST               8 (top_token_ids)
                
-               247         184 LOAD_FAST                0 (self)
+               250         184 LOAD_FAST                0 (self)
                            186 LOAD_ATTR                5 (top_logits)
                            196 LOAD_CONST               1 (None)
                            198 LOAD_FAST                1 (cfg)
                            200 LOAD_ATTR                0 (n_rows)
                            210 BUILD_SLICE              2
                            212 BINARY_SUBSCR
                            222 STORE_FAST               9 (top_logits)
                
-               250         224 LOAD_GLOBAL             13 (NULL + max)
+               253         224 LOAD_GLOBAL             13 (NULL + max)
                            236 LOAD_GLOBAL             13 (NULL + max)
                            248 LOAD_FAST                9 (top_logits)
                            250 LOAD_CONST               1 (None)
                            252 LOAD_FAST                1 (cfg)
                            254 LOAD_ATTR                0 (n_rows)
                            264 BUILD_SLICE              2
                            266 BINARY_SUBSCR
@@ -1841,130 +1845,130 @@
                            330 PRECALL                  1
                            334 CALL                     1
                            344 UNARY_NEGATIVE
                            346 PRECALL                  2
                            350 CALL                     2
                            360 STORE_FAST              10 (max_value)
                
-               251         362 LOAD_GLOBAL             17 (NULL + np)
+               254         362 LOAD_GLOBAL             17 (NULL + np)
                            374 LOAD_ATTR                9 (absolute)
                            384 LOAD_FAST                7 (bottom_logits)
                            386 LOAD_CONST               1 (None)
                            388 LOAD_FAST                1 (cfg)
                            390 LOAD_ATTR                0 (n_rows)
                            400 BUILD_SLICE              2
                            402 BINARY_SUBSCR
                            412 PRECALL                  1
                            416 CALL                     1
                            426 LOAD_FAST               10 (max_value)
                            428 BINARY_OP               11 (/)
                            432 STORE_FAST              11 (neg_bg_values)
                
-               252         434 LOAD_GLOBAL             17 (NULL + np)
+               255         434 LOAD_GLOBAL             17 (NULL + np)
                            446 LOAD_ATTR                9 (absolute)
                            456 LOAD_FAST                9 (top_logits)
                            458 LOAD_CONST               1 (None)
                            460 LOAD_FAST                1 (cfg)
                            462 LOAD_ATTR                0 (n_rows)
                            472 BUILD_SLICE              2
                            474 BINARY_SUBSCR
                            484 PRECALL                  1
                            488 CALL                     1
                            498 LOAD_FAST               10 (max_value)
                            500 BINARY_OP               11 (/)
                            504 STORE_FAST              12 (pos_bg_values)
                
-               255         506 LOAD_GLOBAL             21 (NULL + to_str_tokens)
+               258         506 LOAD_GLOBAL             21 (NULL + to_str_tokens)
                            518 LOAD_FAST                2 (decode_fn)
                            520 LOAD_FAST                6 (bottom_token_ids)
                            522 LOAD_CONST               1 (None)
                            524 LOAD_FAST                1 (cfg)
                            526 LOAD_ATTR                0 (n_rows)
                            536 BUILD_SLICE              2
                            538 BINARY_SUBSCR
                            548 PRECALL                  2
                            552 CALL                     2
                            562 STORE_FAST              13 (neg_str)
                
-               256         564 LOAD_GLOBAL             21 (NULL + to_str_tokens)
+               259         564 LOAD_GLOBAL             21 (NULL + to_str_tokens)
                            576 LOAD_FAST                2 (decode_fn)
                            578 LOAD_FAST                8 (top_token_ids)
                            580 LOAD_CONST               1 (None)
                            582 LOAD_FAST                1 (cfg)
                            584 LOAD_ATTR                0 (n_rows)
                            594 BUILD_SLICE              2
                            596 BINARY_SUBSCR
                            606 PRECALL                  2
                            610 CALL                     2
                            620 STORE_FAST              14 (pos_str)
                
-               259         622 LOAD_GLOBAL             23 (NULL + Path)
+               262         622 LOAD_GLOBAL             23 (NULL + Path)
                            634 LOAD_GLOBAL             24 (__file__)
                            646 PRECALL                  1
                            650 CALL                     1
                            660 LOAD_ATTR               13 (parent)
                            670 LOAD_CONST               2 ('html')
                            672 BINARY_OP               11 (/)
                            676 LOAD_CONST               3 ('logits_table_template.html')
                            678 BINARY_OP               11 (/)
                            682 LOAD_METHOD             14 (read_text)
                            704 PRECALL                  0
                            708 CALL                     0
                            718 STORE_FAST              15 (html_str)
                
-               260         720 LOAD_FAST               15 (html_str)
+               263         720 LOAD_FAST               15 (html_str)
                            722 LOAD_METHOD             15 (replace)
                            744 LOAD_CONST               4 ('LOGITS_TABLE_ID')
                            746 LOAD_CONST               5 ('logits-table-')
                            748 LOAD_FAST                3 (id_suffix)
                            750 FORMAT_VALUE             0
                            752 BUILD_STRING             2
                            754 PRECALL                  2
                            758 CALL                     2
                            768 STORE_FAST              15 (html_str)
                
-               263         770 BUILD_LIST               0
+               266         770 BUILD_LIST               0
                            772 BUILD_LIST               0
                            774 LOAD_CONST               6 (('negLogits', 'posLogits'))
                            776 BUILD_CONST_KEY_MAP      2
                            778 STORE_FAST              16 (data)
                
-               266         780 LOAD_GLOBAL             33 (NULL + range)
+               269         780 LOAD_GLOBAL             33 (NULL + range)
                            792 LOAD_GLOBAL              3 (NULL + len)
                            804 LOAD_FAST               13 (neg_str)
                            806 PRECALL                  1
                            810 CALL                     1
                            820 PRECALL                  1
                            824 CALL                     1
                            834 GET_ITER
                        >>  836 EXTENDED_ARG             1
                            838 FOR_ITER               257 (to 1354)
                            840 STORE_FAST              17 (i)
                
-               267         842 LOAD_FAST               16 (data)
+               270         842 LOAD_FAST               16 (data)
                            844 LOAD_CONST               7 ('negLogits')
                            846 BINARY_SUBSCR
                            856 LOAD_METHOD             17 (append)
                
-               268         878 LOAD_GLOBAL             37 (NULL + unprocess_str_tok)
+               271         878 LOAD_GLOBAL             37 (NULL + unprocess_str_tok)
                            890 LOAD_FAST               13 (neg_str)
                            892 LOAD_FAST               17 (i)
                            894 BINARY_SUBSCR
                            904 PRECALL                  1
                            908 CALL                     1
                
-               269         918 LOAD_GLOBAL             39 (NULL + round)
+               272         918 LOAD_GLOBAL             39 (NULL + round)
                            930 LOAD_FAST                9 (top_logits)
                            932 LOAD_FAST               17 (i)
                            934 BINARY_SUBSCR
                            944 LOAD_CONST               8 (2)
                            946 PRECALL                  2
                            950 CALL                     2
                
-               270         960 LOAD_CONST               9 ('rgba(255,')
+               273         960 LOAD_CONST               9 ('rgba(255,')
                            962 LOAD_GLOBAL             41 (NULL + int)
                            974 LOAD_CONST              10 (255)
                            976 LOAD_CONST              11 (1)
                            978 LOAD_FAST               11 (neg_bg_values)
                            980 LOAD_FAST               17 (i)
                            982 BINARY_SUBSCR
                            992 BINARY_OP               10 (-)
@@ -1983,41 +1987,41 @@
                           1052 BINARY_OP                5 (*)
                           1056 PRECALL                  1
                           1060 CALL                     1
                           1070 FORMAT_VALUE             0
                           1072 LOAD_CONST              13 (',0.5)')
                           1074 BUILD_STRING             5
                
-               267        1076 LOAD_CONST              14 (('symbol', 'value', 'color'))
+               270        1076 LOAD_CONST              14 (('symbol', 'value', 'color'))
                           1078 BUILD_CONST_KEY_MAP      3
                           1080 PRECALL                  1
                           1084 CALL                     1
                           1094 POP_TOP
                
-               272        1096 LOAD_FAST               16 (data)
+               275        1096 LOAD_FAST               16 (data)
                           1098 LOAD_CONST              15 ('posLogits')
                           1100 BINARY_SUBSCR
                           1110 LOAD_METHOD             17 (append)
                
-               273        1132 LOAD_GLOBAL             37 (NULL + unprocess_str_tok)
+               276        1132 LOAD_GLOBAL             37 (NULL + unprocess_str_tok)
                           1144 LOAD_FAST               14 (pos_str)
                           1146 LOAD_FAST               17 (i)
                           1148 BINARY_SUBSCR
                           1158 PRECALL                  1
                           1162 CALL                     1
                
-               274        1172 LOAD_GLOBAL             39 (NULL + round)
+               277        1172 LOAD_GLOBAL             39 (NULL + round)
                           1184 LOAD_FAST                9 (top_logits)
                           1186 LOAD_FAST               17 (i)
                           1188 BINARY_SUBSCR
                           1198 LOAD_CONST               8 (2)
                           1200 PRECALL                  2
                           1204 CALL                     2
                
-               275        1214 LOAD_CONST              16 ('rgba(')
+               278        1214 LOAD_CONST              16 ('rgba(')
                           1216 LOAD_GLOBAL             41 (NULL + int)
                           1228 LOAD_CONST              10 (255)
                           1230 LOAD_CONST              11 (1)
                           1232 LOAD_FAST               12 (pos_bg_values)
                           1234 LOAD_FAST               17 (i)
                           1236 BINARY_SUBSCR
                           1246 BINARY_OP               10 (-)
@@ -2036,35 +2040,35 @@
                           1306 BINARY_OP                5 (*)
                           1310 PRECALL                  1
                           1314 CALL                     1
                           1324 FORMAT_VALUE             0
                           1326 LOAD_CONST              17 (',255,0.5)')
                           1328 BUILD_STRING             5
                
-               272        1330 LOAD_CONST              14 (('symbol', 'value', 'color'))
+               275        1330 LOAD_CONST              14 (('symbol', 'value', 'color'))
                           1332 BUILD_CONST_KEY_MAP      3
                           1334 PRECALL                  1
                           1338 CALL                     1
                           1348 POP_TOP
                           1350 EXTENDED_ARG             1
                           1352 JUMP_BACKWARD          259 (to 836)
                
-               277     >> 1354 LOAD_GLOBAL             43 (NULL + HTML)
+               280     >> 1354 LOAD_GLOBAL             43 (NULL + HTML)
                
-               278        1366 LOAD_FAST                4 (column)
+               281        1366 LOAD_FAST                4 (column)
                           1368 LOAD_FAST               15 (html_str)
                           1370 BUILD_MAP                1
                
-               279        1372 LOAD_CONST              18 ('logitsTableData')
+               282        1372 LOAD_CONST              18 ('logitsTableData')
                           1374 LOAD_FAST                3 (id_suffix)
                           1376 LOAD_FAST               16 (data)
                           1378 BUILD_MAP                1
                           1380 BUILD_MAP                1
                
-               277        1382 KW_NAMES                19
+               280        1382 KW_NAMES                19
                           1384 PRECALL                  2
                           1388 CALL                     2
                           1398 RETURN_VALUE
                consts
                   '\n        Converts data -> HTML object, for the logits table (i.e. the top and bottom affected tokens by this feature).\n        '
                   None
                   'html'
@@ -2087,26 +2091,26 @@
                   ('html_data', 'js_data')
                names      ('n_rows', 'len', 'bottom_logits', 'bottom_token_ids', 'top_token_ids', 'top_logits', 'max', 'min', 'np', 'absolute', 'to_str_tokens', 'Path', '__file__', 'parent', 'read_text', 'replace', 'range', 'append', 'unprocess_str_tok', 'round', 'int', 'HTML')
                varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'bottom_token_ids', 'bottom_logits', 'top_token_ids', 'top_logits', 'max_value', 'neg_bg_values', 'pos_bg_values', 'neg_str', 'pos_str', 'html_str', 'data', 'i')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data'
-               firstlineno 231
+               firstlineno 234
                lnotab
                   0x020c3e0128012801280128038a01480148033a013a03620132030a033e
                   01240128012a0174fd1405240128012a0174fd18050c0106010afe
             None
          names      ('__name__', '__module__', '__qualname__', 'field', 'list', 'bottom_token_ids', 'int', '__annotations__', 'bottom_logits', 'float', 'top_token_ids', 'top_logits', 'LogitsTableConfig', 'Callable', 'str', 'tuple', 'dict', 'Any', 'HTML', '_get_html_data')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'LogitsTableData'
-         firstlineno 222
+         firstlineno 225
          lnotab
             0x0c042e012e012e012e0802fa040202fe020338fd020402fc020518fb02
             0612fa020702f9
       'LogitsTableData'
       code
          argcount  : 0
          nlocals   : 0
@@ -2133,81 +2137,81 @@
             000000000000001900000000000000000065056505650719000000000000
             000000190000000000000000006602190000000000000000006606641084
             045a13690066016411651465157a07000064126516650765056507190000
             000000000000007a0700006701651765056517190000000000000000007a
             070000660219000000000000000000641365176414650765126507650766
             02190000000000000000007a070000641565186517651966021900000000
             0000000000640b651a660c641684055a1b640c5300
-         286           0 RESUME                   0
+         289           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('SequenceData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         289          12 LOAD_CONST               1 ('\n    This contains all the data necessary to make a sequence of tokens in the vis. See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Always-visible data:\n        token_ids:              List of token IDs in the sequence\n        feat_acts:              Sizes of activations on this sequence\n        loss_contribution:   Effect on loss of this feature, for this particular token (neg = helpful)\n\n    Data which is visible on hover:\n        token_logits:       The logits of the particular token in that sequence (used for line on logits histogram)\n        top_token_ids:     List of the top 5 logit-boosted tokens by this feature\n        top_logits:        List of the corresponding 5 changes in logits for those tokens\n        bottom_token_ids:  List of the bottom 5 logit-boosted tokens by this feature\n        bottom_logits:     List of the corresponding 5 changes in logits for those tokens\n    ')
+         292          12 LOAD_CONST               1 ('\n    This contains all the data necessary to make a sequence of tokens in the vis. See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Always-visible data:\n        token_ids:              List of token IDs in the sequence\n        feat_acts:              Sizes of activations on this sequence\n        loss_contribution:   Effect on loss of this feature, for this particular token (neg = helpful)\n\n    Data which is visible on hover:\n        token_logits:       The logits of the particular token in that sequence (used for line on logits histogram)\n        top_token_ids:     List of the top 5 logit-boosted tokens by this feature\n        top_logits:        List of the corresponding 5 changes in logits for those tokens\n        bottom_token_ids:  List of the bottom 5 logit-boosted tokens by this feature\n        bottom_logits:     List of the corresponding 5 changes in logits for those tokens\n    ')
                       14 STORE_NAME               3 (__doc__)
          
-         306          16 PUSH_NULL
+         309          16 PUSH_NULL
                       18 LOAD_NAME                4 (field)
                       20 LOAD_NAME                5 (list)
                       22 KW_NAMES                 2
                       24 PRECALL                  1
                       28 CALL                     1
                       38 STORE_NAME               6 (token_ids)
                       40 LOAD_NAME                5 (list)
                       42 LOAD_NAME                7 (int)
                       44 BINARY_SUBSCR
                       54 LOAD_NAME                8 (__annotations__)
                       56 LOAD_CONST               3 ('token_ids')
                       58 STORE_SUBSCR
          
-         307          62 PUSH_NULL
+         310          62 PUSH_NULL
                       64 LOAD_NAME                4 (field)
                       66 LOAD_NAME                5 (list)
                       68 KW_NAMES                 2
                       70 PRECALL                  1
                       74 CALL                     1
                       84 STORE_NAME               9 (feat_acts)
                       86 LOAD_NAME                5 (list)
                       88 LOAD_NAME               10 (float)
                       90 BINARY_SUBSCR
                      100 LOAD_NAME                8 (__annotations__)
                      102 LOAD_CONST               4 ('feat_acts')
                      104 STORE_SUBSCR
          
-         308         108 PUSH_NULL
+         311         108 PUSH_NULL
                      110 LOAD_NAME                4 (field)
                      112 LOAD_NAME                5 (list)
                      114 KW_NAMES                 2
                      116 PRECALL                  1
                      120 CALL                     1
                      130 STORE_NAME              11 (loss_contribution)
                      132 LOAD_NAME                5 (list)
                      134 LOAD_NAME               10 (float)
                      136 BINARY_SUBSCR
                      146 LOAD_NAME                8 (__annotations__)
                      148 LOAD_CONST               5 ('loss_contribution')
                      150 STORE_SUBSCR
          
-         310         154 PUSH_NULL
+         313         154 PUSH_NULL
                      156 LOAD_NAME                4 (field)
                      158 LOAD_NAME                5 (list)
                      160 KW_NAMES                 2
                      162 PRECALL                  1
                      166 CALL                     1
                      176 STORE_NAME              12 (token_logits)
                      178 LOAD_NAME                5 (list)
                      180 LOAD_NAME               10 (float)
                      182 BINARY_SUBSCR
                      192 LOAD_NAME                8 (__annotations__)
                      194 LOAD_CONST               6 ('token_logits')
                      196 STORE_SUBSCR
          
-         311         200 PUSH_NULL
+         314         200 PUSH_NULL
                      202 LOAD_NAME                4 (field)
                      204 LOAD_NAME                5 (list)
                      206 KW_NAMES                 2
                      208 PRECALL                  1
                      212 CALL                     1
                      222 STORE_NAME              13 (top_token_ids)
                      224 LOAD_NAME                5 (list)
@@ -2215,15 +2219,15 @@
                      228 LOAD_NAME                7 (int)
                      230 BINARY_SUBSCR
                      240 BINARY_SUBSCR
                      250 LOAD_NAME                8 (__annotations__)
                      252 LOAD_CONST               7 ('top_token_ids')
                      254 STORE_SUBSCR
          
-         312         258 PUSH_NULL
+         315         258 PUSH_NULL
                      260 LOAD_NAME                4 (field)
                      262 LOAD_NAME                5 (list)
                      264 KW_NAMES                 2
                      266 PRECALL                  1
                      270 CALL                     1
                      280 STORE_NAME              14 (top_logits)
                      282 LOAD_NAME                5 (list)
@@ -2231,15 +2235,15 @@
                      286 LOAD_NAME               10 (float)
                      288 BINARY_SUBSCR
                      298 BINARY_SUBSCR
                      308 LOAD_NAME                8 (__annotations__)
                      310 LOAD_CONST               8 ('top_logits')
                      312 STORE_SUBSCR
          
-         313         316 PUSH_NULL
+         316         316 PUSH_NULL
                      318 LOAD_NAME                4 (field)
                      320 LOAD_NAME                5 (list)
                      322 KW_NAMES                 2
                      324 PRECALL                  1
                      328 CALL                     1
                      338 STORE_NAME              15 (bottom_token_ids)
                      340 LOAD_NAME                5 (list)
@@ -2247,15 +2251,15 @@
                      344 LOAD_NAME                7 (int)
                      346 BINARY_SUBSCR
                      356 BINARY_SUBSCR
                      366 LOAD_NAME                8 (__annotations__)
                      368 LOAD_CONST               9 ('bottom_token_ids')
                      370 STORE_SUBSCR
          
-         314         374 PUSH_NULL
+         317         374 PUSH_NULL
                      376 LOAD_NAME                4 (field)
                      378 LOAD_NAME                5 (list)
                      380 KW_NAMES                 2
                      382 PRECALL                  1
                      386 CALL                     1
                      396 STORE_NAME              16 (bottom_logits)
                      398 LOAD_NAME                5 (list)
@@ -2263,110 +2267,110 @@
                      402 LOAD_NAME               10 (float)
                      404 BINARY_SUBSCR
                      414 BINARY_SUBSCR
                      424 LOAD_NAME                8 (__annotations__)
                      426 LOAD_CONST              10 ('bottom_logits')
                      428 STORE_SUBSCR
          
-         316         432 LOAD_CONST              23 (('return', None))
-                     434 LOAD_CONST              13 (<code object __post_init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 316>)
+         319         432 LOAD_CONST              23 (('return', None))
+                     434 LOAD_CONST              13 (<code object __post_init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 319>)
                      436 MAKE_FUNCTION            4 (annotations)
                      438 STORE_NAME              17 (__post_init__)
          
-         325         440 LOAD_CONST              14 ('float_list')
+         328         440 LOAD_CONST              14 ('float_list')
          
-         327         442 LOAD_NAME                5 (list)
+         330         442 LOAD_NAME                5 (list)
                      444 LOAD_NAME                5 (list)
                      446 LOAD_NAME               10 (float)
                      448 BINARY_SUBSCR
                      458 BINARY_SUBSCR
          
-         325         468 LOAD_CONST              15 ('int_list')
+         328         468 LOAD_CONST              15 ('int_list')
          
-         328         470 LOAD_NAME                5 (list)
+         331         470 LOAD_NAME                5 (list)
                      472 LOAD_NAME                5 (list)
                      474 LOAD_NAME                7 (int)
                      476 BINARY_SUBSCR
                      486 BINARY_SUBSCR
          
-         325         496 LOAD_CONST              11 ('return')
+         328         496 LOAD_CONST              11 ('return')
          
-         329         498 LOAD_NAME               18 (tuple)
+         332         498 LOAD_NAME               18 (tuple)
                      500 LOAD_NAME                5 (list)
                      502 LOAD_NAME                5 (list)
                      504 LOAD_NAME               10 (float)
                      506 BINARY_SUBSCR
                      516 BINARY_SUBSCR
                      526 LOAD_NAME                5 (list)
                      528 LOAD_NAME                5 (list)
                      530 LOAD_NAME                7 (int)
                      532 BINARY_SUBSCR
                      542 BINARY_SUBSCR
                      552 BUILD_TUPLE              2
                      554 BINARY_SUBSCR
          
-         325         564 BUILD_TUPLE              6
-                     566 LOAD_CONST              16 (<code object _filter, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 325>)
+         328         564 BUILD_TUPLE              6
+                     566 LOAD_CONST              16 (<code object _filter, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 328>)
                      568 MAKE_FUNCTION            4 (annotations)
                      570 STORE_NAME              19 (_filter)
          
-         347         572 BUILD_MAP                0
+         350         572 BUILD_MAP                0
          
-         341         574 BUILD_TUPLE              1
+         344         574 BUILD_TUPLE              1
                      576 LOAD_CONST              17 ('cfg')
          
-         343         578 LOAD_NAME               20 (PromptConfig)
+         346         578 LOAD_NAME               20 (PromptConfig)
                      580 LOAD_NAME               21 (SequencesConfig)
                      582 BINARY_OP                7 (|)
          
-         341         586 LOAD_CONST              18 ('decode_fn')
+         344         586 LOAD_CONST              18 ('decode_fn')
          
-         344         588 LOAD_NAME               22 (Callable)
+         347         588 LOAD_NAME               22 (Callable)
                      590 LOAD_NAME                7 (int)
                      592 LOAD_NAME                5 (list)
                      594 LOAD_NAME                7 (int)
                      596 BINARY_SUBSCR
                      606 BINARY_OP                7 (|)
                      610 BUILD_LIST               1
                      612 LOAD_NAME               23 (str)
                      614 LOAD_NAME                5 (list)
                      616 LOAD_NAME               23 (str)
                      618 BINARY_SUBSCR
                      628 BINARY_OP                7 (|)
                      632 BUILD_TUPLE              2
                      634 BINARY_SUBSCR
          
-         341         644 LOAD_CONST              19 ('id_suffix')
+         344         644 LOAD_CONST              19 ('id_suffix')
          
-         345         646 LOAD_NAME               23 (str)
+         348         646 LOAD_NAME               23 (str)
          
-         341         648 LOAD_CONST              20 ('column')
+         344         648 LOAD_CONST              20 ('column')
          
-         346         650 LOAD_NAME                7 (int)
+         349         650 LOAD_NAME                7 (int)
                      652 LOAD_NAME               18 (tuple)
                      654 LOAD_NAME                7 (int)
                      656 LOAD_NAME                7 (int)
                      658 BUILD_TUPLE              2
                      660 BINARY_SUBSCR
                      670 BINARY_OP                7 (|)
          
-         341         674 LOAD_CONST              21 ('component_specific_kwargs')
+         344         674 LOAD_CONST              21 ('component_specific_kwargs')
          
-         347         676 LOAD_NAME               24 (dict)
+         350         676 LOAD_NAME               24 (dict)
                      678 LOAD_NAME               23 (str)
                      680 LOAD_NAME               25 (Any)
                      682 BUILD_TUPLE              2
                      684 BINARY_SUBSCR
          
-         341         694 LOAD_CONST              11 ('return')
+         344         694 LOAD_CONST              11 ('return')
          
-         348         696 LOAD_NAME               26 (HTML)
+         351         696 LOAD_NAME               26 (HTML)
          
-         341         698 BUILD_TUPLE             12
-                     700 LOAD_CONST              22 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 341>)
+         344         698 BUILD_TUPLE             12
+                     700 LOAD_CONST              22 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 344>)
                      702 MAKE_FUNCTION            5 (defaults, annotations)
                      704 STORE_NAME              27 (_get_html_data)
                      706 LOAD_CONST              12 (None)
                      708 RETURN_VALUE
          consts
             'SequenceData'
             '\n    This contains all the data necessary to make a sequence of tokens in the vis. See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Always-visible data:\n        token_ids:              List of token IDs in the sequence\n        feat_acts:              Sizes of activations on this sequence\n        loss_contribution:   Effect on loss of this feature, for this particular token (neg = helpful)\n\n    Data which is visible on hover:\n        token_logits:       The logits of the particular token in that sequence (used for line on logits histogram)\n        top_token_ids:     List of the top 5 logit-boosted tokens by this feature\n        top_logits:        List of the corresponding 5 changes in logits for those tokens\n        bottom_token_ids:  List of the bottom 5 logit-boosted tokens by this feature\n        bottom_logits:     List of the corresponding 5 changes in logits for those tokens\n    '
@@ -2391,39 +2395,39 @@
                   00ab0100000000000000007c005f0200000000000000007c00a003000000
                   00000000000000000000000000000000007c006a0400000000000000007c
                   006a050000000000000000a6020000ab0200000000000000005c0200007c
                   005f0400000000000000007c005f0500000000000000007c00a003000000
                   00000000000000000000000000000000007c006a0600000000000000007c
                   006a070000000000000000a6020000ab0200000000000000005c0200007c
                   005f0600000000000000007c005f07000000000000000064015300
-               316           0 RESUME                   0
+               319           0 RESUME                   0
                
-               321           2 LOAD_GLOBAL              1 (NULL + len)
+               324           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (token_ids)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 LOAD_FAST                0 (self)
                             42 STORE_ATTR               2 (seq_len)
                
-               322          52 LOAD_FAST                0 (self)
+               325          52 LOAD_FAST                0 (self)
                             54 LOAD_METHOD              3 (_filter)
                             76 LOAD_FAST                0 (self)
                             78 LOAD_ATTR                4 (top_logits)
                             88 LOAD_FAST                0 (self)
                             90 LOAD_ATTR                5 (top_token_ids)
                            100 PRECALL                  2
                            104 CALL                     2
                            114 UNPACK_SEQUENCE          2
                            118 LOAD_FAST                0 (self)
                            120 STORE_ATTR               4 (top_logits)
                            130 LOAD_FAST                0 (self)
                            132 STORE_ATTR               5 (top_token_ids)
                
-               323         142 LOAD_FAST                0 (self)
+               326         142 LOAD_FAST                0 (self)
                            144 LOAD_METHOD              3 (_filter)
                            166 LOAD_FAST                0 (self)
                            168 LOAD_ATTR                6 (bottom_logits)
                            178 LOAD_FAST                0 (self)
                            180 LOAD_ATTR                7 (bottom_token_ids)
                            190 PRECALL                  2
                            194 CALL                     2
@@ -2439,69 +2443,69 @@
                   None
                names      ('len', 'token_ids', 'seq_len', '_filter', 'top_logits', 'top_token_ids', 'bottom_logits', 'bottom_token_ids')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '__post_init__'
-               firstlineno 316
+               firstlineno 319
                lnotab 0x020532015a01
             'float_list'
             'int_list'
             code
                argcount  : 3
                nlocals   : 3
                stacksize : 5
                flags     : 3
                code
                   0x9700640184007c014400a6000000ab0000000000000000007d01640284
                   007401000000000000000000007c027c01a6020000ab0200000000000000
                   004400a6000000ab0000000000000000007d027c017c0266025300
-               325           0 RESUME                   0
+               328           0 RESUME                   0
                
-               336           2 LOAD_CONST               1 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 336>)
+               339           2 LOAD_CONST               1 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 339>)
                              4 MAKE_FUNCTION            0
                              6 LOAD_FAST                1 (float_list)
                              8 GET_ITER
                             10 PRECALL                  0
                             14 CALL                     0
                             24 STORE_FAST               1 (float_list)
                
-               337          26 LOAD_CONST               2 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 337>)
+               340          26 LOAD_CONST               2 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 340>)
                             28 MAKE_FUNCTION            0
                             30 LOAD_GLOBAL              1 (NULL + zip)
                             42 LOAD_FAST                2 (int_list)
                             44 LOAD_FAST                1 (float_list)
                             46 PRECALL                  2
                             50 CALL                     2
                             60 GET_ITER
                             62 PRECALL                  0
                             66 CALL                     0
                             76 STORE_FAST               2 (int_list)
                
-               338          78 LOAD_FAST                1 (float_list)
+               341          78 LOAD_FAST                1 (float_list)
                             80 LOAD_FAST                2 (int_list)
                             82 BUILD_TUPLE              2
                             84 RETURN_VALUE
                consts
                   '\n        Filters the list of floats and ints, by removing any elements which are zero. Note - the absolute values of the\n        floats are monotonic non-increasing, so we can assume that all the elements we keep will be the first elements\n        of their respective lists. Also reduces precisions of feature activations & logits.\n        '
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 19
                      code
                         0x970067007c005d0e7d01640084007c014400a6000000ab000000000000
                         00000091028c0f5300
-                     336           0 RESUME                   0
+                     339           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                14 (to 36)
                                    8 STORE_FAST               1 (floats)
-                                  10 LOAD_CONST               0 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 336>)
+                                  10 LOAD_CONST               0 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 339>)
                                   12 MAKE_FUNCTION            0
                                   14 LOAD_FAST                1 (floats)
                                   16 GET_ITER
                                   18 PRECALL                  0
                                   22 CALL                     0
                                   32 LIST_APPEND              2
                                   34 JUMP_BACKWARD           15 (to 6)
@@ -2513,15 +2517,15 @@
                            stacksize : 6
                            flags     : 19
                            code
                               0x970067007c005d2a7d017401000000000000000000007c01a6010000ab
                               01000000000000000064006b0400000000af157403000000000000000000
                               007c01740400000000000000000000a6020000ab02000000000000000091
                               028c2b5300
-                           336           0 RESUME                   0
+                           339           0 RESUME                   0
                                          2 BUILD_LIST               0
                                          4 LOAD_FAST                0 (.0)
                                    >>    6 FOR_ITER                42 (to 92)
                                          8 STORE_FAST               1 (f)
                                         10 LOAD_GLOBAL              1 (NULL + abs)
                                         22 LOAD_FAST                1 (f)
                                         24 PRECALL                  1
@@ -2541,34 +2545,34 @@
                               1e-06
                            names      ('abs', 'round', 'PRECISION')
                            varnames   ('.0', 'f')
                            freevars   ()
                            cellvars   ()
                            filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                            name       '<listcomp>'
-                           firstlineno 336
+                           firstlineno 339
                            lnotab 0x
                      names      ()
                      varnames   ('.0', 'floats')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 336
+                     firstlineno 339
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 7
                      flags     : 19
                      code
                         0x970067007c005d1c5c0200007d017d027c016400740100000000000000
                         0000007c02a6010000ab0100000000000000008502190000000000000000
                         0091028c1d5300
-                     337           0 RESUME                   0
+                     340           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                28 (to 64)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (ints)
                                   14 STORE_FAST               2 (floats)
                                   16 LOAD_FAST                1 (ints)
@@ -2586,23 +2590,23 @@
                         None
                      names      ('len',)
                      varnames   ('.0', 'ints', 'floats')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 337
+                     firstlineno 340
                      lnotab 0x
                names      ('zip',)
                varnames   ('self', 'float_list', 'int_list')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_filter'
-               firstlineno 325
+               firstlineno 328
                lnotab 0x020b18013401
             'cfg'
             'decode_fn'
             'id_suffix'
             'column'
             'component_specific_kwargs'
             code
@@ -2720,17 +2724,17 @@
                   020000ab0200000000000000007d267c037c27642c3c0000007c0b81057c
                   0b7c27640b3c000000744f000000000000000000007c047c266901642d7c
                   067c2769016901ac2ea6020000ab0200000000000000005300
                              0 MAKE_CELL                0 (self)
                              2 MAKE_CELL                2 (decode_fn)
                              4 MAKE_CELL               40 (bold_idx)
                
-               341           6 RESUME                   0
+               344           6 RESUME                   0
                
-               357           8 LOAD_GLOBAL              1 (NULL + isinstance)
+               360           8 LOAD_GLOBAL              1 (NULL + isinstance)
                             20 LOAD_FAST                1 (cfg)
                             22 LOAD_GLOBAL              2 (PromptConfig)
                             34 LOAD_GLOBAL              4 (SequencesConfig)
                             46 BUILD_TUPLE              2
                             48 PRECALL                  2
                             52 CALL                     2
                             62 POP_JUMP_FORWARD_IF_TRUE    26 (to 116)
@@ -2742,267 +2746,267 @@
                             86 CALL                     1
                             96 FORMAT_VALUE             0
                             98 BUILD_STRING             2
                            100 PRECALL                  0
                            104 CALL                     0
                            114 RAISE_VARARGS            1
                
-               358     >>  116 LOAD_FAST                5 (component_specific_kwargs)
+               361     >>  116 LOAD_FAST                5 (component_specific_kwargs)
                            118 LOAD_METHOD              4 (get)
                            140 LOAD_CONST               2 ('seq_group_id')
                            142 LOAD_CONST               3 (None)
                            144 PRECALL                  2
                            148 CALL                     2
                            158 STORE_FAST               6 (seq_group_id)
                
-               359         160 LOAD_FAST                5 (component_specific_kwargs)
+               362         160 LOAD_FAST                5 (component_specific_kwargs)
                            162 LOAD_METHOD              4 (get)
                            184 LOAD_CONST               4 ('max_act_color')
                            186 LOAD_CONST               3 (None)
                            188 PRECALL                  2
                            192 CALL                     2
                            202 STORE_FAST               7 (max_act_color)
                
-               360         204 LOAD_FAST                5 (component_specific_kwargs)
+               363         204 LOAD_FAST                5 (component_specific_kwargs)
                            206 LOAD_METHOD              4 (get)
                            228 LOAD_CONST               5 ('max_loss_color')
                            230 LOAD_CONST               3 (None)
                            232 PRECALL                  2
                            236 CALL                     2
                            246 STORE_FAST               8 (max_loss_color)
                
-               361         248 LOAD_FAST                5 (component_specific_kwargs)
+               364         248 LOAD_FAST                5 (component_specific_kwargs)
                            250 LOAD_METHOD              4 (get)
                            272 LOAD_CONST               6 ('bold_idx')
                            274 LOAD_CONST               3 (None)
                            276 PRECALL                  2
                            280 CALL                     2
                            290 STORE_DEREF             40 (bold_idx)
                
-               362         292 LOAD_FAST                5 (component_specific_kwargs)
+               365         292 LOAD_FAST                5 (component_specific_kwargs)
                            294 LOAD_METHOD              4 (get)
                            316 LOAD_CONST               7 ('permanent_line')
                            318 LOAD_CONST               8 (False)
                            320 PRECALL                  2
                            324 CALL                     2
                            334 STORE_FAST               9 (permanent_line)
                
-               363         336 LOAD_FAST                5 (component_specific_kwargs)
+               366         336 LOAD_FAST                5 (component_specific_kwargs)
                            338 LOAD_METHOD              4 (get)
                            360 LOAD_CONST               9 ('first_in_group')
                            362 LOAD_CONST              10 (True)
                            364 PRECALL                  2
                            368 CALL                     2
                            378 STORE_FAST              10 (first_in_group)
                
-               364         380 LOAD_FAST                5 (component_specific_kwargs)
+               367         380 LOAD_FAST                5 (component_specific_kwargs)
                            382 LOAD_METHOD              4 (get)
                            404 LOAD_CONST              11 ('title')
                            406 LOAD_CONST               3 (None)
                            408 PRECALL                  2
                            412 CALL                     2
                            422 STORE_FAST              11 (title)
                
-               365         424 LOAD_FAST                5 (component_specific_kwargs)
+               368         424 LOAD_FAST                5 (component_specific_kwargs)
                            426 LOAD_METHOD              4 (get)
                            448 LOAD_CONST              12 ('hover_above')
                            450 LOAD_CONST               8 (False)
                            452 PRECALL                  2
                            456 CALL                     2
                            466 STORE_FAST              12 (hover_above)
                
-               368         468 LOAD_FAST                6 (seq_group_id)
+               371         468 LOAD_FAST                6 (seq_group_id)
                            470 POP_JUMP_FORWARD_IF_NOT_NONE     6 (to 484)
                            472 LOAD_CONST              13 ('prompt-')
                            474 LOAD_FAST                4 (column)
                            476 LOAD_CONST              14 ('03d')
                            478 FORMAT_VALUE             4 (with format)
                            480 BUILD_STRING             2
                            482 STORE_FAST               6 (seq_group_id)
                
-               371     >>  484 LOAD_DEREF              40 (bold_idx)
+               374     >>  484 LOAD_DEREF              40 (bold_idx)
                            486 POP_JUMP_FORWARD_IF_NOT_NONE    10 (to 508)
                            488 LOAD_DEREF               0 (self)
                            490 LOAD_ATTR                5 (seq_len)
                            500 LOAD_CONST              15 (2)
                            502 BINARY_OP                2 (//)
                            506 STORE_DEREF             40 (bold_idx)
                
-               374     >>  508 LOAD_GLOBAL              1 (NULL + isinstance)
+               377     >>  508 LOAD_GLOBAL              1 (NULL + isinstance)
                            520 LOAD_FAST                1 (cfg)
                            522 LOAD_GLOBAL              4 (SequencesConfig)
                            534 PRECALL                  2
                            538 CALL                     2
                            548 JUMP_IF_FALSE_OR_POP     7 (to 564)
                            550 LOAD_FAST                1 (cfg)
                            552 LOAD_ATTR                6 (compute_buffer)
                            562 UNARY_NOT
                        >>  564 STORE_FAST              13 (only_bold)
                
-               375         566 LOAD_FAST               13 (only_bold)
+               378         566 LOAD_FAST               13 (only_bold)
                            568 POP_JUMP_FORWARD_IF_FALSE   199 (to 968)
                
-               376         570 LOAD_CLOSURE            40 (bold_idx)
+               379         570 LOAD_CLOSURE            40 (bold_idx)
                            572 LOAD_CLOSURE             0 (self)
                            574 BUILD_TUPLE              2
-                           576 LOAD_CONST              16 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 376>)
+                           576 LOAD_CONST              16 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 379>)
                            578 MAKE_FUNCTION            8 (closure)
                            580 LOAD_GLOBAL             15 (NULL + range)
                            592 LOAD_DEREF               0 (self)
                            594 LOAD_ATTR                5 (seq_len)
                            604 PRECALL                  1
                            608 CALL                     1
                            618 GET_ITER
                            620 PRECALL                  0
                            624 CALL                     0
                            634 STORE_FAST              14 (feat_acts)
                
-               377         636 LOAD_CLOSURE            40 (bold_idx)
+               380         636 LOAD_CLOSURE            40 (bold_idx)
                            638 LOAD_CLOSURE             0 (self)
                            640 BUILD_TUPLE              2
-                           642 LOAD_CONST              17 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 377>)
+                           642 LOAD_CONST              17 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 380>)
                            644 MAKE_FUNCTION            8 (closure)
                            646 LOAD_GLOBAL             15 (NULL + range)
                            658 LOAD_DEREF               0 (self)
                            660 LOAD_ATTR                5 (seq_len)
                            670 PRECALL                  1
                            674 CALL                     1
                            684 GET_ITER
                            686 PRECALL                  0
                            690 CALL                     0
                            700 STORE_FAST              15 (loss_contribution)
                
-               378         702 LOAD_CLOSURE            40 (bold_idx)
+               381         702 LOAD_CLOSURE            40 (bold_idx)
                            704 LOAD_CLOSURE             0 (self)
                            706 BUILD_TUPLE              2
-                           708 LOAD_CONST              18 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 378>)
+                           708 LOAD_CONST              18 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 381>)
                            710 MAKE_FUNCTION            8 (closure)
                            712 LOAD_GLOBAL             15 (NULL + range)
                            724 LOAD_DEREF               0 (self)
                            726 LOAD_ATTR                5 (seq_len)
                            736 PRECALL                  1
                            740 CALL                     1
                            750 GET_ITER
                            752 PRECALL                  0
                            756 CALL                     0
                            766 STORE_FAST              16 (pos_ids)
                
-               379         768 LOAD_CLOSURE            40 (bold_idx)
+               382         768 LOAD_CLOSURE            40 (bold_idx)
                            770 LOAD_CLOSURE             0 (self)
                            772 BUILD_TUPLE              2
-                           774 LOAD_CONST              19 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 379>)
+                           774 LOAD_CONST              19 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 382>)
                            776 MAKE_FUNCTION            8 (closure)
                            778 LOAD_GLOBAL             15 (NULL + range)
                            790 LOAD_DEREF               0 (self)
                            792 LOAD_ATTR                5 (seq_len)
                            802 PRECALL                  1
                            806 CALL                     1
                            816 GET_ITER
                            818 PRECALL                  0
                            822 CALL                     0
                            832 STORE_FAST              17 (neg_ids)
                
-               380         834 LOAD_CLOSURE            40 (bold_idx)
+               383         834 LOAD_CLOSURE            40 (bold_idx)
                            836 LOAD_CLOSURE             0 (self)
                            838 BUILD_TUPLE              2
-                           840 LOAD_CONST              20 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 380>)
+                           840 LOAD_CONST              20 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 383>)
                            842 MAKE_FUNCTION            8 (closure)
                            844 LOAD_GLOBAL             15 (NULL + range)
                            856 LOAD_DEREF               0 (self)
                            858 LOAD_ATTR                5 (seq_len)
                            868 PRECALL                  1
                            872 CALL                     1
                            882 GET_ITER
                            884 PRECALL                  0
                            888 CALL                     0
                            898 STORE_FAST              18 (pos_val)
                
-               381         900 LOAD_CLOSURE            40 (bold_idx)
+               384         900 LOAD_CLOSURE            40 (bold_idx)
                            902 LOAD_CLOSURE             0 (self)
                            904 BUILD_TUPLE              2
-                           906 LOAD_CONST              21 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 381>)
+                           906 LOAD_CONST              21 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 384>)
                            908 MAKE_FUNCTION            8 (closure)
                            910 LOAD_GLOBAL             15 (NULL + range)
                            922 LOAD_DEREF               0 (self)
                            924 LOAD_ATTR                5 (seq_len)
                            934 PRECALL                  1
                            938 CALL                     1
                            948 GET_ITER
                            950 PRECALL                  0
                            954 CALL                     0
                            964 STORE_FAST              19 (neg_val)
                            966 JUMP_FORWARD           120 (to 1208)
                
-               383     >>  968 LOAD_GLOBAL             17 (NULL + deepcopy)
+               386     >>  968 LOAD_GLOBAL             17 (NULL + deepcopy)
                            980 LOAD_DEREF               0 (self)
                            982 LOAD_ATTR                9 (feat_acts)
                            992 PRECALL                  1
                            996 CALL                     1
                           1006 STORE_FAST              14 (feat_acts)
                
-               384        1008 LOAD_GLOBAL             17 (NULL + deepcopy)
+               387        1008 LOAD_GLOBAL             17 (NULL + deepcopy)
                           1020 LOAD_DEREF               0 (self)
                           1022 LOAD_ATTR               10 (loss_contribution)
                           1032 PRECALL                  1
                           1036 CALL                     1
                           1046 STORE_FAST              15 (loss_contribution)
                
-               385        1048 LOAD_GLOBAL             17 (NULL + deepcopy)
+               388        1048 LOAD_GLOBAL             17 (NULL + deepcopy)
                           1060 LOAD_DEREF               0 (self)
                           1062 LOAD_ATTR               11 (top_token_ids)
                           1072 PRECALL                  1
                           1076 CALL                     1
                           1086 STORE_FAST              16 (pos_ids)
                
-               386        1088 LOAD_GLOBAL             17 (NULL + deepcopy)
+               389        1088 LOAD_GLOBAL             17 (NULL + deepcopy)
                           1100 LOAD_DEREF               0 (self)
                           1102 LOAD_ATTR               12 (bottom_token_ids)
                           1112 PRECALL                  1
                           1116 CALL                     1
                           1126 STORE_FAST              17 (neg_ids)
                
-               387        1128 LOAD_GLOBAL             17 (NULL + deepcopy)
+               390        1128 LOAD_GLOBAL             17 (NULL + deepcopy)
                           1140 LOAD_DEREF               0 (self)
                           1142 LOAD_ATTR               13 (top_logits)
                           1152 PRECALL                  1
                           1156 CALL                     1
                           1166 STORE_FAST              18 (pos_val)
                
-               388        1168 LOAD_GLOBAL             17 (NULL + deepcopy)
+               391        1168 LOAD_GLOBAL             17 (NULL + deepcopy)
                           1180 LOAD_DEREF               0 (self)
                           1182 LOAD_ATTR               14 (bottom_logits)
                           1192 PRECALL                  1
                           1196 CALL                     1
                           1206 STORE_FAST              19 (neg_val)
                
-               391     >> 1208 LOAD_FAST                7 (max_act_color)
+               394     >> 1208 LOAD_FAST                7 (max_act_color)
                           1210 POP_JUMP_FORWARD_IF_NOT_NONE    20 (to 1252)
                           1212 LOAD_GLOBAL             31 (NULL + max_or_1)
                           1224 LOAD_DEREF               0 (self)
                           1226 LOAD_ATTR                9 (feat_acts)
                           1236 PRECALL                  1
                           1240 CALL                     1
                           1250 JUMP_FORWARD             1 (to 1254)
                        >> 1252 LOAD_FAST                7 (max_act_color)
                        >> 1254 STORE_FAST              20 (bg_denom)
                
-               392        1256 LOAD_FAST                8 (max_loss_color)
+               395        1256 LOAD_FAST                8 (max_loss_color)
                           1258 POP_JUMP_FORWARD_IF_NOT_NONE    22 (to 1304)
                           1260 LOAD_GLOBAL             31 (NULL + max_or_1)
                           1272 LOAD_DEREF               0 (self)
                           1274 LOAD_ATTR               10 (loss_contribution)
                           1284 LOAD_CONST              10 (True)
                           1286 KW_NAMES                22
                           1288 PRECALL                  2
                           1292 CALL                     2
                           1302 JUMP_FORWARD             1 (to 1306)
                        >> 1304 LOAD_FAST                8 (max_loss_color)
                        >> 1306 STORE_FAST              21 (u_denom)
                
-               393        1308 LOAD_GLOBAL             33 (NULL + np)
+               396        1308 LOAD_GLOBAL             33 (NULL + np)
                           1320 LOAD_ATTR               17 (maximum)
                           1330 LOAD_FAST               14 (feat_acts)
                           1332 LOAD_CONST              23 (0.0)
                           1334 PRECALL                  2
                           1338 CALL                     2
                           1348 LOAD_GLOBAL             37 (NULL + max)
                           1360 LOAD_CONST              24 (0.0001)
@@ -3011,15 +3015,15 @@
                           1368 CALL                     2
                           1378 BINARY_OP               11 (/)
                           1382 LOAD_METHOD             19 (tolist)
                           1404 PRECALL                  0
                           1408 CALL                     0
                           1418 STORE_FAST              22 (bg_values)
                
-               394        1420 LOAD_GLOBAL             33 (NULL + np)
+               397        1420 LOAD_GLOBAL             33 (NULL + np)
                           1432 LOAD_ATTR               20 (array)
                           1442 LOAD_FAST               15 (loss_contribution)
                           1444 PRECALL                  1
                           1448 CALL                     1
                           1458 LOAD_GLOBAL             37 (NULL + max)
                           1470 LOAD_CONST              24 (0.0001)
                           1472 LOAD_FAST               21 (u_denom)
@@ -3027,22 +3031,22 @@
                           1478 CALL                     2
                           1488 BINARY_OP               11 (/)
                           1492 LOAD_METHOD             19 (tolist)
                           1514 PRECALL                  0
                           1518 CALL                     0
                           1528 STORE_FAST              23 (u_values)
                
-               398        1530 LOAD_GLOBAL              1 (NULL + isinstance)
+               401        1530 LOAD_GLOBAL              1 (NULL + isinstance)
                           1542 LOAD_FAST                1 (cfg)
                           1544 LOAD_GLOBAL              2 (PromptConfig)
                           1556 PRECALL                  2
                           1560 CALL                     2
                           1570 POP_JUMP_FORWARD_IF_FALSE   136 (to 1844)
                
-               399        1572 LOAD_GLOBAL             43 (NULL + len)
+               402        1572 LOAD_GLOBAL             43 (NULL + len)
                           1584 LOAD_FAST               16 (pos_ids)
                           1586 PRECALL                  1
                           1590 CALL                     1
                           1600 LOAD_GLOBAL             43 (NULL + len)
                           1612 LOAD_FAST               17 (neg_ids)
                           1614 PRECALL                  1
                           1618 CALL                     1
@@ -3075,45 +3079,45 @@
                           1760 BINARY_OP               10 (-)
                           1764 COMPARE_OP               2 (==)
                           1770 POP_JUMP_FORWARD_IF_TRUE    12 (to 1796)
                           1772 JUMP_FORWARD             1 (to 1776)
                        >> 1774 POP_TOP
                        >> 1776 LOAD_ASSERTION_ERROR
                
-               400        1778 LOAD_CONST              26 ('If this is a single prompt, these lists must be the same length as token_ids or 1 less')
+               403        1778 LOAD_CONST              26 ('If this is a single prompt, these lists must be the same length as token_ids or 1 less')
                
-               399        1780 PRECALL                  0
+               402        1780 PRECALL                  0
                           1784 CALL                     0
                           1794 RAISE_VARARGS            1
                
-               401     >> 1796 BUILD_LIST               0
+               404     >> 1796 BUILD_LIST               0
                           1798 BUILD_LIST               1
                           1800 LOAD_FAST               16 (pos_ids)
                           1802 BINARY_OP                0 (+)
                           1806 STORE_FAST              16 (pos_ids)
                
-               402        1808 BUILD_LIST               0
+               405        1808 BUILD_LIST               0
                           1810 BUILD_LIST               1
                           1812 LOAD_FAST               17 (neg_ids)
                           1814 BINARY_OP                0 (+)
                           1818 STORE_FAST              17 (neg_ids)
                
-               403        1820 BUILD_LIST               0
+               406        1820 BUILD_LIST               0
                           1822 BUILD_LIST               1
                           1824 LOAD_FAST               18 (pos_val)
                           1826 BINARY_OP                0 (+)
                           1830 STORE_FAST              18 (pos_val)
                
-               404        1832 BUILD_LIST               0
+               407        1832 BUILD_LIST               0
                           1834 BUILD_LIST               1
                           1836 LOAD_FAST               19 (neg_val)
                           1838 BINARY_OP                0 (+)
                           1842 STORE_FAST              19 (neg_val)
                
-               405     >> 1844 LOAD_GLOBAL             43 (NULL + len)
+               408     >> 1844 LOAD_GLOBAL             43 (NULL + len)
                           1856 LOAD_FAST               16 (pos_ids)
                           1858 PRECALL                  1
                           1862 CALL                     1
                           1872 LOAD_GLOBAL             43 (NULL + len)
                           1884 LOAD_FAST               17 (neg_ids)
                           1886 PRECALL                  1
                           1890 CALL                     1
@@ -3144,99 +3148,99 @@
                           2020 CALL                     1
                           2030 COMPARE_OP               2 (==)
                           2036 POP_JUMP_FORWARD_IF_TRUE    12 (to 2062)
                           2038 JUMP_FORWARD             1 (to 2042)
                        >> 2040 POP_TOP
                        >> 2042 LOAD_ASSERTION_ERROR
                
-               406        2044 LOAD_CONST              27 ('If this is part of a sequence group etc are given, they must be the same length as token_ids')
+               409        2044 LOAD_CONST              27 ('If this is part of a sequence group etc are given, they must be the same length as token_ids')
                
-               405        2046 PRECALL                  0
+               408        2046 PRECALL                  0
                           2050 CALL                     0
                           2060 RAISE_VARARGS            1
                
-               409     >> 2062 LOAD_GLOBAL             47 (NULL + to_str_tokens)
+               412     >> 2062 LOAD_GLOBAL             47 (NULL + to_str_tokens)
                           2074 LOAD_DEREF               2 (decode_fn)
                           2076 LOAD_DEREF               0 (self)
                           2078 LOAD_ATTR               22 (token_ids)
                           2088 PRECALL                  2
                           2092 CALL                     2
                           2102 STORE_FAST              24 (toks)
                
-               410        2104 LOAD_CLOSURE             2 (decode_fn)
+               413        2104 LOAD_CLOSURE             2 (decode_fn)
                           2106 BUILD_TUPLE              1
-                          2108 LOAD_CONST              28 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 410>)
+                          2108 LOAD_CONST              28 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 413>)
                           2110 MAKE_FUNCTION            8 (closure)
                           2112 LOAD_FAST               16 (pos_ids)
                           2114 GET_ITER
                           2116 PRECALL                  0
                           2120 CALL                     0
                           2130 STORE_FAST              25 (pos_toks)
                
-               411        2132 LOAD_CLOSURE             2 (decode_fn)
+               414        2132 LOAD_CLOSURE             2 (decode_fn)
                           2134 BUILD_TUPLE              1
-                          2136 LOAD_CONST              29 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 411>)
+                          2136 LOAD_CONST              29 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 414>)
                           2138 MAKE_FUNCTION            8 (closure)
                           2140 LOAD_FAST               17 (neg_ids)
                           2142 GET_ITER
                           2144 PRECALL                  0
                           2148 CALL                     0
                           2158 STORE_FAST              26 (neg_toks)
                
-               414        2160 BUILD_LIST               0
+               417        2160 BUILD_LIST               0
                           2162 STORE_FAST              27 (js_data_list)
                
-               416        2164 LOAD_GLOBAL             15 (NULL + range)
+               419        2164 LOAD_GLOBAL             15 (NULL + range)
                           2176 LOAD_GLOBAL             43 (NULL + len)
                           2188 LOAD_DEREF               0 (self)
                           2190 LOAD_ATTR               22 (token_ids)
                           2200 PRECALL                  1
                           2204 CALL                     1
                           2214 PRECALL                  1
                           2218 CALL                     1
                           2228 GET_ITER
                        >> 2230 EXTENDED_ARG             1
                           2232 FOR_ITER               400 (to 3034)
                           2234 STORE_FAST              28 (i)
                
-               421        2236 BUILD_MAP                0
+               424        2236 BUILD_MAP                0
                           2238 STORE_FAST              29 (kwargs_bold)
                
-               422        2240 BUILD_MAP                0
+               425        2240 BUILD_MAP                0
                           2242 STORE_FAST              30 (kwargs_hide)
                
-               423        2244 BUILD_MAP                0
+               426        2244 BUILD_MAP                0
                           2246 STORE_FAST              31 (kwargs_this_token_active)
                
-               424        2248 BUILD_MAP                0
+               427        2248 BUILD_MAP                0
                           2250 STORE_FAST              32 (kwargs_prev_token_active)
                
-               425        2252 BUILD_MAP                0
+               428        2252 BUILD_MAP                0
                           2254 STORE_FAST              33 (kwargs_hover_above)
                
-               429        2256 LOAD_DEREF              40 (bold_idx)
+               432        2256 LOAD_DEREF              40 (bold_idx)
                           2258 POP_JUMP_FORWARD_IF_NONE    18 (to 2296)
                           2260 LOAD_DEREF              40 (bold_idx)
                           2262 LOAD_FAST               28 (i)
                           2264 COMPARE_OP               2 (==)
                           2270 POP_JUMP_FORWARD_IF_FALSE    12 (to 2296)
                
-               430        2272 LOAD_CONST              10 (True)
+               433        2272 LOAD_CONST              10 (True)
                           2274 LOAD_FAST               29 (kwargs_bold)
                           2276 LOAD_CONST              30 ('isBold')
                           2278 STORE_SUBSCR
                
-               431        2282 LOAD_FAST                9 (permanent_line)
+               434        2282 LOAD_FAST                9 (permanent_line)
                           2284 POP_JUMP_FORWARD_IF_FALSE     5 (to 2296)
                           2286 LOAD_CONST              10 (True)
                           2288 LOAD_FAST               29 (kwargs_bold)
                           2290 LOAD_CONST              31 ('permanentLine')
                           2292 STORE_SUBSCR
                
-               434     >> 2296 LOAD_FAST               13 (only_bold)
+               437     >> 2296 LOAD_FAST               13 (only_bold)
                           2298 POP_JUMP_FORWARD_IF_FALSE    36 (to 2372)
                           2300 LOAD_GLOBAL              1 (NULL + isinstance)
                           2312 LOAD_DEREF              40 (bold_idx)
                           2314 LOAD_GLOBAL             48 (int)
                           2326 PRECALL                  2
                           2330 CALL                     2
                           2340 POP_JUMP_FORWARD_IF_FALSE    15 (to 2372)
@@ -3245,61 +3249,61 @@
                           2346 LOAD_DEREF              40 (bold_idx)
                           2348 LOAD_CONST              25 (1)
                           2350 BINARY_OP                0 (+)
                           2354 BUILD_SET                2
                           2356 CONTAINS_OP              1
                           2358 POP_JUMP_FORWARD_IF_FALSE     6 (to 2372)
                
-               435        2360 LOAD_CONST              10 (True)
+               438        2360 LOAD_CONST              10 (True)
                           2362 LOAD_FAST               30 (kwargs_hide)
                           2364 LOAD_CONST              32 ('hide')
                           2366 STORE_SUBSCR
                           2370 JUMP_FORWARD           228 (to 2828)
                
-               439     >> 2372 LOAD_FAST               12 (hover_above)
+               442     >> 2372 LOAD_FAST               12 (hover_above)
                           2374 POP_JUMP_FORWARD_IF_FALSE     5 (to 2386)
                
-               440        2376 LOAD_CONST              10 (True)
+               443        2376 LOAD_CONST              10 (True)
                           2378 LOAD_FAST               33 (kwargs_hover_above)
                           2380 LOAD_CONST              33 ('hoverAbove')
                           2382 STORE_SUBSCR
                
-               443     >> 2386 LOAD_GLOBAL             51 (NULL + abs)
+               446     >> 2386 LOAD_GLOBAL             51 (NULL + abs)
                           2398 LOAD_FAST               14 (feat_acts)
                           2400 LOAD_FAST               28 (i)
                           2402 BINARY_SUBSCR
                           2412 PRECALL                  1
                           2416 CALL                     1
                           2426 LOAD_CONST              34 (1e-08)
                           2428 COMPARE_OP               4 (>)
                           2434 POP_JUMP_FORWARD_IF_FALSE    61 (to 2558)
                
-               444        2436 LOAD_GLOBAL             53 (NULL + dict)
+               447        2436 LOAD_GLOBAL             53 (NULL + dict)
                
-               445        2448 LOAD_GLOBAL             55 (NULL + round)
+               448        2448 LOAD_GLOBAL             55 (NULL + round)
                           2460 LOAD_FAST               14 (feat_acts)
                           2462 LOAD_FAST               28 (i)
                           2464 BINARY_SUBSCR
                           2474 LOAD_GLOBAL             56 (PRECISION)
                           2486 PRECALL                  2
                           2490 CALL                     2
                
-               446        2500 LOAD_GLOBAL             59 (NULL + bgColorMap)
+               449        2500 LOAD_GLOBAL             59 (NULL + bgColorMap)
                           2512 LOAD_FAST               22 (bg_values)
                           2514 LOAD_FAST               28 (i)
                           2516 BINARY_SUBSCR
                           2526 PRECALL                  1
                           2530 CALL                     1
                
-               444        2540 KW_NAMES                35
+               447        2540 KW_NAMES                35
                           2542 PRECALL                  2
                           2546 CALL                     2
                           2556 STORE_FAST              31 (kwargs_this_token_active)
                
-               450     >> 2558 LOAD_FAST               25 (pos_toks)
+               453     >> 2558 LOAD_FAST               25 (pos_toks)
                           2560 LOAD_FAST               28 (i)
                           2562 BINARY_SUBSCR
                           2572 LOAD_FAST               26 (neg_toks)
                           2574 LOAD_FAST               28 (i)
                           2576 BINARY_SUBSCR
                           2586 LOAD_FAST               18 (pos_val)
                           2588 LOAD_FAST               28 (i)
@@ -3310,167 +3314,167 @@
                           2614 BUILD_TUPLE              4
                           2616 UNPACK_SEQUENCE          4
                           2620 STORE_FAST              34 (pos_toks_i)
                           2622 STORE_FAST              35 (neg_toks_i)
                           2624 STORE_FAST              36 (pos_val_i)
                           2626 STORE_FAST              37 (neg_val_i)
                
-               451        2628 LOAD_GLOBAL             43 (NULL + len)
+               454        2628 LOAD_GLOBAL             43 (NULL + len)
                           2640 LOAD_FAST               34 (pos_toks_i)
                           2642 PRECALL                  1
                           2646 CALL                     1
                           2656 LOAD_GLOBAL             43 (NULL + len)
                           2668 LOAD_FAST               35 (neg_toks_i)
                           2670 PRECALL                  1
                           2674 CALL                     1
                           2684 BINARY_OP                0 (+)
                           2688 LOAD_CONST              36 (0)
                           2690 COMPARE_OP               4 (>)
                           2696 POP_JUMP_FORWARD_IF_FALSE    65 (to 2828)
                
-               453        2698 LOAD_GLOBAL             53 (NULL + dict)
+               456        2698 LOAD_GLOBAL             53 (NULL + dict)
                
-               454        2710 LOAD_FAST               34 (pos_toks_i)
+               457        2710 LOAD_FAST               34 (pos_toks_i)
                
-               455        2712 LOAD_FAST               35 (neg_toks_i)
+               458        2712 LOAD_FAST               35 (neg_toks_i)
                
-               456        2714 LOAD_FAST               36 (pos_val_i)
+               459        2714 LOAD_FAST               36 (pos_val_i)
                
-               457        2716 LOAD_FAST               37 (neg_val_i)
+               460        2716 LOAD_FAST               37 (neg_val_i)
                
-               458        2718 LOAD_GLOBAL             55 (NULL + round)
+               461        2718 LOAD_GLOBAL             55 (NULL + round)
                           2730 LOAD_FAST               15 (loss_contribution)
                           2732 LOAD_FAST               28 (i)
                           2734 BINARY_SUBSCR
                           2744 LOAD_GLOBAL             56 (PRECISION)
                           2756 PRECALL                  2
                           2760 CALL                     2
                
-               459        2770 LOAD_GLOBAL             61 (NULL + uColorMap)
+               462        2770 LOAD_GLOBAL             61 (NULL + uColorMap)
                           2782 LOAD_FAST               23 (u_values)
                           2784 LOAD_FAST               28 (i)
                           2786 BINARY_SUBSCR
                           2796 PRECALL                  1
                           2800 CALL                     1
                
-               453        2810 KW_NAMES                37
+               456        2810 KW_NAMES                37
                           2812 PRECALL                  6
                           2816 CALL                     6
                           2826 STORE_FAST              32 (kwargs_prev_token_active)
                
-               462     >> 2828 LOAD_FAST               27 (js_data_list)
+               465     >> 2828 LOAD_FAST               27 (js_data_list)
                           2830 LOAD_METHOD             31 (append)
                           2852 LOAD_GLOBAL             53 (NULL + dict)
                           2864 LOAD_CONST              47 (())
                
-               463        2866 LOAD_GLOBAL             65 (NULL + unprocess_str_tok)
+               466        2866 LOAD_GLOBAL             65 (NULL + unprocess_str_tok)
                           2878 LOAD_FAST               24 (toks)
                           2880 LOAD_FAST               28 (i)
                           2882 BINARY_SUBSCR
                           2892 PRECALL                  1
                           2896 CALL                     1
                
-               464        2906 LOAD_DEREF               0 (self)
+               467        2906 LOAD_DEREF               0 (self)
                           2908 LOAD_ATTR               22 (token_ids)
                           2918 LOAD_FAST               28 (i)
                           2920 BINARY_SUBSCR
                
-               465        2930 LOAD_GLOBAL             55 (NULL + round)
+               468        2930 LOAD_GLOBAL             55 (NULL + round)
                           2942 LOAD_DEREF               0 (self)
                           2944 LOAD_ATTR               33 (token_logits)
                           2954 LOAD_FAST               28 (i)
                           2956 BINARY_SUBSCR
                           2966 LOAD_GLOBAL             56 (PRECISION)
                           2978 PRECALL                  2
                           2982 CALL                     2
                
-               462        2992 LOAD_CONST              38 (('tok', 'tokID', 'tokenLogit'))
+               465        2992 LOAD_CONST              38 (('tok', 'tokID', 'tokenLogit'))
                           2994 BUILD_CONST_KEY_MAP      3
                
-               466        2996 LOAD_FAST               29 (kwargs_bold)
+               469        2996 LOAD_FAST               29 (kwargs_bold)
                
-               462        2998 DICT_MERGE               1
+               465        2998 DICT_MERGE               1
                
-               467        3000 LOAD_FAST               31 (kwargs_this_token_active)
+               470        3000 LOAD_FAST               31 (kwargs_this_token_active)
                
-               462        3002 DICT_MERGE               1
+               465        3002 DICT_MERGE               1
                
-               468        3004 LOAD_FAST               32 (kwargs_prev_token_active)
+               471        3004 LOAD_FAST               32 (kwargs_prev_token_active)
                
-               462        3006 DICT_MERGE               1
+               465        3006 DICT_MERGE               1
                
-               469        3008 LOAD_FAST               33 (kwargs_hover_above)
+               472        3008 LOAD_FAST               33 (kwargs_hover_above)
                
-               462        3010 DICT_MERGE               1
+               465        3010 DICT_MERGE               1
                           3012 CALL_FUNCTION_EX         1
                           3014 PRECALL                  1
                           3018 CALL                     1
                           3028 POP_TOP
                           3030 EXTENDED_ARG             1
                           3032 JUMP_BACKWARD          402 (to 2230)
                
-               473     >> 3034 LOAD_CONST              39 ('')
+               476     >> 3034 LOAD_CONST              39 ('')
                           3036 STORE_FAST              38 (html_str)
                
-               474        3038 LOAD_CONST              40 ('data')
+               477        3038 LOAD_CONST              40 ('data')
                           3040 LOAD_FAST               27 (js_data_list)
                           3042 BUILD_LIST               1
                           3044 BUILD_MAP                1
                           3046 STORE_FAST              39 (js_seq_group_data)
                
-               477        3048 LOAD_FAST               10 (first_in_group)
+               480        3048 LOAD_FAST               10 (first_in_group)
                           3050 POP_JUMP_FORWARD_IF_FALSE    83 (to 3218)
                
-               480        3052 LOAD_GLOBAL             69 (NULL + Path)
+               483        3052 LOAD_GLOBAL             69 (NULL + Path)
                           3064 LOAD_GLOBAL             70 (__file__)
                           3076 PRECALL                  1
                           3080 CALL                     1
                           3090 LOAD_ATTR               36 (parent)
                           3100 LOAD_CONST              41 ('html')
                           3102 BINARY_OP               11 (/)
                           3106 LOAD_CONST              42 ('sequences_group_template.html')
                           3108 BINARY_OP               11 (/)
                           3112 LOAD_METHOD             37 (read_text)
                           3134 PRECALL                  0
                           3138 CALL                     0
                           3148 STORE_FAST              38 (html_str)
                
-               481        3150 LOAD_FAST               38 (html_str)
+               484        3150 LOAD_FAST               38 (html_str)
                           3152 LOAD_METHOD             38 (replace)
                           3174 LOAD_CONST              43 ('SEQUENCE_GROUP_ID')
                           3176 LOAD_FAST                6 (seq_group_id)
                           3178 PRECALL                  2
                           3182 CALL                     2
                           3192 STORE_FAST              38 (html_str)
                
-               484        3194 LOAD_FAST                3 (id_suffix)
+               487        3194 LOAD_FAST                3 (id_suffix)
                           3196 LOAD_FAST               39 (js_seq_group_data)
                           3198 LOAD_CONST              44 ('idSuffix')
                           3200 STORE_SUBSCR
                
-               485        3204 LOAD_FAST               11 (title)
+               488        3204 LOAD_FAST               11 (title)
                           3206 POP_JUMP_FORWARD_IF_NONE     5 (to 3218)
                           3208 LOAD_FAST               11 (title)
                           3210 LOAD_FAST               39 (js_seq_group_data)
                           3212 LOAD_CONST              11 ('title')
                           3214 STORE_SUBSCR
                
-               487     >> 3218 LOAD_GLOBAL             79 (NULL + HTML)
+               490     >> 3218 LOAD_GLOBAL             79 (NULL + HTML)
                
-               488        3230 LOAD_FAST                4 (column)
+               491        3230 LOAD_FAST                4 (column)
                           3232 LOAD_FAST               38 (html_str)
                           3234 BUILD_MAP                1
                
-               489        3236 LOAD_CONST              45 ('tokenData')
+               492        3236 LOAD_CONST              45 ('tokenData')
                           3238 LOAD_FAST                6 (seq_group_id)
                           3240 LOAD_FAST               39 (js_seq_group_data)
                           3242 BUILD_MAP                1
                           3244 BUILD_MAP                1
                
-               487        3246 KW_NAMES                46
+               490        3246 KW_NAMES                46
                           3248 PRECALL                  2
                           3252 CALL                     2
                           3262 RETURN_VALUE
                consts
                   '\n        Args:\n\n        Returns:\n            js_data: list[dict[str, Any]]\n                The data for this sequence, in the form of a list of dicts for each token (where the dict stores things\n                like token, feature activations, etc).\n        '
                   'Invalid config type: '
                   'seq_group_id'
@@ -3493,15 +3497,15 @@
                      stacksize : 4
                      flags     : 19
                      code
                         0x9502970067007c005d177d017c0189026b0200000000720d89036a0000
                         000000000000006400190000000000000000006e01640191028c185300
                                    0 COPY_FREE_VARS           2
                      
-                     376           2 RESUME                   0
+                     379           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                23 (to 56)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_FAST                1 (i)
                                   14 LOAD_DEREF               2 (bold_idx)
                                   16 COMPARE_OP               2 (==)
@@ -3520,28 +3524,28 @@
                         0.0
                      names      ('feat_acts',)
                      varnames   ('.0', 'i')
                      freevars   ('bold_idx', 'self')
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 376
+                     firstlineno 379
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 5
                      flags     : 19
                      code
                         0x9502970067007c005d1a7d017c01890264007a0000006b020000000072
                         0d89036a0000000000000000006401190000000000000000006e01640291
                         028c1b5300
                                    0 COPY_FREE_VARS           2
                      
-                     377           2 RESUME                   0
+                     380           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_FAST                1 (i)
                                   14 LOAD_DEREF               2 (bold_idx)
                                   16 LOAD_CONST               0 (1)
@@ -3563,28 +3567,28 @@
                         0.0
                      names      ('loss_contribution',)
                      varnames   ('.0', 'i')
                      freevars   ('bold_idx', 'self')
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 377
+                     firstlineno 380
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 5
                      flags     : 19
                      code
                         0x9502970067007c005d1a7d017c01890264007a0000006b020000000072
                         0d89036a0000000000000000006401190000000000000000006e01670091
                         028c1b5300
                                    0 COPY_FREE_VARS           2
                      
-                     378           2 RESUME                   0
+                     381           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_FAST                1 (i)
                                   14 LOAD_DEREF               2 (bold_idx)
                                   16 LOAD_CONST               0 (1)
@@ -3605,28 +3609,28 @@
                         0
                      names      ('top_token_ids',)
                      varnames   ('.0', 'i')
                      freevars   ('bold_idx', 'self')
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 378
+                     firstlineno 381
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 5
                      flags     : 19
                      code
                         0x9502970067007c005d1a7d017c01890264007a0000006b020000000072
                         0d89036a0000000000000000006401190000000000000000006e01670091
                         028c1b5300
                                    0 COPY_FREE_VARS           2
                      
-                     379           2 RESUME                   0
+                     382           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_FAST                1 (i)
                                   14 LOAD_DEREF               2 (bold_idx)
                                   16 LOAD_CONST               0 (1)
@@ -3647,28 +3651,28 @@
                         0
                      names      ('bottom_token_ids',)
                      varnames   ('.0', 'i')
                      freevars   ('bold_idx', 'self')
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 379
+                     firstlineno 382
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 5
                      flags     : 19
                      code
                         0x9502970067007c005d1a7d017c01890264007a0000006b020000000072
                         0d89036a0000000000000000006401190000000000000000006e01670091
                         028c1b5300
                                    0 COPY_FREE_VARS           2
                      
-                     380           2 RESUME                   0
+                     383           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_FAST                1 (i)
                                   14 LOAD_DEREF               2 (bold_idx)
                                   16 LOAD_CONST               0 (1)
@@ -3689,28 +3693,28 @@
                         0
                      names      ('top_logits',)
                      varnames   ('.0', 'i')
                      freevars   ('bold_idx', 'self')
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 380
+                     firstlineno 383
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 5
                      flags     : 19
                      code
                         0x9502970067007c005d1a7d017c01890264007a0000006b020000000072
                         0d89036a0000000000000000006401190000000000000000006e01670091
                         028c1b5300
                                    0 COPY_FREE_VARS           2
                      
-                     381           2 RESUME                   0
+                     384           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                26 (to 62)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_FAST                1 (i)
                                   14 LOAD_DEREF               2 (bold_idx)
                                   16 LOAD_CONST               0 (1)
@@ -3731,15 +3735,15 @@
                         0
                      names      ('bottom_logits',)
                      varnames   ('.0', 'i')
                      freevars   ('bold_idx', 'self')
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 381
+                     firstlineno 384
                      lnotab 0x
                   ('abs',)
                   0.0
                   0.0001
                   1
                   'If this is a single prompt, these lists must be the same length as token_ids or 1 less'
                   'If this is part of a sequence group etc are given, they must be the same length as token_ids'
@@ -3749,15 +3753,15 @@
                      stacksize : 6
                      flags     : 19
                      code
                         0x9501970067007c005d127d0174010000000000000000000089027c01a6
                         020000ab02000000000000000091028c135300
                                    0 COPY_FREE_VARS           1
                      
-                     410           2 RESUME                   0
+                     413           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                18 (to 46)
                                   10 STORE_FAST               1 (pos)
                                   12 LOAD_GLOBAL              1 (NULL + to_str_tokens)
                                   24 LOAD_DEREF               2 (decode_fn)
                                   26 LOAD_FAST                1 (pos)
@@ -3769,27 +3773,27 @@
                      consts
                      names      ('to_str_tokens',)
                      varnames   ('.0', 'pos')
                      freevars   ('decode_fn',)
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 410
+                     firstlineno 413
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 6
                      flags     : 19
                      code
                         0x9501970067007c005d127d0174010000000000000000000089027c01a6
                         020000ab02000000000000000091028c135300
                                    0 COPY_FREE_VARS           1
                      
-                     411           2 RESUME                   0
+                     414           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                18 (to 46)
                                   10 STORE_FAST               1 (neg)
                                   12 LOAD_GLOBAL              1 (NULL + to_str_tokens)
                                   24 LOAD_DEREF               2 (decode_fn)
                                   26 LOAD_FAST                1 (neg)
@@ -3801,15 +3805,15 @@
                      consts
                      names      ('to_str_tokens',)
                      varnames   ('.0', 'neg')
                      freevars   ('decode_fn',)
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 411
+                     firstlineno 414
                      lnotab 0x
                   'isBold'
                   'permanentLine'
                   'hide'
                   'hoverAbove'
                   1e-08
                   ('featAct', 'bgColor')
@@ -3827,15 +3831,15 @@
                   ()
                names      ('isinstance', 'PromptConfig', 'SequencesConfig', 'type', 'get', 'seq_len', 'compute_buffer', 'range', 'deepcopy', 'feat_acts', 'loss_contribution', 'top_token_ids', 'bottom_token_ids', 'top_logits', 'bottom_logits', 'max_or_1', 'np', 'maximum', 'max', 'tolist', 'array', 'len', 'token_ids', 'to_str_tokens', 'int', 'abs', 'dict', 'round', 'PRECISION', 'bgColorMap', 'uColorMap', 'append', 'unprocess_str_tok', 'token_logits', 'Path', '__file__', 'parent', 'read_text', 'replace', 'HTML')
                varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'seq_group_id', 'max_act_color', 'max_loss_color', 'permanent_line', 'first_in_group', 'title', 'hover_above', 'only_bold', 'feat_acts', 'loss_contribution', 'pos_ids', 'neg_ids', 'pos_val', 'neg_val', 'bg_denom', 'u_denom', 'bg_values', 'u_values', 'toks', 'pos_toks', 'neg_toks', 'js_data_list', 'i', 'kwargs_bold', 'kwargs_hide', 'kwargs_this_token_active', 'kwargs_prev_token_active', 'kwargs_hover_above', 'pos_toks_i', 'neg_toks_i', 'pos_val_i', 'neg_val_i', 'html_str', 'js_seq_group_data')
                freevars   ()
                cellvars   ('self', 'decode_fn', 'bold_idx')
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data'
-               firstlineno 341
+               firstlineno 344
                lnotab
                   0x08106c012c012c012c012c012c012c012c012c03100318033a01040142
                   01420142014201420144022801280128012801280128033001340170016e
                   042a01ce0102ff10020c010c010c010c01c80102ff10042a011c011c0304
                   0248050401040104010401040410010a010e0340010c0404010a0332010c
                   01340128fe1206460146020c010201020102010201340128fa1209260128
                   0118013efd040402fc020502fb020602fa020702f9180b04010a03040362
@@ -3843,15 +3847,15 @@
             ('return', None)
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'list', 'token_ids', 'int', '__annotations__', 'feat_acts', 'float', 'loss_contribution', 'token_logits', 'top_token_ids', 'top_logits', 'bottom_token_ids', 'bottom_logits', '__post_init__', 'tuple', '_filter', 'PromptConfig', 'SequencesConfig', 'Callable', 'str', 'dict', 'Any', 'HTML', '_get_html_data')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'SequenceData'
-         firstlineno 286
+         firstlineno 289
          lnotab
             0x0c0304112e012e012e022e013a013a013a013a02080902021afe02031a
             fd020442fc081602fa040208fe020338fd020402fc020518fb020612fa02
             0702f9
       'SequenceData'
       code
          argcount  : 0
@@ -3863,104 +3867,104 @@
             00020065076508ac04a6010000ab0100000000000000005a096508650a19
             000000000000000000650664053c0000006406650b6602640784045a0c69
             0066016408650d6409650e650b6508650b190000000000000000007a0700
             006701650565086505190000000000000000007a07000066021900000000
             0000000000640a6505640b650b650f650b650b6602190000000000000000
             007a070000640c6510650565116602190000000000000000006406651266
             0c640d84055a13640e5300
-         493           0 RESUME                   0
+         496           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('SequenceGroupData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         496          12 LOAD_CONST               1 ('\n    This contains all the data necessary to make a single group of sequences (e.g. a quantile in prompt-centric\n    visualization). See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Inputs:\n        title:      The title that this sequence group will have, if any. This is used in `_get_html_data`. The titles\n                    will actually be in the HTML strings, not in the JavaScript data.\n        seq_data:   The data for the sequences in this group.\n    ')
+         499          12 LOAD_CONST               1 ('\n    This contains all the data necessary to make a single group of sequences (e.g. a quantile in prompt-centric\n    visualization). See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Inputs:\n        title:      The title that this sequence group will have, if any. This is used in `_get_html_data`. The titles\n                    will actually be in the HTML strings, not in the JavaScript data.\n        seq_data:   The data for the sequences in this group.\n    ')
                       14 STORE_NAME               3 (__doc__)
          
-         507          16 LOAD_CONST               2 ('')
+         510          16 LOAD_CONST               2 ('')
                       18 STORE_NAME               4 (title)
                       20 LOAD_NAME                5 (str)
                       22 LOAD_NAME                6 (__annotations__)
                       24 LOAD_CONST               3 ('title')
                       26 STORE_SUBSCR
          
-         508          30 PUSH_NULL
+         511          30 PUSH_NULL
                       32 LOAD_NAME                7 (field)
                       34 LOAD_NAME                8 (list)
                       36 KW_NAMES                 4
                       38 PRECALL                  1
                       42 CALL                     1
                       52 STORE_NAME               9 (seq_data)
                       54 LOAD_NAME                8 (list)
                       56 LOAD_NAME               10 (SequenceData)
                       58 BINARY_SUBSCR
                       68 LOAD_NAME                6 (__annotations__)
                       70 LOAD_CONST               5 ('seq_data')
                       72 STORE_SUBSCR
          
-         510          76 LOAD_CONST               6 ('return')
+         513          76 LOAD_CONST               6 ('return')
                       78 LOAD_NAME               11 (int)
                       80 BUILD_TUPLE              2
-                      82 LOAD_CONST               7 (<code object __len__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 510>)
+                      82 LOAD_CONST               7 (<code object __len__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 513>)
                       84 MAKE_FUNCTION            4 (annotations)
                       86 STORE_NAME              12 (__len__)
          
-         519          88 BUILD_MAP                0
+         522          88 BUILD_MAP                0
          
-         513          90 BUILD_TUPLE              1
+         516          90 BUILD_TUPLE              1
                       92 LOAD_CONST               8 ('cfg')
          
-         515          94 LOAD_NAME               13 (SequencesConfig)
+         518          94 LOAD_NAME               13 (SequencesConfig)
          
-         513          96 LOAD_CONST               9 ('decode_fn')
+         516          96 LOAD_CONST               9 ('decode_fn')
          
-         516          98 LOAD_NAME               14 (Callable)
+         519          98 LOAD_NAME               14 (Callable)
                      100 LOAD_NAME               11 (int)
                      102 LOAD_NAME                8 (list)
                      104 LOAD_NAME               11 (int)
                      106 BINARY_SUBSCR
                      116 BINARY_OP                7 (|)
                      120 BUILD_LIST               1
                      122 LOAD_NAME                5 (str)
                      124 LOAD_NAME                8 (list)
                      126 LOAD_NAME                5 (str)
                      128 BINARY_SUBSCR
                      138 BINARY_OP                7 (|)
                      142 BUILD_TUPLE              2
                      144 BINARY_SUBSCR
          
-         513         154 LOAD_CONST              10 ('id_suffix')
+         516         154 LOAD_CONST              10 ('id_suffix')
          
-         517         156 LOAD_NAME                5 (str)
+         520         156 LOAD_NAME                5 (str)
          
-         513         158 LOAD_CONST              11 ('column')
+         516         158 LOAD_CONST              11 ('column')
          
-         518         160 LOAD_NAME               11 (int)
+         521         160 LOAD_NAME               11 (int)
                      162 LOAD_NAME               15 (tuple)
                      164 LOAD_NAME               11 (int)
                      166 LOAD_NAME               11 (int)
                      168 BUILD_TUPLE              2
                      170 BINARY_SUBSCR
                      180 BINARY_OP                7 (|)
          
-         513         184 LOAD_CONST              12 ('component_specific_kwargs')
+         516         184 LOAD_CONST              12 ('component_specific_kwargs')
          
-         519         186 LOAD_NAME               16 (dict)
+         522         186 LOAD_NAME               16 (dict)
                      188 LOAD_NAME                5 (str)
                      190 LOAD_NAME               17 (Any)
                      192 BUILD_TUPLE              2
                      194 BINARY_SUBSCR
          
-         513         204 LOAD_CONST               6 ('return')
+         516         204 LOAD_CONST               6 ('return')
          
-         523         206 LOAD_NAME               18 (HTML)
+         526         206 LOAD_NAME               18 (HTML)
          
-         513         208 BUILD_TUPLE             12
-                     210 LOAD_CONST              13 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 513>)
+         516         208 BUILD_TUPLE             12
+                     210 LOAD_CONST              13 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 516>)
                      212 MAKE_FUNCTION            5 (defaults, annotations)
                      214 STORE_NAME              19 (_get_html_data)
                      216 LOAD_CONST              14 (None)
                      218 RETURN_VALUE
          consts
             'SequenceGroupData'
             '\n    This contains all the data necessary to make a single group of sequences (e.g. a quantile in prompt-centric\n    visualization). See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Inputs:\n        title:      The title that this sequence group will have, if any. This is used in `_get_html_data`. The titles\n                    will actually be in the HTML strings, not in the JavaScript data.\n        seq_data:   The data for the sequences in this group.\n    '
@@ -3973,31 +3977,31 @@
                argcount  : 1
                nlocals   : 1
                stacksize : 3
                flags     : 3
                code
                   0x97007401000000000000000000007c006a010000000000000000a60100
                   00ab0100000000000000005300
-               510           0 RESUME                   0
+               513           0 RESUME                   0
                
-               511           2 LOAD_GLOBAL              1 (NULL + len)
+               514           2 LOAD_GLOBAL              1 (NULL + len)
                             14 LOAD_FAST                0 (self)
                             16 LOAD_ATTR                1 (seq_data)
                             26 PRECALL                  1
                             30 CALL                     1
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'seq_data')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '__len__'
-               firstlineno 510
+               firstlineno 513
                lnotab 0x0201
             'cfg'
             'decode_fn'
             'id_suffix'
             'column'
             'component_specific_kwargs'
             code
@@ -4021,153 +4025,153 @@
                   000000000000007c006a03000000000000000064027c0785021900000000
                   0000000000a6010000ab01000000000000000044005d4a5c0200007d0b7d
                   0c7c0a7c0ca00500000000000000000000000000000000000000007c017c
                   027c037c04740d000000000000000000007c016a07000000000000000064
                   0c19000000000000000000640d7c087c097c067c0b640c6b02000000007c
                   006a080000000000000000ac0ea6070000ab070000000000000000ac0fa6
                   050000ab0500000000000000007a0d00007d0a8c4b7c0a5300
-               513           0 RESUME                   0
+               516           0 RESUME                   0
                
-               543           2 LOAD_FAST                5 (component_specific_kwargs)
+               546           2 LOAD_FAST                5 (component_specific_kwargs)
                              4 LOAD_METHOD              0 (get)
                             26 LOAD_CONST               1 ('seq_group_id')
                             28 LOAD_CONST               2 (None)
                             30 PRECALL                  2
                             34 CALL                     2
                             44 STORE_FAST               6 (seq_group_id)
                
-               544          46 LOAD_FAST                5 (component_specific_kwargs)
+               547          46 LOAD_FAST                5 (component_specific_kwargs)
                             48 LOAD_METHOD              0 (get)
                             70 LOAD_CONST               3 ('group_size')
                             72 LOAD_CONST               2 (None)
                             74 PRECALL                  2
                             78 CALL                     2
                             88 STORE_FAST               7 (group_size)
                
-               545          90 LOAD_FAST                5 (component_specific_kwargs)
+               548          90 LOAD_FAST                5 (component_specific_kwargs)
                             92 LOAD_METHOD              0 (get)
                            114 LOAD_CONST               4 ('max_act_color')
                            116 LOAD_CONST               2 (None)
                            118 PRECALL                  2
                            122 CALL                     2
                            132 STORE_FAST               8 (max_act_color)
                
-               546         134 LOAD_FAST                5 (component_specific_kwargs)
+               549         134 LOAD_FAST                5 (component_specific_kwargs)
                            136 LOAD_METHOD              0 (get)
                            158 LOAD_CONST               5 ('max_loss_color')
                            160 LOAD_CONST               2 (None)
                            162 PRECALL                  2
                            166 CALL                     2
                            176 STORE_FAST               9 (max_loss_color)
                
-               550         178 LOAD_GLOBAL              3 (NULL + HTML)
+               553         178 LOAD_GLOBAL              3 (NULL + HTML)
                            190 PRECALL                  0
                            194 CALL                     0
                            204 STORE_FAST              10 (html_obj)
                
-               554         206 LOAD_FAST                6 (seq_group_id)
+               557         206 LOAD_FAST                6 (seq_group_id)
                            208 POP_JUMP_FORWARD_IF_NOT_NONE     6 (to 222)
                            210 LOAD_CONST               6 ('seq-group-')
                            212 LOAD_FAST                4 (column)
                            214 LOAD_CONST               7 ('03d')
                            216 FORMAT_VALUE             4 (with format)
                            218 BUILD_STRING             2
                            220 STORE_FAST               6 (seq_group_id)
                
-               557     >>  222 LOAD_FAST                8 (max_act_color)
+               560     >>  222 LOAD_FAST                8 (max_act_color)
                            224 POP_JUMP_FORWARD_IF_NOT_NONE    30 (to 286)
                            226 LOAD_GLOBAL              5 (NULL + max_or_1)
-                           238 LOAD_CONST               8 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 557>)
+                           238 LOAD_CONST               8 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 560>)
                            240 MAKE_FUNCTION            0
                            242 LOAD_FAST                0 (self)
                            244 LOAD_ATTR                3 (seq_data)
                            254 GET_ITER
                            256 PRECALL                  0
                            260 CALL                     0
                            270 PRECALL                  1
                            274 CALL                     1
                            284 STORE_FAST               8 (max_act_color)
                
-               558     >>  286 LOAD_FAST                9 (max_loss_color)
+               561     >>  286 LOAD_FAST                9 (max_loss_color)
                            288 POP_JUMP_FORWARD_IF_NOT_NONE    32 (to 354)
                            290 LOAD_GLOBAL              5 (NULL + max_or_1)
-                           302 LOAD_CONST               9 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 558>)
+                           302 LOAD_CONST               9 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 561>)
                            304 MAKE_FUNCTION            0
                            306 LOAD_FAST                0 (self)
                            308 LOAD_ATTR                3 (seq_data)
                            318 GET_ITER
                            320 PRECALL                  0
                            324 CALL                     0
                            334 LOAD_CONST              10 (True)
                            336 KW_NAMES                11
                            338 PRECALL                  2
                            342 CALL                     2
                            352 STORE_FAST               9 (max_loss_color)
                
-               561     >>  354 LOAD_GLOBAL              9 (NULL + enumerate)
+               564     >>  354 LOAD_GLOBAL              9 (NULL + enumerate)
                            366 LOAD_FAST                0 (self)
                            368 LOAD_ATTR                3 (seq_data)
                            378 LOAD_CONST               2 (None)
                            380 LOAD_FAST                7 (group_size)
                            382 BUILD_SLICE              2
                            384 BINARY_SUBSCR
                            394 PRECALL                  1
                            398 CALL                     1
                            408 GET_ITER
                        >>  410 FOR_ITER                74 (to 560)
                            412 UNPACK_SEQUENCE          2
                            416 STORE_FAST              11 (i)
                            418 STORE_FAST              12 (seq)
                
-               562         420 LOAD_FAST               10 (html_obj)
+               565         420 LOAD_FAST               10 (html_obj)
                            422 LOAD_FAST               12 (seq)
                            424 LOAD_METHOD              5 (_get_html_data)
                
-               563         446 LOAD_FAST                1 (cfg)
+               566         446 LOAD_FAST                1 (cfg)
                
-               565         448 LOAD_FAST                2 (decode_fn)
+               568         448 LOAD_FAST                2 (decode_fn)
                
-               566         450 LOAD_FAST                3 (id_suffix)
+               569         450 LOAD_FAST                3 (id_suffix)
                
-               567         452 LOAD_FAST                4 (column)
+               570         452 LOAD_FAST                4 (column)
                
-               568         454 LOAD_GLOBAL             13 (NULL + dict)
+               571         454 LOAD_GLOBAL             13 (NULL + dict)
                
-               569         466 LOAD_FAST                1 (cfg)
+               572         466 LOAD_FAST                1 (cfg)
                            468 LOAD_ATTR                7 (buffer)
                            478 LOAD_CONST              12 (0)
                            480 BINARY_SUBSCR
                
-               570         490 LOAD_CONST              13 (False)
+               573         490 LOAD_CONST              13 (False)
                
-               571         492 LOAD_FAST                8 (max_act_color)
+               574         492 LOAD_FAST                8 (max_act_color)
                
-               572         494 LOAD_FAST                9 (max_loss_color)
+               575         494 LOAD_FAST                9 (max_loss_color)
                
-               573         496 LOAD_FAST                6 (seq_group_id)
+               576         496 LOAD_FAST                6 (seq_group_id)
                
-               574         498 LOAD_FAST               11 (i)
+               577         498 LOAD_FAST               11 (i)
                            500 LOAD_CONST              12 (0)
                            502 COMPARE_OP               2 (==)
                
-               575         508 LOAD_FAST                0 (self)
+               578         508 LOAD_FAST                0 (self)
                            510 LOAD_ATTR                8 (title)
                
-               568         520 KW_NAMES                14
+               571         520 KW_NAMES                14
                            522 PRECALL                  7
                            526 CALL                     7
                
-               562         536 KW_NAMES                15
+               565         536 KW_NAMES                15
                            538 PRECALL                  5
                            542 CALL                     5
                            552 BINARY_OP               13 (+=)
                            556 STORE_FAST              10 (html_obj)
                            558 JUMP_BACKWARD           75 (to 410)
                
-               579     >>  560 LOAD_FAST               10 (html_obj)
+               582     >>  560 LOAD_FAST               10 (html_obj)
                            562 RETURN_VALUE
                consts
                   '\n        This creates a single group of sequences, i.e. title plus some number of vertically stacked sequences.\n\n        Note, `column` is treated specially here, because it might overflow (could be a tuple).\n\n        Args:\n            decode_fn:      Mapping from token IDs to string tokens.\n            bold_idx:       If supplied, then we bold the token at this index. Default is the middle token. Note, this\n                            argument is only allowed if the sequence group contains just one sequence.\n            group_size:     Max size of sequences in the group (i.e. we truncate after this many, if argument supplied).\n            max_act_color:  If supplied, then we use this as the most extreme value (for coloring by feature act).\n            permanent_line: If True, the bolded token for first seq in group will have a permanent line on histograms.\n            seq_group_id:   The id of the sequence group div. This will usually be passed as e.g. "seq-group-001".\n            column:         The index of this column. Note that it can be a tuple, if our SequenceMultiGroupData object\n                            has overflowed into a new column.\n        \n        Returns:\n            html_obj:       Object containing the HTML and JavaScript data for this seq group.\n        '
                   'seq_group_id'
                   None
                   'group_size'
                   'max_act_color'
@@ -4178,15 +4182,15 @@
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
                      flags     : 19
                      code
                         0x970067007c005d0e7d017c016a00000000000000000044005d047d027c
                         0291038c058c0f5300
-                     557           0 RESUME                   0
+                     560           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                14 (to 36)
                                    8 STORE_FAST               1 (seq)
                                   10 LOAD_FAST                1 (seq)
                                   12 LOAD_ATTR                0 (feat_acts)
                                   22 GET_ITER
@@ -4200,25 +4204,25 @@
                      consts
                      names      ('feat_acts',)
                      varnames   ('.0', 'seq', 'act')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 557
+                     firstlineno 560
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
                      flags     : 19
                      code
                         0x970067007c005d0e7d017c016a00000000000000000044005d047d027c
                         0291038c058c0f5300
-                     558           0 RESUME                   0
+                     561           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                14 (to 36)
                                    8 STORE_FAST               1 (seq)
                                   10 LOAD_FAST                1 (seq)
                                   12 LOAD_ATTR                0 (loss_contribution)
                                   22 GET_ITER
@@ -4232,40 +4236,40 @@
                      consts
                      names      ('loss_contribution',)
                      varnames   ('.0', 'seq', 'loss')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 558
+                     firstlineno 561
                      lnotab 0x
                   True
                   ('abs',)
                   0
                   False
                   ('bold_idx', 'permanent_line', 'max_act_color', 'max_loss_color', 'seq_group_id', 'first_in_group', 'title')
                   ('cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs')
                names      ('get', 'HTML', 'max_or_1', 'seq_data', 'enumerate', '_get_html_data', 'dict', 'buffer', 'title')
                varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'seq_group_id', 'group_size', 'max_act_color', 'max_loss_color', 'html_obj', 'i', 'seq')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data'
-               firstlineno 513
+               firstlineno 516
                lnotab
                   0x021e2c012c012c012c041c0410034001440342011a0102020201020102
                   010c01180102010201020102010a010cf910fa1811
             None
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'title', 'str', '__annotations__', 'field', 'list', 'seq_data', 'SequenceData', 'int', '__len__', 'SequencesConfig', 'Callable', 'tuple', 'dict', 'Any', 'HTML', '_get_html_data')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'SequenceGroupData'
-         firstlineno 493
+         firstlineno 496
          lnotab
             0x0c03040b0e012e020c0902fa040202fe020338fd020402fc020518fb02
             0612fa020a02f6
       'SequenceGroupData'
       code
          argcount  : 0
          nlocals   : 0
@@ -4276,99 +4280,99 @@
             0100000000000000005a066505650719000000000000000000650864033c
             00000064046509640565076604640684045a0a690066016407650b640865
             0c650965056509190000000000000000007a0700006701650d6505650d19
             0000000000000000007a0700006602190000000000000000006409650d64
             0a6509650e650965096602190000000000000000007a070000640b650f65
             0d651066021900000000000000000064056511660c640c84055a12640d53
             00
-         583           0 RESUME                   0
+         586           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('SequenceMultiGroupData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         586          12 LOAD_CONST               1 ('\n    This contains all the data necessary to make multiple groups of sequences (e.g. the different quantiles in the\n    prompt-centric visualization). See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n    ')
+         589          12 LOAD_CONST               1 ('\n    This contains all the data necessary to make multiple groups of sequences (e.g. the different quantiles in the\n    prompt-centric visualization). See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n    ')
                       14 STORE_NAME               3 (__doc__)
          
-         592          16 PUSH_NULL
+         595          16 PUSH_NULL
                       18 LOAD_NAME                4 (field)
                       20 LOAD_NAME                5 (list)
                       22 KW_NAMES                 2
                       24 PRECALL                  1
                       28 CALL                     1
                       38 STORE_NAME               6 (seq_group_data)
                       40 LOAD_NAME                5 (list)
                       42 LOAD_NAME                7 (SequenceGroupData)
                       44 BINARY_SUBSCR
                       54 LOAD_NAME                8 (__annotations__)
                       56 LOAD_CONST               3 ('seq_group_data')
                       58 STORE_SUBSCR
          
-         594          62 LOAD_CONST               4 ('idx')
+         597          62 LOAD_CONST               4 ('idx')
                       64 LOAD_NAME                9 (int)
                       66 LOAD_CONST               5 ('return')
                       68 LOAD_NAME                7 (SequenceGroupData)
                       70 BUILD_TUPLE              4
-                      72 LOAD_CONST               6 (<code object __getitem__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 594>)
+                      72 LOAD_CONST               6 (<code object __getitem__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 597>)
                       74 MAKE_FUNCTION            4 (annotations)
                       76 STORE_NAME              10 (__getitem__)
          
-         603          78 BUILD_MAP                0
+         606          78 BUILD_MAP                0
          
-         597          80 BUILD_TUPLE              1
+         600          80 BUILD_TUPLE              1
                       82 LOAD_CONST               7 ('cfg')
          
-         599          84 LOAD_NAME               11 (SequencesConfig)
+         602          84 LOAD_NAME               11 (SequencesConfig)
          
-         597          86 LOAD_CONST               8 ('decode_fn')
+         600          86 LOAD_CONST               8 ('decode_fn')
          
-         600          88 LOAD_NAME               12 (Callable)
+         603          88 LOAD_NAME               12 (Callable)
                       90 LOAD_NAME                9 (int)
                       92 LOAD_NAME                5 (list)
                       94 LOAD_NAME                9 (int)
                       96 BINARY_SUBSCR
                      106 BINARY_OP                7 (|)
                      110 BUILD_LIST               1
                      112 LOAD_NAME               13 (str)
                      114 LOAD_NAME                5 (list)
                      116 LOAD_NAME               13 (str)
                      118 BINARY_SUBSCR
                      128 BINARY_OP                7 (|)
                      132 BUILD_TUPLE              2
                      134 BINARY_SUBSCR
          
-         597         144 LOAD_CONST               9 ('id_suffix')
+         600         144 LOAD_CONST               9 ('id_suffix')
          
-         601         146 LOAD_NAME               13 (str)
+         604         146 LOAD_NAME               13 (str)
          
-         597         148 LOAD_CONST              10 ('column')
+         600         148 LOAD_CONST              10 ('column')
          
-         602         150 LOAD_NAME                9 (int)
+         605         150 LOAD_NAME                9 (int)
                      152 LOAD_NAME               14 (tuple)
                      154 LOAD_NAME                9 (int)
                      156 LOAD_NAME                9 (int)
                      158 BUILD_TUPLE              2
                      160 BINARY_SUBSCR
                      170 BINARY_OP                7 (|)
          
-         597         174 LOAD_CONST              11 ('component_specific_kwargs')
+         600         174 LOAD_CONST              11 ('component_specific_kwargs')
          
-         603         176 LOAD_NAME               15 (dict)
+         606         176 LOAD_NAME               15 (dict)
                      178 LOAD_NAME               13 (str)
                      180 LOAD_NAME               16 (Any)
                      182 BUILD_TUPLE              2
                      184 BINARY_SUBSCR
          
-         597         194 LOAD_CONST               5 ('return')
+         600         194 LOAD_CONST               5 ('return')
          
-         604         196 LOAD_NAME               17 (HTML)
+         607         196 LOAD_NAME               17 (HTML)
          
-         597         198 BUILD_TUPLE             12
-                     200 LOAD_CONST              12 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 597>)
+         600         198 BUILD_TUPLE             12
+                     200 LOAD_CONST              12 (<code object _get_html_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 600>)
                      202 MAKE_FUNCTION            5 (defaults, annotations)
                      204 STORE_NAME              18 (_get_html_data)
                      206 LOAD_CONST              13 (None)
                      208 RETURN_VALUE
          consts
             'SequenceMultiGroupData'
             '\n    This contains all the data necessary to make multiple groups of sequences (e.g. the different quantiles in the\n    prompt-centric visualization). See diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n    '
@@ -4378,30 +4382,30 @@
             'return'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 2
                flags     : 3
                code 0x97007c006a0000000000000000007c01190000000000000000005300
-               594           0 RESUME                   0
+               597           0 RESUME                   0
                
-               595           2 LOAD_FAST                0 (self)
+               598           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (seq_group_data)
                             14 LOAD_FAST                1 (idx)
                             16 BINARY_SUBSCR
                             26 RETURN_VALUE
                consts
                   None
                names      ('seq_group_data',)
                varnames   ('self', 'idx')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '__getitem__'
-               firstlineno 594
+               firstlineno 597
                lnotab 0x0201
             'cfg'
             'decode_fn'
             'id_suffix'
             'column'
             'component_specific_kwargs'
             code
@@ -4434,159 +4438,159 @@
                   0c5c0300007d0d7d0e7d0f7c0b7c0fa00c00000000000000000000000000
                   000000000000007c017c027c037c0d741b000000000000000000007c0e7c
                   067c07640f89049b0064107c0c9b009d04ac11a6040000ab040000000000
                   000000ac12a6050000ab0500000000000000007a0d00007d0b8c3e7c0b53
                   00
                              0 MAKE_CELL                4 (column)
                
-               597           2 RESUME                   0
+               600           2 RESUME                   0
                
-               611           4 LOAD_GLOBAL              1 (NULL + isinstance)
+               614           4 LOAD_GLOBAL              1 (NULL + isinstance)
                             16 LOAD_DEREF               4 (column)
                             18 LOAD_GLOBAL              2 (int)
                             30 PRECALL                  2
                             34 CALL                     2
                             44 POP_JUMP_FORWARD_IF_TRUE     2 (to 50)
                             46 LOAD_ASSERTION_ERROR
                             48 RAISE_VARARGS            1
                
-               614     >>   50 LOAD_GLOBAL              5 (NULL + max_or_1)
-                            62 LOAD_CONST               1 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 614>)
+               617     >>   50 LOAD_GLOBAL              5 (NULL + max_or_1)
+                            62 LOAD_CONST               1 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 617>)
                             64 MAKE_FUNCTION            0
                
-               615          66 LOAD_FAST                0 (self)
+               618          66 LOAD_FAST                0 (self)
                             68 LOAD_ATTR                3 (seq_group_data)
                
-               614          78 GET_ITER
+               617          78 GET_ITER
                             80 PRECALL                  0
                             84 CALL                     0
                             94 PRECALL                  1
                             98 CALL                     1
                            108 STORE_FAST               6 (max_act_color)
                
-               617         110 LOAD_GLOBAL              5 (NULL + max_or_1)
-                           122 LOAD_CONST               2 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 617>)
+               620         110 LOAD_GLOBAL              5 (NULL + max_or_1)
+                           122 LOAD_CONST               2 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 620>)
                            124 MAKE_FUNCTION            0
                
-               618         126 LOAD_FAST                0 (self)
+               621         126 LOAD_FAST                0 (self)
                            128 LOAD_ATTR                3 (seq_group_data)
                
-               617         138 GET_ITER
+               620         138 GET_ITER
                            140 PRECALL                  0
                            144 CALL                     0
                
-               619         154 LOAD_CONST               3 (True)
+               622         154 LOAD_CONST               3 (True)
                
-               617         156 KW_NAMES                 4
+               620         156 KW_NAMES                 4
                            158 PRECALL                  2
                            162 CALL                     2
                            172 STORE_FAST               7 (max_loss_color)
                
-               625         174 LOAD_GLOBAL              9 (NULL + len)
+               628         174 LOAD_GLOBAL              9 (NULL + len)
                            186 LOAD_FAST                0 (self)
                            188 LOAD_ATTR                3 (seq_group_data)
                            198 PRECALL                  1
                            202 CALL                     1
                            212 STORE_FAST               8 (n_groups)
                
-               626         214 LOAD_FAST                8 (n_groups)
+               629         214 LOAD_FAST                8 (n_groups)
                            216 LOAD_CONST               5 (1)
                            218 BINARY_OP               10 (-)
                            222 STORE_FAST               9 (n_quantile_groups)
                
-               627         224 LOAD_FAST                1 (cfg)
+               630         224 LOAD_FAST                1 (cfg)
                            226 LOAD_ATTR                5 (stack_mode)
                
-               628         236 COPY                     1
+               631         236 COPY                     1
                            238 LOAD_CONST               6 ('stack-all')
                            240 COMPARE_OP               2 (==)
                            246 POP_JUMP_FORWARD_IF_FALSE    29 (to 306)
                            248 POP_TOP
                
-               630         250 LOAD_CLOSURE             4 (column)
+               633         250 LOAD_CLOSURE             4 (column)
                            252 BUILD_TUPLE              1
-                           254 LOAD_CONST               7 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 630>)
+                           254 LOAD_CONST               7 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 633>)
                            256 MAKE_FUNCTION            8 (closure)
                            258 LOAD_GLOBAL             13 (NULL + range)
                            270 LOAD_FAST                8 (n_groups)
                            272 PRECALL                  1
                            276 CALL                     1
                            286 GET_ITER
                            288 PRECALL                  0
                            292 CALL                     0
                            302 STORE_FAST              10 (cols)
                            304 JUMP_FORWARD           104 (to 514)
                
-               631     >>  306 COPY                     1
+               634     >>  306 COPY                     1
                            308 LOAD_CONST               8 ('stack-quantiles')
                            310 COMPARE_OP               2 (==)
                            316 POP_JUMP_FORWARD_IF_FALSE    35 (to 388)
                            318 POP_TOP
                
-               633         320 LOAD_DEREF               4 (column)
+               636         320 LOAD_DEREF               4 (column)
                            322 LOAD_CONST               9 (0)
                            324 BUILD_TUPLE              2
                            326 BUILD_LIST               1
                            328 LOAD_CLOSURE             4 (column)
                            330 BUILD_TUPLE              1
-                           332 LOAD_CONST              10 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 633>)
+                           332 LOAD_CONST              10 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 636>)
                            334 MAKE_FUNCTION            8 (closure)
                            336 LOAD_GLOBAL             13 (NULL + range)
                            348 LOAD_FAST                9 (n_quantile_groups)
                            350 PRECALL                  1
                            354 CALL                     1
                            364 GET_ITER
                            366 PRECALL                  0
                            370 CALL                     0
                            380 BINARY_OP                0 (+)
                            384 STORE_FAST              10 (cols)
                            386 JUMP_FORWARD            63 (to 514)
                
-               634     >>  388 LOAD_CONST              11 ('stack-none')
+               637     >>  388 LOAD_CONST              11 ('stack-none')
                            390 COMPARE_OP               2 (==)
                            396 POP_JUMP_FORWARD_IF_FALSE    33 (to 464)
                
-               636         398 LOAD_DEREF               4 (column)
+               639         398 LOAD_DEREF               4 (column)
                            400 LOAD_CONST               9 (0)
                            402 BUILD_TUPLE              2
                            404 BUILD_LIST               1
                            406 LOAD_CLOSURE             4 (column)
                            408 BUILD_TUPLE              1
-                           410 LOAD_CONST              12 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 636>)
+                           410 LOAD_CONST              12 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 639>)
                            412 MAKE_FUNCTION            8 (closure)
                            414 LOAD_GLOBAL             13 (NULL + range)
                            426 LOAD_FAST                9 (n_quantile_groups)
                            428 PRECALL                  1
                            432 CALL                     1
                            442 GET_ITER
                            444 PRECALL                  0
                            448 CALL                     0
                            458 LIST_EXTEND              1
                            460 STORE_FAST              10 (cols)
                            462 JUMP_FORWARD            25 (to 514)
                
-               637     >>  464 NOP
+               640     >>  464 NOP
                
-               638         466 LOAD_GLOBAL             15 (NULL + ValueError)
+               641         466 LOAD_GLOBAL             15 (NULL + ValueError)
                            478 LOAD_CONST              13 ('Invalid stack_mode: ')
                            480 LOAD_FAST                1 (cfg)
                            482 LOAD_ATTR                5 (stack_mode)
                            492 FORMAT_VALUE             0
                            494 LOAD_CONST              14 (". Expected in 'stack-x' for x='all', 'quantiles', 'none'")
                            496 BUILD_STRING             3
                            498 PRECALL                  1
                            502 CALL                     1
                            512 RAISE_VARARGS            1
                
-               641     >>  514 LOAD_GLOBAL             17 (NULL + HTML)
+               644     >>  514 LOAD_GLOBAL             17 (NULL + HTML)
                            526 PRECALL                  0
                            530 CALL                     0
                            540 STORE_FAST              11 (html_obj)
                
-               642         542 LOAD_GLOBAL             19 (NULL + enumerate)
+               645         542 LOAD_GLOBAL             19 (NULL + enumerate)
                            554 LOAD_GLOBAL             21 (NULL + zip)
                            566 LOAD_FAST               10 (cols)
                            568 LOAD_FAST                1 (cfg)
                            570 LOAD_ATTR               11 (group_sizes)
                            580 LOAD_FAST                0 (self)
                            582 LOAD_ATTR                3 (seq_group_data)
                            592 PRECALL                  3
@@ -4598,158 +4602,158 @@
                            624 UNPACK_SEQUENCE          2
                            628 STORE_FAST              12 (i)
                            630 UNPACK_SEQUENCE          3
                            634 STORE_FAST              13 (col)
                            636 STORE_FAST              14 (group_size)
                            638 STORE_FAST              15 (sequences_group)
                
-               643         640 LOAD_FAST               11 (html_obj)
+               646         640 LOAD_FAST               11 (html_obj)
                            642 LOAD_FAST               15 (sequences_group)
                            644 LOAD_METHOD             12 (_get_html_data)
                
-               644         666 LOAD_FAST                1 (cfg)
+               647         666 LOAD_FAST                1 (cfg)
                
-               645         668 LOAD_FAST                2 (decode_fn)
+               648         668 LOAD_FAST                2 (decode_fn)
                
-               646         670 LOAD_FAST                3 (id_suffix)
+               649         670 LOAD_FAST                3 (id_suffix)
                
-               647         672 LOAD_FAST               13 (col)
+               650         672 LOAD_FAST               13 (col)
                
-               648         674 LOAD_GLOBAL             27 (NULL + dict)
+               651         674 LOAD_GLOBAL             27 (NULL + dict)
                
-               649         686 LOAD_FAST               14 (group_size)
+               652         686 LOAD_FAST               14 (group_size)
                
-               650         688 LOAD_FAST                6 (max_act_color)
+               653         688 LOAD_FAST                6 (max_act_color)
                
-               651         690 LOAD_FAST                7 (max_loss_color)
+               654         690 LOAD_FAST                7 (max_loss_color)
                
-               652         692 LOAD_CONST              15 ('seq-group-')
+               655         692 LOAD_CONST              15 ('seq-group-')
                            694 LOAD_DEREF               4 (column)
                            696 FORMAT_VALUE             0
                            698 LOAD_CONST              16 ('-')
                            700 LOAD_FAST               12 (i)
                            702 FORMAT_VALUE             0
                            704 BUILD_STRING             4
                
-               648         706 KW_NAMES                17
+               651         706 KW_NAMES                17
                            708 PRECALL                  4
                            712 CALL                     4
                
-               643         722 KW_NAMES                18
+               646         722 KW_NAMES                18
                            724 PRECALL                  5
                            728 CALL                     5
                            738 BINARY_OP               13 (+=)
                            742 STORE_FAST              11 (html_obj)
                            744 JUMP_BACKWARD           62 (to 622)
                
-               656     >>  746 LOAD_FAST               11 (html_obj)
+               659     >>  746 LOAD_FAST               11 (html_obj)
                            748 RETURN_VALUE
                consts
                   '\n        Args:\n\n        Returns:\n            html_obj:  Object containing the HTML and JavaScript data for these multiple seq groups.\n        '
                   code
                      argcount  : 1
                      nlocals   : 4
                      stacksize : 5
                      flags     : 19
                      code
                         0x970067007c005d187d017c016a00000000000000000044005d0e7d027c
                         026a01000000000000000044005d047d037c0391048c058c0f8c195300
-                     614           0 RESUME                   0
+                     617           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                24 (to 56)
                      
-                     615           8 STORE_FAST               1 (group)
+                     618           8 STORE_FAST               1 (group)
                                   10 LOAD_FAST                1 (group)
                                   12 LOAD_ATTR                0 (seq_data)
                      
-                     614          22 GET_ITER
+                     617          22 GET_ITER
                              >>   24 FOR_ITER                14 (to 54)
                      
-                     615          26 STORE_FAST               2 (seq)
+                     618          26 STORE_FAST               2 (seq)
                                   28 LOAD_FAST                2 (seq)
                                   30 LOAD_ATTR                1 (feat_acts)
                      
-                     614          40 GET_ITER
+                     617          40 GET_ITER
                              >>   42 FOR_ITER                 4 (to 52)
                      
-                     615          44 STORE_FAST               3 (act)
+                     618          44 STORE_FAST               3 (act)
                                   46 LOAD_FAST                3 (act)
                      
-                     614          48 LIST_APPEND              4
+                     617          48 LIST_APPEND              4
                                   50 JUMP_BACKWARD            5 (to 42)
                              >>   52 JUMP_BACKWARD           15 (to 24)
                              >>   54 JUMP_BACKWARD           25 (to 6)
                              >>   56 RETURN_VALUE
                      consts
                      names      ('seq_data', 'feat_acts')
                      varnames   ('.0', 'group', 'seq', 'act')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 614
+                     firstlineno 617
                      lnotab 0x08010eff04010eff040104ff
                   code
                      argcount  : 1
                      nlocals   : 4
                      stacksize : 5
                      flags     : 19
                      code
                         0x970067007c005d187d017c016a00000000000000000044005d0e7d027c
                         026a01000000000000000044005d047d037c0391048c058c0f8c195300
-                     617           0 RESUME                   0
+                     620           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                24 (to 56)
                      
-                     618           8 STORE_FAST               1 (group)
+                     621           8 STORE_FAST               1 (group)
                                   10 LOAD_FAST                1 (group)
                                   12 LOAD_ATTR                0 (seq_data)
                      
-                     617          22 GET_ITER
+                     620          22 GET_ITER
                              >>   24 FOR_ITER                14 (to 54)
                      
-                     618          26 STORE_FAST               2 (seq)
+                     621          26 STORE_FAST               2 (seq)
                                   28 LOAD_FAST                2 (seq)
                                   30 LOAD_ATTR                1 (loss_contribution)
                      
-                     617          40 GET_ITER
+                     620          40 GET_ITER
                              >>   42 FOR_ITER                 4 (to 52)
                      
-                     618          44 STORE_FAST               3 (loss)
+                     621          44 STORE_FAST               3 (loss)
                                   46 LOAD_FAST                3 (loss)
                      
-                     617          48 LIST_APPEND              4
+                     620          48 LIST_APPEND              4
                                   50 JUMP_BACKWARD            5 (to 42)
                              >>   52 JUMP_BACKWARD           15 (to 24)
                              >>   54 JUMP_BACKWARD           25 (to 6)
                              >>   56 RETURN_VALUE
                      consts
                      names      ('seq_data', 'loss_contribution')
                      varnames   ('.0', 'group', 'seq', 'loss')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 617
+                     firstlineno 620
                      lnotab 0x08010eff04010eff040104ff
                   True
                   ('abs',)
                   1
                   'stack-all'
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 3
                      flags     : 19
                      code 0x9501970067007c005d047d01890291028c055300
                                    0 COPY_FREE_VARS           1
                      
-                     630           2 RESUME                   0
+                     633           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                 4 (to 18)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_DEREF               2 (column)
                                   14 LIST_APPEND              2
                                   16 JUMP_BACKWARD            5 (to 8)
@@ -4757,27 +4761,27 @@
                      consts
                      names      ()
                      varnames   ('.0', 'i')
                      freevars   ('column',)
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 630
+                     firstlineno 633
                      lnotab 0x
                   'stack-quantiles'
                   0
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 19
                      code 0x9501970067007c005d067d0189026400660291028c075300
                                    0 COPY_FREE_VARS           1
                      
-                     633           2 RESUME                   0
+                     636           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                 6 (to 22)
                                   10 STORE_FAST               1 (_)
                                   12 LOAD_DEREF               2 (column)
                                   14 LOAD_CONST               0 (1)
                                   16 BUILD_TUPLE              2
@@ -4788,29 +4792,29 @@
                         1
                      names      ()
                      varnames   ('.0', '_')
                      freevars   ('column',)
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 633
+                     firstlineno 636
                      lnotab 0x
                   'stack-none'
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 8
                      flags     : 19
                      code
                         0x9501970067007c005d197d01890264007401000000000000000000007c
                         0164017a0b0000a6010000ab0100000000000000007a000000660291028c
                         1a5300
                                    0 COPY_FREE_VARS           1
                      
-                     636           2 RESUME                   0
+                     639           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                25 (to 60)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_DEREF               2 (column)
                                   14 LOAD_CONST               0 (1)
                                   16 LOAD_GLOBAL              1 (NULL + int)
@@ -4829,41 +4833,41 @@
                         3
                      names      ('int',)
                      varnames   ('.0', 'i')
                      freevars   ('column',)
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 636
+                     firstlineno 639
                      lnotab 0x
                   'Invalid stack_mode: '
                   ". Expected in 'stack-x' for x='all', 'quantiles', 'none'"
                   'seq-group-'
                   '-'
                   ('group_size', 'max_act_color', 'max_loss_color', 'seq_group_id')
                   ('cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs')
                names      ('isinstance', 'int', 'max_or_1', 'seq_group_data', 'len', 'stack_mode', 'range', 'ValueError', 'HTML', 'enumerate', 'zip', 'group_sizes', '_get_html_data', 'dict')
                varnames   ('self', 'cfg', 'decode_fn', 'id_suffix', 'column', 'component_specific_kwargs', 'max_act_color', 'max_loss_color', 'n_groups', 'n_quantile_groups', 'cols', 'html_obj', 'i', 'col', 'group_size', 'sequences_group')
                freevars   ()
                cellvars   ('column',)
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data'
-               firstlineno 597
+               firstlineno 600
                lnotab
                   0x040e2e0310010cff200310010cff100202fe120828010a010c010e0238
                   010e0244010a024201020130031c0162011a0102010201020102010c0102
                   01020102010efc10fb180d
             None
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'list', 'seq_group_data', 'SequenceGroupData', '__annotations__', 'int', '__getitem__', 'SequencesConfig', 'Callable', 'str', 'tuple', 'dict', 'Any', 'HTML', '_get_html_data')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'SequenceMultiGroupData'
-         firstlineno 583
+         firstlineno 586
          lnotab
             0x0c0304062e02100902fa040202fe020338fd020402fc020518fb020612
             fa020702f9
       'SequenceMultiGroupData'
       code
          argcount  : 0
          nlocals   : 0
@@ -4877,154 +4881,154 @@
             083c0000000200650464098400ac03a6010000ab0100000000000000005a
             0c650d6507640a3c00000002006504640b8400ac03a6010000ab01000000
             00000000005a0e650f6507640c3c00000002006504640d8400ac03a60100
             00ab0100000000000000005a1065116507640e3c000000640f6512641065
             136604641184045a146412651564136516641065176606641484045a1864
             1265156413651664156519641665196417651a64106517660c641884045a
             1b64195300
-         670           0 RESUME                   0
+         673           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('FeatureData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         672          12 LOAD_CONST               1 ("\n    This contains all the data necessary to make the feature-centric visualization, for a single feature. See\n    diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Args:\n        feature_idx:    Index of the feature in question (not used within this class's methods, but used elsewhere).\n        cfg:            Contains layout parameters which are important in the `get_html` function.\n        \n        The other args are the 6 possible components we might have in the feature-centric vis, i.e. this is where we\n        store the actual data. Note that one of these arguments is `prompt_data` which is only applicable in the prompt-\n        centric view.\n\n    This is used in both the feature-centric and prompt-centric views. In the feature-centric view, a single one\n    of these objects creates the HTML for a single feature (i.e. a full screen). In the prompt-centric view, a single\n    one of these objects will create one column of the full screen vis.\n    ")
+         675          12 LOAD_CONST               1 ("\n    This contains all the data necessary to make the feature-centric visualization, for a single feature. See\n    diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Args:\n        feature_idx:    Index of the feature in question (not used within this class's methods, but used elsewhere).\n        cfg:            Contains layout parameters which are important in the `get_html` function.\n        \n        The other args are the 6 possible components we might have in the feature-centric vis, i.e. this is where we\n        store the actual data. Note that one of these arguments is `prompt_data` which is only applicable in the prompt-\n        centric view.\n\n    This is used in both the feature-centric and prompt-centric views. In the feature-centric view, a single one\n    of these objects creates the HTML for a single feature (i.e. a full screen). In the prompt-centric view, a single\n    one of these objects will create one column of the full screen vis.\n    ")
                       14 STORE_NAME               3 (__doc__)
          
-         690          16 PUSH_NULL
+         693          16 PUSH_NULL
                       18 LOAD_NAME                4 (field)
-                      20 LOAD_CONST               2 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 690>)
+                      20 LOAD_CONST               2 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 693>)
                       22 MAKE_FUNCTION            0
                       24 KW_NAMES                 3
                       26 PRECALL                  1
                       30 CALL                     1
                       40 STORE_NAME               5 (feature_tables_data)
                       42 LOAD_NAME                6 (FeatureTablesData)
                       44 LOAD_NAME                7 (__annotations__)
                       46 LOAD_CONST               4 ('feature_tables_data')
                       48 STORE_SUBSCR
          
-         691          52 PUSH_NULL
+         694          52 PUSH_NULL
                       54 LOAD_NAME                4 (field)
-                      56 LOAD_CONST               5 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 691>)
+                      56 LOAD_CONST               5 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 694>)
                       58 MAKE_FUNCTION            0
                       60 KW_NAMES                 3
                       62 PRECALL                  1
                       66 CALL                     1
                       76 STORE_NAME               8 (acts_histogram_data)
                       78 LOAD_NAME                9 (ActsHistogramData)
                       80 LOAD_NAME                7 (__annotations__)
                       82 LOAD_CONST               6 ('acts_histogram_data')
                       84 STORE_SUBSCR
          
-         692          88 PUSH_NULL
+         695          88 PUSH_NULL
                       90 LOAD_NAME                4 (field)
-                      92 LOAD_CONST               7 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 692>)
+                      92 LOAD_CONST               7 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 695>)
                       94 MAKE_FUNCTION            0
                       96 KW_NAMES                 3
                       98 PRECALL                  1
                      102 CALL                     1
                      112 STORE_NAME              10 (logits_table_data)
                      114 LOAD_NAME               11 (LogitsTableData)
                      116 LOAD_NAME                7 (__annotations__)
                      118 LOAD_CONST               8 ('logits_table_data')
                      120 STORE_SUBSCR
          
-         693         124 PUSH_NULL
+         696         124 PUSH_NULL
                      126 LOAD_NAME                4 (field)
-                     128 LOAD_CONST               9 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 693>)
+                     128 LOAD_CONST               9 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 696>)
                      130 MAKE_FUNCTION            0
                      132 KW_NAMES                 3
                      134 PRECALL                  1
                      138 CALL                     1
                      148 STORE_NAME              12 (logits_histogram_data)
                      150 LOAD_NAME               13 (LogitsHistogramData)
                      152 LOAD_NAME                7 (__annotations__)
                      154 LOAD_CONST              10 ('logits_histogram_data')
                      156 STORE_SUBSCR
          
-         694         160 PUSH_NULL
+         697         160 PUSH_NULL
                      162 LOAD_NAME                4 (field)
-                     164 LOAD_CONST              11 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 694>)
+                     164 LOAD_CONST              11 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 697>)
                      166 MAKE_FUNCTION            0
                      168 KW_NAMES                 3
                      170 PRECALL                  1
                      174 CALL                     1
                      184 STORE_NAME              14 (sequence_data)
                      186 LOAD_NAME               15 (SequenceMultiGroupData)
                      188 LOAD_NAME                7 (__annotations__)
                      190 LOAD_CONST              12 ('sequence_data')
                      192 STORE_SUBSCR
          
-         695         196 PUSH_NULL
+         698         196 PUSH_NULL
                      198 LOAD_NAME                4 (field)
-                     200 LOAD_CONST              13 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 695>)
+                     200 LOAD_CONST              13 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 698>)
                      202 MAKE_FUNCTION            0
                      204 KW_NAMES                 3
                      206 PRECALL                  1
                      210 CALL                     1
                      220 STORE_NAME              16 (prompt_data)
                      222 LOAD_NAME               17 (SequenceData)
                      224 LOAD_NAME                7 (__annotations__)
                      226 LOAD_CONST              14 ('prompt_data')
                      228 STORE_SUBSCR
          
-         697         232 LOAD_CONST              15 ('config')
+         700         232 LOAD_CONST              15 ('config')
                      234 LOAD_NAME               18 (GenericComponentConfig)
                      236 LOAD_CONST              16 ('return')
                      238 LOAD_NAME               19 (GenericData)
                      240 BUILD_TUPLE              4
-                     242 LOAD_CONST              17 (<code object get_component_from_config, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 697>)
+                     242 LOAD_CONST              17 (<code object get_component_from_config, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 700>)
                      244 MAKE_FUNCTION            4 (annotations)
                      246 STORE_NAME              20 (get_component_from_config)
          
-         714         248 LOAD_CONST              18 ('layout_cfg')
+         717         248 LOAD_CONST              18 ('layout_cfg')
          
-         716         250 LOAD_NAME               21 (SaeVisLayoutConfig)
+         719         250 LOAD_NAME               21 (SaeVisLayoutConfig)
          
-         714         252 LOAD_CONST              19 ('decode_fn')
+         717         252 LOAD_CONST              19 ('decode_fn')
          
-         717         254 LOAD_NAME               22 (Callable)
+         720         254 LOAD_NAME               22 (Callable)
          
-         714         256 LOAD_CONST              16 ('return')
+         717         256 LOAD_CONST              16 ('return')
          
-         718         258 LOAD_NAME               23 (HTML)
+         721         258 LOAD_NAME               23 (HTML)
          
-         714         260 BUILD_TUPLE              6
-                     262 LOAD_CONST              20 (<code object _get_html_data_feature_centric, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 714>)
+         717         260 BUILD_TUPLE              6
+                     262 LOAD_CONST              20 (<code object _get_html_data_feature_centric, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 717>)
                      264 MAKE_FUNCTION            4 (annotations)
                      266 STORE_NAME              24 (_get_html_data_feature_centric)
          
-         753         268 LOAD_CONST              18 ('layout_cfg')
+         756         268 LOAD_CONST              18 ('layout_cfg')
          
-         755         270 LOAD_NAME               21 (SaeVisLayoutConfig)
+         758         270 LOAD_NAME               21 (SaeVisLayoutConfig)
          
-         753         272 LOAD_CONST              19 ('decode_fn')
+         756         272 LOAD_CONST              19 ('decode_fn')
          
-         756         274 LOAD_NAME               22 (Callable)
+         759         274 LOAD_NAME               22 (Callable)
          
-         753         276 LOAD_CONST              21 ('column_idx')
+         756         276 LOAD_CONST              21 ('column_idx')
          
-         757         278 LOAD_NAME               25 (int)
+         760         278 LOAD_NAME               25 (int)
          
-         753         280 LOAD_CONST              22 ('bold_idx')
+         756         280 LOAD_CONST              22 ('bold_idx')
          
-         758         282 LOAD_NAME               25 (int)
+         761         282 LOAD_NAME               25 (int)
          
-         753         284 LOAD_CONST              23 ('title')
+         756         284 LOAD_CONST              23 ('title')
          
-         759         286 LOAD_NAME               26 (str)
+         762         286 LOAD_NAME               26 (str)
          
-         753         288 LOAD_CONST              16 ('return')
+         756         288 LOAD_CONST              16 ('return')
          
-         760         290 LOAD_NAME               23 (HTML)
+         763         290 LOAD_NAME               23 (HTML)
          
-         753         292 BUILD_TUPLE             12
-                     294 LOAD_CONST              24 (<code object _get_html_data_prompt_centric, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 753>)
+         756         292 BUILD_TUPLE             12
+                     294 LOAD_CONST              24 (<code object _get_html_data_prompt_centric, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 756>)
                      296 MAKE_FUNCTION            4 (annotations)
                      298 STORE_NAME              27 (_get_html_data_prompt_centric)
                      300 LOAD_CONST              25 (None)
                      302 RETURN_VALUE
          consts
             'FeatureData'
             "\n    This contains all the data necessary to make the feature-centric visualization, for a single feature. See\n    diagram in readme: \n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Args:\n        feature_idx:    Index of the feature in question (not used within this class's methods, but used elsewhere).\n        cfg:            Contains layout parameters which are important in the `get_html` function.\n        \n        The other args are the 6 possible components we might have in the feature-centric vis, i.e. this is where we\n        store the actual data. Note that one of these arguments is `prompt_data` which is only applicable in the prompt-\n        centric view.\n\n    This is used in both the feature-centric and prompt-centric views. In the feature-centric view, a single one\n    of these objects creates the HTML for a single feature (i.e. a full screen). In the prompt-centric view, a single\n    one of these objects will create one column of the full screen vis.\n    "
@@ -5032,149 +5036,149 @@
                argcount  : 0
                nlocals   : 0
                stacksize : 2
                flags     : 3
                code
                   0x9700740100000000000000000000a6000000ab00000000000000000053
                   00
-               690           0 RESUME                   0
+               693           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + FeatureTablesData)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 RETURN_VALUE
                consts
                   None
                names      ('FeatureTablesData',)
                varnames   ()
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '<lambda>'
-               firstlineno 690
+               firstlineno 693
                lnotab 0x
             ('default_factory',)
             'feature_tables_data'
             code
                argcount  : 0
                nlocals   : 0
                stacksize : 2
                flags     : 3
                code
                   0x9700740100000000000000000000a6000000ab00000000000000000053
                   00
-               691           0 RESUME                   0
+               694           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + ActsHistogramData)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 RETURN_VALUE
                consts
                   None
                names      ('ActsHistogramData',)
                varnames   ()
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '<lambda>'
-               firstlineno 691
+               firstlineno 694
                lnotab 0x
             'acts_histogram_data'
             code
                argcount  : 0
                nlocals   : 0
                stacksize : 2
                flags     : 3
                code
                   0x9700740100000000000000000000a6000000ab00000000000000000053
                   00
-               692           0 RESUME                   0
+               695           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + LogitsTableData)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 RETURN_VALUE
                consts
                   None
                names      ('LogitsTableData',)
                varnames   ()
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '<lambda>'
-               firstlineno 692
+               firstlineno 695
                lnotab 0x
             'logits_table_data'
             code
                argcount  : 0
                nlocals   : 0
                stacksize : 2
                flags     : 3
                code
                   0x9700740100000000000000000000a6000000ab00000000000000000053
                   00
-               693           0 RESUME                   0
+               696           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + LogitsHistogramData)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 RETURN_VALUE
                consts
                   None
                names      ('LogitsHistogramData',)
                varnames   ()
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '<lambda>'
-               firstlineno 693
+               firstlineno 696
                lnotab 0x
             'logits_histogram_data'
             code
                argcount  : 0
                nlocals   : 0
                stacksize : 2
                flags     : 3
                code
                   0x9700740100000000000000000000a6000000ab00000000000000000053
                   00
-               694           0 RESUME                   0
+               697           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + SequenceMultiGroupData)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 RETURN_VALUE
                consts
                   None
                names      ('SequenceMultiGroupData',)
                varnames   ()
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '<lambda>'
-               firstlineno 694
+               firstlineno 697
                lnotab 0x
             'sequence_data'
             code
                argcount  : 0
                nlocals   : 0
                stacksize : 2
                flags     : 3
                code
                   0x9700740100000000000000000000a6000000ab00000000000000000053
                   00
-               695           0 RESUME                   0
+               698           0 RESUME                   0
                              2 LOAD_GLOBAL              1 (NULL + SequenceData)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 RETURN_VALUE
                consts
                   None
                names      ('SequenceData',)
                varnames   ()
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '<lambda>'
-               firstlineno 695
+               firstlineno 698
                lnotab 0x
             'prompt_data'
             'config'
             'return'
             code
                argcount  : 2
                nlocals   : 4
@@ -5187,81 +5191,81 @@
                   0000007c006a060000000000000000740e000000000000000000006a0100
                   000000000000007c006a0800000000000000007412000000000000000000
                   006a0100000000000000007c006a0a000000000000000074160000000000
                   00000000006a0100000000000000007c006a0c000000000000000069067d
                   027c016a0d00000000000000006a0100000000000000007d037c037c0276
                   00730d4a0064017c039b009d02a6000000ab00000000000000000082017c
                   027c03190000000000000000005300
-               697           0 RESUME                   0
+               700           0 RESUME                   0
                
-               703           2 LOAD_GLOBAL              0 (FeatureTablesConfig)
+               706           2 LOAD_GLOBAL              0 (FeatureTablesConfig)
                             14 LOAD_ATTR                1 (__name__)
                             24 LOAD_FAST                0 (self)
                             26 LOAD_ATTR                2 (feature_tables_data)
                
-               704          36 LOAD_GLOBAL              6 (ActsHistogramConfig)
+               707          36 LOAD_GLOBAL              6 (ActsHistogramConfig)
                             48 LOAD_ATTR                1 (__name__)
                             58 LOAD_FAST                0 (self)
                             60 LOAD_ATTR                4 (acts_histogram_data)
                
-               705          70 LOAD_GLOBAL             10 (LogitsTableConfig)
+               708          70 LOAD_GLOBAL             10 (LogitsTableConfig)
                             82 LOAD_ATTR                1 (__name__)
                             92 LOAD_FAST                0 (self)
                             94 LOAD_ATTR                6 (logits_table_data)
                
-               706         104 LOAD_GLOBAL             14 (LogitsHistogramConfig)
+               709         104 LOAD_GLOBAL             14 (LogitsHistogramConfig)
                            116 LOAD_ATTR                1 (__name__)
                            126 LOAD_FAST                0 (self)
                            128 LOAD_ATTR                8 (logits_histogram_data)
                
-               707         138 LOAD_GLOBAL             18 (SequencesConfig)
+               710         138 LOAD_GLOBAL             18 (SequencesConfig)
                            150 LOAD_ATTR                1 (__name__)
                            160 LOAD_FAST                0 (self)
                            162 LOAD_ATTR               10 (sequence_data)
                
-               708         172 LOAD_GLOBAL             22 (PromptConfig)
+               711         172 LOAD_GLOBAL             22 (PromptConfig)
                            184 LOAD_ATTR                1 (__name__)
                            194 LOAD_FAST                0 (self)
                            196 LOAD_ATTR               12 (prompt_data)
                
-               702         206 BUILD_MAP                6
+               705         206 BUILD_MAP                6
                            208 STORE_FAST               2 (CONFIG_CLASS_MAP)
                
-               710         210 LOAD_FAST                1 (config)
+               713         210 LOAD_FAST                1 (config)
                            212 LOAD_ATTR               13 (__class__)
                            222 LOAD_ATTR                1 (__name__)
                            232 STORE_FAST               3 (config_class_name)
                
-               711         234 LOAD_FAST                3 (config_class_name)
+               714         234 LOAD_FAST                3 (config_class_name)
                            236 LOAD_FAST                2 (CONFIG_CLASS_MAP)
                            238 CONTAINS_OP              0
                            240 POP_JUMP_FORWARD_IF_TRUE    13 (to 268)
                            242 LOAD_ASSERTION_ERROR
                            244 LOAD_CONST               1 ('Invalid component config: ')
                            246 LOAD_FAST                3 (config_class_name)
                            248 FORMAT_VALUE             0
                            250 BUILD_STRING             2
                            252 PRECALL                  0
                            256 CALL                     0
                            266 RAISE_VARARGS            1
                
-               712     >>  268 LOAD_FAST                2 (CONFIG_CLASS_MAP)
+               715     >>  268 LOAD_FAST                2 (CONFIG_CLASS_MAP)
                            270 LOAD_FAST                3 (config_class_name)
                            272 BINARY_SUBSCR
                            282 RETURN_VALUE
                consts
                   '\n        Given a config object, returns the corresponding data object stored by this instance. For instance, if the input\n        is an `FeatureTablesConfig` instance, then this function returns `self.feature_tables_data`.\n        '
                   'Invalid component config: '
                names      ('FeatureTablesConfig', '__name__', 'feature_tables_data', 'ActsHistogramConfig', 'acts_histogram_data', 'LogitsTableConfig', 'logits_table_data', 'LogitsHistogramConfig', 'logits_histogram_data', 'SequencesConfig', 'sequence_data', 'PromptConfig', 'prompt_data', '__class__')
                varnames   ('self', 'config', 'CONFIG_CLASS_MAP', 'config_class_name')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'get_component_from_config'
-               firstlineno 697
+               firstlineno 700
                lnotab 0x02062201220122012201220122fa040818012201
             'layout_cfg'
             'decode_fn'
             code
                argcount  : 3
                nlocals   : 8
                stacksize : 9
@@ -5270,78 +5274,78 @@
                   0x9700740100000000000000000000a6000000ab0000000000000000007d
                   037c016a010000000000000000a002000000000000000000000000000000
                   0000000000a6000000ab00000000000000000044005d3b5c0200007d047d
                   057c0544005d337d067c00a0030000000000000000000000000000000000
                   0000007c06a6010000ab0100000000000000007d077c037c07a004000000
                   00000000000000000000000000000000007c067c027c046401ac02a60400
                   00ab0400000000000000007a0d00007d038c348c3c7c035300
-               714           0 RESUME                   0
+               717           0 RESUME                   0
                
-               735           2 LOAD_GLOBAL              1 (NULL + HTML)
+               738           2 LOAD_GLOBAL              1 (NULL + HTML)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 STORE_FAST               3 (html_obj)
                
-               738          30 LOAD_FAST                1 (layout_cfg)
+               741          30 LOAD_FAST                1 (layout_cfg)
                             32 LOAD_ATTR                1 (columns)
                             42 LOAD_METHOD              2 (items)
                             64 PRECALL                  0
                             68 CALL                     0
                             78 GET_ITER
                        >>   80 FOR_ITER                59 (to 200)
                             82 UNPACK_SEQUENCE          2
                             86 STORE_FAST               4 (column_idx)
                             88 STORE_FAST               5 (column_components)
                
-               740          90 LOAD_FAST                5 (column_components)
+               743          90 LOAD_FAST                5 (column_components)
                             92 GET_ITER
                        >>   94 FOR_ITER                51 (to 198)
                             96 STORE_FAST               6 (component_config)
                
-               742          98 LOAD_FAST                0 (self)
+               745          98 LOAD_FAST                0 (self)
                            100 LOAD_METHOD              3 (get_component_from_config)
                            122 LOAD_FAST                6 (component_config)
                            124 PRECALL                  1
                            128 CALL                     1
                            138 STORE_FAST               7 (component)
                
-               744         140 LOAD_FAST                3 (html_obj)
+               747         140 LOAD_FAST                3 (html_obj)
                            142 LOAD_FAST                7 (component)
                            144 LOAD_METHOD              4 (_get_html_data)
                
-               745         166 LOAD_FAST                6 (component_config)
+               748         166 LOAD_FAST                6 (component_config)
                
-               746         168 LOAD_FAST                2 (decode_fn)
+               749         168 LOAD_FAST                2 (decode_fn)
                
-               747         170 LOAD_FAST                4 (column_idx)
+               750         170 LOAD_FAST                4 (column_idx)
                
-               748         172 LOAD_CONST               1 ('0')
+               751         172 LOAD_CONST               1 ('0')
                
-               744         174 KW_NAMES                 2
+               747         174 KW_NAMES                 2
                            176 PRECALL                  4
                            180 CALL                     4
                            190 BINARY_OP               13 (+=)
                            194 STORE_FAST               3 (html_obj)
                            196 JUMP_BACKWARD           52 (to 94)
                
-               740     >>  198 JUMP_BACKWARD           60 (to 80)
+               743     >>  198 JUMP_BACKWARD           60 (to 80)
                
-               751     >>  200 LOAD_FAST                3 (html_obj)
+               754     >>  200 LOAD_FAST                3 (html_obj)
                            202 RETURN_VALUE
                consts
                   "\n        Returns the HTML object for a single feature-centric view. These are assembled together into the full feature-\n        centric view.\n\n        Args:\n            decode_fn:  We use this function to decode the token IDs into string tokens. \n\n        Returns:\n            html_obj.html_data:\n                Contains a dictionary with keys equal to columns, and values equal to the HTML strings. These will be\n                turned into grid-column elements, and concatenated.\n            html_obj.js_data:\n                Contains a dictionary with keys = component names, and values = JavaScript data that will be used by the\n                scripts we'll eventually dump in.\n        "
                   '0'
                   ('cfg', 'decode_fn', 'column', 'id_suffix')
                names      ('HTML', 'columns', 'items', 'get_component_from_config', '_get_html_data')
                varnames   ('self', 'layout_cfg', 'decode_fn', 'html_obj', 'column_idx', 'column_components', 'component_config', 'component')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data_feature_centric'
-               firstlineno 714
+               firstlineno 717
                lnotab 0x02151c033c0208022a021a0102010201020102fc18fc020b
             'column_idx'
             'bold_idx'
             'title'
             code
                argcount  : 6
                nlocals   : 9
@@ -5364,156 +5368,156 @@
                   0000007c077c027c037413000000000000000000007c03a6010000ab0100
                   000000000000007415000000000000000000007c0464076407ac08a60300
                   00ab030000000000000000ac09a6050000ab0500000000000000007a0d00
                   007d068c52640a7c039b00640b7c066a0b00000000000000007c03190000
                   000000000000009b009d047c066a0b00000000000000007c033c00000074
                   13000000000000000000007c03a6010000ab0100000000000000007c0569
                   017c066a0c0000000000000000640c3c0000007c065300
-               753           0 RESUME                   0
+               756           0 RESUME                   0
                
-               780           2 LOAD_GLOBAL              1 (NULL + HTML)
+               783           2 LOAD_GLOBAL              1 (NULL + HTML)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 STORE_FAST               6 (html_obj)
                
-               783          30 LOAD_FAST                1 (layout_cfg)
+               786          30 LOAD_FAST                1 (layout_cfg)
                             32 LOAD_ATTR                1 (columns)
                             42 LOAD_METHOD              2 (keys)
                             64 PRECALL                  0
                             68 CALL                     0
                             78 LOAD_CONST               1 (0)
                             80 BUILD_SET                1
                             82 COMPARE_OP               2 (==)
                             88 POP_JUMP_FORWARD_IF_TRUE    36 (to 162)
                             90 LOAD_ASSERTION_ERROR
                
-               784          92 LOAD_CONST               2 ('prompt_centric_layout should only have 1 column, instead found cols ')
+               787          92 LOAD_CONST               2 ('prompt_centric_layout should only have 1 column, instead found cols ')
                             94 LOAD_FAST                1 (layout_cfg)
                             96 LOAD_ATTR                1 (columns)
                            106 LOAD_METHOD              2 (keys)
                            128 PRECALL                  0
                            132 CALL                     0
                            142 FORMAT_VALUE             0
                            144 BUILD_STRING             2
                
-               783         146 PRECALL                  0
+               786         146 PRECALL                  0
                            150 CALL                     0
                            160 RAISE_VARARGS            1
                
-               785     >>  162 LOAD_FAST                1 (layout_cfg)
+               788     >>  162 LOAD_FAST                1 (layout_cfg)
                            164 LOAD_ATTR                3 (prompt_cfg)
                            174 POP_JUMP_FORWARD_IF_NOT_NONE    10 (to 196)
                            176 LOAD_ASSERTION_ERROR
                
-               786         178 LOAD_CONST               4 ('prompt_centric_cfg should include a PromptConfig, but found None')
+               789         178 LOAD_CONST               4 ('prompt_centric_cfg should include a PromptConfig, but found None')
                
-               785         180 PRECALL                  0
+               788         180 PRECALL                  0
                            184 CALL                     0
                            194 RAISE_VARARGS            1
                
-               787     >>  196 LOAD_FAST                1 (layout_cfg)
+               790     >>  196 LOAD_FAST                1 (layout_cfg)
                            198 LOAD_ATTR                4 (seq_cfg)
                            208 POP_JUMP_FORWARD_IF_NONE    42 (to 294)
                
-               788         210 LOAD_FAST                1 (layout_cfg)
+               791         210 LOAD_FAST                1 (layout_cfg)
                            212 LOAD_ATTR                4 (seq_cfg)
                            222 LOAD_ATTR                5 (n_quantiles)
                            232 LOAD_CONST               1 (0)
                            234 COMPARE_OP               2 (==)
                            240 POP_JUMP_FORWARD_IF_TRUE    26 (to 294)
                            242 LOAD_FAST                1 (layout_cfg)
                            244 LOAD_ATTR                4 (seq_cfg)
                            254 LOAD_ATTR                6 (stack_mode)
                            264 LOAD_CONST               5 ('stack-all')
                            266 COMPARE_OP               2 (==)
                            272 POP_JUMP_FORWARD_IF_TRUE    10 (to 294)
                            274 LOAD_ASSERTION_ERROR
                
-               789         276 LOAD_CONST               6 ("prompt_centric_layout should have stack_mode='stack-all' if n_quantiles > 0, so that it fits in 1 col")
+               792         276 LOAD_CONST               6 ("prompt_centric_layout should have stack_mode='stack-all' if n_quantiles > 0, so that it fits in 1 col")
                
-               788         278 PRECALL                  0
+               791         278 PRECALL                  0
                            282 CALL                     0
                            292 RAISE_VARARGS            1
                
-               792     >>  294 LOAD_FAST                1 (layout_cfg)
+               795     >>  294 LOAD_FAST                1 (layout_cfg)
                            296 LOAD_ATTR                1 (columns)
                            306 LOAD_CONST               1 (0)
                            308 BINARY_SUBSCR
                            318 GET_ITER
                        >>  320 FOR_ITER                81 (to 484)
                            322 STORE_FAST               7 (component_config)
                
-               794         324 LOAD_FAST                0 (self)
+               797         324 LOAD_FAST                0 (self)
                            326 LOAD_METHOD              7 (get_component_from_config)
                            348 LOAD_FAST                7 (component_config)
                            350 PRECALL                  1
                            354 CALL                     1
                            364 STORE_FAST               8 (component)
                
-               796         366 LOAD_FAST                6 (html_obj)
+               799         366 LOAD_FAST                6 (html_obj)
                            368 LOAD_FAST                8 (component)
                            370 LOAD_METHOD              8 (_get_html_data)
                
-               797         392 LOAD_FAST                7 (component_config)
+               800         392 LOAD_FAST                7 (component_config)
                
-               798         394 LOAD_FAST                2 (decode_fn)
+               801         394 LOAD_FAST                2 (decode_fn)
                
-               799         396 LOAD_FAST                3 (column_idx)
+               802         396 LOAD_FAST                3 (column_idx)
                
-               800         398 LOAD_GLOBAL             19 (NULL + str)
+               803         398 LOAD_GLOBAL             19 (NULL + str)
                            410 LOAD_FAST                3 (column_idx)
                            412 PRECALL                  1
                            416 CALL                     1
                
-               801         426 LOAD_GLOBAL             21 (NULL + dict)
+               804         426 LOAD_GLOBAL             21 (NULL + dict)
                
-               802         438 LOAD_FAST                4 (bold_idx)
+               805         438 LOAD_FAST                4 (bold_idx)
                
-               803         440 LOAD_CONST               7 (True)
+               806         440 LOAD_CONST               7 (True)
                
-               804         442 LOAD_CONST               7 (True)
+               807         442 LOAD_CONST               7 (True)
                
-               801         444 KW_NAMES                 8
+               804         444 KW_NAMES                 8
                            446 PRECALL                  3
                            450 CALL                     3
                
-               796         460 KW_NAMES                 9
+               799         460 KW_NAMES                 9
                            462 PRECALL                  5
                            466 CALL                     5
                            476 BINARY_OP               13 (+=)
                            480 STORE_FAST               6 (html_obj)
                            482 JUMP_BACKWARD           82 (to 320)
                
-               809     >>  484 LOAD_CONST              10 ("<div id='column-")
+               812     >>  484 LOAD_CONST              10 ("<div id='column-")
                            486 LOAD_FAST                3 (column_idx)
                            488 FORMAT_VALUE             0
                            490 LOAD_CONST              11 ("-title'></div>\n")
                            492 LOAD_FAST                6 (html_obj)
                            494 LOAD_ATTR               11 (html_data)
                            504 LOAD_FAST                3 (column_idx)
                            506 BINARY_SUBSCR
                            516 FORMAT_VALUE             0
                            518 BUILD_STRING             4
                            520 LOAD_FAST                6 (html_obj)
                            522 LOAD_ATTR               11 (html_data)
                            532 LOAD_FAST                3 (column_idx)
                            534 STORE_SUBSCR
                
-               810         538 LOAD_GLOBAL             19 (NULL + str)
+               813         538 LOAD_GLOBAL             19 (NULL + str)
                            550 LOAD_FAST                3 (column_idx)
                            552 PRECALL                  1
                            556 CALL                     1
                            566 LOAD_FAST                5 (title)
                            568 BUILD_MAP                1
                            570 LOAD_FAST                6 (html_obj)
                            572 LOAD_ATTR               12 (js_data)
                            582 LOAD_CONST              12 ('gridColumnTitlesData')
                            584 STORE_SUBSCR
                
-               812         588 LOAD_FAST                6 (html_obj)
+               815         588 LOAD_FAST                6 (html_obj)
                            590 RETURN_VALUE
                consts
                   "\n        Returns the HTML object for a single column of the prompt-centric view. These are assembled together into a full\n        screen of a prompt-centric view, and then they're further assembled together into the full prompt-centric view.\n\n        Args:\n            decode_fn:  We use this function to decode the token IDs into string tokens. \n            column_idx: This method only gives us a single column (of the prompt-centric vis), so we need to know which\n                        column this is (for the JavaScript data).\n            title:      The title for this column, which will be used in the JavaScript data.\n\n        Returns:\n            html_obj.html_data:\n                Contains a dictionary with the single key `str(column_idx)`, representing the single column. This will\n                become a single grid-column element, and will get concatenated with others of these.\n            html_obj.js_data:\n                Contains a dictionary with keys = component names, and values = JavaScript data that will be used by the\n                scripts we'll eventually dump in.\n        "
                   0
                   'prompt_centric_layout should only have 1 column, instead found cols '
                   None
                   'prompt_centric_cfg should include a PromptConfig, but found None'
@@ -5527,26 +5531,26 @@
                   'gridColumnTitlesData'
                names      ('HTML', 'columns', 'keys', 'prompt_cfg', 'seq_cfg', 'n_quantiles', 'stack_mode', 'get_component_from_config', '_get_html_data', 'str', 'dict', 'html_data', 'js_data')
                varnames   ('self', 'layout_cfg', 'decode_fn', 'column_idx', 'bold_idx', 'title', 'html_obj', 'component_config', 'component')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       '_get_html_data_prompt_centric'
-               firstlineno 753
+               firstlineno 756
                lnotab
                   0x021b1c033e0136ff1002100102ff10020e01420102ff10041e022a021a
                   010201020102011c010c010201020102fd10fb180d36013202
             None
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'feature_tables_data', 'FeatureTablesData', '__annotations__', 'acts_histogram_data', 'ActsHistogramData', 'logits_table_data', 'LogitsTableData', 'logits_histogram_data', 'LogitsHistogramData', 'sequence_data', 'SequenceMultiGroupData', 'prompt_data', 'SequenceData', 'GenericComponentConfig', 'GenericData', 'get_component_from_config', 'SaeVisLayoutConfig', 'Callable', 'HTML', '_get_html_data_feature_centric', 'int', 'str', '_get_html_data_prompt_centric')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'FeatureData'
-         firstlineno 670
+         firstlineno 673
          lnotab
             0x0c0204122401240124012401240124021011020202fe020302fd020402
             fc0827020202fe020302fd020402fc020502fb020602fa020702f9
       'FeatureData'
       code
          argcount  : 0
          nlocals   : 0
@@ -5554,25 +5558,25 @@
          flags     : 0
          code
             0x970065005a0164005a02550064015a03020065046505ac02a6010000ab
             0100000000000000005a0665056507650866021900000000000000000065
             0964033c00000002006504650aac02a6010000ab0100000000000000005a
             0b650a650964043c000000650c6405650564066400660464078404a60000
             00ab0000000000000000005a0d640665056602640884045a0e64095300
-         815           0 RESUME                   0
+         818           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('_SaeVisData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         818          12 LOAD_CONST               1 ("\n    Dataclass which is used to store the data for the SaeVisData class. It excludes everything which isn't easily\n    serializable, only saving the raw data.\n    ")
+         821          12 LOAD_CONST               1 ("\n    Dataclass which is used to store the data for the SaeVisData class. It excludes everything which isn't easily\n    serializable, only saving the raw data.\n    ")
                       14 STORE_NAME               3 (__doc__)
          
-         822          16 PUSH_NULL
+         825          16 PUSH_NULL
                       18 LOAD_NAME                4 (field)
                       20 LOAD_NAME                5 (dict)
                       22 KW_NAMES                 2
                       24 PRECALL                  1
                       28 CALL                     1
                       38 STORE_NAME               6 (feature_data_dict)
                       40 LOAD_NAME                5 (dict)
@@ -5580,45 +5584,45 @@
                       44 LOAD_NAME                8 (FeatureData)
                       46 BUILD_TUPLE              2
                       48 BINARY_SUBSCR
                       58 LOAD_NAME                9 (__annotations__)
                       60 LOAD_CONST               3 ('feature_data_dict')
                       62 STORE_SUBSCR
          
-         823          66 PUSH_NULL
+         826          66 PUSH_NULL
                       68 LOAD_NAME                4 (field)
                       70 LOAD_NAME               10 (QuantileCalculator)
                       72 KW_NAMES                 2
                       74 PRECALL                  1
                       78 CALL                     1
                       88 STORE_NAME              11 (feature_act_quantiles)
                       90 LOAD_NAME               10 (QuantileCalculator)
                       92 LOAD_NAME                9 (__annotations__)
                       94 LOAD_CONST               4 ('feature_act_quantiles')
                       96 STORE_SUBSCR
          
-         825         100 LOAD_NAME               12 (classmethod)
+         828         100 LOAD_NAME               12 (classmethod)
          
-         826         102 LOAD_CONST               5 ('data')
+         829         102 LOAD_CONST               5 ('data')
                      104 LOAD_NAME                5 (dict)
                      106 LOAD_CONST               6 ('return')
                      108 LOAD_CONST               0 ('_SaeVisData')
                      110 BUILD_TUPLE              4
-                     112 LOAD_CONST               7 (<code object from_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 825>)
+                     112 LOAD_CONST               7 (<code object from_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 828>)
                      114 MAKE_FUNCTION            4 (annotations)
          
-         825         116 PRECALL                  0
+         828         116 PRECALL                  0
                      120 CALL                     0
          
-         826         130 STORE_NAME              13 (from_dict)
+         829         130 STORE_NAME              13 (from_dict)
          
-         829         132 LOAD_CONST               6 ('return')
+         832         132 LOAD_CONST               6 ('return')
                      134 LOAD_NAME                5 (dict)
                      136 BUILD_TUPLE              2
-                     138 LOAD_CONST               8 (<code object to_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 829>)
+                     138 LOAD_CONST               8 (<code object to_dict, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 832>)
                      140 MAKE_FUNCTION            4 (annotations)
                      142 STORE_NAME              14 (to_dict)
                      144 LOAD_CONST               9 (None)
                      146 RETURN_VALUE
          consts
             '_SaeVisData'
             "\n    Dataclass which is used to store the data for the SaeVisData class. It excludes everything which isn't easily\n    serializable, only saving the raw data.\n    "
@@ -5629,56 +5633,56 @@
             'return'
             code
                argcount  : 2
                nlocals   : 2
                stacksize : 1
                flags     : 3
                code 0x970064005300
-               825           0 RESUME                   0
+               828           0 RESUME                   0
                
-               827           2 LOAD_CONST               0 (None)
+               830           2 LOAD_CONST               0 (None)
                              4 RETURN_VALUE
                consts
                   None
                names      ()
                varnames   ('cls', 'data')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'from_dict'
-               firstlineno 825
+               firstlineno 828
                lnotab 0x0202
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x970064005300
-               829           0 RESUME                   0
+               832           0 RESUME                   0
                
-               830           2 LOAD_CONST               0 (None)
+               833           2 LOAD_CONST               0 (None)
                              4 RETURN_VALUE
                consts
                   None
                names      ()
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'to_dict'
-               firstlineno 829
+               firstlineno 832
                lnotab 0x0201
             None
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'dict', 'feature_data_dict', 'int', 'FeatureData', '__annotations__', 'QuantileCalculator', 'feature_act_quantiles', 'classmethod', 'from_dict', 'to_dict')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       '_SaeVisData'
-         firstlineno 815
+         firstlineno 818
          lnotab 0x0c0304043201220202010eff0e010203
       '_SaeVisData'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 14
          flags     : 0
@@ -5696,25 +5700,25 @@
             180900641d64106519651a7a0700006411650f6507190000000000000000
             00640b64066606641284055a1b090009000900641e641465196410651965
             1a7a0700006415650f6519190000000000000000006416650f6507190000
             0000000000000064176507660a641884055a1c6419640064106519651a7a
             070000640b64066606641a84045a1d651564106519651a7a070000640565
             0c640765106408651264096512640b6400660c641b8404a6000000ab0000
             000000000000005a1e64065300
-          835           0 RESUME                   0
+          838           0 RESUME                   0
                         2 LOAD_NAME                0 (__name__)
                         4 STORE_NAME               1 (__module__)
                         6 LOAD_CONST               0 ('SaeVisData')
                         8 STORE_NAME               2 (__qualname__)
                        10 SETUP_ANNOTATIONS
          
-          837          12 LOAD_CONST               1 ('\n    This contains all the data necessary for constructing the feature-centric visualization, over multiple \n    features (i.e. being able to navigate through them). See diagram in readme:\n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Args: \n        feature_data_dict:      Contains the data for each individual feature-centric vis.\n        feature_act_quantiles:  Contains the quantiles of activation values for each feature (used for rank-ordering\n                                features in the prompt-centric vis).\n        cfg:                    The vis config, used for the both the data gathering and the vis layout.\n        model:                  The model which our encoder was trained on.\n        encoder:                The encoder used to get the feature activations.\n        encoder_B:              The encoder used to get the feature activations for the second model (if applicable).\n    ')
+          840          12 LOAD_CONST               1 ('\n    This contains all the data necessary for constructing the feature-centric visualization, over multiple \n    features (i.e. being able to navigate through them). See diagram in readme:\n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Args: \n        feature_data_dict:      Contains the data for each individual feature-centric vis.\n        feature_act_quantiles:  Contains the quantiles of activation values for each feature (used for rank-ordering\n                                features in the prompt-centric vis).\n        cfg:                    The vis config, used for the both the data gathering and the vis layout.\n        model:                  The model which our encoder was trained on.\n        encoder:                The encoder used to get the feature activations.\n        encoder_B:              The encoder used to get the feature activations for the second model (if applicable).\n    ')
                        14 STORE_NAME               3 (__doc__)
          
-          852          16 PUSH_NULL
+          855          16 PUSH_NULL
                        18 LOAD_NAME                4 (field)
                        20 LOAD_NAME                5 (dict)
                        22 KW_NAMES                 2
                        24 PRECALL                  1
                        28 CALL                     1
                        38 STORE_NAME               6 (feature_data_dict)
                        40 LOAD_NAME                5 (dict)
@@ -5722,225 +5726,225 @@
                        44 LOAD_NAME                8 (FeatureData)
                        46 BUILD_TUPLE              2
                        48 BINARY_SUBSCR
                        58 LOAD_NAME                9 (__annotations__)
                        60 LOAD_CONST               3 ('feature_data_dict')
                        62 STORE_SUBSCR
          
-          853          66 PUSH_NULL
+          856          66 PUSH_NULL
                        68 LOAD_NAME                4 (field)
                        70 LOAD_NAME               10 (QuantileCalculator)
                        72 KW_NAMES                 2
                        74 PRECALL                  1
                        78 CALL                     1
                        88 STORE_NAME              11 (feature_act_quantiles)
                        90 LOAD_NAME               10 (QuantileCalculator)
                        92 LOAD_NAME                9 (__annotations__)
                        94 LOAD_CONST               4 ('feature_act_quantiles')
                        96 STORE_SUBSCR
          
-          854         100 PUSH_NULL
+          857         100 PUSH_NULL
                       102 LOAD_NAME                4 (field)
                       104 LOAD_NAME               12 (SaeVisConfig)
                       106 KW_NAMES                 2
                       108 PRECALL                  1
                       112 CALL                     1
                       122 STORE_NAME              13 (cfg)
                       124 LOAD_NAME               12 (SaeVisConfig)
                       126 LOAD_NAME                9 (__annotations__)
                       128 LOAD_CONST               5 ('cfg')
                       130 STORE_SUBSCR
          
-          856         134 LOAD_CONST               6 (None)
+          859         134 LOAD_CONST               6 (None)
                       136 STORE_NAME              14 (model)
                       138 LOAD_NAME               15 (Optional)
                       140 LOAD_NAME               16 (HookedTransformer)
                       142 BINARY_SUBSCR
                       152 LOAD_NAME                9 (__annotations__)
                       154 LOAD_CONST               7 ('model')
                       156 STORE_SUBSCR
          
-          857         160 LOAD_CONST               6 (None)
+          860         160 LOAD_CONST               6 (None)
                       162 STORE_NAME              17 (encoder)
                       164 LOAD_NAME               15 (Optional)
                       166 LOAD_NAME               18 (AutoEncoder)
                       168 BINARY_SUBSCR
                       178 LOAD_NAME                9 (__annotations__)
                       180 LOAD_CONST               8 ('encoder')
                       182 STORE_SUBSCR
          
-          858         186 LOAD_CONST               6 (None)
+          861         186 LOAD_CONST               6 (None)
                       188 STORE_NAME              19 (encoder_B)
                       190 LOAD_NAME               15 (Optional)
                       192 LOAD_NAME               18 (AutoEncoder)
                       194 BINARY_SUBSCR
                       204 LOAD_NAME                9 (__annotations__)
                       206 LOAD_CONST               9 ('encoder_B')
                       208 STORE_SUBSCR
          
-          860         212 LOAD_CONST              28 (('other', 'SaeVisData', 'return', None))
-                      214 LOAD_CONST              12 (<code object update, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 860>)
+          863         212 LOAD_CONST              28 (('other', 'SaeVisData', 'return', None))
+                      214 LOAD_CONST              12 (<code object update, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 863>)
                       216 MAKE_FUNCTION            4 (annotations)
                       218 STORE_NAME              20 (update)
          
-          871         220 LOAD_NAME               21 (classmethod)
+          874         220 LOAD_NAME               21 (classmethod)
          
-          878         222 NOP
+          881         222 NOP
          
-          872         224 LOAD_CONST              29 ((None,))
+          875         224 LOAD_CONST              29 ((None,))
                       226 LOAD_CONST               8 ('encoder')
          
-          874         228 LOAD_NAME               18 (AutoEncoder)
+          877         228 LOAD_NAME               18 (AutoEncoder)
          
-          872         230 LOAD_CONST               7 ('model')
+          875         230 LOAD_CONST               7 ('model')
          
-          875         232 LOAD_NAME               16 (HookedTransformer)
+          878         232 LOAD_NAME               16 (HookedTransformer)
          
-          872         234 LOAD_CONST              13 ('tokens')
+          875         234 LOAD_CONST              13 ('tokens')
          
-          876         236 LOAD_NAME               22 (Int)
+          879         236 LOAD_NAME               22 (Int)
                       238 LOAD_NAME               23 (Tensor)
                       240 LOAD_CONST              14 ('batch seq')
                       242 BUILD_TUPLE              2
                       244 BINARY_SUBSCR
          
-          872         254 LOAD_CONST               5 ('cfg')
+          875         254 LOAD_CONST               5 ('cfg')
          
-          877         256 LOAD_NAME               12 (SaeVisConfig)
+          880         256 LOAD_NAME               12 (SaeVisConfig)
          
-          872         258 LOAD_CONST               9 ('encoder_B')
+          875         258 LOAD_CONST               9 ('encoder_B')
          
-          878         260 LOAD_NAME               15 (Optional)
+          881         260 LOAD_NAME               15 (Optional)
                       262 LOAD_NAME               18 (AutoEncoder)
                       264 BINARY_SUBSCR
          
-          872         274 LOAD_CONST              11 ('return')
+          875         274 LOAD_CONST              11 ('return')
          
-          879         276 LOAD_CONST               0 ('SaeVisData')
+          882         276 LOAD_CONST               0 ('SaeVisData')
          
-          872         278 BUILD_TUPLE             12
-                      280 LOAD_CONST              15 (<code object create, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 871>)
+          875         278 BUILD_TUPLE             12
+                      280 LOAD_CONST              15 (<code object create, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 874>)
                       282 MAKE_FUNCTION            5 (defaults, annotations)
          
-          871         284 PRECALL                  0
+          874         284 PRECALL                  0
                       288 CALL                     0
          
-          872         298 STORE_NAME              24 (create)
+          875         298 STORE_NAME              24 (create)
          
-          901         300 NOP
+          904         300 NOP
          
-          898         302 LOAD_CONST              29 ((None,))
+          901         302 LOAD_CONST              29 ((None,))
                       304 LOAD_CONST              16 ('filename')
          
-          900         306 LOAD_NAME               25 (str)
+          903         306 LOAD_NAME               25 (str)
                       308 LOAD_NAME               26 (Path)
                       310 BINARY_OP                7 (|)
          
-          898         314 LOAD_CONST              17 ('feature_idx')
+          901         314 LOAD_CONST              17 ('feature_idx')
          
-          901         316 LOAD_NAME               15 (Optional)
+          904         316 LOAD_NAME               15 (Optional)
                       318 LOAD_NAME                7 (int)
                       320 BINARY_SUBSCR
          
-          898         330 LOAD_CONST              11 ('return')
+          901         330 LOAD_CONST              11 ('return')
          
-          902         332 LOAD_CONST               6 (None)
+          905         332 LOAD_CONST               6 (None)
          
-          898         334 BUILD_TUPLE              6
-                      336 LOAD_CONST              18 (<code object save_feature_centric_vis, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 898>)
+          901         334 BUILD_TUPLE              6
+                      336 LOAD_CONST              18 (<code object save_feature_centric_vis, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 901>)
                       338 MAKE_FUNCTION            5 (defaults, annotations)
                       340 STORE_NAME              27 (save_feature_centric_vis)
          
-          943         342 NOP
+          949         342 NOP
          
-          944         344 NOP
+          950         344 NOP
          
-          945         346 NOP
+          951         346 NOP
          
-          939         348 LOAD_CONST              30 ((None, None, 10))
+          945         348 LOAD_CONST              30 ((None, None, 10))
                       350 LOAD_CONST              20 ('prompt')
          
-          941         352 LOAD_NAME               25 (str)
+          947         352 LOAD_NAME               25 (str)
          
-          939         354 LOAD_CONST              16 ('filename')
+          945         354 LOAD_CONST              16 ('filename')
          
-          942         356 LOAD_NAME               25 (str)
+          948         356 LOAD_NAME               25 (str)
                       358 LOAD_NAME               26 (Path)
                       360 BINARY_OP                7 (|)
          
-          939         364 LOAD_CONST              21 ('metric')
+          945         364 LOAD_CONST              21 ('metric')
          
-          943         366 LOAD_NAME               15 (Optional)
+          949         366 LOAD_NAME               15 (Optional)
                       368 LOAD_NAME               25 (str)
                       370 BINARY_SUBSCR
          
-          939         380 LOAD_CONST              22 ('seq_pos')
+          945         380 LOAD_CONST              22 ('seq_pos')
          
-          944         382 LOAD_NAME               15 (Optional)
+          950         382 LOAD_NAME               15 (Optional)
                       384 LOAD_NAME                7 (int)
                       386 BINARY_SUBSCR
          
-          939         396 LOAD_CONST              23 ('num_top_features')
+          945         396 LOAD_CONST              23 ('num_top_features')
          
-          945         398 LOAD_NAME                7 (int)
+          951         398 LOAD_NAME                7 (int)
          
-          939         400 BUILD_TUPLE             10
-                      402 LOAD_CONST              24 (<code object save_prompt_centric_vis, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 939>)
+          945         400 BUILD_TUPLE             10
+                      402 LOAD_CONST              24 (<code object save_prompt_centric_vis, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 945>)
                       404 MAKE_FUNCTION            5 (defaults, annotations)
                       406 STORE_NAME              28 (save_prompt_centric_vis)
          
-         1027         408 LOAD_CONST              25 ('self')
+         1033         408 LOAD_CONST              25 ('self')
                       410 LOAD_CONST               0 ('SaeVisData')
                       412 LOAD_CONST              16 ('filename')
                       414 LOAD_NAME               25 (str)
                       416 LOAD_NAME               26 (Path)
                       418 BINARY_OP                7 (|)
                       422 LOAD_CONST              11 ('return')
                       424 LOAD_CONST               6 (None)
                       426 BUILD_TUPLE              6
-                      428 LOAD_CONST              26 (<code object save_json, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 1027>)
+                      428 LOAD_CONST              26 (<code object save_json, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 1033>)
                       430 MAKE_FUNCTION            4 (annotations)
                       432 STORE_NAME              29 (save_json)
          
-         1043         434 LOAD_NAME               21 (classmethod)
+         1049         434 LOAD_NAME               21 (classmethod)
          
-         1044         436 LOAD_CONST              16 ('filename')
+         1050         436 LOAD_CONST              16 ('filename')
          
-         1046         438 LOAD_NAME               25 (str)
+         1052         438 LOAD_NAME               25 (str)
                       440 LOAD_NAME               26 (Path)
                       442 BINARY_OP                7 (|)
          
-         1044         446 LOAD_CONST               5 ('cfg')
+         1050         446 LOAD_CONST               5 ('cfg')
          
-         1047         448 LOAD_NAME               12 (SaeVisConfig)
+         1053         448 LOAD_NAME               12 (SaeVisConfig)
          
-         1044         450 LOAD_CONST               7 ('model')
+         1050         450 LOAD_CONST               7 ('model')
          
-         1048         452 LOAD_NAME               16 (HookedTransformer)
+         1054         452 LOAD_NAME               16 (HookedTransformer)
          
-         1044         454 LOAD_CONST               8 ('encoder')
+         1050         454 LOAD_CONST               8 ('encoder')
          
-         1049         456 LOAD_NAME               18 (AutoEncoder)
+         1055         456 LOAD_NAME               18 (AutoEncoder)
          
-         1044         458 LOAD_CONST               9 ('encoder_B')
+         1050         458 LOAD_CONST               9 ('encoder_B')
          
-         1050         460 LOAD_NAME               18 (AutoEncoder)
+         1056         460 LOAD_NAME               18 (AutoEncoder)
          
-         1044         462 LOAD_CONST              11 ('return')
+         1050         462 LOAD_CONST              11 ('return')
          
-         1051         464 LOAD_CONST               0 ('SaeVisData')
+         1057         464 LOAD_CONST               0 ('SaeVisData')
          
-         1044         466 BUILD_TUPLE             12
-                      468 LOAD_CONST              27 (<code object load_json, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 1043>)
+         1050         466 BUILD_TUPLE             12
+                      468 LOAD_CONST              27 (<code object load_json, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 1049>)
                       470 MAKE_FUNCTION            4 (annotations)
          
-         1043         472 PRECALL                  0
+         1049         472 PRECALL                  0
                       476 CALL                     0
          
-         1044         486 STORE_NAME              30 (load_json)
+         1050         486 STORE_NAME              30 (load_json)
                       488 LOAD_CONST               6 (None)
                       490 RETURN_VALUE
          consts
             'SaeVisData'
             '\n    This contains all the data necessary for constructing the feature-centric visualization, over multiple \n    features (i.e. being able to navigate through them). See diagram in readme:\n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    Args: \n        feature_data_dict:      Contains the data for each individual feature-centric vis.\n        feature_act_quantiles:  Contains the quantiles of activation values for each feature (used for rank-ordering\n                                features in the prompt-centric vis).\n        cfg:                    The vis config, used for the both the data gathering and the vis layout.\n        model:                  The model which our encoder was trained on.\n        encoder:                The encoder used to get the feature activations.\n        encoder_B:              The encoder used to get the feature activations for the second model (if applicable).\n    '
             ('default_factory',)
             'feature_data_dict'
@@ -5959,31 +5963,31 @@
                flags     : 3
                code
                   0x97007c018002640153007c006a000000000000000000a0010000000000
                   0000000000000000000000000000007c016a000000000000000000a60100
                   00ab01000000000000000001007c006a020000000000000000a001000000
                   00000000000000000000000000000000007c016a020000000000000000a6
                   010000ab010000000000000000010064015300
-               860           0 RESUME                   0
+               863           0 RESUME                   0
                
-               866           2 LOAD_FAST                1 (other)
+               869           2 LOAD_FAST                1 (other)
                              4 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 10)
                              6 LOAD_CONST               1 (None)
                              8 RETURN_VALUE
                
-               867     >>   10 LOAD_FAST                0 (self)
+               870     >>   10 LOAD_FAST                0 (self)
                             12 LOAD_ATTR                0 (feature_data_dict)
                             22 LOAD_METHOD              1 (update)
                             44 LOAD_FAST                1 (other)
                             46 LOAD_ATTR                0 (feature_data_dict)
                             56 PRECALL                  1
                             60 CALL                     1
                             70 POP_TOP
                
-               868          72 LOAD_FAST                0 (self)
+               871          72 LOAD_FAST                0 (self)
                             74 LOAD_ATTR                2 (feature_act_quantiles)
                             84 LOAD_METHOD              1 (update)
                            106 LOAD_FAST                1 (other)
                            108 LOAD_ATTR                2 (feature_act_quantiles)
                            118 PRECALL                  1
                            122 CALL                     1
                            132 POP_TOP
@@ -5994,227 +5998,251 @@
                   None
                names      ('feature_data_dict', 'update', 'feature_act_quantiles')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'update'
-               firstlineno 860
+               firstlineno 863
                lnotab 0x020608013e01
             'tokens'
             'batch seq'
             code
                argcount  : 6
                nlocals   : 8
                stacksize : 7
                flags     : 3
                code
                   0x9700640164026c006d017d06010002007c067c017c027c037c047c05ac
                   03a6050000ab0500000000000000007d077c047c075f0200000000000000
                   007c027c075f0300000000000000007c017c075f0400000000000000007c
                   057c075f0500000000000000007c075300
-               871           0 RESUME                   0
+               874           0 RESUME                   0
                
-               881           2 LOAD_CONST               1 (0)
+               884           2 LOAD_CONST               1 (0)
                              4 LOAD_CONST               2 (('get_feature_data',))
                              6 IMPORT_NAME              0 (sae_vis.data_fetching_fns)
                              8 IMPORT_FROM              1 (get_feature_data)
                             10 STORE_FAST               6 (get_feature_data)
                             12 POP_TOP
                
-               883          14 PUSH_NULL
+               886          14 PUSH_NULL
                             16 LOAD_FAST                6 (get_feature_data)
                
-               884          18 LOAD_FAST                1 (encoder)
+               887          18 LOAD_FAST                1 (encoder)
                
-               885          20 LOAD_FAST                2 (model)
+               888          20 LOAD_FAST                2 (model)
                
-               886          22 LOAD_FAST                3 (tokens)
+               889          22 LOAD_FAST                3 (tokens)
                
-               887          24 LOAD_FAST                4 (cfg)
+               890          24 LOAD_FAST                4 (cfg)
                
-               888          26 LOAD_FAST                5 (encoder_B)
+               891          26 LOAD_FAST                5 (encoder_B)
                
-               883          28 KW_NAMES                 3
+               886          28 KW_NAMES                 3
                             30 PRECALL                  5
                             34 CALL                     5
                             44 STORE_FAST               7 (sae_vis_data)
                
-               890          46 LOAD_FAST                4 (cfg)
+               893          46 LOAD_FAST                4 (cfg)
                             48 LOAD_FAST                7 (sae_vis_data)
                             50 STORE_ATTR               2 (cfg)
                
-               891          60 LOAD_FAST                2 (model)
+               894          60 LOAD_FAST                2 (model)
                             62 LOAD_FAST                7 (sae_vis_data)
                             64 STORE_ATTR               3 (model)
                
-               892          74 LOAD_FAST                1 (encoder)
+               895          74 LOAD_FAST                1 (encoder)
                             76 LOAD_FAST                7 (sae_vis_data)
                             78 STORE_ATTR               4 (encoder)
                
-               893          88 LOAD_FAST                5 (encoder_B)
+               896          88 LOAD_FAST                5 (encoder_B)
                             90 LOAD_FAST                7 (sae_vis_data)
                             92 STORE_ATTR               5 (encoder_B)
                
-               895         102 LOAD_FAST                7 (sae_vis_data)
+               898         102 LOAD_FAST                7 (sae_vis_data)
                            104 RETURN_VALUE
                consts
                   None
                   0
                   ('get_feature_data',)
                   ('encoder', 'model', 'tokens', 'cfg', 'encoder_B')
                names      ('sae_vis.data_fetching_fns', 'get_feature_data', 'cfg', 'model', 'encoder', 'encoder_B')
                varnames   ('cls', 'encoder', 'model', 'tokens', 'cfg', 'encoder_B', 'get_feature_data', 'sae_vis_data')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'create'
-               firstlineno 871
+               firstlineno 874
                lnotab 0x020a0c020401020102010201020102fb12070e010e010e010e02
             'filename'
             'feature_idx'
             code
                argcount  : 3
-               nlocals   : 9
+               nlocals   : 10
                stacksize : 7
                flags     : 3
                code
                   0x9700740100000000000000000000a6000000ab0000000000000000007d
                   037c0280217403000000000000000000007405000000000000000000007c
                   006a030000000000000000a6010000ab010000000000000000a6010000ab
                   0100000000000000006e017c027d047c006a04000000000000000080024a
                   008201740b000000000000000000007c006a0400000000000000006a0600
-                  00000000000000a6010000ab0100000000000000007d057c006a03000000
-                  0000000000a0070000000000000000000000000000000000000000a60000
-                  00ab00000000000000000044005d6d5c0200007d067d077c07a008000000
-                  00000000000000000000000000000000007c006a0900000000000000006a
-                  0a00000000000000007c05a6020000ab0200000000000000007d08741700
-                  0000000000000000007c086a0c0000000000000000a6010000ab01000000
-                  00000000007c036a0c0000000000000000741b000000000000000000007c
-                  06a6010000ab0100000000000000003c0000007c067c046b020000000072
-                  197417000000000000000000007c086a0e0000000000000000a6010000ab
-                  0100000000000000007c035f0e00000000000000008c6e7c03a00f000000
-                  00000000000000000000000000000000007c006a0900000000000000006a
-                  0a00000000000000007c01741b000000000000000000007c04a6010000ab
-                  010000000000000000ac02a6030000ab0300000000000000000100640153
-                  00
-               898           0 RESUME                   0
+                  00000000000000a6010000ab0100000000000000007d05740f0000000000
+                  00000000007c006a030000000000000000a0080000000000000000000000
+                  000000000000000000a6000000ab000000000000000000a6010000ab0100
+                  000000000000007d067c006a0900000000000000006a0a00000000000000
+                  0072117417000000000000000000007c066402ac03a6020000ab02000000
+                  00000000007d067c0644005d6d5c0200007d077d087c08a00c0000000000
+                  0000000000000000000000000000007c006a0900000000000000006a0d00
+                  000000000000007c05a6020000ab0200000000000000007d09741d000000
+                  000000000000007c096a0f0000000000000000a6010000ab010000000000
+                  0000007c036a0f00000000000000007421000000000000000000007c07a6
+                  010000ab0100000000000000003c0000007c077c046b0200000000721974
+                  1d000000000000000000007c096a110000000000000000a6010000ab0100
+                  000000000000007c035f1100000000000000008c6e7c03a0120000000000
+                  0000000000000000000000000000007c006a0900000000000000006a0d00
+                  000000000000007c017421000000000000000000007c04a6010000ab0100
+                  00000000000000ac04a6030000ab030000000000000000010064015300
+               901           0 RESUME                   0
                
-               912           2 LOAD_GLOBAL              1 (NULL + HTML)
+               915           2 LOAD_GLOBAL              1 (NULL + HTML)
                             14 PRECALL                  0
                             18 CALL                     0
                             28 STORE_FAST               3 (HTML_OBJ)
                
-               915          30 LOAD_FAST                2 (feature_idx)
+               918          30 LOAD_FAST                2 (feature_idx)
                             32 POP_JUMP_FORWARD_IF_NOT_NONE    33 (to 100)
                             34 LOAD_GLOBAL              3 (NULL + next)
                             46 LOAD_GLOBAL              5 (NULL + iter)
                             58 LOAD_FAST                0 (self)
                             60 LOAD_ATTR                3 (feature_data_dict)
                             70 PRECALL                  1
                             74 CALL                     1
                             84 PRECALL                  1
                             88 CALL                     1
                             98 JUMP_FORWARD             1 (to 102)
                        >>  100 LOAD_FAST                2 (feature_idx)
                        >>  102 STORE_FAST               4 (first_feature)
                
-               918         104 LOAD_FAST                0 (self)
+               921         104 LOAD_FAST                0 (self)
                            106 LOAD_ATTR                4 (model)
                            116 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 122)
                            118 LOAD_ASSERTION_ERROR
                            120 RAISE_VARARGS            1
                
-               919     >>  122 LOAD_GLOBAL             11 (NULL + get_decode_html_safe_fn)
+               922     >>  122 LOAD_GLOBAL             11 (NULL + get_decode_html_safe_fn)
                            134 LOAD_FAST                0 (self)
                            136 LOAD_ATTR                4 (model)
                            146 LOAD_ATTR                6 (tokenizer)
                            156 PRECALL                  1
                            160 CALL                     1
                            170 STORE_FAST               5 (decode_fn)
                
-               922         172 LOAD_FAST                0 (self)
-                           174 LOAD_ATTR                3 (feature_data_dict)
-                           184 LOAD_METHOD              7 (items)
-                           206 PRECALL                  0
-                           210 CALL                     0
-                           220 GET_ITER
-                       >>  222 FOR_ITER               109 (to 442)
-                           224 UNPACK_SEQUENCE          2
-                           228 STORE_FAST               6 (feature)
-                           230 STORE_FAST               7 (feature_data)
-               
-               925         232 LOAD_FAST                7 (feature_data)
-                           234 LOAD_METHOD              8 (_get_html_data_feature_centric)
-                           256 LOAD_FAST                0 (self)
-                           258 LOAD_ATTR                9 (cfg)
-                           268 LOAD_ATTR               10 (feature_centric_layout)
-                           278 LOAD_FAST                5 (decode_fn)
-                           280 PRECALL                  2
-                           284 CALL                     2
-                           294 STORE_FAST               8 (html_obj)
-               
-               928         296 LOAD_GLOBAL             23 (NULL + deepcopy)
-                           308 LOAD_FAST                8 (html_obj)
-                           310 LOAD_ATTR               12 (js_data)
-                           320 PRECALL                  1
-                           324 CALL                     1
-                           334 LOAD_FAST                3 (HTML_OBJ)
-                           336 LOAD_ATTR               12 (js_data)
-                           346 LOAD_GLOBAL             27 (NULL + str)
-                           358 LOAD_FAST                6 (feature)
-                           360 PRECALL                  1
-                           364 CALL                     1
-                           374 STORE_SUBSCR
-               
-               929         378 LOAD_FAST                6 (feature)
-                           380 LOAD_FAST                4 (first_feature)
-                           382 COMPARE_OP               2 (==)
-                           388 POP_JUMP_FORWARD_IF_FALSE    25 (to 440)
-                           390 LOAD_GLOBAL             23 (NULL + deepcopy)
-                           402 LOAD_FAST                8 (html_obj)
-                           404 LOAD_ATTR               14 (html_data)
-                           414 PRECALL                  1
-                           418 CALL                     1
-                           428 LOAD_FAST                3 (HTML_OBJ)
-                           430 STORE_ATTR              14 (html_data)
-                       >>  440 JUMP_BACKWARD          110 (to 222)
-               
-               932     >>  442 LOAD_FAST                3 (HTML_OBJ)
-                           444 LOAD_METHOD             15 (get_html)
-               
-               933         466 LOAD_FAST                0 (self)
-                           468 LOAD_ATTR                9 (cfg)
-                           478 LOAD_ATTR               10 (feature_centric_layout)
-               
-               934         488 LOAD_FAST                1 (filename)
-               
-               935         490 LOAD_GLOBAL             27 (NULL + str)
-                           502 LOAD_FAST                4 (first_feature)
-                           504 PRECALL                  1
-                           508 CALL                     1
-               
-               932         518 KW_NAMES                 2
-                           520 PRECALL                  3
-                           524 CALL                     3
-                           534 POP_TOP
-                           536 LOAD_CONST               1 (None)
-                           538 RETURN_VALUE
+               925         172 LOAD_GLOBAL             15 (NULL + list)
+                           184 LOAD_FAST                0 (self)
+                           186 LOAD_ATTR                3 (feature_data_dict)
+                           196 LOAD_METHOD              8 (items)
+                           218 PRECALL                  0
+                           222 CALL                     0
+                           232 PRECALL                  1
+                           236 CALL                     1
+                           246 STORE_FAST               6 (iterator)
+               
+               926         248 LOAD_FAST                0 (self)
+                           250 LOAD_ATTR                9 (cfg)
+                           260 LOAD_ATTR               10 (verbose)
+                           270 POP_JUMP_FORWARD_IF_FALSE    17 (to 306)
+                           272 LOAD_GLOBAL             23 (NULL + tqdm)
+                           284 LOAD_FAST                6 (iterator)
+                           286 LOAD_CONST               2 ('Saving feature-centric vis')
+                           288 KW_NAMES                 3
+                           290 PRECALL                  2
+                           294 CALL                     2
+                           304 STORE_FAST               6 (iterator)
+               
+               928     >>  306 LOAD_FAST                6 (iterator)
+                           308 GET_ITER
+                       >>  310 FOR_ITER               109 (to 530)
+                           312 UNPACK_SEQUENCE          2
+                           316 STORE_FAST               7 (feature)
+                           318 STORE_FAST               8 (feature_data)
+               
+               931         320 LOAD_FAST                8 (feature_data)
+                           322 LOAD_METHOD             12 (_get_html_data_feature_centric)
+                           344 LOAD_FAST                0 (self)
+                           346 LOAD_ATTR                9 (cfg)
+                           356 LOAD_ATTR               13 (feature_centric_layout)
+                           366 LOAD_FAST                5 (decode_fn)
+                           368 PRECALL                  2
+                           372 CALL                     2
+                           382 STORE_FAST               9 (html_obj)
+               
+               934         384 LOAD_GLOBAL             29 (NULL + deepcopy)
+                           396 LOAD_FAST                9 (html_obj)
+                           398 LOAD_ATTR               15 (js_data)
+                           408 PRECALL                  1
+                           412 CALL                     1
+                           422 LOAD_FAST                3 (HTML_OBJ)
+                           424 LOAD_ATTR               15 (js_data)
+                           434 LOAD_GLOBAL             33 (NULL + str)
+                           446 LOAD_FAST                7 (feature)
+                           448 PRECALL                  1
+                           452 CALL                     1
+                           462 STORE_SUBSCR
+               
+               935         466 LOAD_FAST                7 (feature)
+                           468 LOAD_FAST                4 (first_feature)
+                           470 COMPARE_OP               2 (==)
+                           476 POP_JUMP_FORWARD_IF_FALSE    25 (to 528)
+                           478 LOAD_GLOBAL             29 (NULL + deepcopy)
+                           490 LOAD_FAST                9 (html_obj)
+                           492 LOAD_ATTR               17 (html_data)
+                           502 PRECALL                  1
+                           506 CALL                     1
+                           516 LOAD_FAST                3 (HTML_OBJ)
+                           518 STORE_ATTR              17 (html_data)
+                       >>  528 JUMP_BACKWARD          110 (to 310)
+               
+               938     >>  530 LOAD_FAST                3 (HTML_OBJ)
+                           532 LOAD_METHOD             18 (get_html)
+               
+               939         554 LOAD_FAST                0 (self)
+                           556 LOAD_ATTR                9 (cfg)
+                           566 LOAD_ATTR               13 (feature_centric_layout)
+               
+               940         576 LOAD_FAST                1 (filename)
+               
+               941         578 LOAD_GLOBAL             33 (NULL + str)
+                           590 LOAD_FAST                4 (first_feature)
+                           592 PRECALL                  1
+                           596 CALL                     1
+               
+               938         606 KW_NAMES                 4
+                           608 PRECALL                  3
+                           612 CALL                     3
+                           622 POP_TOP
+                           624 LOAD_CONST               1 (None)
+                           626 RETURN_VALUE
                consts
                   "\n        Returns the HTML string for the view which lets you navigate between different features.\n\n        Args:\n            model:          Used to get the tokenizer (for converting token IDs to string tokens).\n            filename:       The HTML filepath we'll save the visualization to.\n            feature_idx:    This is the default feature index we'll start on. If None, we use the first feature.\n        "
                   None
+                  'Saving feature-centric vis'
+                  ('desc',)
                   ('layout', 'filename', 'first_key')
-               names      ('HTML', 'next', 'iter', 'feature_data_dict', 'model', 'get_decode_html_safe_fn', 'tokenizer', 'items', '_get_html_data_feature_centric', 'cfg', 'feature_centric_layout', 'deepcopy', 'js_data', 'str', 'html_data', 'get_html')
-               varnames   ('self', 'filename', 'feature_idx', 'HTML_OBJ', 'first_feature', 'decode_fn', 'feature', 'feature_data', 'html_obj')
+               names      ('HTML', 'next', 'iter', 'feature_data_dict', 'model', 'get_decode_html_safe_fn', 'tokenizer', 'list', 'items', 'cfg', 'verbose', 'tqdm', '_get_html_data_feature_centric', 'feature_centric_layout', 'deepcopy', 'js_data', 'str', 'html_data', 'get_html')
+               varnames   ('self', 'filename', 'feature_idx', 'HTML_OBJ', 'first_feature', 'decode_fn', 'iterator', 'feature', 'feature_data', 'html_obj')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'save_feature_centric_vis'
-               firstlineno 898
-               lnotab 0x020e1c034a03120132033c034003520140031801160102011cfd
+               firstlineno 901
+               lnotab
+                  0x020e1c034a03120132034c013a020e034003520140031801160102011c
+                  fd
             10
             'prompt'
             'metric'
             'seq_pos'
             'num_top_features'
             code
                argcount  : 6
@@ -6254,110 +6282,110 @@
                   0072197425000000000000000000007c156a140000000000000000a60100
                   00ab0100000000000000007c065f1400000000000000008cfd7c0e7c0876
                   0073234a00640f7c0e9b0064107c08a01500000000000000000000000000
                   00000000000000a6000000ab0000000000000000009b0264119d05a60000
                   00ab00000000000000000082017c06a01600000000000000000000000000
                   000000000000007c006a0f00000000000000006a1000000000000000007c
                   027c0eac12a6030000ab030000000000000000010064085300
-                939           0 RESUME                   0
+                945           0 RESUME                   0
                
-                958           2 LOAD_GLOBAL              1 (NULL + HTML)
+                964           2 LOAD_GLOBAL              1 (NULL + HTML)
                              14 PRECALL                  0
                              18 CALL                     0
                              28 STORE_FAST               6 (HTML_OBJ)
                
-                962          30 LOAD_CONST               1 (0)
+                968          30 LOAD_CONST               1 (0)
                              32 LOAD_CONST               2 (('get_prompt_data',))
                              34 IMPORT_NAME              1 (sae_vis.data_fetching_fns)
                              36 IMPORT_FROM              2 (get_prompt_data)
                              38 STORE_FAST               7 (get_prompt_data)
                              40 POP_TOP
                
-                963          42 PUSH_NULL
+                969          42 PUSH_NULL
                              44 LOAD_FAST                7 (get_prompt_data)
                
-                964          46 LOAD_FAST                0 (self)
+                970          46 LOAD_FAST                0 (self)
                
-                965          48 LOAD_FAST                1 (prompt)
+                971          48 LOAD_FAST                1 (prompt)
                
-                966          50 LOAD_FAST                5 (num_top_features)
+                972          50 LOAD_FAST                5 (num_top_features)
                
-                963          52 KW_NAMES                 3
+                969          52 KW_NAMES                 3
                              54 PRECALL                  3
                              58 CALL                     3
                              68 STORE_FAST               8 (scores_dict)
                
-                970          70 LOAD_FAST                0 (self)
+                976          70 LOAD_FAST                0 (self)
                              72 LOAD_ATTR                3 (model)
                              82 LOAD_ATTR                4 (tokenizer)
                              92 LOAD_METHOD              5 (tokenize)
                             114 LOAD_FAST                1 (prompt)
                             116 PRECALL                  1
                             120 CALL                     1
                             130 STORE_FAST               9 (str_toks)
                
-                971         132 LOAD_CONST               4 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 971>)
+                977         132 LOAD_CONST               4 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 977>)
                             134 MAKE_FUNCTION            0
                             136 LOAD_FAST                9 (str_toks)
                             138 GET_ITER
                             140 PRECALL                  0
                             144 CALL                     0
                             154 STORE_FAST               9 (str_toks)
                
-                972         156 LOAD_CONST               5 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 972>)
+                978         156 LOAD_CONST               5 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\data_storing_fns.py", line 978>)
                             158 MAKE_FUNCTION            0
                             160 LOAD_GLOBAL             13 (NULL + enumerate)
                             172 LOAD_FAST                9 (str_toks)
                             174 PRECALL                  1
                             178 CALL                     1
                             188 GET_ITER
                             190 PRECALL                  0
                             194 CALL                     0
                             204 STORE_FAST              10 (str_toks_list)
                
-                973         206 BUILD_LIST               0
+                979         206 BUILD_LIST               0
                             208 LOAD_CONST               6 (('act_quantile', 'act_size', 'loss_effect'))
                             210 LIST_EXTEND              1
                             212 STORE_FAST              11 (metric_list)
                
-                976         214 LOAD_CONST               7 ('act_quantile')
+                982         214 LOAD_CONST               7 ('act_quantile')
                             216 STORE_FAST              12 (first_metric)
                
-                977         218 LOAD_FAST               10 (str_toks_list)
+                983         218 LOAD_FAST               10 (str_toks_list)
                             220 LOAD_FAST                4 (seq_pos)
                             222 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 228)
                             224 LOAD_CONST               1 (0)
                             226 JUMP_FORWARD             1 (to 230)
                         >>  228 LOAD_FAST                4 (seq_pos)
                         >>  230 BINARY_SUBSCR
                             240 STORE_FAST              13 (first_seq_pos)
                
-                978         242 LOAD_FAST               12 (first_metric)
+                984         242 LOAD_FAST               12 (first_metric)
                             244 FORMAT_VALUE             0
                             246 LOAD_CONST               9 ('|')
                             248 LOAD_FAST               13 (first_seq_pos)
                             250 FORMAT_VALUE             0
                             252 BUILD_STRING             3
                             254 STORE_FAST              14 (first_key)
                
-                981         256 LOAD_FAST                0 (self)
+                987         256 LOAD_FAST                0 (self)
                             258 LOAD_ATTR                3 (model)
                             268 POP_JUMP_FORWARD_IF_NOT_NONE     2 (to 274)
                             270 LOAD_ASSERTION_ERROR
                             272 RAISE_VARARGS            1
                
-                982     >>  274 LOAD_GLOBAL             15 (NULL + get_decode_html_safe_fn)
+                988     >>  274 LOAD_GLOBAL             15 (NULL + get_decode_html_safe_fn)
                             286 LOAD_FAST                0 (self)
                             288 LOAD_ATTR                3 (model)
                             298 LOAD_ATTR                4 (tokenizer)
                             308 PRECALL                  1
                             312 CALL                     1
                             322 STORE_FAST              15 (decode_fn)
                
-                986         324 LOAD_GLOBAL             17 (NULL + itertools)
+                992         324 LOAD_GLOBAL             17 (NULL + itertools)
                             336 LOAD_ATTR                9 (product)
                             346 LOAD_FAST               11 (metric_list)
                             348 LOAD_GLOBAL             21 (NULL + range)
                             360 LOAD_GLOBAL             23 (NULL + len)
                             372 LOAD_FAST                9 (str_toks)
                             374 PRECALL                  1
                             378 CALL                     1
@@ -6367,44 +6395,44 @@
                             406 CALL                     2
                             416 GET_ITER
                         >>  418 FOR_ITER               252 (to 924)
                             420 UNPACK_SEQUENCE          2
                             424 STORE_FAST              16 (_metric)
                             426 STORE_FAST              17 (_seq_pos)
                
-                989         428 LOAD_FAST               16 (_metric)
+                995         428 LOAD_FAST               16 (_metric)
                             430 FORMAT_VALUE             0
                             432 LOAD_CONST               9 ('|')
                             434 LOAD_FAST               10 (str_toks_list)
                             436 LOAD_FAST               17 (_seq_pos)
                             438 BINARY_SUBSCR
                             448 FORMAT_VALUE             0
                             450 BUILD_STRING             3
                             452 STORE_FAST              18 (key)
                
-                990         454 LOAD_FAST               18 (key)
+                996         454 LOAD_FAST               18 (key)
                             456 LOAD_FAST                8 (scores_dict)
                             458 CONTAINS_OP              1
                             460 POP_JUMP_FORWARD_IF_FALSE     1 (to 464)
                
-                991         462 JUMP_BACKWARD           23 (to 418)
+                997         462 JUMP_BACKWARD           23 (to 418)
                
-                992     >>  464 LOAD_FAST                8 (scores_dict)
+                998     >>  464 LOAD_FAST                8 (scores_dict)
                             466 LOAD_FAST               18 (key)
                             468 BINARY_SUBSCR
                             478 UNPACK_SEQUENCE          2
                             482 STORE_FAST              19 (feature_idx_list)
                             484 STORE_FAST              20 (scores_formatted)
                
-                995         486 LOAD_GLOBAL              1 (NULL + HTML)
+               1001         486 LOAD_GLOBAL              1 (NULL + HTML)
                             498 PRECALL                  0
                             502 CALL                     0
                             512 STORE_FAST              21 (html_obj)
                
-                997         514 LOAD_GLOBAL             13 (NULL + enumerate)
+               1003         514 LOAD_GLOBAL             13 (NULL + enumerate)
                             526 LOAD_GLOBAL             25 (NULL + zip)
                             538 LOAD_FAST               19 (feature_idx_list)
                             540 LOAD_FAST               20 (scores_formatted)
                             542 PRECALL                  2
                             546 CALL                     2
                             556 PRECALL                  1
                             560 CALL                     1
@@ -6412,85 +6440,85 @@
                         >>  572 FOR_ITER                79 (to 732)
                             574 UNPACK_SEQUENCE          2
                             578 STORE_FAST              22 (i)
                             580 UNPACK_SEQUENCE          2
                             584 STORE_FAST              23 (feature_idx)
                             586 STORE_FAST              24 (score_formatted)
                
-               1000         588 LOAD_FAST               21 (html_obj)
+               1006         588 LOAD_FAST               21 (html_obj)
                             590 LOAD_FAST                0 (self)
                             592 LOAD_ATTR               13 (feature_data_dict)
                             602 LOAD_FAST               23 (feature_idx)
                             604 BINARY_SUBSCR
                             614 LOAD_METHOD             14 (_get_html_data_prompt_centric)
                
-               1001         636 LOAD_FAST                0 (self)
+               1007         636 LOAD_FAST                0 (self)
                             638 LOAD_ATTR               15 (cfg)
                             648 LOAD_ATTR               16 (prompt_centric_layout)
                
-               1002         658 LOAD_FAST               15 (decode_fn)
+               1008         658 LOAD_FAST               15 (decode_fn)
                
-               1003         660 LOAD_FAST               22 (i)
+               1009         660 LOAD_FAST               22 (i)
                
-               1004         662 LOAD_FAST               17 (_seq_pos)
+               1010         662 LOAD_FAST               17 (_seq_pos)
                
-               1005         664 LOAD_CONST              10 ('<h3>#')
+               1011         664 LOAD_CONST              10 ('<h3>#')
                             666 LOAD_FAST               23 (feature_idx)
                             668 FORMAT_VALUE             0
                             670 LOAD_CONST              11 ('<br>')
                             672 LOAD_GLOBAL             34 (METRIC_TITLES)
                             684 LOAD_FAST               16 (_metric)
                             686 BINARY_SUBSCR
                             696 FORMAT_VALUE             0
                             698 LOAD_CONST              12 (' = ')
                             700 LOAD_FAST               24 (score_formatted)
                             702 FORMAT_VALUE             0
                             704 LOAD_CONST              13 ('</h3><hr>')
                             706 BUILD_STRING             7
                
-               1000         708 KW_NAMES                14
+               1006         708 KW_NAMES                14
                             710 PRECALL                  5
                             714 CALL                     5
                             724 BINARY_OP               13 (+=)
                             728 STORE_FAST              21 (html_obj)
                             730 JUMP_BACKWARD           80 (to 572)
                
-               1009     >>  732 LOAD_GLOBAL             37 (NULL + deepcopy)
+               1015     >>  732 LOAD_GLOBAL             37 (NULL + deepcopy)
                             744 LOAD_FAST               21 (html_obj)
                             746 LOAD_ATTR               19 (js_data)
                             756 PRECALL                  1
                             760 CALL                     1
                             770 LOAD_FAST                6 (HTML_OBJ)
                             772 LOAD_ATTR               19 (js_data)
                             782 LOAD_FAST               18 (key)
                             784 STORE_SUBSCR
                
-               1012         788 LOAD_GLOBAL             23 (NULL + len)
+               1018         788 LOAD_GLOBAL             23 (NULL + len)
                             800 LOAD_FAST                6 (HTML_OBJ)
                             802 LOAD_ATTR               20 (html_data)
                             812 PRECALL                  1
                             816 CALL                     1
                             826 LOAD_GLOBAL             23 (NULL + len)
                             838 LOAD_FAST               21 (html_obj)
                             840 LOAD_ATTR               20 (html_data)
                             850 PRECALL                  1
                             854 CALL                     1
                             864 COMPARE_OP               0 (<)
                             870 POP_JUMP_FORWARD_IF_FALSE    25 (to 922)
                
-               1013         872 LOAD_GLOBAL             37 (NULL + deepcopy)
+               1019         872 LOAD_GLOBAL             37 (NULL + deepcopy)
                             884 LOAD_FAST               21 (html_obj)
                             886 LOAD_ATTR               20 (html_data)
                             896 PRECALL                  1
                             900 CALL                     1
                             910 LOAD_FAST                6 (HTML_OBJ)
                             912 STORE_ATTR              20 (html_data)
                         >>  922 JUMP_BACKWARD          253 (to 418)
                
-               1016     >>  924 LOAD_FAST               14 (first_key)
+               1022     >>  924 LOAD_FAST               14 (first_key)
                             926 LOAD_FAST                8 (scores_dict)
                             928 CONTAINS_OP              0
                             930 POP_JUMP_FORWARD_IF_TRUE    35 (to 1002)
                             932 LOAD_ASSERTION_ERROR
                             934 LOAD_CONST              15 ('Key ')
                             936 LOAD_FAST               14 (first_key)
                             938 FORMAT_VALUE             0
@@ -6502,26 +6530,26 @@
                             980 FORMAT_VALUE             2 (repr)
                             982 LOAD_CONST              17 ('. Have you tried computing your initial data with more features and/or tokens, to make sure you have enough positive examples?')
                             984 BUILD_STRING             5
                             986 PRECALL                  0
                             990 CALL                     0
                            1000 RAISE_VARARGS            1
                
-               1020     >> 1002 LOAD_FAST                6 (HTML_OBJ)
+               1026     >> 1002 LOAD_FAST                6 (HTML_OBJ)
                            1004 LOAD_METHOD             22 (get_html)
                
-               1021        1026 LOAD_FAST                0 (self)
+               1027        1026 LOAD_FAST                0 (self)
                            1028 LOAD_ATTR               15 (cfg)
                            1038 LOAD_ATTR               16 (prompt_centric_layout)
                
-               1022        1048 LOAD_FAST                2 (filename)
+               1028        1048 LOAD_FAST                2 (filename)
                
-               1023        1050 LOAD_FAST               14 (first_key)
+               1029        1050 LOAD_FAST               14 (first_key)
                
-               1020        1052 KW_NAMES                18
+               1026        1052 KW_NAMES                18
                            1054 PRECALL                  3
                            1058 CALL                     3
                            1068 POP_TOP
                            1070 LOAD_CONST               8 (None)
                            1072 RETURN_VALUE
                consts
                   "\n        Returns the HTML string for the view which lets you navigate between different features.\n\n        Args:\n            prompt:     The user-input prompt.\n            model:      Used to get the tokenizer (for converting token IDs to string tokens).\n            filename:   The HTML filepath we'll save the visualization to.\n            metric:     This is the default scoring metric we'll start on. If None, we use 'act_quantile'.\n            seq_pos:    This is the default seq pos we'll start on. If None, we use 0.\n        "
@@ -6532,15 +6560,15 @@
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 6
                      flags     : 19
                      code
                         0x970067007c005d187d017c01a000000000000000000000000000000000
                         000000000064006401a6020000ab02000000000000000091028c195300
-                     971           0 RESUME                   0
+                     977           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                24 (to 56)
                                    8 STORE_FAST               1 (t)
                                   10 LOAD_FAST                1 (t)
                                   12 LOAD_METHOD              0 (replace)
                                   34 LOAD_CONST               0 ('|')
@@ -6555,25 +6583,25 @@
                         '│'
                      names      ('replace',)
                      varnames   ('.0', 't')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 971
+                     firstlineno 977
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 6
                      flags     : 19
                      code
                         0x970067007c005d0d5c0200007d017d027c029b0264007c019b0064019d
                         0491028c0e5300
-                     972           0 RESUME                   0
+                     978           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                13 (to 34)
                                    8 UNPACK_SEQUENCE          2
                                   12 STORE_FAST               1 (i)
                                   14 STORE_FAST               2 (t)
                                   16 LOAD_FAST                2 (t)
@@ -6591,15 +6619,15 @@
                         ')'
                      names      ()
                      varnames   ('.0', 'i', 't')
                      freevars   ()
                      cellvars   ()
                      filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                      name       '<listcomp>'
-                     firstlineno 972
+                     firstlineno 978
                      lnotab 0x
                   ('act_quantile', 'act_size', 'loss_effect')
                   'act_quantile'
                   None
                   '|'
                   '<h3>#'
                   '<br>'
@@ -6612,15 +6640,15 @@
                   ('layout', 'filename', 'first_key')
                names      ('HTML', 'sae_vis.data_fetching_fns', 'get_prompt_data', 'model', 'tokenizer', 'tokenize', 'enumerate', 'get_decode_html_safe_fn', 'itertools', 'product', 'range', 'len', 'zip', 'feature_data_dict', '_get_html_data_prompt_centric', 'cfg', 'prompt_centric_layout', 'METRIC_TITLES', 'deepcopy', 'js_data', 'html_data', 'keys', 'get_html')
                varnames   ('self', 'prompt', 'filename', 'metric', 'seq_pos', 'num_top_features', 'HTML_OBJ', 'get_prompt_data', 'scores_dict', 'str_toks', 'str_toks_list', 'metric_list', 'first_metric', 'first_seq_pos', 'first_key', 'decode_fn', '_metric', '_seq_pos', 'key', 'feature_idx_list', 'scores_formatted', 'html_obj', 'i', 'feature_idx', 'score_formatted')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'save_prompt_centric_vis'
-               firstlineno 939
+               firstlineno 945
                lnotab
                   0x02131c040c0104010201020102fd12073e01180132010803040118010e
                   031201320468031a010801020116031c024a03300116010201020102012c
                   fb18093803540134034e0418011601020102fd
             'self'
             code
                argcount  : 2
@@ -6636,72 +6664,72 @@
                   000000ac03a6020000ab0200000000000000007d02740f00000000000000
                   0000007c016404a6020000ab02000000000000000035007d037411000000
                   000000000000006a0900000000000000007c02a00a000000000000000000
                   0000000000000000000000a6000000ab0000000000000000007c03a60200
                   00ab0200000000000000000100640564056405a6020000ab020000000000
                   000000010064055300230031007304770278035900770101005900010001
                   0064055300
-               1027           0 RESUME                   0
+               1033           0 RESUME                   0
                
-               1031           2 LOAD_GLOBAL              1 (NULL + isinstance)
+               1037           2 LOAD_GLOBAL              1 (NULL + isinstance)
                              14 LOAD_FAST                1 (filename)
                              16 LOAD_GLOBAL              2 (str)
                              28 PRECALL                  2
                              32 CALL                     2
                              42 POP_JUMP_FORWARD_IF_FALSE    15 (to 74)
                              44 LOAD_GLOBAL              5 (NULL + Path)
                              56 LOAD_FAST                1 (filename)
                              58 PRECALL                  1
                              62 CALL                     1
                              72 STORE_FAST               1 (filename)
                
-               1032     >>   74 LOAD_FAST                1 (filename)
+               1038     >>   74 LOAD_FAST                1 (filename)
                              76 LOAD_ATTR                3 (suffix)
                              86 LOAD_CONST               1 ('.json')
                              88 COMPARE_OP               2 (==)
                              94 POP_JUMP_FORWARD_IF_TRUE    10 (to 116)
                              96 LOAD_ASSERTION_ERROR
                              98 LOAD_CONST               2 ('Filename must have a .json extension')
                             100 PRECALL                  0
                             104 CALL                     0
                             114 RAISE_VARARGS            1
                
-               1034     >>  116 LOAD_GLOBAL              9 (NULL + _SaeVisData)
+               1040     >>  116 LOAD_GLOBAL              9 (NULL + _SaeVisData)
                
-               1035         128 LOAD_FAST                0 (self)
+               1041         128 LOAD_FAST                0 (self)
                             130 LOAD_ATTR                5 (feature_data_dict)
                
-               1036         140 LOAD_FAST                0 (self)
+               1042         140 LOAD_FAST                0 (self)
                             142 LOAD_ATTR                6 (feature_act_quantiles)
                
-               1034         152 KW_NAMES                 3
+               1040         152 KW_NAMES                 3
                             154 PRECALL                  2
                             158 CALL                     2
                             168 STORE_FAST               2 (_self)
                
-               1039         170 LOAD_GLOBAL             15 (NULL + open)
+               1045         170 LOAD_GLOBAL             15 (NULL + open)
                             182 LOAD_FAST                1 (filename)
                             184 LOAD_CONST               4 ('w')
                             186 PRECALL                  2
                             190 CALL                     2
                             200 BEFORE_WITH
                             202 STORE_FAST               3 (f)
                
-               1040         204 LOAD_GLOBAL             17 (NULL + json)
+               1046         204 LOAD_GLOBAL             17 (NULL + json)
                             216 LOAD_ATTR                9 (dump)
                             226 LOAD_FAST                2 (_self)
                             228 LOAD_METHOD             10 (to_dict)
                             250 PRECALL                  0
                             254 CALL                     0
                             264 LOAD_FAST                3 (f)
                             266 PRECALL                  2
                             270 CALL                     2
                             280 POP_TOP
                
-               1039         282 LOAD_CONST               5 (None)
+               1045         282 LOAD_CONST               5 (None)
                             284 LOAD_CONST               5 (None)
                             286 LOAD_CONST               5 (None)
                             288 PRECALL                  2
                             292 CALL                     2
                             302 POP_TOP
                             304 LOAD_CONST               5 (None)
                             306 RETURN_VALUE
@@ -6731,15 +6759,15 @@
                   None
                names      ('isinstance', 'str', 'Path', 'suffix', '_SaeVisData', 'feature_data_dict', 'feature_act_quantiles', 'open', 'json', 'dump', 'to_dict')
                varnames   ('self', 'filename', '_self', 'f')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'save_json'
-               firstlineno 1027
+               firstlineno 1033
                lnotab 0x020448012a020c010c010cfe120522014eff
             code
                argcount  : 6
                nlocals   : 10
                stacksize : 8
                flags     : 3
                code
@@ -6751,55 +6779,55 @@
                   06740b000000000000000000006a0600000000000000007c06a6010000ab
                   0100000000000000007d07640464046404a6020000ab0200000000000000
                   0001006e0b23003100730477027803590077010100590001000100740e00
                   000000000000000000a00800000000000000000000000000000000000000
                   007c07a6010000ab0100000000000000007d087413000000000000000000
                   007c086a0a00000000000000007c086a0b00000000000000007c027c037c
                   047c05ac05a6060000ab0600000000000000007d097c095300
-               1043           0 RESUME                   0
+               1049           0 RESUME                   0
                
-               1055           2 LOAD_GLOBAL              1 (NULL + isinstance)
+               1061           2 LOAD_GLOBAL              1 (NULL + isinstance)
                              14 LOAD_FAST                1 (filename)
                              16 LOAD_GLOBAL              2 (str)
                              28 PRECALL                  2
                              32 CALL                     2
                              42 POP_JUMP_FORWARD_IF_FALSE    15 (to 74)
                              44 LOAD_GLOBAL              5 (NULL + Path)
                              56 LOAD_FAST                1 (filename)
                              58 PRECALL                  1
                              62 CALL                     1
                              72 STORE_FAST               1 (filename)
                
-               1056     >>   74 LOAD_FAST                1 (filename)
+               1062     >>   74 LOAD_FAST                1 (filename)
                              76 LOAD_ATTR                3 (suffix)
                              86 LOAD_CONST               1 ('.json')
                              88 COMPARE_OP               2 (==)
                              94 POP_JUMP_FORWARD_IF_TRUE    10 (to 116)
                              96 LOAD_ASSERTION_ERROR
                              98 LOAD_CONST               2 ('Filename must have a .json extension')
                             100 PRECALL                  0
                             104 CALL                     0
                             114 RAISE_VARARGS            1
                
-               1058     >>  116 LOAD_GLOBAL              9 (NULL + open)
+               1064     >>  116 LOAD_GLOBAL              9 (NULL + open)
                             128 LOAD_FAST                1 (filename)
                             130 LOAD_CONST               3 ('r')
                             132 PRECALL                  2
                             136 CALL                     2
                             146 BEFORE_WITH
                             148 STORE_FAST               6 (f)
                
-               1059         150 LOAD_GLOBAL             11 (NULL + json)
+               1065         150 LOAD_GLOBAL             11 (NULL + json)
                             162 LOAD_ATTR                6 (load)
                             172 LOAD_FAST                6 (f)
                             174 PRECALL                  1
                             178 CALL                     1
                             188 STORE_FAST               7 (data)
                
-               1058         190 LOAD_CONST               4 (None)
+               1064         190 LOAD_CONST               4 (None)
                             192 LOAD_CONST               4 (None)
                             194 LOAD_CONST               4 (None)
                             196 PRECALL                  2
                             200 CALL                     2
                             210 POP_TOP
                             212 JUMP_FORWARD            11 (to 236)
                         >>  214 PUSH_EXC_INFO
@@ -6810,43 +6838,43 @@
                             224 POP_EXCEPT
                             226 RERAISE                  1
                         >>  228 POP_TOP
                             230 POP_EXCEPT
                             232 POP_TOP
                             234 POP_TOP
                
-               1061     >>  236 LOAD_GLOBAL             14 (_SaeVisData)
+               1067     >>  236 LOAD_GLOBAL             14 (_SaeVisData)
                             248 LOAD_METHOD              8 (from_dict)
                             270 LOAD_FAST                7 (data)
                             272 PRECALL                  1
                             276 CALL                     1
                             286 STORE_FAST               8 (_self)
                
-               1063         288 LOAD_GLOBAL             19 (NULL + SaeVisData)
+               1069         288 LOAD_GLOBAL             19 (NULL + SaeVisData)
                
-               1064         300 LOAD_FAST                8 (_self)
+               1070         300 LOAD_FAST                8 (_self)
                             302 LOAD_ATTR               10 (feature_data_dict)
                
-               1065         312 LOAD_FAST                8 (_self)
+               1071         312 LOAD_FAST                8 (_self)
                             314 LOAD_ATTR               11 (feature_act_quantiles)
                
-               1066         324 LOAD_FAST                2 (cfg)
+               1072         324 LOAD_FAST                2 (cfg)
                
-               1067         326 LOAD_FAST                3 (model)
+               1073         326 LOAD_FAST                3 (model)
                
-               1068         328 LOAD_FAST                4 (encoder)
+               1074         328 LOAD_FAST                4 (encoder)
                
-               1069         330 LOAD_FAST                5 (encoder_B)
+               1075         330 LOAD_FAST                5 (encoder_B)
                
-               1063         332 KW_NAMES                 5
+               1069         332 KW_NAMES                 5
                             334 PRECALL                  6
                             338 CALL                     6
                             348 STORE_FAST               9 (self)
                
-               1072         350 LOAD_FAST                9 (self)
+               1078         350 LOAD_FAST                9 (self)
                             352 RETURN_VALUE
                ExceptionTable:
                  148 to 188 -> 214 [1] lasti
                  214 to 220 -> 222 [3] lasti
                  228 to 228 -> 222 [3] lasti
                consts
                   '\n        Loads an SaeVisData instance from JSON file. The config, model & encoder arguments must be user-supplied.\n        '
@@ -6857,42 +6885,43 @@
                   ('feature_data_dict', 'feature_act_quantiles', 'cfg', 'model', 'encoder', 'encoder_B')
                names      ('isinstance', 'str', 'Path', 'suffix', 'open', 'json', 'load', '_SaeVisData', 'from_dict', 'SaeVisData', 'feature_data_dict', 'feature_act_quantiles')
                varnames   ('cls', 'filename', 'cfg', 'model', 'encoder', 'encoder_B', 'f', 'data', '_self', 'self')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
                name       'load_json'
-               firstlineno 1043
+               firstlineno 1049
                lnotab
                   0x020c48012a02220128ff2e0334020c010c010c0102010201020102fa12
                   09
             ('other', 'SaeVisData', 'return', None)
             (None,)
             (None, None, 10)
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'dict', 'feature_data_dict', 'int', 'FeatureData', '__annotations__', 'QuantileCalculator', 'feature_act_quantiles', 'SaeVisConfig', 'cfg', 'model', 'Optional', 'HookedTransformer', 'encoder', 'AutoEncoder', 'encoder_B', 'update', 'classmethod', 'Int', 'Tensor', 'create', 'str', 'Path', 'save_feature_centric_vis', 'save_prompt_centric_vis', 'save_json', 'load_json')
          varnames   ()
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
          name       'SaeVisData'
-         firstlineno 835
+         firstlineno 838
          lnotab
             0x0c02040f3201220122021a011a011a02080b020702fa040202fe020302
             fd020412fc020502fb02060efa020702f906ff0e01021d02fd040208fe02
-            030efd020402fc082d0201020102fa040202fe020308fd02040efc02050e
+            030efd020402fc08300201020102fa040202fe020308fd02040efc02050e
             fb020602fa08581a100201020208fe020302fd020402fc020502fb020602
             fa020702f906ff0e01
       'SaeVisData'
-   names      ('numpy', 'np', 'itertools', 'pathlib', 'Path', 'torch', 'Tensor', 'typing', 'Optional', 'Union', 'Any', 'Callable', 'dataclasses', 'dataclass', 'field', 'dataclasses_json', 'dataclass_json', 'jaxtyping', 'Int', 're', 'copy', 'deepcopy', 'json', 'transformer_lens', 'HookedTransformer', 'sae_vis.model_fns', 'AutoEncoder', 'sae_vis.utils_fns', 'to_str_tokens', 'QuantileCalculator', 'HistogramData', 'get_decode_html_safe_fn', 'unprocess_str_tok', 'max_or_1', 'sae_vis.html_fns', 'bgColorMap', 'uColorMap', 'HTML', 'sae_vis.data_config_classes', 'SaeVisLayoutConfig', 'SaeVisConfig', 'FeatureTablesConfig', 'ActsHistogramConfig', 'LogitsTableConfig', 'LogitsHistogramConfig', 'SequencesConfig', 'PromptConfig', 'GenericComponentConfig', 'METRIC_TITLES', 'PRECISION', 'FeatureTablesData', 'ActsHistogramData', 'LogitsHistogramData', 'LogitsTableData', 'SequenceData', 'SequenceGroupData', 'SequenceMultiGroupData', 'GenericData', 'FeatureData', '_SaeVisData', 'SaeVisData')
+   names      ('numpy', 'np', 'itertools', 'pathlib', 'Path', 'torch', 'Tensor', 'typing', 'Optional', 'Union', 'Any', 'Callable', 'dataclasses', 'dataclass', 'field', 'dataclasses_json', 'dataclass_json', 'jaxtyping', 'Int', 're', 'copy', 'deepcopy', 'json', 'tqdm.auto', 'tqdm', 'transformer_lens', 'HookedTransformer', 'sae_vis.model_fns', 'AutoEncoder', 'sae_vis.utils_fns', 'to_str_tokens', 'QuantileCalculator', 'HistogramData', 'get_decode_html_safe_fn', 'unprocess_str_tok', 'max_or_1', 'sae_vis.html_fns', 'bgColorMap', 'uColorMap', 'HTML', 'sae_vis.data_config_classes', 'SaeVisLayoutConfig', 'SaeVisConfig', 'FeatureTablesConfig', 'ActsHistogramConfig', 'LogitsTableConfig', 'LogitsHistogramConfig', 'SequencesConfig', 'PromptConfig', 'GenericComponentConfig', 'METRIC_TITLES', 'PRECISION', 'FeatureTablesData', 'ActsHistogramData', 'LogitsHistogramData', 'LogitsTableData', 'SequenceData', 'SequenceGroupData', 'SequenceMultiGroupData', 'GenericData', 'FeatureData', '_SaeVisData', 'SaeVisData')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\data_storing_fns.py'
    name       '<module>'
    firstlineno 1
    lnotab
-      0x00ff0201080108010c010c01180110010c010c0108010c0108020c020c
-      02200814052c0d0201020102fd060504020201020118ff0eff0e02025b02
-      0102011aff0eff0e020229020102011aff0eff0e0202230201020118ff0e
-      ff0e02023e0201020118ff0eff0e02027f004e0201020118ff0eff0e0202
-      580201020118ff0eff0e02024b02010201020102010201020102fb02ff0c
-      0a020118ff0e01027f00110201020118ff0eff0e020212020118ff0e01
+      0x00ff0201080108010c010c01180110010c010c0108010c0108010c020c
+      020c02200814052c0d0201020102fd060504020201020118ff0eff0e0202
+      5d020102011aff0eff0e020229020102011aff0eff0e0202230201020118
+      ff0eff0e02023e0201020118ff0eff0e02027f004e0201020118ff0eff0e
+      0202580201020118ff0eff0e02024b02010201020102010201020102fb02
+      ff0c0a020118ff0e01027f00110201020118ff0eff0e020212020118ff0e
+      01
```

### Comparing `sae-vis-0.2.7/sae_vis/__pycache__/html_fns.cpython-311.pyc` & `sae-vis-0.2.8/sae_vis/__pycache__/html_fns.cpython-311.pyc`

 * *Files 0% similar despite different names*

#### Python bytecode

```diff
@@ -1,9 +1,9 @@
 magic:    0xa70d0d0a
-moddate:  0xdc770866 (Sat Mar 30 20:36:44 2024 UTC)
+moddate:  0xf57e0a66 (Mon Apr  1 09:31:33 2024 UTC)
 files sz: 13674
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 13
    flags     : 0
    code
```

### Comparing `sae-vis-0.2.7/sae_vis/__pycache__/model_fns.cpython-311.pyc` & `sae-vis-0.2.8/sae_vis/__pycache__/model_fns.cpython-311.pyc`

 * *Files 2% similar despite different names*

#### Python bytecode

```diff
@@ -1,10 +1,10 @@
 magic:    0xa70d0d0a
-moddate:  0xc0e70766 (Sat Mar 30 10:21:52 2024 UTC)
-files sz: 8845
+moddate:  0x21880a66 (Mon Apr  1 10:10:41 2024 UTC)
+files sz: 8967
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 5
    flags     : 0
    code
       0x9700640064016c005a00640064026c006d015a010100640064016c025a
@@ -148,24 +148,24 @@
                278 LOAD_CONST              14 ('TransformerLensWrapper')
                280 LOAD_NAME                4 (nn)
                282 LOAD_ATTR               29 (Module)
                292 PRECALL                  3
                296 CALL                     3
                306 STORE_NAME              31 (TransformerLensWrapper)
    
-   211         308 LOAD_CONST              15 ('dir')
+   214         308 LOAD_CONST              15 ('dir')
                310 LOAD_NAME               11 (Float)
                312 LOAD_NAME                1 (Tensor)
                314 LOAD_CONST              16 ('feats d_in')
                316 BUILD_TUPLE              2
                318 BINARY_SUBSCR
                328 LOAD_CONST              17 ('model')
                330 LOAD_NAME               31 (TransformerLensWrapper)
                332 BUILD_TUPLE              4
-               334 LOAD_CONST              18 (<code object to_resid_dir, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 211>)
+               334 LOAD_CONST              18 (<code object to_resid_dir, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 214>)
                336 MAKE_FUNCTION            4 (annotations)
                338 STORE_NAME              32 (to_resid_dir)
                340 LOAD_CONST               1 (None)
                342 RETURN_VALUE
    consts
       0
       None
@@ -1185,53 +1185,53 @@
          164         192 LOAD_NAME               13 (bool)
          
          161         194 BUILD_TUPLE              4
                      196 LOAD_CONST              13 (<code object forward, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 161>)
                      198 MAKE_FUNCTION            5 (defaults, annotations)
                      200 STORE_NAME              11 (forward)
          
-         194         202 LOAD_CONST              14 ('activation')
+         197         202 LOAD_CONST              14 ('activation')
                      204 LOAD_NAME               14 (torch)
                      206 LOAD_ATTR                8 (Tensor)
                      216 LOAD_CONST              15 ('hook')
                      218 LOAD_NAME               15 (HookPoint)
                      220 BUILD_TUPLE              4
-                     222 LOAD_CONST              16 (<code object hook_fn_store_act, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 194>)
+                     222 LOAD_CONST              16 (<code object hook_fn_store_act, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 197>)
                      224 MAKE_FUNCTION            4 (annotations)
                      226 STORE_NAME              16 (hook_fn_store_act)
          
-         197         228 LOAD_NAME               17 (property)
+         200         228 LOAD_NAME               17 (property)
          
-         198         230 LOAD_CONST              17 (<code object tokenizer, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 197>)
+         201         230 LOAD_CONST              17 (<code object tokenizer, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 200>)
                      232 MAKE_FUNCTION            0
          
-         197         234 PRECALL                  0
+         200         234 PRECALL                  0
                      238 CALL                     0
          
-         198         248 STORE_NAME              18 (tokenizer)
+         201         248 STORE_NAME              18 (tokenizer)
          
-         201         250 LOAD_NAME               17 (property)
+         204         250 LOAD_NAME               17 (property)
          
-         202         252 LOAD_CONST              18 (<code object W_U, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 201>)
+         205         252 LOAD_CONST              18 (<code object W_U, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 204>)
                      254 MAKE_FUNCTION            0
          
-         201         256 PRECALL                  0
+         204         256 PRECALL                  0
                      260 CALL                     0
          
-         202         270 STORE_NAME              19 (W_U)
+         205         270 STORE_NAME              19 (W_U)
          
-         205         272 LOAD_NAME               17 (property)
+         208         272 LOAD_NAME               17 (property)
          
-         206         274 LOAD_CONST              19 (<code object W_out, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 205>)
+         209         274 LOAD_CONST              19 (<code object W_out, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\model_fns.py", line 208>)
                      276 MAKE_FUNCTION            0
          
-         205         278 PRECALL                  0
+         208         278 PRECALL                  0
                      282 CALL                     0
          
-         206         292 STORE_NAME              20 (W_out)
+         209         292 STORE_NAME              20 (W_out)
                      294 LOAD_CLOSURE             0 (__class__)
                      296 COPY                     1
                      298 STORE_NAME              21 (__classcell__)
                      300 RETURN_VALUE
          consts
             'TransformerLensWrapper'
             '\n    This class wraps around & extends the TransformerLens model, so that we can make sure things like the forward\n    function have a standardized signature.\n    '
@@ -1439,19 +1439,20 @@
                code
                   0x97007c006a000000000000000000a00100000000000000000000000000
                   000000000000007c017c006a0200000000000000007c006a030000000000
                   00000066027c006a0400000000000000007c006a03000000000000000066
                   026702ac01a6020000ab0200000000000000007d037c006a000000000000
                   0000006a0500000000000000007c006a0200000000000000001900000000
                   00000000006a060000000000000000a00700000000000000000000000000
-                  000000000000006402a6010000ab0100000000000000007d047c006a0000
-                  000000000000006a0500000000000000007c006a04000000000000000019
-                  0000000000000000006a060000000000000000a007000000000000000000
-                  00000000000000000000006402a6010000ab0100000000000000007d057c
-                  0272057c037c057c04660353007c057c0466025300
+                  000000000000006402a6010000ab0100000000000000007d047c006a0400
+                  000000000000007c006a0200000000000000006b020000000072037c047d
+                  056e2f7c006a0000000000000000006a0500000000000000007c006a0400
+                  00000000000000190000000000000000006a060000000000000000a00700
+                  000000000000000000000000000000000000006402a6010000ab01000000
+                  00000000007d057c0272057c037c057c04660353007c057c0466025300
                161           0 RESUME                   0
                
                177           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (model)
                             14 LOAD_METHOD              1 (run_with_hooks)
                
                178          36 LOAD_FAST                1 (tokens)
@@ -1485,62 +1486,73 @@
                            164 LOAD_METHOD              7 (pop)
                            186 LOAD_CONST               2 ('activation')
                            188 PRECALL                  1
                            192 CALL                     1
                            202 STORE_FAST               4 (activation)
                
                188         204 LOAD_FAST                0 (self)
-                           206 LOAD_ATTR                0 (model)
-                           216 LOAD_ATTR                5 (hook_dict)
-                           226 LOAD_FAST                0 (self)
-                           228 LOAD_ATTR                4 (hook_point_resid_final)
-                           238 BINARY_SUBSCR
-                           248 LOAD_ATTR                6 (ctx)
-                           258 LOAD_METHOD              7 (pop)
-                           280 LOAD_CONST               2 ('activation')
-                           282 PRECALL                  1
-                           286 CALL                     1
-                           296 STORE_FAST               5 (residual)
-               
-               190         298 LOAD_FAST                2 (return_logits)
-                           300 POP_JUMP_FORWARD_IF_FALSE     5 (to 312)
-               
-               191         302 LOAD_FAST                3 (output)
-                           304 LOAD_FAST                5 (residual)
-                           306 LOAD_FAST                4 (activation)
-                           308 BUILD_TUPLE              3
-                           310 RETURN_VALUE
-               
-               192     >>  312 LOAD_FAST                5 (residual)
-                           314 LOAD_FAST                4 (activation)
-                           316 BUILD_TUPLE              2
-                           318 RETURN_VALUE
+                           206 LOAD_ATTR                4 (hook_point_resid_final)
+                           216 LOAD_FAST                0 (self)
+                           218 LOAD_ATTR                2 (hook_point)
+                           228 COMPARE_OP               2 (==)
+                           234 POP_JUMP_FORWARD_IF_FALSE     3 (to 242)
+               
+               189         236 LOAD_FAST                4 (activation)
+                           238 STORE_FAST               5 (residual)
+                           240 JUMP_FORWARD            47 (to 336)
+               
+               191     >>  242 LOAD_FAST                0 (self)
+                           244 LOAD_ATTR                0 (model)
+                           254 LOAD_ATTR                5 (hook_dict)
+                           264 LOAD_FAST                0 (self)
+                           266 LOAD_ATTR                4 (hook_point_resid_final)
+                           276 BINARY_SUBSCR
+                           286 LOAD_ATTR                6 (ctx)
+                           296 LOAD_METHOD              7 (pop)
+                           318 LOAD_CONST               2 ('activation')
+                           320 PRECALL                  1
+                           324 CALL                     1
+                           334 STORE_FAST               5 (residual)
+               
+               193     >>  336 LOAD_FAST                2 (return_logits)
+                           338 POP_JUMP_FORWARD_IF_FALSE     5 (to 350)
+               
+               194         340 LOAD_FAST                3 (output)
+                           342 LOAD_FAST                5 (residual)
+                           344 LOAD_FAST                4 (activation)
+                           346 BUILD_TUPLE              3
+                           348 RETURN_VALUE
+               
+               195     >>  350 LOAD_FAST                5 (residual)
+                           352 LOAD_FAST                4 (activation)
+                           354 BUILD_TUPLE              2
+                           356 RETURN_VALUE
                consts
                   '\n        Inputs:\n            tokens: Int[Tensor, "batch seq"]\n                The input tokens, shape (batch, seq)\n            return_logits: bool\n                If True, returns (logits, residual, activation)\n                If False, returns (residual, activation)\n        '
                   ('fwd_hooks',)
                   'activation'
                names      ('model', 'run_with_hooks', 'hook_point', 'hook_fn_store_act', 'hook_point_resid_final', 'hook_dict', 'ctx', 'pop')
                varnames   ('self', 'tokens', 'return_logits', 'output', 'activation', 'residual')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
                name       'forward'
                firstlineno 161
-               lnotab 0x0210220102031a011afe02fd120a5e015e0204010a01
+               lnotab 0x0210220102031a011afe02fd120a5e01200106025e0204010a01
             'activation'
             'hook'
             code
                argcount  : 3
                nlocals   : 3
                stacksize : 3
                flags     : 3
                code 0x97007c017c026a00000000000000000064013c00000064005300
-               194           0 RESUME                   0
+               197           0 RESUME                   0
                
-               195           2 LOAD_FAST                1 (activation)
+               198           2 LOAD_FAST                1 (activation)
                              4 LOAD_FAST                2 (hook)
                              6 LOAD_ATTR                0 (ctx)
                             16 LOAD_CONST               1 ('activation')
                             18 STORE_SUBSCR
                             22 LOAD_CONST               0 (None)
                             24 RETURN_VALUE
                consts
@@ -1548,93 +1560,93 @@
                   'activation'
                names      ('ctx',)
                varnames   ('self', 'activation', 'hook')
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
                name       'hook_fn_store_act'
-               firstlineno 194
+               firstlineno 197
                lnotab 0x0201
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007c006a0000000000000000006a0100000000000000005300
-               197           0 RESUME                   0
+               200           0 RESUME                   0
                
-               199           2 LOAD_FAST                0 (self)
+               202           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (model)
                             14 LOAD_ATTR                1 (tokenizer)
                             24 RETURN_VALUE
                consts
                   None
                names      ('model', 'tokenizer')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
                name       'tokenizer'
-               firstlineno 197
+               firstlineno 200
                lnotab 0x0202
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007c006a0000000000000000006a0100000000000000005300
-               201           0 RESUME                   0
+               204           0 RESUME                   0
                
-               203           2 LOAD_FAST                0 (self)
+               206           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (model)
                             14 LOAD_ATTR                1 (W_U)
                             24 RETURN_VALUE
                consts
                   None
                names      ('model', 'W_U')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
                name       'W_U'
-               firstlineno 201
+               firstlineno 204
                lnotab 0x0202
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
                flags     : 3
                code 0x97007c006a0000000000000000006a0100000000000000005300
-               205           0 RESUME                   0
+               208           0 RESUME                   0
                
-               207           2 LOAD_FAST                0 (self)
+               210           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (model)
                             14 LOAD_ATTR                1 (W_out)
                             24 RETURN_VALUE
                consts
                   None
                names      ('model', 'W_out')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
                filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
                name       'W_out'
-               firstlineno 205
+               firstlineno 208
                lnotab 0x0202
             (True,)
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'HookedTransformer', 'str', '__init__', 'overload', 'Tensor', 'Literal', 'tuple', 'forward', 'Int', 'bool', 'torch', 'HookPoint', 'hook_fn_store_act', 'property', 'tokenizer', 'W_U', 'W_out', '__classcell__')
          varnames   ()
          freevars   ()
          cellvars   ('__class__',)
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
          name       'TransformerLensWrapper'
          firstlineno 123
          lnotab
             0x0c01040414110201020202fe02030efd020414fc06ff0e010207020102
-            0202fe02030efd020412fc06ff0e01020a02fd040212fe020302fd08211a
+            0202fe02030efd020412fc06ff0e01020a02fd040212fe020302fd08241a
             03020104ff0e010203020104ff0e010203020104ff0e01
       'TransformerLensWrapper'
       'dir'
       'feats d_in'
       'model'
       code
          argcount  : 2
@@ -1644,51 +1656,51 @@
          code
             0x970064017c016a0000000000000000007600730964027c016a00000000
             0000000000760072027c00530064037c016a000000000000000000760073
             0964047c016a000000000000000000760072157c007c016a010000000000
             0000007c016a020000000000000000190000000000000000007a04000053
             007407000000000000000000006405a6010000ab01000000000000000082
             01
-         211           0 RESUME                   0
+         214           0 RESUME                   0
          
-         222           2 LOAD_CONST               1 ('resid')
+         225           2 LOAD_CONST               1 ('resid')
                        4 LOAD_FAST                1 (model)
                        6 LOAD_ATTR                0 (hook_point)
                       16 CONTAINS_OP              0
                       18 POP_JUMP_FORWARD_IF_TRUE     9 (to 38)
                       20 LOAD_CONST               2 ('_out')
                       22 LOAD_FAST                1 (model)
                       24 LOAD_ATTR                0 (hook_point)
                       34 CONTAINS_OP              0
                       36 POP_JUMP_FORWARD_IF_FALSE     2 (to 42)
          
-         223     >>   38 LOAD_FAST                0 (dir)
+         226     >>   38 LOAD_FAST                0 (dir)
                       40 RETURN_VALUE
          
-         226     >>   42 LOAD_CONST               3 ('pre')
+         229     >>   42 LOAD_CONST               3 ('pre')
                       44 LOAD_FAST                1 (model)
                       46 LOAD_ATTR                0 (hook_point)
                       56 CONTAINS_OP              0
                       58 POP_JUMP_FORWARD_IF_TRUE     9 (to 78)
                       60 LOAD_CONST               4 ('post')
                       62 LOAD_FAST                1 (model)
                       64 LOAD_ATTR                0 (hook_point)
                       74 CONTAINS_OP              0
                       76 POP_JUMP_FORWARD_IF_FALSE    21 (to 120)
          
-         227     >>   78 LOAD_FAST                0 (dir)
+         230     >>   78 LOAD_FAST                0 (dir)
                       80 LOAD_FAST                1 (model)
                       82 LOAD_ATTR                1 (W_out)
                       92 LOAD_FAST                1 (model)
                       94 LOAD_ATTR                2 (hook_layer)
                      104 BINARY_SUBSCR
                      114 BINARY_OP                4 (@)
                      118 RETURN_VALUE
          
-         231     >>  120 LOAD_GLOBAL              7 (NULL + NotImplementedError)
+         234     >>  120 LOAD_GLOBAL              7 (NULL + NotImplementedError)
                      132 LOAD_CONST               5 ("The hook your SAE was trained on isn't yet supported")
                      134 PRECALL                  1
                      138 CALL                     1
                      148 RAISE_VARARGS            1
          consts
             '\n    Takes a direction (eg. in the post-ReLU MLP activations) and returns the corresponding dir in the residual stream.\n\n    Args:\n        dir: \n            The direction in the activations, i.e. shape (feats, d_in) where d_in could be d_model, d_mlp, etc.\n        model:\n            The model, which should be a HookedTransformerWrapper or similar.\n    '
             'resid'
@@ -1698,19 +1710,19 @@
             "The hook your SAE was trained on isn't yet supported"
          names      ('hook_point', 'W_out', 'hook_layer', 'NotImplementedError')
          varnames   ('dir', 'model')
          freevars   ()
          cellvars   ()
          filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
          name       'to_resid_dir'
-         firstlineno 211
+         firstlineno 214
          lnotab 0x020b2401040324012a04
    names      ('torch', 'Tensor', 'pprint', 'torch.nn', 'nn', 'torch.nn.functional', 'functional', 'F', 'dataclasses', 'dataclass', 'jaxtyping', 'Float', 'Int', 'Bool', 'transformer_lens', 'utils', 'HookedTransformer', 'transformer_lens.hook_points', 'HookPoint', 'typing', 'overload', 'Tuple', 'Literal', 're', 'float32', 'float16', 'bfloat16', 'DTYPES', 'AutoEncoderConfig', 'Module', 'AutoEncoder', 'TransformerLensWrapper', 'to_resid_dir')
    varnames   ()
    freevars   ()
    cellvars   ()
    filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\model_fns.py'
    name       '<module>'
    firstlineno 1
    lnotab
       0x00ff020108010c0108010c0112010c01140110010c01140108032a0202
-      0118ff0e01021d264d2658
+      0118ff0e01021d264d265b
```

### Comparing `sae-vis-0.2.7/sae_vis/__pycache__/utils_fns.cpython-311.pyc` & `sae-vis-0.2.8/sae_vis/__pycache__/utils_fns.cpython-311.pyc`

 * *Files 7% similar despite different names*

#### Python bytecode

```diff
@@ -1,10 +1,10 @@
 magic:    0xa70d0d0a
-moddate:  0xa77e0966 (Sun Mar 31 15:17:59 2024 UTC)
-files sz: 34980
+moddate:  0xe86c1166 (Sat Apr  6 15:40:24 2024 UTC)
+files sz: 36140
 code
    argcount  : 0
    nlocals   : 0
    stacksize : 13
    flags     : 0
    code
       0x9700640064016c006d015a016d025a026d035a030100640064026c046d
@@ -12,97 +12,97 @@
       0c6d0d5a0d6d0e5a0e6d0f5a0f0100640064036c105a10640064036c115a
       11640064046c116d125a120100640064036c135a14640064056c156d165a
       160100640064066c176d175a170100640064076c186d195a196d1a5a1a01
       00640064086c1b6d1c5a1c0100640064036c1d5a1d640064096c1e6d1e5a
       1e0100640064036c1f5a1f640064036c205a206400640a6c216d225a2201
       000200650f640ba6010000ab0100000000000000005a23640c65116a2400
       000000000000006602640d84045a2565146a2600000000000000005a2765
-      28640e6b02000000005a296487640f652a64106506652b19000000000000
-      0000006604641184055a2c09000900648864146501651264156602190000
+      28640e6b02000000005a296489640f652a64106506652b19000000000000
+      0000006604641184055a2c09000900648a64146501651264156602190000
       000000000000006416652d6417652a64186505652d652d66021900000000
       0000000000640c650265126419660219000000000000000000660a641a84
       055a2e641b652d641c652d640c65026512641c6602190000000000000000
-      006606641d84045a2f09006489641465016512641e660219000000000000
+      006606641d84045a2f0900648b641465016512641e660219000000000000
       0000006416652d641f650565306530660219000000000000000000641865
       05652d652d660219000000000000000000640c6502651264196602190000
-      00000000000000660a642084055a31648a6422652a640c650d652d653265
+      00000000000000660a642084055a31648c6422652a640c650d652d653265
       2d190000000000000000007a0700006701652b6532652b19000000000000
       0000007a0700006602190000000000000000006604642384055a33642464
       256426642764286429642a642b642c642d9c095a34642e642f6430643164
-      329c045a356433643464359c025a3669006534a5016536a5016436642f69
-      01a5015a37648b6437652b6422652a640c652b6606643884055a38643765
-      2b640c652b6604643984045a39650c643a650d652d6532652d1900000000
-      00000000007a0700006701652b6532652b190000000000000000007a0700
-      00660219000000000000000000643b652d640c652b6606643c8404a60000
-      00ab0000000000000000005a3a650c643a650d652d6532652d1900000000
-      00000000007a0700006701652b6532652b190000000000000000007a0700
-      00660219000000000000000000643b6509652d1900000000000000000064
-      0c6509652b190000000000000000006606643d8404a6000000ab00000000
-      00000000005a3a643a650d652d6532652d190000000000000000007a0700
-      006701652b6532652b190000000000000000007a07000066021900000000
-      0000000000643b6507652d6509652d1900000000000000000065116a1200
-      00000000000000660319000000000000000000640c652b650b7a07000066
-      06643e84045a3a02004700643f84006440a6020000ab0200000000000000
-      005a3b644184005a3c6442652b640c6505652b652b660219000000000000
-      0000006604644384045a3d0900648c641465096530190000000000000000
-      006445652d6446650a644719000000000000000000640c65096530190000
-      000000000000006608644884055a3e6449644a6702644b6702644a644c67
-      02644d6702644c644e6702644f6702644e64506702644d67026450645167
-      02644b670267055a3f6449644e6702644f6702644e64506702644d670264
-      5064516702644b670267035a40651c651902004700645284006453a60200
-      00ab020000000000000000a6000000ab000000000000000000a6000000ab
-      0000000000000000005a416529900172ae02006525a6000000ab00000000
-      00000000005a2464545a42020065116a430000000000000000020065116a
-      4400000000000000006542a6010000ab010000000000000000a045000000
-      0000000000000000000000000000000000020065116a4400000000000000
-      006542a6010000ab01000000000000000064556b00000000006449a60200
-      00ab020000000000000000020065116a4400000000000000006542a60100
-      00ab0100000000000000006702a6010000ab010000000000000000a04600
-      000000000000000000000000000000000000006524a6010000ab01000000
-      00000000005a476541a04800000000000000000000000000000000000000
-      006547a6010000ab0100000000000000005a490200654a64560200654b64
-      57840065496a4c00000000000000004400a6000000ab0000000000000000
-      00a6010000ab01000000000000000064589b049d02a6010000ab01000000
-      000000000001000200654a64596547a04d00000000000000000000000000
-      00000000000000a6000000ab00000000000000000064589b04645a9d03a6
-      010000ab0100000000000000000100020065116a4e000000000000000067
-      00645ba2016700645ca2016702a6010000ab010000000000000000a04600
-      000000000000000000000000000000000000006524a6010000ab01000000
-      00000000005a4f6549a05000000000000000000000000000000000000000
-      00654fa6010000ab0100000000000000005c0200005a515a520200654a64
-      5da6010000ab010000000000000000010002006553654f64001900000000
-      000000000065516400190000000000000000006552640019000000000000
-      000000a6030000ab03000000000000000044005d235c0300005a545a555a
-      560200654a645e6554645f9b04646065569b00646165556462655664637a
-      0a00009b0064649d039b049d06a6010000ab01000000000000000001008c
-      240200654a6465a6010000ab010000000000000000010002006553654f64
-      661900000000000000000065516466190000000000000000006552646619
-      000000000000000000a6030000ab03000000000000000044005d235c0300
-      005a545a555a560200654a645e6554645f9b04646065569b006461655564
-      62655664637a0a00009b0064649d039b049d06a6010000ab010000000000
-      00000001008c246467652b6468652b6469652b640c6557652b652b660219
-      0000000000000000006608646a84045a5865297238646b5a59646c5a5a64
-      6d5a5b0200654a020065586559655a655ba6030000ab0300000000000000
-      00a6010000ab0100000000000000000100646e5a59646f5a5a64705a5b02
-      00654a020065586559655a655ba6030000ab030000000000000000a60100
-      00ab01000000000000000001000900648a6471652b6472652b6473652a64
-      0c652b6608647484055a5c648d6476655d6477655d6478652b640c655d66
-      08647984055a5e652972830200655e646664636901644f644d6901a60200
-      00ab0200000000000000006463644d647a9c026b020000000073024a0082
-      010200655e64666463644f644d6702690169016466644f644f644d670269
-      016901a6020000ab0200000000000000006466644f644d6702644f644d67
-      02647b9c0269016b020000000073024a0082010200655e6414647c647d64
-      666901690169016414647c647e6463690169016901a6020000ab02000000
-      00000000006414647c64666463647f9c02690169016b020000000073024a
-      0082010200655e641464666463670269016414644f644d67026901a60200
-      00ab020000000000000000641467006480a20169016b020000000073024a
-      00820102004700648184006482a6020000ab0200000000000000005a5f65
-      1c651902004700648384006484a6020000ab020000000000000000a60000
-      00ab000000000000000000a6000000ab0000000000000000005a60648a64
-      85652a640c6530652d7a0700006604648684055a6164035300
+      32643364349c065a356435643664379c025a3669006534a5016536a50164
+      3864316901a5015a37648d6439652b6422652a640c652b6606643a84055a
+      386439652b640c652b6604643b84045a39650c643c650d652d6532652d19
+      0000000000000000007a0700006701652b6532652b190000000000000000
+      007a070000660219000000000000000000643d652d640c652b6606643e84
+      04a6000000ab0000000000000000005a3a650c643c650d652d6532652d19
+      0000000000000000007a0700006701652b6532652b190000000000000000
+      007a070000660219000000000000000000643d6509652d19000000000000
+      000000640c6509652b190000000000000000006606643f8404a6000000ab
+      0000000000000000005a3a643c650d652d6532652d190000000000000000
+      007a0700006701652b6532652b190000000000000000007a070000660219
+      000000000000000000643d6507652d6509652d1900000000000000000065
+      116a120000000000000000660319000000000000000000640c652b650b7a
+      0700006606644084045a3a02004700644184006442a6020000ab02000000
+      00000000005a3b644384005a3c6444652b640c6505652b652b6602190000
+      000000000000006604644584045a3d0900648e6414650965301900000000
+      00000000006447652d6448650a644919000000000000000000640c650965
+      30190000000000000000006608644a84055a3e644b644c6702644d670264
+      4c644e6702644f6702644e6450670264516702645064526702644f670264
+      5264536702644d670267055a3f644b645067026451670264506452670264
+      4f6702645264536702644d670267035a40651c6519020047006454840064
+      55a6020000ab020000000000000000a6000000ab000000000000000000a6
+      000000ab0000000000000000005a416529900172ae02006525a6000000ab
+      0000000000000000005a2464565a42020065116a43000000000000000002
+      0065116a4400000000000000006542a6010000ab010000000000000000a0
+      450000000000000000000000000000000000000000020065116a44000000
+      00000000006542a6010000ab01000000000000000064576b000000000064
+      4ba6020000ab020000000000000000020065116a44000000000000000065
+      42a6010000ab0100000000000000006702a6010000ab0100000000000000
+      00a04600000000000000000000000000000000000000006524a6010000ab
+      0100000000000000005a476541a048000000000000000000000000000000
+      00000000006547a6010000ab0100000000000000005a490200654a645802
+      00654b6459840065496a4c00000000000000004400a6000000ab00000000
+      0000000000a6010000ab010000000000000000645a9b049d02a6010000ab
+      01000000000000000001000200654a645b6547a04d000000000000000000
+      0000000000000000000000a6000000ab000000000000000000645a9b0464
+      5c9d03a6010000ab0100000000000000000100020065116a4e0000000000
+      0000006700645da2016700645ea2016702a6010000ab0100000000000000
+      00a04600000000000000000000000000000000000000006524a6010000ab
+      0100000000000000005a4f6549a050000000000000000000000000000000
+      0000000000654fa6010000ab0100000000000000005c0200005a515a5202
+      00654a645fa6010000ab010000000000000000010002006553654f640019
+      000000000000000000655164001900000000000000000065526400190000
+      00000000000000a6030000ab03000000000000000044005d235c0300005a
+      545a555a560200654a6460655464619b04646265569b0064636555646465
+      5664657a0a00009b0064669d039b049d06a6010000ab0100000000000000
+      0001008c240200654a6467a6010000ab0100000000000000000100020065
+      53654f646819000000000000000000655164681900000000000000000065
+      52646819000000000000000000a6030000ab03000000000000000044005d
+      235c0300005a545a555a560200654a6460655464619b04646265569b0064
+      6365556464655664657a0a00009b0064669d039b049d06a6010000ab0100
+      0000000000000001008c246469652b646a652b646b652b640c6557652b65
+      2b6602190000000000000000006608646c84045a5865297238646d5a5964
+      6e5a5a646f5a5b0200654a020065586559655a655ba6030000ab03000000
+      0000000000a6010000ab010000000000000000010064705a5964715a5a64
+      725a5b0200654a020065586559655a655ba6030000ab0300000000000000
+      00a6010000ab01000000000000000001000900648c6473652b6474652b64
+      75652a640c652b6608647684055a5c648f6478655d6479655d647a652b64
+      0c655d6608647b84055a5e652972830200655e6468646569016451644f69
+      01a6020000ab0200000000000000006465644f647c9c026b020000000073
+      024a0082010200655e646864656451644f67026901690164686451645164
+      4f670269016901a6020000ab02000000000000000064686451644f670264
+      51644f6702647d9c0269016b020000000073024a0082010200655e641464
+      7e647f64686901690169016414647e64806465690169016901a6020000ab
+      0200000000000000006414647e6468646564819c02690169016b02000000
+      0073024a0082010200655e6414646864656702690164146451644f670269
+      01a6020000ab020000000000000000641467006482a20169016b02000000
+      0073024a00820102004700648384006484a6020000ab0200000000000000
+      005a5f651c651902004700648584006486a6020000ab0200000000000000
+      00a6000000ab000000000000000000a6000000ab0000000000000000005a
+      60648c6487652a640c6530652d7a0700006604648884055a6164035300
      0           0 RESUME                   0
    
      3           2 LOAD_CONST               0 (0)
                  4 LOAD_CONST               1 (('Float', 'Int', 'Bool'))
                  6 IMPORT_NAME              0 (jaxtyping)
                  8 IMPORT_FROM              1 (Float)
                 10 STORE_NAME               1 (Float)
@@ -227,44 +227,44 @@
                220 CALL                     1
                230 STORE_NAME              35 (T)
    
     27         232 LOAD_CONST              12 ('return')
                234 LOAD_NAME               17 (torch)
                236 LOAD_ATTR               36 (device)
                246 BUILD_TUPLE              2
-               248 LOAD_CONST              13 (<code object get_device, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 27>)
+               248 LOAD_CONST              13 (<code object get_device, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 27>)
                250 MAKE_FUNCTION            4 (annotations)
                252 STORE_NAME              37 (get_device)
    
     42         254 LOAD_NAME               20 (np)
                256 LOAD_ATTR               38 (ndarray)
                266 STORE_NAME              39 (Arr)
    
     44         268 LOAD_NAME               40 (__name__)
                270 LOAD_CONST              14 ('__main__')
                272 COMPARE_OP               2 (==)
                278 STORE_NAME              41 (MAIN)
    
-    48         280 LOAD_CONST             135 ((None,))
+    48         280 LOAD_CONST             137 ((None,))
                282 LOAD_CONST              15 ('verbose')
                284 LOAD_NAME               42 (bool)
                286 LOAD_CONST              16 ('desc')
                288 LOAD_NAME                6 (Optional)
                290 LOAD_NAME               43 (str)
                292 BINARY_SUBSCR
                302 BUILD_TUPLE              4
-               304 LOAD_CONST              17 (<code object create_iterator, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 48>)
+               304 LOAD_CONST              17 (<code object create_iterator, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 48>)
                306 MAKE_FUNCTION            5 (defaults, annotations)
                308 STORE_NAME              44 (create_iterator)
    
     59         310 NOP
    
     60         312 NOP
    
-    56         314 LOAD_CONST             136 ((True, (5, -5)))
+    56         314 LOAD_CONST             138 ((True, (5, -5)))
                316 LOAD_CONST              20 ('x')
    
     57         318 LOAD_NAME                1 (Float)
                320 LOAD_NAME               18 (Tensor)
                322 LOAD_CONST              21 ('rows cols')
                324 BUILD_TUPLE              2
                326 BINARY_SUBSCR
@@ -290,36 +290,36 @@
     61         366 LOAD_NAME                2 (Int)
                368 LOAD_NAME               18 (Tensor)
                370 LOAD_CONST              25 ('k 2')
                372 BUILD_TUPLE              2
                374 BINARY_SUBSCR
    
     56         384 BUILD_TUPLE             10
-               386 LOAD_CONST              26 (<code object k_largest_indices, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 56>)
+               386 LOAD_CONST              26 (<code object k_largest_indices, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 56>)
                388 MAKE_FUNCTION            5 (defaults, annotations)
                390 STORE_NAME              46 (k_largest_indices)
    
     86         392 LOAD_CONST              27 ('large_number')
                394 LOAD_NAME               45 (int)
                396 LOAD_CONST              28 ('small_number')
                398 LOAD_NAME               45 (int)
                400 LOAD_CONST              12 ('return')
                402 LOAD_NAME                2 (Int)
                404 LOAD_NAME               18 (Tensor)
                406 LOAD_CONST              28 ('small_number')
                408 BUILD_TUPLE              2
                410 BINARY_SUBSCR
                420 BUILD_TUPLE              6
-               422 LOAD_CONST              29 (<code object sample_unique_indices, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 86>)
+               422 LOAD_CONST              29 (<code object sample_unique_indices, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 86>)
                424 MAKE_FUNCTION            4 (annotations)
                426 STORE_NAME              47 (sample_unique_indices)
    
    102         428 NOP
    
-    98         430 LOAD_CONST             137 (((5, -5),))
+    98         430 LOAD_CONST             139 (((5, -5),))
                432 LOAD_CONST              20 ('x')
    
     99         434 LOAD_NAME                1 (Float)
                436 LOAD_NAME               18 (Tensor)
                438 LOAD_CONST              30 ('batch seq')
                440 BUILD_TUPLE              2
                442 BINARY_SUBSCR
@@ -349,19 +349,19 @@
    103         498 LOAD_NAME                2 (Int)
                500 LOAD_NAME               18 (Tensor)
                502 LOAD_CONST              25 ('k 2')
                504 BUILD_TUPLE              2
                506 BINARY_SUBSCR
    
     98         516 BUILD_TUPLE             10
-               518 LOAD_CONST              32 (<code object random_range_indices, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 98>)
+               518 LOAD_CONST              32 (<code object random_range_indices, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 98>)
                520 MAKE_FUNCTION            5 (defaults, annotations)
                522 STORE_NAME              49 (random_range_indices)
    
-   157         524 LOAD_CONST             138 ((False,))
+   157         524 LOAD_CONST             140 ((False,))
                526 LOAD_CONST              34 ('html')
                528 LOAD_NAME               42 (bool)
                530 LOAD_CONST              12 ('return')
                532 LOAD_NAME               13 (Callable)
                534 LOAD_NAME               45 (int)
                536 LOAD_NAME               50 (list)
                538 LOAD_NAME               45 (int)
@@ -372,15 +372,15 @@
                558 LOAD_NAME               50 (list)
                560 LOAD_NAME               43 (str)
                562 BINARY_SUBSCR
                572 BINARY_OP                7 (|)
                576 BUILD_TUPLE              2
                578 BINARY_SUBSCR
                588 BUILD_TUPLE              4
-               590 LOAD_CONST              35 (<code object get_decode_html_safe_fn, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 157>)
+               590 LOAD_CONST              35 (<code object get_decode_html_safe_fn, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 157>)
                592 MAKE_FUNCTION            5 (defaults, annotations)
                594 STORE_NAME              51 (get_decode_html_safe_fn)
    
    185         596 LOAD_CONST              36 ('&bsol;')
    
    186         598 LOAD_CONST              37 ('&lt;')
    
@@ -398,812 +398,816 @@
    
    193         612 LOAD_CONST              44 ('&#125;')
    
    184         614 LOAD_CONST              45 (('\\', '<', '>', ')', '(', '[', ']', '{', '}'))
                616 BUILD_CONST_KEY_MAP      9
                618 STORE_NAME              52 (HTML_CHARS)
    
-   198         620 LOAD_CONST              46 ('&#8203;')
+   196         620 LOAD_CONST              46 ('&ndash;')
    
-   199         622 LOAD_CONST              47 ('&nbsp;')
+   197         622 LOAD_CONST              47 ('&rsquo;')
    
-   200         624 LOAD_CONST              48 ('&bsol;n')
+   198         624 LOAD_CONST              48 ('&#8203;')
    
-   201         626 LOAD_CONST              49 ('&bsol;t')
+   199         626 LOAD_CONST              49 ('&nbsp;')
    
-   195         628 LOAD_CONST              50 (('âĢĭ', 'Ġ', 'Ċ', 'ĉ'))
-               630 BUILD_CONST_KEY_MAP      4
-               632 STORE_NAME              53 (HTML_ANOMALIES)
+   200         628 LOAD_CONST              50 ('&bsol;n')
    
-   204         634 LOAD_CONST              51 ('&apos;')
+   201         630 LOAD_CONST              51 ('&bsol;t')
    
-   205         636 LOAD_CONST              52 ('&quot;')
+   195         632 LOAD_CONST              52 (('âĢĶ', 'âĢĻ', 'âĢĭ', 'Ġ', 'Ċ', 'ĉ'))
+               634 BUILD_CONST_KEY_MAP      6
+               636 STORE_NAME              53 (HTML_ANOMALIES)
    
-   203         638 LOAD_CONST              53 (("'", '"'))
-               640 BUILD_CONST_KEY_MAP      2
-               642 STORE_NAME              54 (HTML_QUOTES)
+   204         638 LOAD_CONST              53 ('&apos;')
    
-   207         644 BUILD_MAP                0
-               646 LOAD_NAME               52 (HTML_CHARS)
-               648 DICT_UPDATE              1
-               650 LOAD_NAME               54 (HTML_QUOTES)
+   205         640 LOAD_CONST              54 ('&quot;')
+   
+   203         642 LOAD_CONST              55 (("'", '"'))
+               644 BUILD_CONST_KEY_MAP      2
+               646 STORE_NAME              54 (HTML_QUOTES)
+   
+   207         648 BUILD_MAP                0
+               650 LOAD_NAME               52 (HTML_CHARS)
                652 DICT_UPDATE              1
-               654 LOAD_CONST              54 (' ')
-               656 LOAD_CONST              47 ('&nbsp;')
-               658 BUILD_MAP                1
-               660 DICT_UPDATE              1
-               662 STORE_NAME              55 (HTML_ALL)
-   
-   209         664 LOAD_CONST             139 ((True,))
-               666 LOAD_CONST              55 ('str_tok')
-               668 LOAD_NAME               43 (str)
-               670 LOAD_CONST              34 ('html')
-               672 LOAD_NAME               42 (bool)
-               674 LOAD_CONST              12 ('return')
-               676 LOAD_NAME               43 (str)
-               678 BUILD_TUPLE              6
-               680 LOAD_CONST              56 (<code object process_str_tok, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 209>)
-               682 MAKE_FUNCTION            5 (defaults, annotations)
-               684 STORE_NAME              56 (process_str_tok)
-   
-   238         686 LOAD_CONST              55 ('str_tok')
-               688 LOAD_NAME               43 (str)
-               690 LOAD_CONST              12 ('return')
+               654 LOAD_NAME               54 (HTML_QUOTES)
+               656 DICT_UPDATE              1
+               658 LOAD_CONST              56 (' ')
+               660 LOAD_CONST              49 ('&nbsp;')
+               662 BUILD_MAP                1
+               664 DICT_UPDATE              1
+               666 STORE_NAME              55 (HTML_ALL)
+   
+   209         668 LOAD_CONST             141 ((True,))
+               670 LOAD_CONST              57 ('str_tok')
+               672 LOAD_NAME               43 (str)
+               674 LOAD_CONST              34 ('html')
+               676 LOAD_NAME               42 (bool)
+               678 LOAD_CONST              12 ('return')
+               680 LOAD_NAME               43 (str)
+               682 BUILD_TUPLE              6
+               684 LOAD_CONST              58 (<code object process_str_tok, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 209>)
+               686 MAKE_FUNCTION            5 (defaults, annotations)
+               688 STORE_NAME              56 (process_str_tok)
+   
+   238         690 LOAD_CONST              57 ('str_tok')
                692 LOAD_NAME               43 (str)
-               694 BUILD_TUPLE              4
-               696 LOAD_CONST              57 (<code object unprocess_str_tok, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 238>)
-               698 MAKE_FUNCTION            4 (annotations)
-               700 STORE_NAME              57 (unprocess_str_tok)
-   
-   252         702 LOAD_NAME               12 (overload)
-   
-   253         704 LOAD_CONST              58 ('decode_fn')
-   
-   254         706 LOAD_NAME               13 (Callable)
-               708 LOAD_NAME               45 (int)
-               710 LOAD_NAME               50 (list)
+               694 LOAD_CONST              12 ('return')
+               696 LOAD_NAME               43 (str)
+               698 BUILD_TUPLE              4
+               700 LOAD_CONST              59 (<code object unprocess_str_tok, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 238>)
+               702 MAKE_FUNCTION            4 (annotations)
+               704 STORE_NAME              57 (unprocess_str_tok)
+   
+   252         706 LOAD_NAME               12 (overload)
+   
+   253         708 LOAD_CONST              60 ('decode_fn')
+   
+   254         710 LOAD_NAME               13 (Callable)
                712 LOAD_NAME               45 (int)
-               714 BINARY_SUBSCR
-               724 BINARY_OP                7 (|)
-               728 BUILD_LIST               1
-               730 LOAD_NAME               43 (str)
-               732 LOAD_NAME               50 (list)
+               714 LOAD_NAME               50 (list)
+               716 LOAD_NAME               45 (int)
+               718 BINARY_SUBSCR
+               728 BINARY_OP                7 (|)
+               732 BUILD_LIST               1
                734 LOAD_NAME               43 (str)
-               736 BINARY_SUBSCR
-               746 BINARY_OP                7 (|)
-               750 BUILD_TUPLE              2
-               752 BINARY_SUBSCR
+               736 LOAD_NAME               50 (list)
+               738 LOAD_NAME               43 (str)
+               740 BINARY_SUBSCR
+               750 BINARY_OP                7 (|)
+               754 BUILD_TUPLE              2
+               756 BINARY_SUBSCR
    
-   253         762 LOAD_CONST              59 ('tokens')
+   253         766 LOAD_CONST              61 ('tokens')
    
-   255         764 LOAD_NAME               45 (int)
+   255         768 LOAD_NAME               45 (int)
    
-   253         766 LOAD_CONST              12 ('return')
+   253         770 LOAD_CONST              12 ('return')
    
-   256         768 LOAD_NAME               43 (str)
+   256         772 LOAD_NAME               43 (str)
    
-   253         770 BUILD_TUPLE              6
-               772 LOAD_CONST              60 (<code object to_str_tokens, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 252>)
-               774 MAKE_FUNCTION            4 (annotations)
+   253         774 BUILD_TUPLE              6
+               776 LOAD_CONST              62 (<code object to_str_tokens, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 252>)
+               778 MAKE_FUNCTION            4 (annotations)
    
-   252         776 PRECALL                  0
-               780 CALL                     0
+   252         780 PRECALL                  0
+               784 CALL                     0
    
-   253         790 STORE_NAME              58 (to_str_tokens)
+   253         794 STORE_NAME              58 (to_str_tokens)
    
-   259         792 LOAD_NAME               12 (overload)
+   259         796 LOAD_NAME               12 (overload)
    
-   260         794 LOAD_CONST              58 ('decode_fn')
+   260         798 LOAD_CONST              60 ('decode_fn')
    
-   261         796 LOAD_NAME               13 (Callable)
-               798 LOAD_NAME               45 (int)
-               800 LOAD_NAME               50 (list)
+   261         800 LOAD_NAME               13 (Callable)
                802 LOAD_NAME               45 (int)
-               804 BINARY_SUBSCR
-               814 BINARY_OP                7 (|)
-               818 BUILD_LIST               1
-               820 LOAD_NAME               43 (str)
-               822 LOAD_NAME               50 (list)
+               804 LOAD_NAME               50 (list)
+               806 LOAD_NAME               45 (int)
+               808 BINARY_SUBSCR
+               818 BINARY_OP                7 (|)
+               822 BUILD_LIST               1
                824 LOAD_NAME               43 (str)
-               826 BINARY_SUBSCR
-               836 BINARY_OP                7 (|)
-               840 BUILD_TUPLE              2
-               842 BINARY_SUBSCR
+               826 LOAD_NAME               50 (list)
+               828 LOAD_NAME               43 (str)
+               830 BINARY_SUBSCR
+               840 BINARY_OP                7 (|)
+               844 BUILD_TUPLE              2
+               846 BINARY_SUBSCR
    
-   260         852 LOAD_CONST              59 ('tokens')
+   260         856 LOAD_CONST              61 ('tokens')
    
-   262         854 LOAD_NAME                9 (List)
-               856 LOAD_NAME               45 (int)
-               858 BINARY_SUBSCR
+   262         858 LOAD_NAME                9 (List)
+               860 LOAD_NAME               45 (int)
+               862 BINARY_SUBSCR
    
-   260         868 LOAD_CONST              12 ('return')
+   260         872 LOAD_CONST              12 ('return')
    
-   263         870 LOAD_NAME                9 (List)
-               872 LOAD_NAME               43 (str)
-               874 BINARY_SUBSCR
+   263         874 LOAD_NAME                9 (List)
+               876 LOAD_NAME               43 (str)
+               878 BINARY_SUBSCR
    
-   260         884 BUILD_TUPLE              6
-               886 LOAD_CONST              61 (<code object to_str_tokens, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 259>)
-               888 MAKE_FUNCTION            4 (annotations)
+   260         888 BUILD_TUPLE              6
+               890 LOAD_CONST              63 (<code object to_str_tokens, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 259>)
+               892 MAKE_FUNCTION            4 (annotations)
    
-   259         890 PRECALL                  0
-               894 CALL                     0
+   259         894 PRECALL                  0
+               898 CALL                     0
    
-   260         904 STORE_NAME              58 (to_str_tokens)
+   260         908 STORE_NAME              58 (to_str_tokens)
    
-   266         906 LOAD_CONST              58 ('decode_fn')
+   266         910 LOAD_CONST              60 ('decode_fn')
    
-   267         908 LOAD_NAME               13 (Callable)
-               910 LOAD_NAME               45 (int)
-               912 LOAD_NAME               50 (list)
+   267         912 LOAD_NAME               13 (Callable)
                914 LOAD_NAME               45 (int)
-               916 BINARY_SUBSCR
-               926 BINARY_OP                7 (|)
-               930 BUILD_LIST               1
-               932 LOAD_NAME               43 (str)
-               934 LOAD_NAME               50 (list)
+               916 LOAD_NAME               50 (list)
+               918 LOAD_NAME               45 (int)
+               920 BINARY_SUBSCR
+               930 BINARY_OP                7 (|)
+               934 BUILD_LIST               1
                936 LOAD_NAME               43 (str)
-               938 BINARY_SUBSCR
-               948 BINARY_OP                7 (|)
-               952 BUILD_TUPLE              2
-               954 BINARY_SUBSCR
-   
-   266         964 LOAD_CONST              59 ('tokens')
-   
-   268         966 LOAD_NAME                7 (Union)
-               968 LOAD_NAME               45 (int)
-               970 LOAD_NAME                9 (List)
+               938 LOAD_NAME               50 (list)
+               940 LOAD_NAME               43 (str)
+               942 BINARY_SUBSCR
+               952 BINARY_OP                7 (|)
+               956 BUILD_TUPLE              2
+               958 BINARY_SUBSCR
+   
+   266         968 LOAD_CONST              61 ('tokens')
+   
+   268         970 LOAD_NAME                7 (Union)
                972 LOAD_NAME               45 (int)
-               974 BINARY_SUBSCR
-               984 LOAD_NAME               17 (torch)
-               986 LOAD_ATTR               18 (Tensor)
-               996 BUILD_TUPLE              3
-               998 BINARY_SUBSCR
-   
-   266        1008 LOAD_CONST              12 ('return')
-   
-   269        1010 LOAD_NAME               43 (str)
-              1012 LOAD_NAME               11 (Any)
-              1014 BINARY_OP                7 (|)
-   
-   266        1018 BUILD_TUPLE              6
-              1020 LOAD_CONST              62 (<code object to_str_tokens, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 266>)
-              1022 MAKE_FUNCTION            4 (annotations)
-              1024 STORE_NAME              58 (to_str_tokens)
-   
-   290        1026 PUSH_NULL
-              1028 LOAD_BUILD_CLASS
-              1030 LOAD_CONST              63 (<code object TopK, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 290>)
-              1032 MAKE_FUNCTION            0
-              1034 LOAD_CONST              64 ('TopK')
-              1036 PRECALL                  2
-              1040 CALL                     2
-              1050 STORE_NAME              59 (TopK)
-   
-   366        1052 LOAD_CONST              65 (<code object merge_lists, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 366>)
-              1054 MAKE_FUNCTION            0
-              1056 STORE_NAME              60 (merge_lists)
-   
-   374        1058 LOAD_CONST              66 ('html_content')
-              1060 LOAD_NAME               43 (str)
-              1062 LOAD_CONST              12 ('return')
-              1064 LOAD_NAME                5 (Tuple)
-              1066 LOAD_NAME               43 (str)
-              1068 LOAD_NAME               43 (str)
-              1070 BUILD_TUPLE              2
-              1072 BINARY_SUBSCR
-              1082 BUILD_TUPLE              4
-              1084 LOAD_CONST              67 (<code object extract_and_remove_scripts, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 374>)
-              1086 MAKE_FUNCTION            4 (annotations)
-              1088 STORE_NAME              61 (extract_and_remove_scripts)
-   
-   398        1090 NOP
-   
-   395        1092 LOAD_CONST             140 (('left',))
-              1094 LOAD_CONST              20 ('x')
-   
-   396        1096 LOAD_NAME                9 (List)
-              1098 LOAD_NAME               48 (float)
-              1100 BINARY_SUBSCR
-   
-   395        1110 LOAD_CONST              69 ('n')
-   
-   397        1112 LOAD_NAME               45 (int)
-   
-   395        1114 LOAD_CONST              70 ('side')
-   
-   398        1116 LOAD_NAME               10 (Literal)
-              1118 LOAD_CONST              71 (('left', 'right'))
-              1120 BINARY_SUBSCR
-   
-   395        1130 LOAD_CONST              12 ('return')
-   
-   399        1132 LOAD_NAME                9 (List)
-              1134 LOAD_NAME               48 (float)
-              1136 BINARY_SUBSCR
-   
-   395        1146 BUILD_TUPLE              8
-              1148 LOAD_CONST              72 (<code object pad_with_zeros, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 395>)
-              1150 MAKE_FUNCTION            5 (defaults, annotations)
-              1152 STORE_NAME              62 (pad_with_zeros)
-   
-   417        1154 LOAD_CONST              73 (0.0)
-              1156 LOAD_CONST              74 (0.01)
-              1158 BUILD_LIST               2
-              1160 LOAD_CONST              75 (5)
+               974 LOAD_NAME                9 (List)
+               976 LOAD_NAME               45 (int)
+               978 BINARY_SUBSCR
+               988 LOAD_NAME               17 (torch)
+               990 LOAD_ATTR               18 (Tensor)
+              1000 BUILD_TUPLE              3
+              1002 BINARY_SUBSCR
+   
+   266        1012 LOAD_CONST              12 ('return')
+   
+   269        1014 LOAD_NAME               43 (str)
+              1016 LOAD_NAME               11 (Any)
+              1018 BINARY_OP                7 (|)
+   
+   266        1022 BUILD_TUPLE              6
+              1024 LOAD_CONST              64 (<code object to_str_tokens, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 266>)
+              1026 MAKE_FUNCTION            4 (annotations)
+              1028 STORE_NAME              58 (to_str_tokens)
+   
+   290        1030 PUSH_NULL
+              1032 LOAD_BUILD_CLASS
+              1034 LOAD_CONST              65 (<code object TopK, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 290>)
+              1036 MAKE_FUNCTION            0
+              1038 LOAD_CONST              66 ('TopK')
+              1040 PRECALL                  2
+              1044 CALL                     2
+              1054 STORE_NAME              59 (TopK)
+   
+   366        1056 LOAD_CONST              67 (<code object merge_lists, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 366>)
+              1058 MAKE_FUNCTION            0
+              1060 STORE_NAME              60 (merge_lists)
+   
+   374        1062 LOAD_CONST              68 ('html_content')
+              1064 LOAD_NAME               43 (str)
+              1066 LOAD_CONST              12 ('return')
+              1068 LOAD_NAME                5 (Tuple)
+              1070 LOAD_NAME               43 (str)
+              1072 LOAD_NAME               43 (str)
+              1074 BUILD_TUPLE              2
+              1076 BINARY_SUBSCR
+              1086 BUILD_TUPLE              4
+              1088 LOAD_CONST              69 (<code object extract_and_remove_scripts, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 374>)
+              1090 MAKE_FUNCTION            4 (annotations)
+              1092 STORE_NAME              61 (extract_and_remove_scripts)
+   
+   398        1094 NOP
+   
+   395        1096 LOAD_CONST             142 (('left',))
+              1098 LOAD_CONST              20 ('x')
+   
+   396        1100 LOAD_NAME                9 (List)
+              1102 LOAD_NAME               48 (float)
+              1104 BINARY_SUBSCR
+   
+   395        1114 LOAD_CONST              71 ('n')
+   
+   397        1116 LOAD_NAME               45 (int)
+   
+   395        1118 LOAD_CONST              72 ('side')
+   
+   398        1120 LOAD_NAME               10 (Literal)
+              1122 LOAD_CONST              73 (('left', 'right'))
+              1124 BINARY_SUBSCR
+   
+   395        1134 LOAD_CONST              12 ('return')
+   
+   399        1136 LOAD_NAME                9 (List)
+              1138 LOAD_NAME               48 (float)
+              1140 BINARY_SUBSCR
+   
+   395        1150 BUILD_TUPLE              8
+              1152 LOAD_CONST              74 (<code object pad_with_zeros, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 395>)
+              1154 MAKE_FUNCTION            5 (defaults, annotations)
+              1156 STORE_NAME              62 (pad_with_zeros)
+   
+   417        1158 LOAD_CONST              75 (0.0)
+              1160 LOAD_CONST              76 (0.01)
               1162 BUILD_LIST               2
+              1164 LOAD_CONST              77 (5)
+              1166 BUILD_LIST               2
    
-   418        1164 LOAD_CONST              74 (0.01)
-              1166 LOAD_CONST              76 (0.05)
-              1168 BUILD_LIST               2
-              1170 LOAD_CONST              77 (4)
+   418        1168 LOAD_CONST              76 (0.01)
+              1170 LOAD_CONST              78 (0.05)
               1172 BUILD_LIST               2
+              1174 LOAD_CONST              79 (4)
+              1176 BUILD_LIST               2
    
-   419        1174 LOAD_CONST              76 (0.05)
-              1176 LOAD_CONST              78 (0.95)
-              1178 BUILD_LIST               2
-              1180 LOAD_CONST              79 (3)
+   419        1178 LOAD_CONST              78 (0.05)
+              1180 LOAD_CONST              80 (0.95)
               1182 BUILD_LIST               2
+              1184 LOAD_CONST              81 (3)
+              1186 BUILD_LIST               2
    
-   420        1184 LOAD_CONST              78 (0.95)
-              1186 LOAD_CONST              80 (0.99)
-              1188 BUILD_LIST               2
-              1190 LOAD_CONST              77 (4)
+   420        1188 LOAD_CONST              80 (0.95)
+              1190 LOAD_CONST              82 (0.99)
               1192 BUILD_LIST               2
+              1194 LOAD_CONST              79 (4)
+              1196 BUILD_LIST               2
    
-   421        1194 LOAD_CONST              80 (0.99)
-              1196 LOAD_CONST              81 (1.0)
-              1198 BUILD_LIST               2
-              1200 LOAD_CONST              75 (5)
+   421        1198 LOAD_CONST              82 (0.99)
+              1200 LOAD_CONST              83 (1.0)
               1202 BUILD_LIST               2
+              1204 LOAD_CONST              77 (5)
+              1206 BUILD_LIST               2
    
-   416        1204 BUILD_LIST               5
-              1206 STORE_NAME              63 (SYMMETRIC_RANGES_AND_PRECISIONS)
+   416        1208 BUILD_LIST               5
+              1210 STORE_NAME              63 (SYMMETRIC_RANGES_AND_PRECISIONS)
    
-   424        1208 LOAD_CONST              73 (0.0)
-              1210 LOAD_CONST              78 (0.95)
-              1212 BUILD_LIST               2
-              1214 LOAD_CONST              79 (3)
+   424        1212 LOAD_CONST              75 (0.0)
+              1214 LOAD_CONST              80 (0.95)
               1216 BUILD_LIST               2
+              1218 LOAD_CONST              81 (3)
+              1220 BUILD_LIST               2
    
-   425        1218 LOAD_CONST              78 (0.95)
-              1220 LOAD_CONST              80 (0.99)
-              1222 BUILD_LIST               2
-              1224 LOAD_CONST              77 (4)
+   425        1222 LOAD_CONST              80 (0.95)
+              1224 LOAD_CONST              82 (0.99)
               1226 BUILD_LIST               2
+              1228 LOAD_CONST              79 (4)
+              1230 BUILD_LIST               2
    
-   426        1228 LOAD_CONST              80 (0.99)
-              1230 LOAD_CONST              81 (1.0)
-              1232 BUILD_LIST               2
-              1234 LOAD_CONST              75 (5)
+   426        1232 LOAD_CONST              82 (0.99)
+              1234 LOAD_CONST              83 (1.0)
               1236 BUILD_LIST               2
+              1238 LOAD_CONST              77 (5)
+              1240 BUILD_LIST               2
    
-   423        1238 BUILD_LIST               3
-              1240 STORE_NAME              64 (ASYMMETRIC_RANGES_AND_PRECISIONS)
+   423        1242 BUILD_LIST               3
+              1244 STORE_NAME              64 (ASYMMETRIC_RANGES_AND_PRECISIONS)
    
-   430        1242 LOAD_NAME               28 (dataclass_json)
+   430        1246 LOAD_NAME               28 (dataclass_json)
    
-   431        1244 LOAD_NAME               25 (dataclass)
+   431        1248 LOAD_NAME               25 (dataclass)
+   
+   432        1250 PUSH_NULL
+              1252 LOAD_BUILD_CLASS
+              1254 LOAD_CONST              84 (<code object QuantileCalculator, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 430>)
+              1256 MAKE_FUNCTION            0
+              1258 LOAD_CONST              85 ('QuantileCalculator')
+              1260 PRECALL                  2
+              1264 CALL                     2
+   
+   431        1274 PRECALL                  0
+              1278 CALL                     0
+   
+   430        1288 PRECALL                  0
+              1292 CALL                     0
+   
+   432        1302 STORE_NAME              65 (QuantileCalculator)
+   
+   556        1304 LOAD_NAME               41 (MAIN)
+              1306 EXTENDED_ARG             1
+              1308 POP_JUMP_FORWARD_IF_FALSE   430 (to 2170)
+   
+   559        1310 PUSH_NULL
+              1312 LOAD_NAME               37 (get_device)
+              1314 PRECALL                  0
+              1318 CALL                     0
+              1328 STORE_NAME              36 (device)
+   
+   560        1330 LOAD_CONST              86 (100000)
+              1332 STORE_NAME              66 (N)
+   
+   561        1334 PUSH_NULL
+              1336 LOAD_NAME               17 (torch)
+              1338 LOAD_ATTR               67 (stack)
+              1348 PUSH_NULL
+              1350 LOAD_NAME               17 (torch)
+              1352 LOAD_ATTR               68 (rand)
+              1362 LOAD_NAME               66 (N)
+              1364 PRECALL                  1
+              1368 CALL                     1
+              1378 LOAD_METHOD             69 (masked_fill)
+              1400 PUSH_NULL
+              1402 LOAD_NAME               17 (torch)
+              1404 LOAD_ATTR               68 (rand)
+              1414 LOAD_NAME               66 (N)
+              1416 PRECALL                  1
+              1420 CALL                     1
+              1430 LOAD_CONST              87 (0.5)
+              1432 COMPARE_OP               0 (<)
+              1438 LOAD_CONST              75 (0.0)
+              1440 PRECALL                  2
+              1444 CALL                     2
+              1454 PUSH_NULL
+              1456 LOAD_NAME               17 (torch)
+              1458 LOAD_ATTR               68 (rand)
+              1468 LOAD_NAME               66 (N)
+              1470 PRECALL                  1
+              1474 CALL                     1
+              1484 BUILD_LIST               2
+              1486 PRECALL                  1
+              1490 CALL                     1
+              1500 LOAD_METHOD             70 (to)
+              1522 LOAD_NAME               36 (device)
+              1524 PRECALL                  1
+              1528 CALL                     1
+              1538 STORE_NAME              71 (data)
+   
+   562        1540 LOAD_NAME               65 (QuantileCalculator)
+              1542 LOAD_METHOD             72 (from_data)
+              1564 LOAD_NAME               71 (data)
+              1566 PRECALL                  1
+              1570 CALL                     1
+              1580 STORE_NAME              73 (qc)
+   
+   563        1582 PUSH_NULL
+              1584 LOAD_NAME               74 (print)
+              1586 LOAD_CONST              88 ('Total datapoints stored = ')
+              1588 PUSH_NULL
+              1590 LOAD_NAME               75 (sum)
+              1592 LOAD_CONST              89 (<code object <genexpr>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 563>)
+              1594 MAKE_FUNCTION            0
+              1596 LOAD_NAME               73 (qc)
+              1598 LOAD_ATTR               76 (quantile_data)
+              1608 GET_ITER
+              1610 PRECALL                  0
+              1614 CALL                     0
+              1624 PRECALL                  1
+              1628 CALL                     1
+              1638 LOAD_CONST              90 ('_')
+              1640 FORMAT_VALUE             4 (with format)
+              1642 BUILD_STRING             2
+              1644 PRECALL                  1
+              1648 CALL                     1
+              1658 POP_TOP
+   
+   564        1660 PUSH_NULL
+              1662 LOAD_NAME               74 (print)
+              1664 LOAD_CONST              91 ('Total datapoints used to compute quantiles = ')
+              1666 LOAD_NAME               71 (data)
+              1668 LOAD_METHOD             77 (numel)
+              1690 PRECALL                  0
+              1694 CALL                     0
+              1704 LOAD_CONST              90 ('_')
+              1706 FORMAT_VALUE             4 (with format)
+              1708 LOAD_CONST              92 ('\n')
+              1710 BUILD_STRING             3
+              1712 PRECALL                  1
+              1716 CALL                     1
+              1726 POP_TOP
+   
+   567        1728 PUSH_NULL
+              1730 LOAD_NAME               17 (torch)
+              1732 LOAD_ATTR               78 (tensor)
+              1742 BUILD_LIST               0
+              1744 LOAD_CONST              93 ((0.0, 0.005, 0.02, 0.25))
+              1746 LIST_EXTEND              1
+              1748 BUILD_LIST               0
+              1750 LOAD_CONST              94 ((0.75, 0.98, 0.995, 1.0))
+              1752 LIST_EXTEND              1
+              1754 BUILD_LIST               2
+              1756 PRECALL                  1
+              1760 CALL                     1
+              1770 LOAD_METHOD             70 (to)
+              1792 LOAD_NAME               36 (device)
+              1794 PRECALL                  1
+              1798 CALL                     1
+              1808 STORE_NAME              79 (values)
+   
+   568        1810 LOAD_NAME               73 (qc)
+              1812 LOAD_METHOD             80 (get_quantile)
+              1834 LOAD_NAME               79 (values)
+              1836 PRECALL                  1
+              1840 CALL                     1
+              1850 UNPACK_SEQUENCE          2
+              1854 STORE_NAME              81 (quantiles)
+              1856 STORE_NAME              82 (precisions)
+   
+   570        1858 PUSH_NULL
+              1860 LOAD_NAME               74 (print)
+              1862 LOAD_CONST              95 ('When 50% of data is 0, and 50% is Unif[0, 1]')
+              1864 PRECALL                  1
+              1868 CALL                     1
+              1878 POP_TOP
+   
+   571        1880 PUSH_NULL
+              1882 LOAD_NAME               83 (zip)
+              1884 LOAD_NAME               79 (values)
+              1886 LOAD_CONST               0 (0)
+              1888 BINARY_SUBSCR
+              1898 LOAD_NAME               81 (quantiles)
+              1900 LOAD_CONST               0 (0)
+              1902 BINARY_SUBSCR
+              1912 LOAD_NAME               82 (precisions)
+              1914 LOAD_CONST               0 (0)
+              1916 BINARY_SUBSCR
+              1926 PRECALL                  3
+              1930 CALL                     3
+              1940 GET_ITER
+           >> 1942 FOR_ITER                35 (to 2014)
+              1944 UNPACK_SEQUENCE          3
+              1948 STORE_NAME              84 (v)
+              1950 STORE_NAME              85 (q)
+              1952 STORE_NAME              86 (p)
+   
+   572        1954 PUSH_NULL
+              1956 LOAD_NAME               74 (print)
+              1958 LOAD_CONST              96 ('Value: ')
+              1960 LOAD_NAME               84 (v)
+              1962 LOAD_CONST              97 ('.3f')
+              1964 FORMAT_VALUE             4 (with format)
+              1966 LOAD_CONST              98 (', Precision: ')
+              1968 LOAD_NAME               86 (p)
+              1970 FORMAT_VALUE             0
+              1972 LOAD_CONST              99 (', Quantile: ')
+              1974 LOAD_NAME               85 (q)
+              1976 LOAD_CONST             100 ('.')
+              1978 LOAD_NAME               86 (p)
+              1980 LOAD_CONST             101 (2)
+              1982 BINARY_OP               10 (-)
+              1986 FORMAT_VALUE             0
+              1988 LOAD_CONST             102 ('%')
+              1990 BUILD_STRING             3
+              1992 FORMAT_VALUE             4 (with format)
+              1994 BUILD_STRING             6
+              1996 PRECALL                  1
+              2000 CALL                     1
+              2010 POP_TOP
+              2012 JUMP_BACKWARD           36 (to 1942)
+   
+   573     >> 2014 PUSH_NULL
+              2016 LOAD_NAME               74 (print)
+              2018 LOAD_CONST             103 ('\nWhen 100% of data is Unif[0, 1]')
+              2020 PRECALL                  1
+              2024 CALL                     1
+              2034 POP_TOP
+   
+   574        2036 PUSH_NULL
+              2038 LOAD_NAME               83 (zip)
+              2040 LOAD_NAME               79 (values)
+              2042 LOAD_CONST             104 (1)
+              2044 BINARY_SUBSCR
+              2054 LOAD_NAME               81 (quantiles)
+              2056 LOAD_CONST             104 (1)
+              2058 BINARY_SUBSCR
+              2068 LOAD_NAME               82 (precisions)
+              2070 LOAD_CONST             104 (1)
+              2072 BINARY_SUBSCR
+              2082 PRECALL                  3
+              2086 CALL                     3
+              2096 GET_ITER
+           >> 2098 FOR_ITER                35 (to 2170)
+              2100 UNPACK_SEQUENCE          3
+              2104 STORE_NAME              84 (v)
+              2106 STORE_NAME              85 (q)
+              2108 STORE_NAME              86 (p)
+   
+   575        2110 PUSH_NULL
+              2112 LOAD_NAME               74 (print)
+              2114 LOAD_CONST              96 ('Value: ')
+              2116 LOAD_NAME               84 (v)
+              2118 LOAD_CONST              97 ('.3f')
+              2120 FORMAT_VALUE             4 (with format)
+              2122 LOAD_CONST              98 (', Precision: ')
+              2124 LOAD_NAME               86 (p)
+              2126 FORMAT_VALUE             0
+              2128 LOAD_CONST              99 (', Quantile: ')
+              2130 LOAD_NAME               85 (q)
+              2132 LOAD_CONST             100 ('.')
+              2134 LOAD_NAME               86 (p)
+              2136 LOAD_CONST             101 (2)
+              2138 BINARY_OP               10 (-)
+              2142 FORMAT_VALUE             0
+              2144 LOAD_CONST             102 ('%')
+              2146 BUILD_STRING             3
+              2148 FORMAT_VALUE             4 (with format)
+              2150 BUILD_STRING             6
+              2152 PRECALL                  1
+              2156 CALL                     1
+              2166 POP_TOP
+              2168 JUMP_BACKWARD           36 (to 2098)
+   
+   581     >> 2170 LOAD_CONST             105 ('input_string')
+   
+   582        2172 LOAD_NAME               43 (str)
+   
+   581        2174 LOAD_CONST             106 ('str1')
+   
+   583        2176 LOAD_NAME               43 (str)
+   
+   581        2178 LOAD_CONST             107 ('str2')
+   
+   584        2180 LOAD_NAME               43 (str)
+   
+   581        2182 LOAD_CONST              12 ('return')
+   
+   585        2184 LOAD_NAME               87 (tuple)
+              2186 LOAD_NAME               43 (str)
+              2188 LOAD_NAME               43 (str)
+              2190 BUILD_TUPLE              2
+              2192 BINARY_SUBSCR
+   
+   581        2202 BUILD_TUPLE              8
+              2204 LOAD_CONST             108 (<code object split_string, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 581>)
+              2206 MAKE_FUNCTION            4 (annotations)
+              2208 STORE_NAME              88 (split_string)
+   
+   597        2210 LOAD_NAME               41 (MAIN)
+              2212 POP_JUMP_FORWARD_IF_FALSE    56 (to 2326)
+   
+   598        2214 LOAD_CONST             109 ('The quick brown fox jumps over the lazy dog')
+              2216 STORE_NAME              89 (input_string)
+   
+   599        2218 LOAD_CONST             110 ('quick')
+              2220 STORE_NAME              90 (str1)
+   
+   600        2222 LOAD_CONST             111 ('jumps')
+              2224 STORE_NAME              91 (str2)
+   
+   601        2226 PUSH_NULL
+              2228 LOAD_NAME               74 (print)
+              2230 PUSH_NULL
+              2232 LOAD_NAME               88 (split_string)
+              2234 LOAD_NAME               89 (input_string)
+              2236 LOAD_NAME               90 (str1)
+              2238 LOAD_NAME               91 (str2)
+              2240 PRECALL                  3
+              2244 CALL                     3
+              2254 PRECALL                  1
+              2258 CALL                     1
+              2268 POP_TOP
+   
+   603        2270 LOAD_CONST             112 ('Before table <!-- Logits table --> Table <!-- Logits histogram --> After table')
+              2272 STORE_NAME              89 (input_string)
+   
+   604        2274 LOAD_CONST             113 ('<!-- Logits table -->')
+              2276 STORE_NAME              90 (str1)
+   
+   605        2278 LOAD_CONST             114 ('<!-- Logits histogram -->')
+              2280 STORE_NAME              91 (str2)
+   
+   606        2282 PUSH_NULL
+              2284 LOAD_NAME               74 (print)
+              2286 PUSH_NULL
+              2288 LOAD_NAME               88 (split_string)
+              2290 LOAD_NAME               89 (input_string)
+              2292 LOAD_NAME               90 (str1)
+              2294 LOAD_NAME               91 (str2)
+              2296 PRECALL                  3
+              2300 CALL                     3
+              2310 PRECALL                  1
+              2314 CALL                     1
+              2324 POP_TOP
+   
+   615     >> 2326 NOP
+   
+   612        2328 LOAD_CONST             140 ((False,))
+              2330 LOAD_CONST             115 ('text')
+   
+   613        2332 LOAD_NAME               43 (str)
+   
+   612        2334 LOAD_CONST             116 ('prefix')
+   
+   614        2336 LOAD_NAME               43 (str)
+   
+   612        2338 LOAD_CONST             117 ('first_line_indented')
+   
+   615        2340 LOAD_NAME               42 (bool)
+   
+   612        2342 LOAD_CONST              12 ('return')
+   
+   616        2344 LOAD_NAME               43 (str)
+   
+   612        2346 BUILD_TUPLE              8
+              2348 LOAD_CONST             118 (<code object apply_indent, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 612>)
+              2350 MAKE_FUNCTION            5 (defaults, annotations)
+              2352 STORE_NAME              92 (apply_indent)
    
-   432        1246 PUSH_NULL
-              1248 LOAD_BUILD_CLASS
-              1250 LOAD_CONST              82 (<code object QuantileCalculator, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 430>)
-              1252 MAKE_FUNCTION            0
-              1254 LOAD_CONST              83 ('QuantileCalculator')
-              1256 PRECALL                  2
-              1260 CALL                     2
-   
-   431        1270 PRECALL                  0
-              1274 CALL                     0
-   
-   430        1284 PRECALL                  0
-              1288 CALL                     0
-   
-   432        1298 STORE_NAME              65 (QuantileCalculator)
-   
-   556        1300 LOAD_NAME               41 (MAIN)
-              1302 EXTENDED_ARG             1
-              1304 POP_JUMP_FORWARD_IF_FALSE   430 (to 2166)
-   
-   559        1306 PUSH_NULL
-              1308 LOAD_NAME               37 (get_device)
-              1310 PRECALL                  0
-              1314 CALL                     0
-              1324 STORE_NAME              36 (device)
-   
-   560        1326 LOAD_CONST              84 (100000)
-              1328 STORE_NAME              66 (N)
-   
-   561        1330 PUSH_NULL
-              1332 LOAD_NAME               17 (torch)
-              1334 LOAD_ATTR               67 (stack)
-              1344 PUSH_NULL
-              1346 LOAD_NAME               17 (torch)
-              1348 LOAD_ATTR               68 (rand)
-              1358 LOAD_NAME               66 (N)
-              1360 PRECALL                  1
-              1364 CALL                     1
-              1374 LOAD_METHOD             69 (masked_fill)
-              1396 PUSH_NULL
-              1398 LOAD_NAME               17 (torch)
-              1400 LOAD_ATTR               68 (rand)
-              1410 LOAD_NAME               66 (N)
-              1412 PRECALL                  1
-              1416 CALL                     1
-              1426 LOAD_CONST              85 (0.5)
-              1428 COMPARE_OP               0 (<)
-              1434 LOAD_CONST              73 (0.0)
-              1436 PRECALL                  2
-              1440 CALL                     2
-              1450 PUSH_NULL
-              1452 LOAD_NAME               17 (torch)
-              1454 LOAD_ATTR               68 (rand)
-              1464 LOAD_NAME               66 (N)
-              1466 PRECALL                  1
-              1470 CALL                     1
-              1480 BUILD_LIST               2
-              1482 PRECALL                  1
-              1486 CALL                     1
-              1496 LOAD_METHOD             70 (to)
-              1518 LOAD_NAME               36 (device)
-              1520 PRECALL                  1
-              1524 CALL                     1
-              1534 STORE_NAME              71 (data)
-   
-   562        1536 LOAD_NAME               65 (QuantileCalculator)
-              1538 LOAD_METHOD             72 (from_data)
-              1560 LOAD_NAME               71 (data)
-              1562 PRECALL                  1
-              1566 CALL                     1
-              1576 STORE_NAME              73 (qc)
-   
-   563        1578 PUSH_NULL
-              1580 LOAD_NAME               74 (print)
-              1582 LOAD_CONST              86 ('Total datapoints stored = ')
-              1584 PUSH_NULL
-              1586 LOAD_NAME               75 (sum)
-              1588 LOAD_CONST              87 (<code object <genexpr>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 563>)
-              1590 MAKE_FUNCTION            0
-              1592 LOAD_NAME               73 (qc)
-              1594 LOAD_ATTR               76 (quantile_data)
-              1604 GET_ITER
-              1606 PRECALL                  0
-              1610 CALL                     0
-              1620 PRECALL                  1
-              1624 CALL                     1
-              1634 LOAD_CONST              88 ('_')
-              1636 FORMAT_VALUE             4 (with format)
-              1638 BUILD_STRING             2
-              1640 PRECALL                  1
-              1644 CALL                     1
-              1654 POP_TOP
-   
-   564        1656 PUSH_NULL
-              1658 LOAD_NAME               74 (print)
-              1660 LOAD_CONST              89 ('Total datapoints used to compute quantiles = ')
-              1662 LOAD_NAME               71 (data)
-              1664 LOAD_METHOD             77 (numel)
-              1686 PRECALL                  0
-              1690 CALL                     0
-              1700 LOAD_CONST              88 ('_')
-              1702 FORMAT_VALUE             4 (with format)
-              1704 LOAD_CONST              90 ('\n')
-              1706 BUILD_STRING             3
-              1708 PRECALL                  1
-              1712 CALL                     1
-              1722 POP_TOP
-   
-   567        1724 PUSH_NULL
-              1726 LOAD_NAME               17 (torch)
-              1728 LOAD_ATTR               78 (tensor)
-              1738 BUILD_LIST               0
-              1740 LOAD_CONST              91 ((0.0, 0.005, 0.02, 0.25))
-              1742 LIST_EXTEND              1
-              1744 BUILD_LIST               0
-              1746 LOAD_CONST              92 ((0.75, 0.98, 0.995, 1.0))
-              1748 LIST_EXTEND              1
-              1750 BUILD_LIST               2
-              1752 PRECALL                  1
-              1756 CALL                     1
-              1766 LOAD_METHOD             70 (to)
-              1788 LOAD_NAME               36 (device)
-              1790 PRECALL                  1
-              1794 CALL                     1
-              1804 STORE_NAME              79 (values)
-   
-   568        1806 LOAD_NAME               73 (qc)
-              1808 LOAD_METHOD             80 (get_quantile)
-              1830 LOAD_NAME               79 (values)
-              1832 PRECALL                  1
-              1836 CALL                     1
-              1846 UNPACK_SEQUENCE          2
-              1850 STORE_NAME              81 (quantiles)
-              1852 STORE_NAME              82 (precisions)
-   
-   570        1854 PUSH_NULL
-              1856 LOAD_NAME               74 (print)
-              1858 LOAD_CONST              93 ('When 50% of data is 0, and 50% is Unif[0, 1]')
-              1860 PRECALL                  1
-              1864 CALL                     1
-              1874 POP_TOP
-   
-   571        1876 PUSH_NULL
-              1878 LOAD_NAME               83 (zip)
-              1880 LOAD_NAME               79 (values)
-              1882 LOAD_CONST               0 (0)
-              1884 BINARY_SUBSCR
-              1894 LOAD_NAME               81 (quantiles)
-              1896 LOAD_CONST               0 (0)
-              1898 BINARY_SUBSCR
-              1908 LOAD_NAME               82 (precisions)
-              1910 LOAD_CONST               0 (0)
-              1912 BINARY_SUBSCR
-              1922 PRECALL                  3
-              1926 CALL                     3
-              1936 GET_ITER
-           >> 1938 FOR_ITER                35 (to 2010)
-              1940 UNPACK_SEQUENCE          3
-              1944 STORE_NAME              84 (v)
-              1946 STORE_NAME              85 (q)
-              1948 STORE_NAME              86 (p)
-   
-   572        1950 PUSH_NULL
-              1952 LOAD_NAME               74 (print)
-              1954 LOAD_CONST              94 ('Value: ')
-              1956 LOAD_NAME               84 (v)
-              1958 LOAD_CONST              95 ('.3f')
-              1960 FORMAT_VALUE             4 (with format)
-              1962 LOAD_CONST              96 (', Precision: ')
-              1964 LOAD_NAME               86 (p)
-              1966 FORMAT_VALUE             0
-              1968 LOAD_CONST              97 (', Quantile: ')
-              1970 LOAD_NAME               85 (q)
-              1972 LOAD_CONST              98 ('.')
-              1974 LOAD_NAME               86 (p)
-              1976 LOAD_CONST              99 (2)
-              1978 BINARY_OP               10 (-)
-              1982 FORMAT_VALUE             0
-              1984 LOAD_CONST             100 ('%')
-              1986 BUILD_STRING             3
-              1988 FORMAT_VALUE             4 (with format)
-              1990 BUILD_STRING             6
-              1992 PRECALL                  1
-              1996 CALL                     1
-              2006 POP_TOP
-              2008 JUMP_BACKWARD           36 (to 1938)
-   
-   573     >> 2010 PUSH_NULL
-              2012 LOAD_NAME               74 (print)
-              2014 LOAD_CONST             101 ('\nWhen 100% of data is Unif[0, 1]')
-              2016 PRECALL                  1
-              2020 CALL                     1
-              2030 POP_TOP
-   
-   574        2032 PUSH_NULL
-              2034 LOAD_NAME               83 (zip)
-              2036 LOAD_NAME               79 (values)
-              2038 LOAD_CONST             102 (1)
-              2040 BINARY_SUBSCR
-              2050 LOAD_NAME               81 (quantiles)
-              2052 LOAD_CONST             102 (1)
-              2054 BINARY_SUBSCR
-              2064 LOAD_NAME               82 (precisions)
-              2066 LOAD_CONST             102 (1)
-              2068 BINARY_SUBSCR
-              2078 PRECALL                  3
-              2082 CALL                     3
-              2092 GET_ITER
-           >> 2094 FOR_ITER                35 (to 2166)
-              2096 UNPACK_SEQUENCE          3
-              2100 STORE_NAME              84 (v)
-              2102 STORE_NAME              85 (q)
-              2104 STORE_NAME              86 (p)
-   
-   575        2106 PUSH_NULL
-              2108 LOAD_NAME               74 (print)
-              2110 LOAD_CONST              94 ('Value: ')
-              2112 LOAD_NAME               84 (v)
-              2114 LOAD_CONST              95 ('.3f')
-              2116 FORMAT_VALUE             4 (with format)
-              2118 LOAD_CONST              96 (', Precision: ')
-              2120 LOAD_NAME               86 (p)
-              2122 FORMAT_VALUE             0
-              2124 LOAD_CONST              97 (', Quantile: ')
-              2126 LOAD_NAME               85 (q)
-              2128 LOAD_CONST              98 ('.')
-              2130 LOAD_NAME               86 (p)
-              2132 LOAD_CONST              99 (2)
-              2134 BINARY_OP               10 (-)
-              2138 FORMAT_VALUE             0
-              2140 LOAD_CONST             100 ('%')
-              2142 BUILD_STRING             3
-              2144 FORMAT_VALUE             4 (with format)
-              2146 BUILD_STRING             6
-              2148 PRECALL                  1
-              2152 CALL                     1
-              2162 POP_TOP
-              2164 JUMP_BACKWARD           36 (to 2094)
-   
-   581     >> 2166 LOAD_CONST             103 ('input_string')
-   
-   582        2168 LOAD_NAME               43 (str)
-   
-   581        2170 LOAD_CONST             104 ('str1')
-   
-   583        2172 LOAD_NAME               43 (str)
-   
-   581        2174 LOAD_CONST             105 ('str2')
-   
-   584        2176 LOAD_NAME               43 (str)
-   
-   581        2178 LOAD_CONST              12 ('return')
-   
-   585        2180 LOAD_NAME               87 (tuple)
-              2182 LOAD_NAME               43 (str)
-              2184 LOAD_NAME               43 (str)
-              2186 BUILD_TUPLE              2
-              2188 BINARY_SUBSCR
-   
-   581        2198 BUILD_TUPLE              8
-              2200 LOAD_CONST             106 (<code object split_string, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 581>)
-              2202 MAKE_FUNCTION            4 (annotations)
-              2204 STORE_NAME              88 (split_string)
-   
-   597        2206 LOAD_NAME               41 (MAIN)
-              2208 POP_JUMP_FORWARD_IF_FALSE    56 (to 2322)
-   
-   598        2210 LOAD_CONST             107 ('The quick brown fox jumps over the lazy dog')
-              2212 STORE_NAME              89 (input_string)
-   
-   599        2214 LOAD_CONST             108 ('quick')
-              2216 STORE_NAME              90 (str1)
-   
-   600        2218 LOAD_CONST             109 ('jumps')
-              2220 STORE_NAME              91 (str2)
-   
-   601        2222 PUSH_NULL
-              2224 LOAD_NAME               74 (print)
-              2226 PUSH_NULL
-              2228 LOAD_NAME               88 (split_string)
-              2230 LOAD_NAME               89 (input_string)
-              2232 LOAD_NAME               90 (str1)
-              2234 LOAD_NAME               91 (str2)
-              2236 PRECALL                  3
-              2240 CALL                     3
-              2250 PRECALL                  1
-              2254 CALL                     1
-              2264 POP_TOP
-   
-   603        2266 LOAD_CONST             110 ('Before table <!-- Logits table --> Table <!-- Logits histogram --> After table')
-              2268 STORE_NAME              89 (input_string)
-   
-   604        2270 LOAD_CONST             111 ('<!-- Logits table -->')
-              2272 STORE_NAME              90 (str1)
-   
-   605        2274 LOAD_CONST             112 ('<!-- Logits histogram -->')
-              2276 STORE_NAME              91 (str2)
-   
-   606        2278 PUSH_NULL
-              2280 LOAD_NAME               74 (print)
-              2282 PUSH_NULL
-              2284 LOAD_NAME               88 (split_string)
-              2286 LOAD_NAME               89 (input_string)
-              2288 LOAD_NAME               90 (str1)
-              2290 LOAD_NAME               91 (str2)
-              2292 PRECALL                  3
-              2296 CALL                     3
-              2306 PRECALL                  1
-              2310 CALL                     1
-              2320 POP_TOP
-   
-   615     >> 2322 NOP
-   
-   612        2324 LOAD_CONST             138 ((False,))
-              2326 LOAD_CONST             113 ('text')
-   
-   613        2328 LOAD_NAME               43 (str)
-   
-   612        2330 LOAD_CONST             114 ('prefix')
-   
-   614        2332 LOAD_NAME               43 (str)
-   
-   612        2334 LOAD_CONST             115 ('first_line_indented')
-   
-   615        2336 LOAD_NAME               42 (bool)
-   
-   612        2338 LOAD_CONST              12 ('return')
-   
-   616        2340 LOAD_NAME               43 (str)
-   
-   612        2342 BUILD_TUPLE              8
-              2344 LOAD_CONST             116 (<code object apply_indent, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 612>)
-              2346 MAKE_FUNCTION            5 (defaults, annotations)
-              2348 STORE_NAME              92 (apply_indent)
-   
-   639        2350 LOAD_CONST             141 (('',))
-              2352 LOAD_CONST             118 ('dict1')
-              2354 LOAD_NAME               93 (dict)
-              2356 LOAD_CONST             119 ('dict2')
+   639        2354 LOAD_CONST             143 (('',))
+              2356 LOAD_CONST             120 ('dict1')
               2358 LOAD_NAME               93 (dict)
-              2360 LOAD_CONST             120 ('path')
-              2362 LOAD_NAME               43 (str)
-              2364 LOAD_CONST              12 ('return')
-              2366 LOAD_NAME               93 (dict)
-              2368 BUILD_TUPLE              8
-              2370 LOAD_CONST             121 (<code object deep_union, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 639>)
-              2372 MAKE_FUNCTION            5 (defaults, annotations)
-              2374 STORE_NAME              94 (deep_union)
-   
-   701        2376 LOAD_NAME               41 (MAIN)
-              2378 POP_JUMP_FORWARD_IF_FALSE   131 (to 2642)
-   
-   703        2380 PUSH_NULL
-              2382 LOAD_NAME               94 (deep_union)
-              2384 LOAD_CONST             102 (1)
-              2386 LOAD_CONST              99 (2)
-              2388 BUILD_MAP                1
-              2390 LOAD_CONST              79 (3)
-              2392 LOAD_CONST              77 (4)
-              2394 BUILD_MAP                1
-              2396 PRECALL                  2
-              2400 CALL                     2
-              2410 LOAD_CONST              99 (2)
-              2412 LOAD_CONST              77 (4)
-              2414 LOAD_CONST             122 ((1, 3))
-              2416 BUILD_CONST_KEY_MAP      2
-              2418 COMPARE_OP               2 (==)
-              2424 POP_JUMP_FORWARD_IF_TRUE     2 (to 2430)
-              2426 LOAD_ASSERTION_ERROR
-              2428 RAISE_VARARGS            1
-   
-   706     >> 2430 PUSH_NULL
-              2432 LOAD_NAME               94 (deep_union)
-   
-   707        2434 LOAD_CONST             102 (1)
-              2436 LOAD_CONST              99 (2)
-              2438 LOAD_CONST              79 (3)
-              2440 LOAD_CONST              77 (4)
-              2442 BUILD_LIST               2
-              2444 BUILD_MAP                1
-              2446 BUILD_MAP                1
-   
-   708        2448 LOAD_CONST             102 (1)
-              2450 LOAD_CONST              79 (3)
-              2452 LOAD_CONST              79 (3)
-              2454 LOAD_CONST              77 (4)
-              2456 BUILD_LIST               2
-              2458 BUILD_MAP                1
-              2460 BUILD_MAP                1
-   
-   706        2462 PRECALL                  2
-              2466 CALL                     2
-   
-   709        2476 LOAD_CONST             102 (1)
-              2478 LOAD_CONST              79 (3)
-              2480 LOAD_CONST              77 (4)
-              2482 BUILD_LIST               2
-              2484 LOAD_CONST              79 (3)
-              2486 LOAD_CONST              77 (4)
-              2488 BUILD_LIST               2
-              2490 LOAD_CONST             123 ((2, 3))
-              2492 BUILD_CONST_KEY_MAP      2
-              2494 BUILD_MAP                1
-   
-   706        2496 COMPARE_OP               2 (==)
-              2502 POP_JUMP_FORWARD_IF_TRUE     2 (to 2508)
-              2504 LOAD_ASSERTION_ERROR
-              2506 RAISE_VARARGS            1
-   
-   712     >> 2508 PUSH_NULL
-              2510 LOAD_NAME               94 (deep_union)
-   
-   713        2512 LOAD_CONST              20 ('x')
-              2514 LOAD_CONST             124 ('y')
-              2516 LOAD_CONST             125 ('z')
-              2518 LOAD_CONST             102 (1)
-              2520 BUILD_MAP                1
-              2522 BUILD_MAP                1
+              2360 LOAD_CONST             121 ('dict2')
+              2362 LOAD_NAME               93 (dict)
+              2364 LOAD_CONST             122 ('path')
+              2366 LOAD_NAME               43 (str)
+              2368 LOAD_CONST              12 ('return')
+              2370 LOAD_NAME               93 (dict)
+              2372 BUILD_TUPLE              8
+              2374 LOAD_CONST             123 (<code object deep_union, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 639>)
+              2376 MAKE_FUNCTION            5 (defaults, annotations)
+              2378 STORE_NAME              94 (deep_union)
+   
+   701        2380 LOAD_NAME               41 (MAIN)
+              2382 POP_JUMP_FORWARD_IF_FALSE   131 (to 2646)
+   
+   703        2384 PUSH_NULL
+              2386 LOAD_NAME               94 (deep_union)
+              2388 LOAD_CONST             104 (1)
+              2390 LOAD_CONST             101 (2)
+              2392 BUILD_MAP                1
+              2394 LOAD_CONST              81 (3)
+              2396 LOAD_CONST              79 (4)
+              2398 BUILD_MAP                1
+              2400 PRECALL                  2
+              2404 CALL                     2
+              2414 LOAD_CONST             101 (2)
+              2416 LOAD_CONST              79 (4)
+              2418 LOAD_CONST             124 ((1, 3))
+              2420 BUILD_CONST_KEY_MAP      2
+              2422 COMPARE_OP               2 (==)
+              2428 POP_JUMP_FORWARD_IF_TRUE     2 (to 2434)
+              2430 LOAD_ASSERTION_ERROR
+              2432 RAISE_VARARGS            1
+   
+   706     >> 2434 PUSH_NULL
+              2436 LOAD_NAME               94 (deep_union)
+   
+   707        2438 LOAD_CONST             104 (1)
+              2440 LOAD_CONST             101 (2)
+              2442 LOAD_CONST              81 (3)
+              2444 LOAD_CONST              79 (4)
+              2446 BUILD_LIST               2
+              2448 BUILD_MAP                1
+              2450 BUILD_MAP                1
+   
+   708        2452 LOAD_CONST             104 (1)
+              2454 LOAD_CONST              81 (3)
+              2456 LOAD_CONST              81 (3)
+              2458 LOAD_CONST              79 (4)
+              2460 BUILD_LIST               2
+              2462 BUILD_MAP                1
+              2464 BUILD_MAP                1
+   
+   706        2466 PRECALL                  2
+              2470 CALL                     2
+   
+   709        2480 LOAD_CONST             104 (1)
+              2482 LOAD_CONST              81 (3)
+              2484 LOAD_CONST              79 (4)
+              2486 BUILD_LIST               2
+              2488 LOAD_CONST              81 (3)
+              2490 LOAD_CONST              79 (4)
+              2492 BUILD_LIST               2
+              2494 LOAD_CONST             125 ((2, 3))
+              2496 BUILD_CONST_KEY_MAP      2
+              2498 BUILD_MAP                1
+   
+   706        2500 COMPARE_OP               2 (==)
+              2506 POP_JUMP_FORWARD_IF_TRUE     2 (to 2512)
+              2508 LOAD_ASSERTION_ERROR
+              2510 RAISE_VARARGS            1
+   
+   712     >> 2512 PUSH_NULL
+              2514 LOAD_NAME               94 (deep_union)
+   
+   713        2516 LOAD_CONST              20 ('x')
+              2518 LOAD_CONST             126 ('y')
+              2520 LOAD_CONST             127 ('z')
+              2522 LOAD_CONST             104 (1)
               2524 BUILD_MAP                1
+              2526 BUILD_MAP                1
+              2528 BUILD_MAP                1
    
-   714        2526 LOAD_CONST              20 ('x')
-              2528 LOAD_CONST             124 ('y')
-              2530 LOAD_CONST             126 ('w')
-              2532 LOAD_CONST              99 (2)
-              2534 BUILD_MAP                1
-              2536 BUILD_MAP                1
+   714        2530 LOAD_CONST              20 ('x')
+              2532 LOAD_CONST             126 ('y')
+              2534 LOAD_CONST             128 ('w')
+              2536 LOAD_CONST             101 (2)
               2538 BUILD_MAP                1
+              2540 BUILD_MAP                1
+              2542 BUILD_MAP                1
    
-   712        2540 PRECALL                  2
-              2544 CALL                     2
+   712        2544 PRECALL                  2
+              2548 CALL                     2
    
-   715        2554 LOAD_CONST              20 ('x')
-              2556 LOAD_CONST             124 ('y')
-              2558 LOAD_CONST             102 (1)
-              2560 LOAD_CONST              99 (2)
-              2562 LOAD_CONST             127 (('z', 'w'))
-              2564 BUILD_CONST_KEY_MAP      2
-              2566 BUILD_MAP                1
-              2568 BUILD_MAP                1
-   
-   712        2570 COMPARE_OP               2 (==)
-              2576 POP_JUMP_FORWARD_IF_TRUE     2 (to 2582)
-              2578 LOAD_ASSERTION_ERROR
-              2580 RAISE_VARARGS            1
-   
-   718     >> 2582 PUSH_NULL
-              2584 LOAD_NAME               94 (deep_union)
-   
-   719        2586 LOAD_CONST              20 ('x')
-              2588 LOAD_CONST             102 (1)
-              2590 LOAD_CONST              99 (2)
-              2592 BUILD_LIST               2
-              2594 BUILD_MAP                1
-   
-   720        2596 LOAD_CONST              20 ('x')
-              2598 LOAD_CONST              79 (3)
-              2600 LOAD_CONST              77 (4)
-              2602 BUILD_LIST               2
-              2604 BUILD_MAP                1
-   
-   718        2606 PRECALL                  2
-              2610 CALL                     2
-   
-   721        2620 LOAD_CONST              20 ('x')
-              2622 BUILD_LIST               0
-              2624 LOAD_CONST             128 ((1, 2, 3, 4))
-              2626 LIST_EXTEND              1
-              2628 BUILD_MAP                1
-   
-   718        2630 COMPARE_OP               2 (==)
-              2636 POP_JUMP_FORWARD_IF_TRUE     2 (to 2642)
-              2638 LOAD_ASSERTION_ERROR
-              2640 RAISE_VARARGS            1
-   
-   727     >> 2642 PUSH_NULL
-              2644 LOAD_BUILD_CLASS
-              2646 LOAD_CONST             129 (<code object BatchedCorrCoef, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 727>)
-              2648 MAKE_FUNCTION            0
-              2650 LOAD_CONST             130 ('BatchedCorrCoef')
-              2652 PRECALL                  2
-              2656 CALL                     2
-              2666 STORE_NAME              95 (BatchedCorrCoef)
-   
-   819        2668 LOAD_NAME               28 (dataclass_json)
-   
-   820        2670 LOAD_NAME               25 (dataclass)
-   
-   821        2672 PUSH_NULL
-              2674 LOAD_BUILD_CLASS
-              2676 LOAD_CONST             131 (<code object HistogramData, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 819>)
-              2678 MAKE_FUNCTION            0
-              2680 LOAD_CONST             132 ('HistogramData')
-              2682 PRECALL                  2
-              2686 CALL                     2
-   
-   820        2696 PRECALL                  0
-              2700 CALL                     0
-   
-   819        2710 PRECALL                  0
-              2714 CALL                     0
-   
-   821        2724 STORE_NAME              96 (HistogramData)
-   
-   907        2726 LOAD_CONST             138 ((False,))
-              2728 LOAD_CONST             133 ('abs')
-              2730 LOAD_NAME               42 (bool)
-              2732 LOAD_CONST              12 ('return')
-              2734 LOAD_NAME               48 (float)
-              2736 LOAD_NAME               45 (int)
-              2738 BINARY_OP                7 (|)
-              2742 BUILD_TUPLE              4
-              2744 LOAD_CONST             134 (<code object max_or_1, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 907>)
-              2746 MAKE_FUNCTION            5 (defaults, annotations)
-              2748 STORE_NAME              97 (max_or_1)
-              2750 LOAD_CONST               3 (None)
-              2752 RETURN_VALUE
+   715        2558 LOAD_CONST              20 ('x')
+              2560 LOAD_CONST             126 ('y')
+              2562 LOAD_CONST             104 (1)
+              2564 LOAD_CONST             101 (2)
+              2566 LOAD_CONST             129 (('z', 'w'))
+              2568 BUILD_CONST_KEY_MAP      2
+              2570 BUILD_MAP                1
+              2572 BUILD_MAP                1
+   
+   712        2574 COMPARE_OP               2 (==)
+              2580 POP_JUMP_FORWARD_IF_TRUE     2 (to 2586)
+              2582 LOAD_ASSERTION_ERROR
+              2584 RAISE_VARARGS            1
+   
+   718     >> 2586 PUSH_NULL
+              2588 LOAD_NAME               94 (deep_union)
+   
+   719        2590 LOAD_CONST              20 ('x')
+              2592 LOAD_CONST             104 (1)
+              2594 LOAD_CONST             101 (2)
+              2596 BUILD_LIST               2
+              2598 BUILD_MAP                1
+   
+   720        2600 LOAD_CONST              20 ('x')
+              2602 LOAD_CONST              81 (3)
+              2604 LOAD_CONST              79 (4)
+              2606 BUILD_LIST               2
+              2608 BUILD_MAP                1
+   
+   718        2610 PRECALL                  2
+              2614 CALL                     2
+   
+   721        2624 LOAD_CONST              20 ('x')
+              2626 BUILD_LIST               0
+              2628 LOAD_CONST             130 ((1, 2, 3, 4))
+              2630 LIST_EXTEND              1
+              2632 BUILD_MAP                1
+   
+   718        2634 COMPARE_OP               2 (==)
+              2640 POP_JUMP_FORWARD_IF_TRUE     2 (to 2646)
+              2642 LOAD_ASSERTION_ERROR
+              2644 RAISE_VARARGS            1
+   
+   727     >> 2646 PUSH_NULL
+              2648 LOAD_BUILD_CLASS
+              2650 LOAD_CONST             131 (<code object BatchedCorrCoef, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 727>)
+              2652 MAKE_FUNCTION            0
+              2654 LOAD_CONST             132 ('BatchedCorrCoef')
+              2656 PRECALL                  2
+              2660 CALL                     2
+              2670 STORE_NAME              95 (BatchedCorrCoef)
+   
+   842        2672 LOAD_NAME               28 (dataclass_json)
+   
+   843        2674 LOAD_NAME               25 (dataclass)
+   
+   844        2676 PUSH_NULL
+              2678 LOAD_BUILD_CLASS
+              2680 LOAD_CONST             133 (<code object HistogramData, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 842>)
+              2682 MAKE_FUNCTION            0
+              2684 LOAD_CONST             134 ('HistogramData')
+              2686 PRECALL                  2
+              2690 CALL                     2
+   
+   843        2700 PRECALL                  0
+              2704 CALL                     0
+   
+   842        2714 PRECALL                  0
+              2718 CALL                     0
+   
+   844        2728 STORE_NAME              96 (HistogramData)
+   
+   930        2730 LOAD_CONST             140 ((False,))
+              2732 LOAD_CONST             135 ('abs')
+              2734 LOAD_NAME               42 (bool)
+              2736 LOAD_CONST              12 ('return')
+              2738 LOAD_NAME               48 (float)
+              2740 LOAD_NAME               45 (int)
+              2742 BINARY_OP                7 (|)
+              2746 BUILD_TUPLE              4
+              2748 LOAD_CONST             136 (<code object max_or_1, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 930>)
+              2750 MAKE_FUNCTION            5 (defaults, annotations)
+              2752 STORE_NAME              97 (max_or_1)
+              2754 LOAD_CONST               3 (None)
+              2756 RETURN_VALUE
    consts
       0
       ('Float', 'Int', 'Bool')
       ('Tuple', 'Optional', 'Union', 'Dict', 'List', 'Literal', 'Any', 'overload', 'Callable', 'Type', 'TypeVar')
       None
       ('Tensor',)
       ('PreTrainedTokenizerFast',)
@@ -1276,15 +1280,15 @@
             'cuda'
             'mps'
             'cpu'
          names      ('torch', 'cuda', 'is_available', 'device', 'backends', 'mps')
          varnames   ('device',)
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'get_device'
          firstlineno 27
          lnotab 0x02043c012a0146012a022801
       '__main__'
       'verbose'
       'desc'
       code
@@ -1313,15 +1317,15 @@
             '\n    Returns an iterator, useful for reducing code repetition.\n    '
             False
             ('desc', 'leave')
          names      ('tqdm',)
          varnames   ('iterator', 'verbose', 'desc')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'create_iterator'
          firstlineno 48
          lnotab 0x0204
       True
       (5, -5)
       'x'
       'rows cols'
@@ -1415,15 +1419,15 @@
             1
             ('k', 'largest')
             ('dim',)
          names      ('flatten', 'topk', 'indices', 'size', 'torch', 'stack')
          varnames   ('x', 'k', 'largest', 'buffer', 'indices', 'rows', 'cols')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'k_largest_indices'
          firstlineno 56
          lnotab 0x021634015c0130014201
       'large_number'
       'small_number'
       code
          argcount  : 2
@@ -1460,15 +1464,15 @@
             "\n    Samples a small number of unique indices from a large number of indices.\n\n    This is more efficient than using `torch.permutation`, because we don't need to shuffle everything.\n    "
             False
             ('replacement',)
          names      ('torch', 'ones', 'multinomial')
          varnames   ('large_number', 'small_number', 'weights', 'sampled_indices')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'sample_unique_indices'
          firstlineno 86
          lnotab 0x020628012e01
       'batch seq'
       'bounds'
       code
          argcount  : 4
@@ -1577,15 +1581,15 @@
             1
             -1
             ('dim',)
          names      ('torch', 'stack', 'where', 'len', 'sample_unique_indices', 'tensor', 'to', 'device')
          varnames   ('x', 'k', 'bounds', 'buffer', 'mask', 'indices')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'random_range_indices'
          firstlineno 98
          lnotab 0x021634033201500326014603
       False
       'html'
       code
          argcount  : 2
@@ -1602,15 +1606,15 @@
             070000660488028801880366036404840c8a0289025300
                        0 MAKE_CELL                1 (html)
                        2 MAKE_CELL                2 (decode)
                        4 MAKE_CELL                3 (vocab_dict)
          
          157           6 RESUME                   0
          
-         159           8 LOAD_CONST               1 (<code object <dictcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 159>)
+         159           8 LOAD_CONST               1 (<code object <dictcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 159>)
                       10 MAKE_FUNCTION            0
                       12 LOAD_FAST                0 (tokenizer)
                       14 LOAD_ATTR                0 (vocab)
                       24 LOAD_METHOD              1 (items)
                       46 PRECALL                  0
                       50 CALL                     0
                       60 GET_ITER
@@ -1631,15 +1635,15 @@
                      168 BINARY_SUBSCR
                      178 BINARY_OP                7 (|)
                      182 BUILD_TUPLE              4
                      184 LOAD_CLOSURE             2 (decode)
                      186 LOAD_CLOSURE             1 (html)
                      188 LOAD_CLOSURE             3 (vocab_dict)
                      190 BUILD_TUPLE              3
-                     192 LOAD_CONST               4 (<code object decode, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 161>)
+                     192 LOAD_CONST               4 (<code object decode, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 161>)
                      194 MAKE_FUNCTION           12 (annotations, closure)
                      196 STORE_DEREF              2 (decode)
          
          173         198 LOAD_DEREF               2 (decode)
                      200 RETURN_VALUE
          consts
             None
@@ -1662,15 +1666,15 @@
                             22 JUMP_BACKWARD            9 (to 6)
                        >>   24 RETURN_VALUE
                consts
                names      ()
                varnames   ('.0', 'k', 'v')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '<dictcomp>'
                firstlineno 159
                lnotab 0x
             'token_id'
             'return'
             code
                argcount  : 1
@@ -1726,15 +1730,15 @@
                            178 LOAD_METHOD              6 (tolist)
                            200 PRECALL                  0
                            204 CALL                     0
                            214 STORE_FAST               0 (token_id)
                
                171     >>  216 LOAD_CLOSURE             2 (decode)
                            218 BUILD_TUPLE              1
-                           220 LOAD_CONST               3 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 171>)
+                           220 LOAD_CONST               3 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 171>)
                            222 MAKE_FUNCTION            8 (closure)
                            224 LOAD_FAST                0 (token_id)
                            226 GET_ITER
                            228 PRECALL                  0
                            232 CALL                     0
                            242 RETURN_VALUE
                consts
@@ -1765,49 +1769,51 @@
                                   34 JUMP_BACKWARD           14 (to 8)
                              >>   36 RETURN_VALUE
                      consts
                      names      ()
                      varnames   ('.0', 'tok')
                      freevars   ('decode',)
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
                      firstlineno 171
                      lnotab 0x
                names      ('isinstance', 'int', 'get', 'process_str_tok', 'torch', 'Tensor', 'tolist')
                varnames   ('token_id', 'str_tok')
                freevars   ('decode', 'html', 'vocab_dict')
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'decode'
                firstlineno 161
                lnotab 0x04042a012c01220234012801
          names      ('vocab', 'items', 'int', 'list', 'str')
          varnames   ('tokenizer', 'html')
          freevars   ()
          cellvars   ('html', 'decode', 'vocab_dict')
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'get_decode_html_safe_fn'
          firstlineno 157
          lnotab 0x08024602780c
       '&bsol;'
       '&lt;'
       '&gt;'
       '&#41;'
       '&#40;'
       '&#91;'
       '&#93;'
       '&#123;'
       '&#125;'
       ('\\', '<', '>', ')', '(', '[', ']', '{', '}')
+      '&ndash;'
+      '&rsquo;'
       '&#8203;'
       '&nbsp;'
       '&bsol;n'
       '&bsol;t'
-      ('âĢĭ', 'Ġ', 'Ċ', 'ĉ')
+      ('âĢĶ', 'âĢĻ', 'âĢĭ', 'Ġ', 'Ċ', 'ĉ')
       '&apos;'
       '&quot;'
       ("'", '"')
       ' '
       'str_tok'
       code
          argcount  : 2
@@ -1906,15 +1912,15 @@
             '\n    Takes a string token, and does the necessary formatting to produce the right HTML output. There are 2 things that\n    might need to be changed:\n\n        (1) Anomalous chars like Ġ should be replaced with their normal Python string representations\n            e.g. "Ġ" -> " "\n        (2) Special HTML characters like "<" should be replaced with their HTML representations\n            e.g. "<" -> "&lt;", or " " -> "&nbsp;"\n\n    We always do (1), the argument `html` determines whether we do (2) as well.\n    '
             1
             -1
          names      ('HTML_ANOMALIES', 'items', 'replace', 'HTML_QUOTES', 'repr', 'HTML_CHARS')
          varnames   ('str_tok', 'html', 'k', 'v')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'process_str_tok'
          firstlineno 209
          lnotab 0x020c3c012e0204023c012e022e033c012e02
       code
          argcount  : 1
          nlocals   : 3
          stacksize : 5
@@ -1949,15 +1955,15 @@
                      110 RETURN_VALUE
          consts
             '\n    Performs the reverse of the `process_str_tok` function, i.e. maps from HTML representations back to their original\n    characters. This is useful when e.g. our string is inside a <code>...</code> element, because then we have to use\n    the literal characters.\n    '
          names      ('HTML_ALL', 'items', 'replace')
          varnames   ('str_tok', 'k', 'v')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'unprocess_str_tok'
          firstlineno 238
          lnotab 0x02063c012e02
       'decode_fn'
       'tokens'
       code
          argcount  : 2
@@ -1971,15 +1977,15 @@
                        4 RETURN_VALUE
          consts
             None
          names      ()
          varnames   ('decode_fn', 'tokens')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'to_str_tokens'
          firstlineno 252
          lnotab 0x0205
       code
          argcount  : 2
          nlocals   : 2
          stacksize : 1
@@ -1991,15 +1997,15 @@
                        4 RETURN_VALUE
          consts
             None
          names      ()
          varnames   ('decode_fn', 'tokens')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'to_str_tokens'
          firstlineno 259
          lnotab 0x0205
       code
          argcount  : 2
          nlocals   : 3
          stacksize : 4
@@ -2047,15 +2053,15 @@
                      132 LOAD_FAST                1 (tokens)
                      134 PRECALL                  1
                      138 CALL                     1
                      148 STORE_FAST               1 (tokens)
          
          283     >>  150 LOAD_CLOSURE             0 (decode_fn)
                      152 BUILD_TUPLE              1
-                     154 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 283>)
+                     154 LOAD_CONST               1 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 283>)
                      156 MAKE_FUNCTION            8 (closure)
                      158 LOAD_FAST                1 (tokens)
                      160 LOAD_METHOD              5 (flatten)
                      182 PRECALL                  0
                      186 CALL                     0
                      196 LOAD_METHOD              6 (tolist)
                      218 PRECALL                  0
@@ -2102,23 +2108,23 @@
                             34 JUMP_BACKWARD           14 (to 8)
                        >>   36 RETURN_VALUE
                consts
                names      ()
                varnames   ('.0', 't')
                freevars   ('decode_fn',)
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '<listcomp>'
                firstlineno 283
                lnotab 0x
          names      ('isinstance', 'int', 'list', 'torch', 'tensor', 'flatten', 'tolist', 'np', 'reshape', 'shape')
          varnames   ('decode_fn', 'tokens', 'str_tokens')
          freevars   ()
          cellvars   ('decode_fn',)
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'to_str_tokens'
          firstlineno 266
          lnotab 0x04092a0116032a0128036403
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 12
@@ -2182,62 +2188,62 @@
                       76 LOAD_NAME                7 (Tensor)
                       78 LOAD_CONST              11 ('...')
                       80 BUILD_TUPLE              2
                       82 BINARY_SUBSCR
                       92 BINARY_SUBSCR
          
          301         102 BUILD_TUPLE              8
-                     104 LOAD_CONST              12 (<code object __init__, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 301>)
+                     104 LOAD_CONST              12 (<code object __init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 301>)
                      106 MAKE_FUNCTION            5 (defaults, annotations)
                      108 STORE_NAME              12 (__init__)
          
          312         110 LOAD_CONST              21 (('return', 'TopK'))
-                     112 LOAD_CONST              14 (<code object __getitem__, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 312>)
+                     112 LOAD_CONST              14 (<code object __getitem__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 312>)
                      114 MAKE_FUNCTION            4 (annotations)
                      116 STORE_NAME              13 (__getitem__)
          
          320         118 LOAD_CONST              13 ('return')
                      120 LOAD_NAME                8 (int)
                      122 BUILD_TUPLE              2
-                     124 LOAD_CONST              15 (<code object __len__, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 320>)
+                     124 LOAD_CONST              15 (<code object __len__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 320>)
                      126 MAKE_FUNCTION            4 (annotations)
                      128 STORE_NAME              14 (__len__)
          
          323         130 LOAD_NAME               15 (property)
          
          324         132 LOAD_CONST              13 ('return')
                      134 LOAD_NAME                8 (int)
                      136 BUILD_TUPLE              2
-                     138 LOAD_CONST              16 (<code object ndim, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 323>)
+                     138 LOAD_CONST              16 (<code object ndim, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 323>)
                      140 MAKE_FUNCTION            4 (annotations)
          
          323         142 PRECALL                  0
                      146 CALL                     0
          
          324         156 STORE_NAME              16 (ndim)
          
          327         158 LOAD_NAME               15 (property)
          
          328         160 LOAD_CONST              13 ('return')
                      162 LOAD_NAME               17 (Tuple)
                      164 LOAD_NAME                8 (int)
                      166 BINARY_SUBSCR
                      176 BUILD_TUPLE              2
-                     178 LOAD_CONST              17 (<code object shape, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 327>)
+                     178 LOAD_CONST              17 (<code object shape, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 327>)
                      180 MAKE_FUNCTION            4 (annotations)
          
          327         182 PRECALL                  0
                      186 CALL                     0
          
          328         196 STORE_NAME              18 (shape)
          
          331         198 LOAD_CONST              13 ('return')
                      200 LOAD_NAME                8 (int)
                      202 BUILD_TUPLE              2
-                     204 LOAD_CONST              18 (<code object numel, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 331>)
+                     204 LOAD_CONST              18 (<code object numel, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 331>)
                      206 MAKE_FUNCTION            4 (annotations)
                      208 STORE_NAME              19 (numel)
          
          337         210 NOP
          
          334         212 LOAD_CONST              22 ((None,))
                      214 LOAD_CONST               6 ('tensor')
@@ -2263,15 +2269,15 @@
          338         268 LOAD_NAME               17 (Tuple)
                      270 LOAD_NAME                4 (Arr)
                      272 LOAD_NAME                4 (Arr)
                      274 BUILD_TUPLE              2
                      276 BINARY_SUBSCR
          
          334         286 BUILD_TUPLE              6
-                     288 LOAD_CONST              19 (<code object topk, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 334>)
+                     288 LOAD_CONST              19 (<code object topk, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 334>)
                      290 MAKE_FUNCTION            5 (defaults, annotations)
                      292 STORE_NAME              20 (topk)
                      294 LOAD_CONST               5 (None)
                      296 RETURN_VALUE
          consts
             'TopK'
             "\n    This function implements a version of torch.topk over the last dimension. It offers the following:\n\n        (1) Nicer type signatures (the default obj returned by torck.topk isn't well typed)\n        (2) Helper functions for indexing & other standard tensor operations like .ndim, .shape, etc.\n        (3) An efficient topk calculation, which doesn't bother applying it to the zero elements of a tensor.\n    "
@@ -2320,15 +2326,15 @@
                            102 RETURN_VALUE
                consts
                   None
                names      ('k', 'largest', 'topk', 'values', 'indices')
                varnames   ('self', 'tensor', 'k', 'largest', 'tensor_mask')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '__init__'
                firstlineno 301
                lnotab 0x02070e010e01
             'return'
             code
                argcount  : 2
                nlocals   : 3
@@ -2379,15 +2385,15 @@
                            186 RETURN_VALUE
                consts
                   None
                names      ('TopK', '__new__', 'k', 'largest', 'values', 'indices')
                varnames   ('self', 'item', 'new_topk')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '__getitem__'
                firstlineno 312
                lnotab 0x02013e011801180124012401
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
@@ -2405,15 +2411,15 @@
                             40 RETURN_VALUE
                consts
                   None
                names      ('len', 'values')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '__len__'
                firstlineno 320
                lnotab 0x0201
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
@@ -2427,15 +2433,15 @@
                             24 RETURN_VALUE
                consts
                   None
                names      ('values', 'ndim')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'ndim'
                firstlineno 323
                lnotab 0x0202
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 3
@@ -2454,15 +2460,15 @@
                             50 RETURN_VALUE
                consts
                   None
                names      ('tuple', 'values', 'shape')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'shape'
                firstlineno 327
                lnotab 0x0202
             code
                argcount  : 1
                nlocals   : 1
                stacksize : 1
@@ -2476,15 +2482,15 @@
                             24 RETURN_VALUE
                consts
                   None
                names      ('values', 'size')
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'numel'
                firstlineno 331
                lnotab 0x0201
             code
                argcount  : 3
                nlocals   : 8
                stacksize : 4
@@ -2630,26 +2636,26 @@
                   "\n        This is an efficient version of `torch.topk(..., dim=-1)`. It saves time by only doing the topk calculation over\n        the bits of `tensor` where `tensor_mask=True`. This is useful when `tensor` is very sparse, e.g. it has shape\n        (batch, seq, d_vocab) and its elements are zero if the corresponding token has feature activation zero. In this\n        case, we don't want to waste time taking topk over a tensor of zeros.\n        "
                   None
                   ('k', 'largest')
                names      ('any', 'topk', 'k', 'largest', 'utils', 'to_numpy', 'values', 'indices', 'shape', 'torch', 'zeros', 'to', 'device', 'long')
                varnames   ('self', 'tensor', 'tensor_mask', 'topk', 'tensor_nontrivial_values', 'topk_shape', 'topk_indices', 'topk_values')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'topk'
                firstlineno 334
                lnotab 0x020c2c01420164031001420322017c01140158011402
             (True, None)
             ('return', 'TopK')
             (None,)
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'Arr', '__annotations__', 'Float', 'Tensor', 'int', 'bool', 'Optional', 'Bool', '__init__', '__getitem__', '__len__', 'property', 'ndim', 'Tuple', 'shape', 'numel', 'topk')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'TopK'
          firstlineno 290
          lnotab
             0x0c0104070a010a06020102fb040212fe020302fd020402fc02051efb08
             0b08080c0302010aff0e010203020116ff0e0102030c0602fd040212fe02
             031efd020412fc
       'TopK'
@@ -2657,15 +2663,15 @@
          argcount  : 0
          nlocals   : 1
          stacksize : 2
          flags     : 7
          code 0x9700640184007c004400a6000000ab0000000000000000005300
          366           0 RESUME                   0
          
-         370           2 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 370>)
+         370           2 LOAD_CONST               1 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 370>)
                        4 MAKE_FUNCTION            0
                        6 LOAD_FAST                0 (lists)
                        8 GET_ITER
                       10 PRECALL                  0
                       14 CALL                     0
                       24 RETURN_VALUE
          consts
@@ -2691,23 +2697,23 @@
                        >>   24 JUMP_BACKWARD           10 (to 6)
                        >>   26 RETURN_VALUE
                consts
                names      ()
                varnames   ('.0', 'sublist', 'item')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '<listcomp>'
                firstlineno 370
                lnotab 0x
          names      ()
          varnames   ('lists',)
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'merge_lists'
          firstlineno 366
          lnotab 0x0204
       'html_content'
       code
          argcount  : 1
          nlocals   : 5
@@ -2765,15 +2771,15 @@
             ''
             ('flags',)
             '\n'
          names      ('re', 'findall', 'DOTALL', 'sub', 'join')
          varnames   ('html_content', 'pattern', 'scripts', 'html_without_scripts', 'javascript')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'extract_and_remove_scripts'
          firstlineno 374
          lnotab 0x02060403400344032a02
       'left'
       'n'
       'side'
       ('left', 'right')
@@ -2839,15 +2845,15 @@
             'Error: x must have fewer than n elements.'
             'right'
             0.0
          names      ('len',)
          varnames   ('x', 'n', 'side')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'pad_with_zeros'
          firstlineno 395
          lnotab 0x02083a020c013202
       0.0
       0.01
       5
       0.05
@@ -2912,15 +2918,15 @@
                      102 BINARY_SUBSCR
                      112 LOAD_NAME                9 (__annotations__)
                      114 LOAD_CONST               4 ('quantile_data')
                      116 STORE_SUBSCR
          
          446         120 PUSH_NULL
                      122 LOAD_NAME                4 (field)
-                     124 LOAD_CONST               5 (<code object <lambda>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 446>)
+                     124 LOAD_CONST               5 (<code object <lambda>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 446>)
                      126 MAKE_FUNCTION            0
                      128 KW_NAMES                 2
                      130 PRECALL                  1
                      134 CALL                     1
                      144 STORE_NAME              11 (ranges_and_precisions)
                      146 LOAD_NAME                5 (list)
                      148 LOAD_NAME                9 (__annotations__)
@@ -2949,24 +2955,24 @@
          452         198 LOAD_NAME                5 (list)
          
          449         200 LOAD_CONST              10 ('return')
          
          453         202 LOAD_CONST               0 ('QuantileCalculator')
          
          449         204 BUILD_TUPLE              6
-                     206 LOAD_CONST              11 (<code object from_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 448>)
+                     206 LOAD_CONST              11 (<code object from_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 448>)
                      208 MAKE_FUNCTION            5 (defaults, annotations)
          
          448         210 PRECALL                  0
                      214 CALL                     0
          
          449         224 STORE_NAME              17 (from_data)
          
          486         226 LOAD_CONST              18 (('other', 'QuantileCalculator'))
-                     228 LOAD_CONST              13 (<code object update, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 486>)
+                     228 LOAD_CONST              13 (<code object update, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 486>)
                      230 MAKE_FUNCTION            4 (annotations)
                      232 STORE_NAME              18 (update)
          
          503         234 NOP
          
          500         236 LOAD_CONST              19 ((None,))
                      238 LOAD_CONST              14 ('values')
@@ -2998,15 +3004,15 @@
                      312 LOAD_CONST              15 ('batch *data_dim')
                      314 BUILD_TUPLE              2
                      316 BINARY_SUBSCR
                      326 BUILD_TUPLE              2
                      328 BINARY_SUBSCR
          
          500         338 BUILD_TUPLE              6
-                     340 LOAD_CONST              17 (<code object get_quantile, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 500>)
+                     340 LOAD_CONST              17 (<code object get_quantile, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 500>)
                      342 MAKE_FUNCTION            5 (defaults, annotations)
                      344 STORE_NAME              22 (get_quantile)
                      346 LOAD_CONST               7 (None)
                      348 RETURN_VALUE
          consts
             'QuantileCalculator'
             "\n    This class is initialized with some float-type data, as well as a list of ranges and precisions. It will only keep\n    the data which is necessary to calculate the quantile of additional data to the required precision, but no more.\n\n    This was created because (for example) when looking at the top-activating features, we care way more about precision\n    if the feature's activation is in the top 1% of its activations over all other data it's been analyzed on.\n\n    Note, this class works in parallel, i.e. it can handle multiple different sets of data at once. The data is expected\n    in 2D tensor format, with the first dimension being the batch dim, i.e. each row is a different dataset which we\n    want to be able to compute quantiles from.\n    "
@@ -3024,15 +3030,15 @@
                             14 RETURN_VALUE
                consts
                   None
                names      ('ASYMMETRIC_RANGES_AND_PRECISIONS',)
                varnames   ()
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '<lambda>'
                firstlineno 446
                lnotab 0x
             'ranges_and_precisions'
             None
             'data'
             'batch data'
@@ -3140,26 +3146,26 @@
                            288 CALL                     3
                            298 LOAD_ATTR                9 (T)
                            308 LOAD_METHOD             10 (tolist)
                            330 PRECALL                  0
                            334 CALL                     0
                            344 STORE_FAST               9 (quantile_data)
                
-               475     >>  346 LOAD_CONST               7 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 475>)
+               475     >>  346 LOAD_CONST               7 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 475>)
                            348 MAKE_FUNCTION            0
                            350 LOAD_FAST                3 (quantiles)
                            352 LOAD_CONST               8 (1.0)
                            354 BUILD_LIST               1
                            356 BINARY_OP                0 (+)
                            360 GET_ITER
                            362 PRECALL                  0
                            366 CALL                     0
                            376 STORE_FAST               3 (quantiles)
                
-               476         378 LOAD_CONST               9 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 476>)
+               476         378 LOAD_CONST               9 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 476>)
                            380 MAKE_FUNCTION            0
                            382 LOAD_FAST                9 (quantile_data)
                            384 GET_ITER
                            386 PRECALL                  0
                            390 CALL                     0
                            400 STORE_FAST               9 (quantile_data)
                
@@ -3170,15 +3176,15 @@
                            430 GET_ITER
                        >>  432 FOR_ITER                70 (to 574)
                            434 UNPACK_SEQUENCE          2
                            438 STORE_FAST              11 (i)
                            440 STORE_FAST              12 (qd)
                
                480         442 LOAD_GLOBAL             25 (NULL + next)
-                           454 LOAD_CONST              10 (<code object <genexpr>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 480>)
+                           454 LOAD_CONST              10 (<code object <genexpr>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 480>)
                            456 MAKE_FUNCTION            0
                            458 LOAD_GLOBAL             23 (NULL + enumerate)
                            470 LOAD_FAST               12 (qd)
                            472 PRECALL                  1
                            476 CALL                     1
                            486 GET_ITER
                            488 PRECALL                  0
@@ -3240,15 +3246,15 @@
                              >>   44 RETURN_VALUE
                      consts
                         6
                      names      ('round',)
                      varnames   ('.0', 'q')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
                      firstlineno 475
                      lnotab 0x
                   1.0
                   code
                      argcount  : 1
                      nlocals   : 2
@@ -3258,15 +3264,15 @@
                         0x970067007c005d0e7d01640084007c014400a6000000ab000000000000
                         00000091028c0f5300
                      476           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                14 (to 36)
                                    8 STORE_FAST               1 (qd)
-                                  10 LOAD_CONST               0 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 476>)
+                                  10 LOAD_CONST               0 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 476>)
                                   12 MAKE_FUNCTION            0
                                   14 LOAD_FAST                1 (qd)
                                   16 GET_ITER
                                   18 PRECALL                  0
                                   22 CALL                     0
                                   32 LIST_APPEND              2
                                   34 JUMP_BACKWARD           15 (to 6)
@@ -3295,23 +3301,23 @@
                                    >>   44 RETURN_VALUE
                            consts
                               6
                            names      ('round',)
                            varnames   ('.0', 'q')
                            freevars   ()
                            cellvars   ()
-                           filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                           filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                            name       '<listcomp>'
                            firstlineno 476
                            lnotab 0x
                      names      ()
                      varnames   ('.0', 'qd')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
                      firstlineno 476
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 3
                      stacksize : 4
@@ -3345,23 +3351,23 @@
                      consts
                         1e-06
                         None
                      names      ('abs',)
                      varnames   ('.0', 'i', 'x')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<genexpr>'
                      firstlineno 480
                      lnotab 0x
                names      ('extend', 'np', 'arange', 'torch', 'tensor', 'dtype', 'to', 'device', 'quantile', 'T', 'tolist', 'enumerate', 'next', 'len')
                varnames   ('cls', 'data', 'ranges_and_precisions', 'quantiles', 'r', 'p', 'start', 'end', 'step', 'quantile_data', 'quantiles_tensor', 'i', 'qd', 'first_nonzero')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'from_data'
                firstlineno 448
                lnotab
                   0x020b04010e010a010c01600304010401060366015c0320011803280168
                   011c02
             'other'
             code
@@ -3416,15 +3422,15 @@
                   "\n        Merges two QuantileCalculator objects together (changing self inplace). This is useful when we're batching our\n        calculations over different groups of features, and we want to merge them together at the end.\n\n        Note, we also deal with the special case where self has no data.\n        "
                   "Error: can't merge two QuantileCalculator objects with different ranges."
                   None
                names      ('ranges_and_precisions', 'quantiles', 'extend', 'quantile_data')
                varnames   ('self', 'other')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'update'
                firstlineno 486
                lnotab 0x0207220102ff10033e01
             'values'
             'batch *data_dim'
             'batch_indices'
             code
@@ -3470,15 +3476,15 @@
                
                522           4 LOAD_FAST                0 (self)
                              6 LOAD_ATTR                0 (ranges_and_precisions)
                             16 STORE_FAST               3 (rp)
                
                523          18 LOAD_GLOBAL              3 (NULL + torch)
                             30 LOAD_ATTR                2 (tensor)
-                            40 LOAD_CONST               1 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 523>)
+                            40 LOAD_CONST               1 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 523>)
                             42 MAKE_FUNCTION            0
                             44 LOAD_FAST                3 (rp)
                             46 GET_ITER
                             48 PRECALL                  0
                             52 CALL                     0
                             62 LOAD_CONST               2 (1.0)
                             64 BUILD_LIST               1
@@ -3496,15 +3502,15 @@
                            146 LOAD_ATTR                2 (tensor)
                            156 LOAD_FAST                3 (rp)
                            158 LOAD_CONST               3 (0)
                            160 BINARY_SUBSCR
                            170 LOAD_CONST               4 (1)
                            172 BINARY_SUBSCR
                            182 BUILD_LIST               1
-                           184 LOAD_CONST               5 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 524>)
+                           184 LOAD_CONST               5 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 524>)
                            186 MAKE_FUNCTION            0
                            188 LOAD_FAST                3 (rp)
                            190 GET_ITER
                            192 PRECALL                  0
                            196 CALL                     0
                            206 BINARY_OP                0 (+)
                            210 LOAD_FAST                3 (rp)
@@ -3545,15 +3551,15 @@
                            438 CALL                     1
                            448 STORE_FAST               6 (quantiles)
                
                530         450 LOAD_GLOBAL              3 (NULL + torch)
                            462 LOAD_ATTR                2 (tensor)
                            472 LOAD_CLOSURE            12 (n_buckets)
                            474 BUILD_TUPLE              1
-                           476 LOAD_CONST               7 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 530>)
+                           476 LOAD_CONST               7 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 530>)
                            478 MAKE_FUNCTION            8 (closure)
                            480 LOAD_FAST                0 (self)
                            482 LOAD_ATTR                7 (quantile_data)
                            492 GET_ITER
                            494 PRECALL                  0
                            498 CALL                     0
                            508 PRECALL                  1
@@ -3665,15 +3671,15 @@
                              >>   34 RETURN_VALUE
                      consts
                         0
                      names      ()
                      varnames   ('.0', 'r', 'p')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
                      firstlineno 523
                      lnotab 0x
                   1.0
                   0
                   1
                   code
@@ -3694,15 +3700,15 @@
                                   20 JUMP_BACKWARD            8 (to 6)
                              >>   22 RETURN_VALUE
                      consts
                      names      ()
                      varnames   ('.0', 'r', 'p')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
                      firstlineno 524
                      lnotab 0x
                   -1
                   code
                      argcount  : 1
                      nlocals   : 2
@@ -3727,36 +3733,36 @@
                                   44 JUMP_BACKWARD           19 (to 8)
                              >>   46 RETURN_VALUE
                      consts
                      names      ('pad_with_zeros',)
                      varnames   ('.0', 'x')
                      freevars   ('n_buckets',)
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
                      firstlineno 530
                      lnotab 0x
                   None
                names      ('ranges_and_precisions', 'torch', 'tensor', 'to', 'device', 'len', 'quantiles', 'quantile_data', 'ndim', 'unsqueeze', 'slice', 'searchsorted', 'squeeze')
                varnames   ('self', 'values', 'batch_indices', 'rp', 'ranges', 'precisions', 'quantiles', 'quantile_data', 'values_is_1d', 'my_slice', 'quantile_indices', 'precision_indices')
                freevars   ()
                cellvars   ('n_buckets',)
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'get_quantile'
                firstlineno 500
                lnotab
                   0x04160e017401ac042e0162017a02160104012a032603360110032a0110
                   0304012a012a02
             ('other', 'QuantileCalculator')
             (None,)
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'list', 'quantiles', 'List', 'float', '__annotations__', 'quantile_data', 'ranges_and_precisions', 'classmethod', 'ASYMMETRIC_RANGES_AND_PRECISIONS', 'Optional', 'Float', 'Tensor', 'from_data', 'update', 'int', 'Tuple', 'Int', 'get_quantile')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'QuantileCalculator'
          firstlineno 430
          lnotab
             0x0c03040b2e013a0124020203020102fd04021efe020302fd020402fc06
             ff0e010225081102fd040212fe02031afd020432fc
       'QuantileCalculator'
       100000
@@ -3788,15 +3794,15 @@
                       50 RETURN_VALUE
          consts
             None
          names      ('len',)
          varnames   ('.0', 'x')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       '<genexpr>'
          firstlineno 563
          lnotab 0x
       '_'
       'Total datapoints used to compute quantiles = '
       '\n'
       (0.0, 0.005, 0.02, 0.25)
@@ -3909,15 +3915,15 @@
             ('flags',)
             1
             ''
          names      ('re', 'escape', 'search', 'DOTALL', 'group', 'replace')
          varnames   ('input_string', 'str1', 'str2', 'pattern', 'match', 'between_str1_str2', 'remaining_string')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'split_string'
          firstlineno 581
          lnotab 0x020524015801420104012a012c010802
       'The quick brown fox jumps over the lazy dog'
       'quick'
       'jumps'
       'Before table <!-- Logits table --> Table <!-- Logits histogram --> After table'
@@ -3942,15 +3948,15 @@
          
          612           2 RESUME                   0
          
          629           4 LOAD_CONST               1 ('\n')
                        6 LOAD_METHOD              0 (join)
                       28 LOAD_CLOSURE             1 (prefix)
                       30 BUILD_TUPLE              1
-                      32 LOAD_CONST               2 (<code object <genexpr>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 629>)
+                      32 LOAD_CONST               2 (<code object <genexpr>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 629>)
                       34 MAKE_FUNCTION            8 (closure)
                       36 LOAD_FAST                0 (text)
                       38 LOAD_METHOD              1 (split)
                       60 LOAD_CONST               1 ('\n')
                       62 PRECALL                  1
                       66 CALL                     1
                       76 GET_ITER
@@ -4005,24 +4011,24 @@
                             32 RETURN_VALUE
                consts
                   None
                names      ()
                varnames   ('.0', 'line')
                freevars   ('prefix',)
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '<genexpr>'
                firstlineno 629
                lnotab 0x
             None
          names      ('join', 'split', 'len')
          varnames   ('text', 'prefix', 'first_line_indented', 'text_indented')
          freevars   ()
          cellvars   ('prefix',)
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'apply_indent'
          firstlineno 612
          lnotab 0x0411680104012e02
       ''
       'dict1'
       'dict2'
       'path'
@@ -4181,51 +4187,51 @@
             '] = '
             'Merge failed. Conflicting paths:\n'
             '\n'
          names      ('copy', 'items', 'isinstance', 'dict', 'deep_union', 'list', 'ValueError')
          varnames   ('dict1', 'dict2', 'path', 'result', 'key2', 'value2', 'value1', 'path1', 'path2')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'deep_union'
          firstlineno 639
          lnotab 0x02202803320308010c0510035401380354011204160116012a02
       (1, 3)
       (2, 3)
       'y'
       'z'
       'w'
       ('z', 'w')
       (1, 2, 3, 4)
       code
          argcount  : 0
          nlocals   : 0
-         stacksize : 12
+         stacksize : 14
          flags     : 0
          code
-            0x970065005a0164005a0264015a036410640484045a0464056505650664
+            0x970065005a0164005a0264015a036412640484045a0464056505650664
             066602190000000000000000006407650565066408660219000000000000
-            000000640264036606640984045a076402650865056506640a6602190000
-            0000000000000065056506640a6602190000000000000000006602190000
-            000000000000006602640b84045a0909006411640d650a640e650b640265
-            08650c650c650a1900000000000000000019000000000000000000650c65
-            0c650d1900000000000000000019000000000000000000650c650c650d19
-            000000000000000000190000000000000000006603190000000000000000
-            006606640f84055a0e64035300
+            000000640264036606640984045a0709006413640b650864026509650565
+            06640c66021900000000000000000065056506640c660219000000000000
+            0000006602190000000000000000006604640d84055a0a09000900641464
+            0f650b64106508640b650864026509650c650c650b190000000000000000
+            0019000000000000000000650c650c650d19000000000000000000190000
+            00000000000000650c650c650d1900000000000000000019000000000000
+            0000006603190000000000000000006608641184055a0e64035300
          727           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('BatchedCorrCoef')
                        8 STORE_NAME               2 (__qualname__)
          
          728          10 LOAD_CONST               1 ("\n    This class helps compute corrcoef (Pearson & cosine sim) between 2 batches of vectors, without having to store the\n    entire batch in memory. \n    \n    How exactly does it work? We exploit the formula below (x, y assumed to be vectors here), which writes corrcoefs in\n    terms of scalars which can be computed on a rolling basis.\n\n        cos_sim(x, y) = xy_sum / ((x2_sum ** 0.5) * (y2_sum ** 0.5))\n\n        pearson_corrcoef(x, y) = num / denom\n            num = n * xy_sum - x_sum * y_sum\n            denom = (n * x2_sum - x_sum ** 2) ** 0.5 * (n * y2_sum - y_sum ** 2) ** 0.5\n\n    This class batches this computation, i.e. x.shape = (X, N), y.shape = (Y, N), where:\n        N = batch_size * seq_len, i.e. it's the number of datapoints we have\n        x = features of our original encoder\n        y = features of our encoder-B, or neurons of our original model\n\n    So we can e.g. compute the correlation coefficients for every combination of feature in encoder and model neurons,\n    then take topk to find the most correlated neurons for each feature.\n    ")
                       12 STORE_NAME               3 (__doc__)
          
-         749          14 LOAD_CONST              16 (('return', None))
-                      16 LOAD_CONST               4 (<code object __init__, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 749>)
+         749          14 LOAD_CONST              18 (('return', None))
+                      16 LOAD_CONST               4 (<code object __init__, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 749>)
                       18 MAKE_FUNCTION            4 (annotations)
                       20 STORE_NAME               4 (__init__)
          
          752          22 LOAD_CONST               5 ('x')
                       24 LOAD_NAME                5 (Float)
                       26 LOAD_NAME                6 (Tensor)
                       28 LOAD_CONST               6 ('X N')
@@ -4236,75 +4242,90 @@
                       46 LOAD_NAME                6 (Tensor)
                       48 LOAD_CONST               8 ('Y N')
                       50 BUILD_TUPLE              2
                       52 BINARY_SUBSCR
                       62 LOAD_CONST               2 ('return')
                       64 LOAD_CONST               3 (None)
                       66 BUILD_TUPLE              6
-                      68 LOAD_CONST               9 (<code object update, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 752>)
+                      68 LOAD_CONST               9 (<code object update, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 752>)
                       70 MAKE_FUNCTION            4 (annotations)
                       72 STORE_NAME               7 (update)
          
-         772          74 LOAD_CONST               2 ('return')
-                      76 LOAD_NAME                8 (Tuple)
-                      78 LOAD_NAME                5 (Float)
-                      80 LOAD_NAME                6 (Tensor)
-                      82 LOAD_CONST              10 ('X Y')
-                      84 BUILD_TUPLE              2
-                      86 BINARY_SUBSCR
-                      96 LOAD_NAME                5 (Float)
-                      98 LOAD_NAME                6 (Tensor)
-                     100 LOAD_CONST              10 ('X Y')
-                     102 BUILD_TUPLE              2
-                     104 BINARY_SUBSCR
-                     114 BUILD_TUPLE              2
-                     116 BINARY_SUBSCR
-                     126 BUILD_TUPLE              2
-                     128 LOAD_CONST              11 (<code object corrcoef, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 772>)
-                     130 MAKE_FUNCTION            4 (annotations)
-                     132 STORE_NAME               9 (corrcoef)
+         774          74 NOP
          
-         787         134 NOP
+         772          76 LOAD_CONST              19 ((False,))
+                      78 LOAD_CONST              11 ('exclude_diag')
          
-         784         136 LOAD_CONST              17 ((True,))
-                     138 LOAD_CONST              13 ('k')
+         774          80 LOAD_NAME                8 (bool)
          
-         786         140 LOAD_NAME               10 (int)
+         772          82 LOAD_CONST               2 ('return')
          
-         784         142 LOAD_CONST              14 ('largest')
+         775          84 LOAD_NAME                9 (Tuple)
+                      86 LOAD_NAME                5 (Float)
+                      88 LOAD_NAME                6 (Tensor)
+                      90 LOAD_CONST              12 ('X Y')
+                      92 BUILD_TUPLE              2
+                      94 BINARY_SUBSCR
+                     104 LOAD_NAME                5 (Float)
+                     106 LOAD_NAME                6 (Tensor)
+                     108 LOAD_CONST              12 ('X Y')
+                     110 BUILD_TUPLE              2
+                     112 BINARY_SUBSCR
+                     122 BUILD_TUPLE              2
+                     124 BINARY_SUBSCR
          
-         787         144 LOAD_NAME               11 (bool)
+         772         134 BUILD_TUPLE              4
+                     136 LOAD_CONST              13 (<code object corrcoef, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 772>)
+                     138 MAKE_FUNCTION            5 (defaults, annotations)
+                     140 STORE_NAME              10 (corrcoef)
          
-         784         146 LOAD_CONST               2 ('return')
+         806         142 NOP
          
-         788         148 LOAD_NAME                8 (Tuple)
-                     150 LOAD_NAME               12 (list)
-                     152 LOAD_NAME               12 (list)
-                     154 LOAD_NAME               10 (int)
-                     156 BINARY_SUBSCR
-                     166 BINARY_SUBSCR
-                     176 LOAD_NAME               12 (list)
-                     178 LOAD_NAME               12 (list)
-                     180 LOAD_NAME               13 (float)
-                     182 BINARY_SUBSCR
-                     192 BINARY_SUBSCR
-                     202 LOAD_NAME               12 (list)
-                     204 LOAD_NAME               12 (list)
-                     206 LOAD_NAME               13 (float)
-                     208 BINARY_SUBSCR
-                     218 BINARY_SUBSCR
-                     228 BUILD_TUPLE              3
-                     230 BINARY_SUBSCR
-         
-         784         240 BUILD_TUPLE              6
-                     242 LOAD_CONST              15 (<code object topk_pearson, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 784>)
-                     244 MAKE_FUNCTION            5 (defaults, annotations)
-                     246 STORE_NAME              14 (topk_pearson)
-                     248 LOAD_CONST               3 (None)
-                     250 RETURN_VALUE
+         807         144 NOP
+         
+         803         146 LOAD_CONST              20 ((True, False))
+                     148 LOAD_CONST              15 ('k')
+         
+         805         150 LOAD_NAME               11 (int)
+         
+         803         152 LOAD_CONST              16 ('largest')
+         
+         806         154 LOAD_NAME                8 (bool)
+         
+         803         156 LOAD_CONST              11 ('exclude_diag')
+         
+         807         158 LOAD_NAME                8 (bool)
+         
+         803         160 LOAD_CONST               2 ('return')
+         
+         808         162 LOAD_NAME                9 (Tuple)
+                     164 LOAD_NAME               12 (list)
+                     166 LOAD_NAME               12 (list)
+                     168 LOAD_NAME               11 (int)
+                     170 BINARY_SUBSCR
+                     180 BINARY_SUBSCR
+                     190 LOAD_NAME               12 (list)
+                     192 LOAD_NAME               12 (list)
+                     194 LOAD_NAME               13 (float)
+                     196 BINARY_SUBSCR
+                     206 BINARY_SUBSCR
+                     216 LOAD_NAME               12 (list)
+                     218 LOAD_NAME               12 (list)
+                     220 LOAD_NAME               13 (float)
+                     222 BINARY_SUBSCR
+                     232 BINARY_SUBSCR
+                     242 BUILD_TUPLE              3
+                     244 BINARY_SUBSCR
+         
+         803         254 BUILD_TUPLE              8
+                     256 LOAD_CONST              17 (<code object topk_pearson, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 803>)
+                     258 MAKE_FUNCTION            5 (defaults, annotations)
+                     260 STORE_NAME              14 (topk_pearson)
+                     262 LOAD_CONST               3 (None)
+                     264 RETURN_VALUE
          consts
             'BatchedCorrCoef'
             "\n    This class helps compute corrcoef (Pearson & cosine sim) between 2 batches of vectors, without having to store the\n    entire batch in memory. \n    \n    How exactly does it work? We exploit the formula below (x, y assumed to be vectors here), which writes corrcoefs in\n    terms of scalars which can be computed on a rolling basis.\n\n        cos_sim(x, y) = xy_sum / ((x2_sum ** 0.5) * (y2_sum ** 0.5))\n\n        pearson_corrcoef(x, y) = num / denom\n            num = n * xy_sum - x_sum * y_sum\n            denom = (n * x2_sum - x_sum ** 2) ** 0.5 * (n * y2_sum - y_sum ** 2) ** 0.5\n\n    This class batches this computation, i.e. x.shape = (X, N), y.shape = (Y, N), where:\n        N = batch_size * seq_len, i.e. it's the number of datapoints we have\n        x = features of our original encoder\n        y = features of our encoder-B, or neurons of our original model\n\n    So we can e.g. compute the correlation coefficients for every combination of feature in encoder and model neurons,\n    then take topk to find the most correlated neurons for each feature.\n    "
             'return'
             None
             code
                argcount  : 1
@@ -4322,15 +4343,15 @@
                consts
                   None
                   0
                names      ('n',)
                varnames   ('self',)
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '__init__'
                firstlineno 749
                lnotab 0x0201
             'x'
             'X N'
             'y'
             'Y N'
@@ -4587,84 +4608,95 @@
                   'sum'
                   'Y N -> Y'
                   'X N, Y N -> X Y'
                names      ('ndim', 'shape', 'n', 'torch', 'zeros', 'device', 'x_sum', 'y_sum', 'xy_sum', 'x2_sum', 'y2_sum', 'einops', 'reduce', 'einsum')
                varnames   ('self', 'x', 'y')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'update'
                firstlineno 752
                lnotab 0x020140014c031601560156016e015601560336014801480148014e01
+            False
+            'exclude_diag'
             'X Y'
             code
-               argcount  : 1
-               nlocals   : 7
+               argcount  : 2
+               nlocals   : 9
                stacksize : 8
                flags     : 3
                code
-                  0x97007c006a0000000000000000007d017403000000000000000000006a
+                  0x97007c006a0000000000000000007d027403000000000000000000006a
                   0200000000000000007403000000000000000000006a0300000000000000
                   007c006a0400000000000000007c006a050000000000000000a6020000ab
                   020000000000000000a6010000ab01000000000000000064017a0000007d
-                  027c017c027a0b00007d037c006a0600000000000000007c006a00000000
+                  037c027c037a0b00007d047c006a0600000000000000007c006a00000000
                   00000000007a0500007403000000000000000000006a0300000000000000
                   007c006a0700000000000000007c006a080000000000000000a6020000ab
-                  0200000000000000007a0a00007d047403000000000000000000006a0200
+                  0200000000000000007a0a00007d057403000000000000000000006a0200
                   000000000000007403000000000000000000006a0300000000000000007c
                   006a0600000000000000007c006a0400000000000000007a0500007c006a
                   07000000000000000064027a0800007a0a00007c006a0600000000000000
                   007c006a0500000000000000007a0500007c006a08000000000000000064
                   027a0800007a0a0000a6020000ab020000000000000000a6010000ab0100
-                  0000000000000064017a0000007d057c047c057a0b00007d067c067c0366
-                  025300
+                  0000000000000064017a0000007d067c057c067a0b00007d077c01728e7c
+                  046a0900000000000000006403190000000000000000007d087415000000
+                  000000000000007c046a090000000000000000a6010000ab010000000000
+                  0000007415000000000000000000007c076a090000000000000000a60100
+                  00ab010000000000000000630278026b020000000072087c087c0866026b
+                  0200000000730c6e0101004a006404a6000000ab00000000000000000082
+                  0164057c047417000000000000000000007c08a6010000ab010000000000
+                  0000007417000000000000000000007c08a6010000ab0100000000000000
+                  0066023c00000064057c077417000000000000000000007c08a6010000ab
+                  0100000000000000007417000000000000000000007c08a6010000ab0100
+                  0000000000000066023c0000007c077c0466025300
                772           0 RESUME                   0
                
-               774           2 LOAD_FAST                0 (self)
+               785           2 LOAD_FAST                0 (self)
                              4 LOAD_ATTR                0 (xy_sum)
-                            14 STORE_FAST               1 (cossim_numer)
+                            14 STORE_FAST               2 (cossim_numer)
                
-               775          16 LOAD_GLOBAL              3 (NULL + torch)
+               786          16 LOAD_GLOBAL              3 (NULL + torch)
                             28 LOAD_ATTR                2 (sqrt)
                             38 LOAD_GLOBAL              3 (NULL + torch)
                             50 LOAD_ATTR                3 (outer)
                             60 LOAD_FAST                0 (self)
                             62 LOAD_ATTR                4 (x2_sum)
                             72 LOAD_FAST                0 (self)
                             74 LOAD_ATTR                5 (y2_sum)
                             84 PRECALL                  2
                             88 CALL                     2
                             98 PRECALL                  1
                            102 CALL                     1
                            112 LOAD_CONST               1 (1e-06)
                            114 BINARY_OP                0 (+)
-                           118 STORE_FAST               2 (cossim_denom)
+                           118 STORE_FAST               3 (cossim_denom)
                
-               776         120 LOAD_FAST                1 (cossim_numer)
-                           122 LOAD_FAST                2 (cossim_denom)
+               787         120 LOAD_FAST                2 (cossim_numer)
+                           122 LOAD_FAST                3 (cossim_denom)
                            124 BINARY_OP               11 (/)
-                           128 STORE_FAST               3 (cossim)
+                           128 STORE_FAST               4 (cossim)
                
-               778         130 LOAD_FAST                0 (self)
+               790         130 LOAD_FAST                0 (self)
                            132 LOAD_ATTR                6 (n)
                            142 LOAD_FAST                0 (self)
                            144 LOAD_ATTR                0 (xy_sum)
                            154 BINARY_OP                5 (*)
                            158 LOAD_GLOBAL              3 (NULL + torch)
                            170 LOAD_ATTR                3 (outer)
                            180 LOAD_FAST                0 (self)
                            182 LOAD_ATTR                7 (x_sum)
                            192 LOAD_FAST                0 (self)
                            194 LOAD_ATTR                8 (y_sum)
                            204 PRECALL                  2
                            208 CALL                     2
                            218 BINARY_OP               10 (-)
-                           222 STORE_FAST               4 (pearson_numer)
+                           222 STORE_FAST               5 (pearson_numer)
                
-               779         224 LOAD_GLOBAL              3 (NULL + torch)
+               791         224 LOAD_GLOBAL              3 (NULL + torch)
                            236 LOAD_ATTR                2 (sqrt)
                            246 LOAD_GLOBAL              3 (NULL + torch)
                            258 LOAD_ATTR                3 (outer)
                            268 LOAD_FAST                0 (self)
                            270 LOAD_ATTR                6 (n)
                            280 LOAD_FAST                0 (self)
                            282 LOAD_ATTR                4 (x2_sum)
@@ -4686,119 +4718,193 @@
                            364 BINARY_OP               10 (-)
                            368 PRECALL                  2
                            372 CALL                     2
                            382 PRECALL                  1
                            386 CALL                     1
                            396 LOAD_CONST               1 (1e-06)
                            398 BINARY_OP                0 (+)
-                           402 STORE_FAST               5 (pearson_denom)
+                           402 STORE_FAST               6 (pearson_denom)
                
-               780         404 LOAD_FAST                4 (pearson_numer)
-                           406 LOAD_FAST                5 (pearson_denom)
+               792         404 LOAD_FAST                5 (pearson_numer)
+                           406 LOAD_FAST                6 (pearson_denom)
                            408 BINARY_OP               11 (/)
-                           412 STORE_FAST               6 (pearson)
+                           412 STORE_FAST               7 (pearson)
+               
+               795         414 LOAD_FAST                1 (exclude_diag)
+                           416 POP_JUMP_FORWARD_IF_FALSE   142 (to 702)
                
-               782         414 LOAD_FAST                6 (pearson)
-                           416 LOAD_FAST                3 (cossim)
-                           418 BUILD_TUPLE              2
-                           420 RETURN_VALUE
+               796         418 LOAD_FAST                4 (cossim)
+                           420 LOAD_ATTR                9 (shape)
+                           430 LOAD_CONST               3 (0)
+                           432 BINARY_SUBSCR
+                           442 STORE_FAST               8 (d)
+               
+               797         444 LOAD_GLOBAL             21 (NULL + tuple)
+                           456 LOAD_FAST                4 (cossim)
+                           458 LOAD_ATTR                9 (shape)
+                           468 PRECALL                  1
+                           472 CALL                     1
+                           482 LOAD_GLOBAL             21 (NULL + tuple)
+                           494 LOAD_FAST                7 (pearson)
+                           496 LOAD_ATTR                9 (shape)
+                           506 PRECALL                  1
+                           510 CALL                     1
+                           520 SWAP                     2
+                           522 COPY                     2
+                           524 COMPARE_OP               2 (==)
+                           530 POP_JUMP_FORWARD_IF_FALSE     8 (to 548)
+                           532 LOAD_FAST                8 (d)
+                           534 LOAD_FAST                8 (d)
+                           536 BUILD_TUPLE              2
+                           538 COMPARE_OP               2 (==)
+                           544 POP_JUMP_FORWARD_IF_TRUE    12 (to 570)
+                           546 JUMP_FORWARD             1 (to 550)
+                       >>  548 POP_TOP
+                       >>  550 LOAD_ASSERTION_ERROR
+                           552 LOAD_CONST               4 ('X and Y should be the same dataset')
+                           554 PRECALL                  0
+                           558 CALL                     0
+                           568 RAISE_VARARGS            1
+               
+               798     >>  570 LOAD_CONST               5 (0.0)
+                           572 LOAD_FAST                4 (cossim)
+                           574 LOAD_GLOBAL             23 (NULL + range)
+                           586 LOAD_FAST                8 (d)
+                           588 PRECALL                  1
+                           592 CALL                     1
+                           602 LOAD_GLOBAL             23 (NULL + range)
+                           614 LOAD_FAST                8 (d)
+                           616 PRECALL                  1
+                           620 CALL                     1
+                           630 BUILD_TUPLE              2
+                           632 STORE_SUBSCR
+               
+               799         636 LOAD_CONST               5 (0.0)
+                           638 LOAD_FAST                7 (pearson)
+                           640 LOAD_GLOBAL             23 (NULL + range)
+                           652 LOAD_FAST                8 (d)
+                           654 PRECALL                  1
+                           658 CALL                     1
+                           668 LOAD_GLOBAL             23 (NULL + range)
+                           680 LOAD_FAST                8 (d)
+                           682 PRECALL                  1
+                           686 CALL                     1
+                           696 BUILD_TUPLE              2
+                           698 STORE_SUBSCR
+               
+               801     >>  702 LOAD_FAST                7 (pearson)
+                           704 LOAD_FAST                4 (cossim)
+                           706 BUILD_TUPLE              2
+                           708 RETURN_VALUE
                consts
-                  None
+                  "\n        Computes the correlation coefficients between x and y, using the formulae given in the class docstring.\n\n        Args:\n            exclude_diag: bool\n                If True, we assume X and Y are the same dataset, and we don't include the diagonal in the topk (since\n                correlation with self is always 1, this is not interesting).\n        "
                   1e-06
                   2
-               names      ('xy_sum', 'torch', 'sqrt', 'outer', 'x2_sum', 'y2_sum', 'n', 'x_sum', 'y_sum')
-               varnames   ('self', 'cossim_numer', 'cossim_denom', 'cossim', 'pearson_numer', 'pearson_denom', 'pearson')
+                  0
+                  'X and Y should be the same dataset'
+                  0.0
+               names      ('xy_sum', 'torch', 'sqrt', 'outer', 'x2_sum', 'y2_sum', 'n', 'x_sum', 'y_sum', 'shape', 'tuple', 'range')
+               varnames   ('self', 'exclude_diag', 'cossim_numer', 'cossim_denom', 'cossim', 'pearson_numer', 'pearson_denom', 'pearson', 'd')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'corrcoef'
                firstlineno 772
-               lnotab 0x02020e0168010a025e01b4010a02
+               lnotab 0x020d0e0168010a035e01b4010a0304011a017e0142014202
             True
             'k'
             'largest'
             code
-               argcount  : 3
-               nlocals   : 7
+               argcount  : 4
+               nlocals   : 8
                stacksize : 5
                flags     : 3
                code
-                  0x97007c00a0000000000000000000000000000000000000000000a60000
-                  00ab0000000000000000005c0200007d037d047403000000000000000000
-                  007c037c017c02a6030000ab0300000000000000007d0574050000000000
-                  00000000007c047c056a0300000000000000006401a6030000ab03000000
-                  00000000007d067c056a030000000000000000a004000000000000000000
-                  0000000000000000000000a6000000ab0000000000000000007c056a0500
-                  00000000000000a0040000000000000000000000000000000000000000a6
-                  000000ab0000000000000000007c06a00400000000000000000000000000
-                  00000000000000a6000000ab00000000000000000066035300
-               784           0 RESUME                   0
+                  0x97007c00a00000000000000000000000000000000000000000007c03ac
+                  01a6010000ab0100000000000000005c0200007d047d0574030000000000
+                  00000000007c047c017c02ac02a6030000ab0300000000000000007d0674
+                  05000000000000000000007c057c066a0300000000000000006403a60300
+                  00ab0300000000000000007d077c066a030000000000000000a004000000
+                  0000000000000000000000000000000000a6000000ab0000000000000000
+                  007c066a050000000000000000a004000000000000000000000000000000
+                  0000000000a6000000ab0000000000000000007c07a00400000000000000
+                  00000000000000000000000000a6000000ab000000000000000000660353
+                  00
+               803           0 RESUME                   0
                
-               808           2 LOAD_FAST                0 (self)
+               831           2 LOAD_FAST                0 (self)
                              4 LOAD_METHOD              0 (corrcoef)
-                            26 PRECALL                  0
-                            30 CALL                     0
-                            40 UNPACK_SEQUENCE          2
-                            44 STORE_FAST               3 (pearson)
-                            46 STORE_FAST               4 (cossim)
-               
-               811          48 LOAD_GLOBAL              3 (NULL + TopK)
-                            60 LOAD_FAST                3 (pearson)
-                            62 LOAD_FAST                1 (k)
-                            64 LOAD_FAST                2 (largest)
-                            66 PRECALL                  3
-                            70 CALL                     3
-                            80 STORE_FAST               5 (pearson_topk)
-               
-               814          82 LOAD_GLOBAL              5 (NULL + eindex)
-                            94 LOAD_FAST                4 (cossim)
-                            96 LOAD_FAST                5 (pearson_topk)
-                            98 LOAD_ATTR                3 (indices)
-                           108 LOAD_CONST               1 ('X [X k]')
-                           110 PRECALL                  3
-                           114 CALL                     3
-                           124 STORE_FAST               6 (cossim_values)
-               
-               816         126 LOAD_FAST                5 (pearson_topk)
-                           128 LOAD_ATTR                3 (indices)
-                           138 LOAD_METHOD              4 (tolist)
-                           160 PRECALL                  0
-                           164 CALL                     0
-                           174 LOAD_FAST                5 (pearson_topk)
-                           176 LOAD_ATTR                5 (values)
-                           186 LOAD_METHOD              4 (tolist)
-                           208 PRECALL                  0
-                           212 CALL                     0
-                           222 LOAD_FAST                6 (cossim_values)
-                           224 LOAD_METHOD              4 (tolist)
-                           246 PRECALL                  0
-                           250 CALL                     0
-                           260 BUILD_TUPLE              3
-                           262 RETURN_VALUE
+                            26 LOAD_FAST                3 (exclude_diag)
+                            28 KW_NAMES                 1
+                            30 PRECALL                  1
+                            34 CALL                     1
+                            44 UNPACK_SEQUENCE          2
+                            48 STORE_FAST               4 (pearson)
+                            50 STORE_FAST               5 (cossim)
+               
+               834          52 LOAD_GLOBAL              3 (NULL + TopK)
+                            64 LOAD_FAST                4 (pearson)
+                            66 LOAD_FAST                1 (k)
+                            68 LOAD_FAST                2 (largest)
+                            70 KW_NAMES                 2
+                            72 PRECALL                  3
+                            76 CALL                     3
+                            86 STORE_FAST               6 (pearson_topk)
+               
+               837          88 LOAD_GLOBAL              5 (NULL + eindex)
+                           100 LOAD_FAST                5 (cossim)
+                           102 LOAD_FAST                6 (pearson_topk)
+                           104 LOAD_ATTR                3 (indices)
+                           114 LOAD_CONST               3 ('X [X k]')
+                           116 PRECALL                  3
+                           120 CALL                     3
+                           130 STORE_FAST               7 (cossim_values)
+               
+               839         132 LOAD_FAST                6 (pearson_topk)
+                           134 LOAD_ATTR                3 (indices)
+                           144 LOAD_METHOD              4 (tolist)
+                           166 PRECALL                  0
+                           170 CALL                     0
+                           180 LOAD_FAST                6 (pearson_topk)
+                           182 LOAD_ATTR                5 (values)
+                           192 LOAD_METHOD              4 (tolist)
+                           214 PRECALL                  0
+                           218 CALL                     0
+                           228 LOAD_FAST                7 (cossim_values)
+                           230 LOAD_METHOD              4 (tolist)
+                           252 PRECALL                  0
+                           256 CALL                     0
+                           266 BUILD_TUPLE              3
+                           268 RETURN_VALUE
                consts
-                  '\n        Takes topk of the pearson corrcoefs over the y-dimension (e.g. giving us the most correlated neurons or most\n        correlated encoder-B features for each encoder feature).\n\n        Args:\n            k: int\n                Number of top indices to take (usually 3, for the left-hand tables)\n            largest: bool\n                If True, then we take the largest k indices. If False, then we take the smallest k indices.\n\n        Returns:\n            pearson_indices: list[list[int]]\n                y-indices which are most correlated with each x-index (in terms of pearson corrcoef)\n            pearson_values: list[list[float]]\n                Values of pearson corrcoef for each of the topk indices\n            cossim_values: list[list[float]]\n                Values of cosine similarity for each of the topk indices\n        '
+                  "\n        Takes topk of the pearson corrcoefs over the y-dimension (e.g. giving us the most correlated neurons or most\n        correlated encoder-B features for each encoder feature).\n\n        Args:\n            k: int\n                Number of top indices to take (usually 3, for the left-hand tables)\n            largest: bool\n                If True, then we take the largest k indices. If False, then we take the smallest k indices.\n            exclude_diag: bool\n                If True, we assume X and Y are the same dataset, and we don't include the diagonal in the topk (since\n                correlation with self is always 1, this is not interesting).\n\n        Returns:\n            pearson_indices: list[list[int]]\n                y-indices which are most correlated with each x-index (in terms of pearson corrcoef)\n            pearson_values: list[list[float]]\n                Values of pearson corrcoef for each of the topk indices\n            cossim_values: list[list[float]]\n                Values of cosine similarity for each of the topk indices\n        "
+                  ('exclude_diag',)
+                  ('tensor', 'k', 'largest')
                   'X [X k]'
                names      ('corrcoef', 'TopK', 'eindex', 'indices', 'tolist', 'values')
-               varnames   ('self', 'k', 'largest', 'pearson', 'cossim', 'pearson_topk', 'cossim_values')
+               varnames   ('self', 'k', 'largest', 'exclude_diag', 'pearson', 'cossim', 'pearson_topk', 'cossim_values')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'topk_pearson'
-               firstlineno 784
-               lnotab 0x02182e0322032c02
+               firstlineno 803
+               lnotab 0x021c320324032c02
             ('return', None)
-            (True,)
-         names      ('__name__', '__module__', '__qualname__', '__doc__', '__init__', 'Float', 'Tensor', 'update', 'Tuple', 'corrcoef', 'int', 'bool', 'list', 'float', 'topk_pearson')
+            (False,)
+            (True, False)
+         names      ('__name__', '__module__', '__qualname__', '__doc__', '__init__', 'Float', 'Tensor', 'update', 'bool', 'Tuple', 'corrcoef', 'int', 'list', 'float', 'topk_pearson')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'BatchedCorrCoef'
          firstlineno 727
-         lnotab 0x0a010415080334143c0f02fd040202fe020302fd02045cfc
+         lnotab
+            0x0a0104150803341602fe040202fe020332fd0822020102fc040202fe02
+            0302fd020402fc02055cfb
       'BatchedCorrCoef'
       code
          argcount  : 0
          nlocals   : 0
          stacksize : 13
          flags     : 0
          code
@@ -4807,115 +4913,115 @@
             000000020065046505ac02a6010000ab0100000000000000005a09650565
             0719000000000000000000650864043c000000020065046505ac02a60100
             00ab0100000000000000005a0a6505650719000000000000000000650864
             053c00000064065a0b650c650d19000000000000000000650864073c0000
             00650e6408650f65101900000000000000000064096511640a6512640b65
             13640c190000000000000000006407650c650d1900000000000000000064
             0d6510660c640e8404a6000000ab0000000000000000005a1464065300
-         819           0 RESUME                   0
+         842           0 RESUME                   0
                        2 LOAD_NAME                0 (__name__)
                        4 STORE_NAME               1 (__module__)
                        6 LOAD_CONST               0 ('HistogramData')
                        8 STORE_NAME               2 (__qualname__)
                       10 SETUP_ANNOTATIONS
          
-         822          12 LOAD_CONST               1 ("\n    This class contains all the data necessary to construct a single histogram (e.g. the logits or feat acts histogram).\n    See diagram in readme:\n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    We don't need to store the entire `data` tensor, so we initialize instances of this class using the `from_data`\n    method, which computes statistics from the input data tensor then discards it.\n\n        bar_heights: The height of each bar in the histogram\n        bar_values: The value of each bar in the histogram\n        tick_vals: The tick values we want to use for the histogram\n    ")
+         845          12 LOAD_CONST               1 ("\n    This class contains all the data necessary to construct a single histogram (e.g. the logits or feat acts histogram).\n    See diagram in readme:\n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    We don't need to store the entire `data` tensor, so we initialize instances of this class using the `from_data`\n    method, which computes statistics from the input data tensor then discards it.\n\n        bar_heights: The height of each bar in the histogram\n        bar_values: The value of each bar in the histogram\n        tick_vals: The tick values we want to use for the histogram\n    ")
                       14 STORE_NAME               3 (__doc__)
          
-         835          16 PUSH_NULL
+         858          16 PUSH_NULL
                       18 LOAD_NAME                4 (field)
                       20 LOAD_NAME                5 (list)
                       22 KW_NAMES                 2
                       24 PRECALL                  1
                       28 CALL                     1
                       38 STORE_NAME               6 (bar_heights)
                       40 LOAD_NAME                5 (list)
                       42 LOAD_NAME                7 (float)
                       44 BINARY_SUBSCR
                       54 LOAD_NAME                8 (__annotations__)
                       56 LOAD_CONST               3 ('bar_heights')
                       58 STORE_SUBSCR
          
-         836          62 PUSH_NULL
+         859          62 PUSH_NULL
                       64 LOAD_NAME                4 (field)
                       66 LOAD_NAME                5 (list)
                       68 KW_NAMES                 2
                       70 PRECALL                  1
                       74 CALL                     1
                       84 STORE_NAME               9 (bar_values)
                       86 LOAD_NAME                5 (list)
                       88 LOAD_NAME                7 (float)
                       90 BINARY_SUBSCR
                      100 LOAD_NAME                8 (__annotations__)
                      102 LOAD_CONST               4 ('bar_values')
                      104 STORE_SUBSCR
          
-         837         108 PUSH_NULL
+         860         108 PUSH_NULL
                      110 LOAD_NAME                4 (field)
                      112 LOAD_NAME                5 (list)
                      114 KW_NAMES                 2
                      116 PRECALL                  1
                      120 CALL                     1
                      130 STORE_NAME              10 (tick_vals)
                      132 LOAD_NAME                5 (list)
                      134 LOAD_NAME                7 (float)
                      136 BINARY_SUBSCR
                      146 LOAD_NAME                8 (__annotations__)
                      148 LOAD_CONST               5 ('tick_vals')
                      150 STORE_SUBSCR
          
-         838         154 LOAD_CONST               6 (None)
+         861         154 LOAD_CONST               6 (None)
                      156 STORE_NAME              11 (title)
                      158 LOAD_NAME               12 (Optional)
                      160 LOAD_NAME               13 (str)
                      162 BINARY_SUBSCR
                      172 LOAD_NAME                8 (__annotations__)
                      174 LOAD_CONST               7 ('title')
                      176 STORE_SUBSCR
          
-         840         180 LOAD_NAME               14 (classmethod)
+         863         180 LOAD_NAME               14 (classmethod)
          
-         841         182 LOAD_CONST               8 ('cls')
+         864         182 LOAD_CONST               8 ('cls')
          
-         842         184 LOAD_NAME               15 (Type)
+         865         184 LOAD_NAME               15 (Type)
                      186 LOAD_NAME               16 (T)
                      188 BINARY_SUBSCR
          
-         841         198 LOAD_CONST               9 ('data')
+         864         198 LOAD_CONST               9 ('data')
          
-         843         200 LOAD_NAME               17 (Tensor)
+         866         200 LOAD_NAME               17 (Tensor)
          
-         841         202 LOAD_CONST              10 ('n_bins')
+         864         202 LOAD_CONST              10 ('n_bins')
          
-         844         204 LOAD_NAME               18 (int)
+         867         204 LOAD_NAME               18 (int)
          
-         841         206 LOAD_CONST              11 ('tickmode')
+         864         206 LOAD_CONST              11 ('tickmode')
          
-         845         208 LOAD_NAME               19 (Literal)
+         868         208 LOAD_NAME               19 (Literal)
                      210 LOAD_CONST              12 (('ints', '5 ticks'))
                      212 BINARY_SUBSCR
          
-         841         222 LOAD_CONST               7 ('title')
+         864         222 LOAD_CONST               7 ('title')
          
-         846         224 LOAD_NAME               12 (Optional)
+         869         224 LOAD_NAME               12 (Optional)
                      226 LOAD_NAME               13 (str)
                      228 BINARY_SUBSCR
          
-         841         238 LOAD_CONST              13 ('return')
+         864         238 LOAD_CONST              13 ('return')
          
-         847         240 LOAD_NAME               16 (T)
+         870         240 LOAD_NAME               16 (T)
          
-         841         242 BUILD_TUPLE             12
-                     244 LOAD_CONST              14 (<code object from_data, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 840>)
+         864         242 BUILD_TUPLE             12
+                     244 LOAD_CONST              14 (<code object from_data, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 863>)
                      246 MAKE_FUNCTION            4 (annotations)
          
-         840         248 PRECALL                  0
+         863         248 PRECALL                  0
                      252 CALL                     0
          
-         841         262 STORE_NAME              20 (from_data)
+         864         262 STORE_NAME              20 (from_data)
                      264 LOAD_CONST               6 (None)
                      266 RETURN_VALUE
          consts
             'HistogramData'
             "\n    This class contains all the data necessary to construct a single histogram (e.g. the logits or feat acts histogram).\n    See diagram in readme:\n\n        https://github.com/callummcdougall/sae_vis#data_storing_fnspy\n\n    We don't need to store the entire `data` tensor, so we initialize instances of this class using the `from_data`\n    method, which computes statistics from the input data tensor then discards it.\n\n        bar_heights: The height of each bar in the histogram\n        bar_values: The value of each bar in the histogram\n        tick_vals: The tick values we want to use for the histogram\n    "
             ('default_factory',)
             'bar_heights'
@@ -4970,82 +5076,82 @@
                   0f660164118408741900000000000000000000640264027c0d7a000000a6
                   020000ab0200000000000000004400a6000000ab000000000000000000a6
                   030000ab0300000000000000007d0c641284007c0c4400a6000000ab0000
                   000000000000007d0c02007c007c097c0a7c0c7c04ac13a6040000ab0400
                   000000000000005300
                              0 MAKE_CELL               15 (tickrange)
                
-               840           2 RESUME                   0
+               863           2 RESUME                   0
                
-               858           4 LOAD_FAST                1 (data)
+               881           4 LOAD_FAST                1 (data)
                              6 LOAD_METHOD              0 (numel)
                             28 PRECALL                  0
                             32 CALL                     0
                             42 LOAD_CONST               1 (0)
                             44 COMPARE_OP               2 (==)
                             50 POP_JUMP_FORWARD_IF_FALSE    10 (to 72)
                
-               859          52 PUSH_NULL
+               882          52 PUSH_NULL
                             54 LOAD_FAST                0 (cls)
                             56 PRECALL                  0
                             60 CALL                     0
                             70 RETURN_VALUE
                
-               862     >>   72 LOAD_FAST                1 (data)
+               885     >>   72 LOAD_FAST                1 (data)
                             74 LOAD_METHOD              1 (max)
                             96 PRECALL                  0
                            100 CALL                     0
                            110 LOAD_METHOD              2 (item)
                            132 PRECALL                  0
                            136 CALL                     0
                            146 STORE_FAST               5 (max_value)
                
-               863         148 LOAD_FAST                1 (data)
+               886         148 LOAD_FAST                1 (data)
                            150 LOAD_METHOD              3 (min)
                            172 PRECALL                  0
                            176 CALL                     0
                            186 LOAD_METHOD              2 (item)
                            208 PRECALL                  0
                            212 CALL                     0
                            222 STORE_FAST               6 (min_value)
                
-               866         224 LOAD_FAST                5 (max_value)
+               889         224 LOAD_FAST                5 (max_value)
                            226 LOAD_FAST                6 (min_value)
                            228 BINARY_OP               10 (-)
                            232 LOAD_FAST                2 (n_bins)
                            234 BINARY_OP               11 (/)
                            238 STORE_FAST               7 (bin_size)
                
-               867         240 LOAD_GLOBAL              9 (NULL + torch)
+               890         240 LOAD_GLOBAL              9 (NULL + torch)
                            252 LOAD_ATTR                5 (linspace)
                            262 LOAD_FAST                6 (min_value)
                            264 LOAD_FAST                5 (max_value)
                            266 LOAD_FAST                2 (n_bins)
                            268 LOAD_CONST               2 (1)
                            270 BINARY_OP                0 (+)
                            274 PRECALL                  3
                            278 CALL                     3
                            288 STORE_FAST               8 (bin_edges)
                
-               869         290 LOAD_GLOBAL              9 (NULL + torch)
+               892         290 LOAD_GLOBAL              9 (NULL + torch)
                            302 LOAD_ATTR                6 (histc)
                            312 LOAD_FAST                1 (data)
                            314 LOAD_FAST                2 (n_bins)
                            316 KW_NAMES                 3
                            318 PRECALL                  2
                            322 CALL                     2
                            332 LOAD_METHOD              7 (int)
                            354 PRECALL                  0
                            358 CALL                     0
                            368 LOAD_METHOD              8 (tolist)
                            390 PRECALL                  0
                            394 CALL                     0
                            404 STORE_FAST               9 (bar_heights)
                
-               870         406 LOAD_CONST               4 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 870>)
+               893         406 LOAD_CONST               4 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 893>)
                            408 MAKE_FUNCTION            0
                            410 LOAD_FAST                8 (bin_edges)
                            412 LOAD_CONST               5 (None)
                            414 LOAD_CONST               6 (-1)
                            416 BUILD_SLICE              2
                            418 BINARY_SUBSCR
                            428 LOAD_FAST                7 (bin_size)
@@ -5056,173 +5162,173 @@
                            462 PRECALL                  0
                            466 CALL                     0
                            476 GET_ITER
                            478 PRECALL                  0
                            482 CALL                     0
                            492 STORE_FAST              10 (bar_values)
                
-               874         494 LOAD_FAST                3 (tickmode)
+               897         494 LOAD_FAST                3 (tickmode)
                            496 LOAD_CONST               8 (('ints', '5 ticks'))
                            498 CONTAINS_OP              0
                            500 POP_JUMP_FORWARD_IF_TRUE     2 (to 506)
                            502 LOAD_ASSERTION_ERROR
                            504 RAISE_VARARGS            1
                
-               875     >>  506 LOAD_FAST                3 (tickmode)
+               898     >>  506 LOAD_FAST                3 (tickmode)
                            508 LOAD_CONST               9 ('ints')
                            510 COMPARE_OP               2 (==)
                            516 POP_JUMP_FORWARD_IF_FALSE    59 (to 636)
                
-               876         518 LOAD_GLOBAL             15 (NULL + int)
+               899         518 LOAD_GLOBAL             15 (NULL + int)
                            530 LOAD_FAST                5 (max_value)
                            532 PRECALL                  1
                            536 CALL                     1
                            546 STORE_FAST              11 (top_tickval)
                
-               877         548 LOAD_GLOBAL              9 (NULL + torch)
+               900         548 LOAD_GLOBAL              9 (NULL + torch)
                            560 LOAD_ATTR                9 (arange)
                            570 LOAD_CONST               1 (0)
                            572 LOAD_FAST               11 (top_tickval)
                            574 LOAD_CONST               2 (1)
                            576 BINARY_OP                0 (+)
                            580 LOAD_CONST               2 (1)
                            582 PRECALL                  3
                            586 CALL                     3
                            596 LOAD_METHOD              8 (tolist)
                            618 PRECALL                  0
                            622 CALL                     0
                            632 STORE_FAST              12 (tick_vals)
                            634 JUMP_FORWARD           211 (to 1058)
                
-               878     >>  636 LOAD_FAST                3 (tickmode)
+               901     >>  636 LOAD_FAST                3 (tickmode)
                            638 LOAD_CONST              10 ('5 ticks')
                            640 COMPARE_OP               2 (==)
                            646 POP_JUMP_FORWARD_IF_FALSE   205 (to 1058)
                
-               880         648 LOAD_FAST                5 (max_value)
+               903         648 LOAD_FAST                5 (max_value)
                            650 LOAD_FAST                6 (min_value)
                            652 UNARY_NEGATIVE
                            654 COMPARE_OP               4 (>)
                            660 POP_JUMP_FORWARD_IF_FALSE    49 (to 760)
                
-               881         662 LOAD_CONST              11 (0.1)
+               904         662 LOAD_CONST              11 (0.1)
                            664 LOAD_GLOBAL             15 (NULL + int)
                            676 LOAD_CONST              12 (0.0001)
                            678 LOAD_FAST                5 (max_value)
                            680 LOAD_CONST              13 (0.30000000000000004)
                            682 BINARY_OP               11 (/)
                            686 BINARY_OP                0 (+)
                            690 PRECALL                  1
                            694 CALL                     1
                            704 BINARY_OP                5 (*)
                            708 LOAD_CONST              14 (1e-06)
                            710 BINARY_OP                0 (+)
                            714 STORE_DEREF             15 (tickrange)
                
-               882         716 LOAD_CONST              15 (3)
+               905         716 LOAD_CONST              15 (3)
                            718 STORE_FAST              13 (num_positive_ticks)
                
-               883         720 LOAD_GLOBAL             15 (NULL + int)
+               906         720 LOAD_GLOBAL             15 (NULL + int)
                            732 LOAD_FAST                6 (min_value)
                            734 UNARY_NEGATIVE
                            736 LOAD_DEREF              15 (tickrange)
                            738 BINARY_OP               11 (/)
                            742 PRECALL                  1
                            746 CALL                     1
                            756 STORE_FAST              14 (num_negative_ticks)
                            758 JUMP_FORWARD            48 (to 856)
                
-               885     >>  760 LOAD_CONST              11 (0.1)
+               908     >>  760 LOAD_CONST              11 (0.1)
                            762 LOAD_GLOBAL             15 (NULL + int)
                            774 LOAD_CONST              12 (0.0001)
                            776 LOAD_FAST                6 (min_value)
                            778 UNARY_NEGATIVE
                            780 LOAD_CONST              13 (0.30000000000000004)
                            782 BINARY_OP               11 (/)
                            786 BINARY_OP                0 (+)
                            790 PRECALL                  1
                            794 CALL                     1
                            804 BINARY_OP                5 (*)
                            808 LOAD_CONST              14 (1e-06)
                            810 BINARY_OP                0 (+)
                            814 STORE_DEREF             15 (tickrange)
                
-               886         816 LOAD_CONST              15 (3)
+               909         816 LOAD_CONST              15 (3)
                            818 STORE_FAST              14 (num_negative_ticks)
                
-               887         820 LOAD_GLOBAL             15 (NULL + int)
+               910         820 LOAD_GLOBAL             15 (NULL + int)
                            832 LOAD_FAST                5 (max_value)
                            834 LOAD_DEREF              15 (tickrange)
                            836 BINARY_OP               11 (/)
                            840 PRECALL                  1
                            844 CALL                     1
                            854 STORE_FAST              13 (num_positive_ticks)
                
-               889     >>  856 LOAD_GLOBAL             21 (NULL + merge_lists)
+               912     >>  856 LOAD_GLOBAL             21 (NULL + merge_lists)
                
-               890         868 LOAD_GLOBAL             23 (NULL + reversed)
+               913         868 LOAD_GLOBAL             23 (NULL + reversed)
                            880 LOAD_CLOSURE            15 (tickrange)
                            882 BUILD_TUPLE              1
-                           884 LOAD_CONST              16 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 890>)
+                           884 LOAD_CONST              16 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 913>)
                            886 MAKE_FUNCTION            8 (closure)
                            888 LOAD_GLOBAL             25 (NULL + range)
                            900 LOAD_CONST               2 (1)
                            902 LOAD_CONST               2 (1)
                            904 LOAD_FAST               14 (num_negative_ticks)
                            906 BINARY_OP                0 (+)
                            910 PRECALL                  2
                            914 CALL                     2
                            924 GET_ITER
                            926 PRECALL                  0
                            930 CALL                     0
                            940 PRECALL                  1
                            944 CALL                     1
                
-               891         954 LOAD_CONST               1 (0)
+               914         954 LOAD_CONST               1 (0)
                            956 BUILD_LIST               1
                
-               892         958 LOAD_CLOSURE            15 (tickrange)
+               915         958 LOAD_CLOSURE            15 (tickrange)
                            960 BUILD_TUPLE              1
-                           962 LOAD_CONST              17 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 892>)
+                           962 LOAD_CONST              17 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 915>)
                            964 MAKE_FUNCTION            8 (closure)
                            966 LOAD_GLOBAL             25 (NULL + range)
                            978 LOAD_CONST               2 (1)
                            980 LOAD_CONST               2 (1)
                            982 LOAD_FAST               13 (num_positive_ticks)
                            984 BINARY_OP                0 (+)
                            988 PRECALL                  2
                            992 CALL                     2
                           1002 GET_ITER
                           1004 PRECALL                  0
                           1008 CALL                     0
                
-               889        1018 PRECALL                  3
+               912        1018 PRECALL                  3
                           1022 CALL                     3
                           1032 STORE_FAST              12 (tick_vals)
                
-               894        1034 LOAD_CONST              18 (<code object <listcomp>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 894>)
+               917        1034 LOAD_CONST              18 (<code object <listcomp>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 917>)
                           1036 MAKE_FUNCTION            0
                           1038 LOAD_FAST               12 (tick_vals)
                           1040 GET_ITER
                           1042 PRECALL                  0
                           1046 CALL                     0
                           1056 STORE_FAST              12 (tick_vals)
                
-               896     >> 1058 PUSH_NULL
+               919     >> 1058 PUSH_NULL
                           1060 LOAD_FAST                0 (cls)
                
-               897        1062 LOAD_FAST                9 (bar_heights)
+               920        1062 LOAD_FAST                9 (bar_heights)
                
-               898        1064 LOAD_FAST               10 (bar_values)
+               921        1064 LOAD_FAST               10 (bar_values)
                
-               899        1066 LOAD_FAST               12 (tick_vals)
+               922        1066 LOAD_FAST               12 (tick_vals)
                
-               900        1068 LOAD_FAST                4 (title)
+               923        1068 LOAD_FAST                4 (title)
                
-               896        1070 KW_NAMES                19
+               919        1070 KW_NAMES                19
                           1072 PRECALL                  4
                           1076 CALL                     4
                           1086 RETURN_VALUE
                consts
                   '\n        Args:\n            data: 1D tensor of data which will be turned into histogram\n            n_bins: Number of bins in the histogram\n            line_posn: List of possible positions of vertical lines we want to put on the histogram\n        \n        Returns a HistogramData object, with data computed from the inputs. This is to support the goal of only storing\n        the minimum necessary data (and making it serializable, for JSON saving).\n        '
                   0
                   1
@@ -5231,15 +5337,15 @@
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 6
                      flags     : 19
                      code
                         0x970067007c005d127d017401000000000000000000007c016400a60200
                         00ab02000000000000000091028c135300
-                     870           0 RESUME                   0
+                     893           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                18 (to 44)
                                    8 STORE_FAST               1 (x)
                                   10 LOAD_GLOBAL              1 (NULL + round)
                                   22 LOAD_FAST                1 (x)
                                   24 LOAD_CONST               0 (5)
@@ -5250,17 +5356,17 @@
                              >>   44 RETURN_VALUE
                      consts
                         5
                      names      ('round',)
                      varnames   ('.0', 'x')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
-                     firstlineno 870
+                     firstlineno 893
                      lnotab 0x
                   None
                   -1
                   2
                   ('ints', '5 ticks')
                   'ints'
                   '5 ticks'
@@ -5273,15 +5379,15 @@
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 19
                      code 0x9501970067007c005d087d0189020b007c017a05000091028c095300
                                    0 COPY_FREE_VARS           1
                      
-                     890           2 RESUME                   0
+                     913           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                 8 (to 26)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_DEREF               2 (tickrange)
                                   14 UNARY_NEGATIVE
                                   16 LOAD_FAST                1 (i)
@@ -5290,27 +5396,27 @@
                                   24 JUMP_BACKWARD            9 (to 8)
                              >>   26 RETURN_VALUE
                      consts
                      names      ()
                      varnames   ('.0', 'i')
                      freevars   ('tickrange',)
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
-                     firstlineno 890
+                     firstlineno 913
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 4
                      flags     : 19
                      code 0x9501970067007c005d077d0189027c017a05000091028c085300
                                    0 COPY_FREE_VARS           1
                      
-                     892           2 RESUME                   0
+                     915           2 RESUME                   0
                                    4 BUILD_LIST               0
                                    6 LOAD_FAST                0 (.0)
                              >>    8 FOR_ITER                 7 (to 24)
                                   10 STORE_FAST               1 (i)
                                   12 LOAD_DEREF               2 (tickrange)
                                   14 LOAD_FAST                1 (i)
                                   16 BINARY_OP                5 (*)
@@ -5318,27 +5424,27 @@
                                   22 JUMP_BACKWARD            8 (to 8)
                              >>   24 RETURN_VALUE
                      consts
                      names      ()
                      varnames   ('.0', 'i')
                      freevars   ('tickrange',)
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
-                     firstlineno 892
+                     firstlineno 915
                      lnotab 0x
                   code
                      argcount  : 1
                      nlocals   : 2
                      stacksize : 6
                      flags     : 19
                      code
                         0x970067007c005d127d017401000000000000000000007c016400a60200
                         00ab02000000000000000091028c135300
-                     894           0 RESUME                   0
+                     917           0 RESUME                   0
                                    2 BUILD_LIST               0
                                    4 LOAD_FAST                0 (.0)
                              >>    6 FOR_ITER                18 (to 44)
                                    8 STORE_FAST               1 (t)
                                   10 LOAD_GLOBAL              1 (NULL + round)
                                   22 LOAD_FAST                1 (t)
                                   24 LOAD_CONST               0 (1)
@@ -5349,37 +5455,37 @@
                              >>   44 RETURN_VALUE
                      consts
                         1
                      names      ('round',)
                      varnames   ('.0', 't')
                      freevars   ()
                      cellvars   ()
-                     filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+                     filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                      name       '<listcomp>'
-                     firstlineno 894
+                     firstlineno 917
                      lnotab 0x
                   ('bar_heights', 'bar_values', 'tick_vals', 'title')
                names      ('numel', 'max', 'item', 'min', 'torch', 'linspace', 'histc', 'int', 'tolist', 'arange', 'merge_lists', 'reversed', 'range')
                varnames   ('cls', 'data', 'n_bins', 'tickmode', 'title', 'max_value', 'min_value', 'bin_size', 'bin_edges', 'bar_heights', 'bar_values', 'top_tickval', 'tick_vals', 'num_positive_ticks', 'num_negative_ticks')
                freevars   ()
                cellvars   ('tickrange',)
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       'from_data'
-               firstlineno 840
+               firstlineno 863
                lnotab
                   0x0412300114034c014c0310013202740158040c010c011e0158010c020e
                   013601040128023801040124020c01560104013cfd100518020401020102
                   01020102fc
          names      ('__name__', '__module__', '__qualname__', '__doc__', 'field', 'list', 'bar_heights', 'float', '__annotations__', 'bar_values', 'tick_vals', 'title', 'Optional', 'str', 'classmethod', 'Type', 'T', 'Tensor', 'int', 'Literal', 'from_data')
          varnames   ()
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'HistogramData'
-         firstlineno 819
+         firstlineno 842
          lnotab
             0x0c03040d2e012e012e011a02020102010eff020202fe020302fd02040e
             fc02050efb020602fa06ff0e01
       'HistogramData'
       'abs'
       code
          argcount  : 2
@@ -5388,42 +5494,42 @@
          flags     : 3
          code
             0x97007401000000000000000000007c00a6010000ab0100000000000000
             0064016b02000000007202640253007c0172197403000000000000000000
             00640384007c004400a6000000ab000000000000000000a6010000ab0100
             0000000000000053007403000000000000000000007c00a6010000ab0100
             000000000000005300
-         907           0 RESUME                   0
+         930           0 RESUME                   0
          
-         915           2 LOAD_GLOBAL              1 (NULL + len)
+         938           2 LOAD_GLOBAL              1 (NULL + len)
                       14 LOAD_FAST                0 (myList)
                       16 PRECALL                  1
                       20 CALL                     1
                       30 LOAD_CONST               1 (0)
                       32 COMPARE_OP               2 (==)
                       38 POP_JUMP_FORWARD_IF_FALSE     2 (to 44)
          
-         916          40 LOAD_CONST               2 (1)
+         939          40 LOAD_CONST               2 (1)
                       42 RETURN_VALUE
          
-         918     >>   44 LOAD_FAST                1 (abs)
+         941     >>   44 LOAD_FAST                1 (abs)
                       46 POP_JUMP_FORWARD_IF_FALSE    25 (to 98)
          
-         919          48 LOAD_GLOBAL              3 (NULL + max)
-                      60 LOAD_CONST               3 (<code object <genexpr>, file "C:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 919>)
+         942          48 LOAD_GLOBAL              3 (NULL + max)
+                      60 LOAD_CONST               3 (<code object <genexpr>, file "c:\Users\calsm\Documents\AI Alignment\sae-vis\sae_vis\utils_fns.py", line 942>)
                       62 MAKE_FUNCTION            0
                       64 LOAD_FAST                0 (myList)
                       66 GET_ITER
                       68 PRECALL                  0
                       72 CALL                     0
                       82 PRECALL                  1
                       86 CALL                     1
                       96 RETURN_VALUE
          
-         921     >>   98 LOAD_GLOBAL              3 (NULL + max)
+         944     >>   98 LOAD_GLOBAL              3 (NULL + max)
                      110 LOAD_FAST                0 (myList)
                      112 PRECALL                  1
                      116 CALL                     1
                      126 RETURN_VALUE
          consts
             '\n    Returns max of a list, or 1 if the list is empty. \n\n    Args:\n        myList: List of numbers\n        abs: If True, then we take the max of the absolute values of the list\n    '
             0
@@ -5432,15 +5538,15 @@
                argcount  : 1
                nlocals   : 2
                stacksize : 5
                flags     : 51
                code
                   0x4b00010097007c005d157d017401000000000000000000007c017c010b
                   00a6020000ab0200000000000000005600970101008c1664005300
-               919           0 RETURN_GENERATOR
+               942           0 RETURN_GENERATOR
                              2 POP_TOP
                              4 RESUME                   0
                              6 LOAD_FAST                0 (.0)
                        >>    8 FOR_ITER                21 (to 52)
                             10 STORE_FAST               1 (x)
                             12 LOAD_GLOBAL              1 (NULL + max)
                             24 LOAD_FAST                1 (x)
@@ -5456,48 +5562,48 @@
                             54 RETURN_VALUE
                consts
                   None
                names      ('max',)
                varnames   ('.0', 'x')
                freevars   ()
                cellvars   ()
-               filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+               filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
                name       '<genexpr>'
-               firstlineno 919
+               firstlineno 942
                lnotab 0x
          names      ('len', 'max')
          varnames   ('myList', 'abs')
          freevars   ()
          cellvars   ()
-         filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+         filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
          name       'max_or_1'
-         firstlineno 907
+         firstlineno 930
          lnotab 0x02082601040204013202
       (None,)
       (True, (5, -5))
       ((5, -5),)
       (False,)
       (True,)
       ('left',)
       ('',)
    names      ('jaxtyping', 'Float', 'Int', 'Bool', 'typing', 'Tuple', 'Optional', 'Union', 'Dict', 'List', 'Literal', 'Any', 'overload', 'Callable', 'Type', 'TypeVar', 're', 'torch', 'Tensor', 'numpy', 'np', 'transformers.tokenization_utils_fast', 'PreTrainedTokenizerFast', 'tqdm', 'dataclasses', 'dataclass', 'field', 'dataclasses_json', 'dataclass_json', 'einops', 'eindex', 'time', 'json', 'transformer_lens', 'utils', 'T', 'device', 'get_device', 'ndarray', 'Arr', '__name__', 'MAIN', 'bool', 'str', 'create_iterator', 'int', 'k_largest_indices', 'sample_unique_indices', 'float', 'random_range_indices', 'list', 'get_decode_html_safe_fn', 'HTML_CHARS', 'HTML_ANOMALIES', 'HTML_QUOTES', 'HTML_ALL', 'process_str_tok', 'unprocess_str_tok', 'to_str_tokens', 'TopK', 'merge_lists', 'extract_and_remove_scripts', 'pad_with_zeros', 'SYMMETRIC_RANGES_AND_PRECISIONS', 'ASYMMETRIC_RANGES_AND_PRECISIONS', 'QuantileCalculator', 'N', 'stack', 'rand', 'masked_fill', 'to', 'data', 'from_data', 'qc', 'print', 'sum', 'quantile_data', 'numel', 'tensor', 'values', 'get_quantile', 'quantiles', 'precisions', 'zip', 'v', 'q', 'p', 'tuple', 'split_string', 'input_string', 'str1', 'str2', 'apply_indent', 'dict', 'deep_union', 'BatchedCorrCoef', 'HistogramData', 'max_or_1')
    varnames   ()
    freevars   ()
    cellvars   ()
-   filename   'C:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
+   filename   'c:\\Users\\calsm\\Documents\\AI Alignment\\sae-vis\\sae_vis\\utils_fns.py'
    name       '<module>'
    firstlineno 1
    lnotab
       0x00ff020314013401080108010c0108010c010c0110010c0108010c0108
       0108020c021607160f0e020c041e0b020102fc040112ff020202fe020302
       fd020412fc020512fb081e241002fc040112ff020202fe020312fd020412
-      fc020512fb083b481c0201020102010201020102010201020102f7060e02
-      010201020102fa0609020102fe06041402161d100e0201020138ff020202
-      fe020302fd06ff0e0102060201020138ff02020efe02030efd06ff0e0102
-      06020138ff02022afe020308fd08181a4c0608201802fd04010eff020202
-      fe02030efd02040efc08160a010a010a010a010afb04080a010a010afd04
-      070201020118ff0eff0e02027c060314010401ce012a014e014403520130
-      0216014a013c0116014a013c06020102ff020202fe020302fd020412fc08
-      1004010401040104012c020401040104012c0902fd040102ff020202fe02
-      0302fd020402fc081b1a3e0402320304010e010efe0e0314fd0c0604010e
-      010efe0e0310fd0c0604010a010afe0e030afd0c091a5c0201020118ff0e
-      ff0e020256
+      fc020512fb083b481c0201020102010201020102010201020102f7060c02
+      01020102010201020102fa0609020102fe06041402161d100e0201020138
+      ff020202fe020302fd06ff0e0102060201020138ff02020efe02030efd06
+      ff0e010206020138ff02022afe020308fd08181a4c0608201802fd04010e
+      ff020202fe02030efd02040efc08160a010a010a010a010afb04080a010a
+      010afd04070201020118ff0eff0e02027c060314010401ce012a014e0144
+      035201300216014a013c0116014a013c06020102ff020202fe020302fd02
+      0412fc081004010401040104012c020401040104012c0902fd040102ff02
+      0202fe020302fd020402fc081b1a3e0402320304010e010efe0e0314fd0c
+      0604010e010efe0e0310fd0c0604010a010afe0e030afd0c091a73020102
+      0118ff0eff0e020256
```

### Comparing `sae-vis-0.2.7/sae_vis/css/dropdown.css` & `sae-vis-0.2.8/sae_vis/css/dropdown.css`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/css/general.css` & `sae-vis-0.2.8/sae_vis/css/general.css`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/css/sequences.css` & `sae-vis-0.2.8/sae_vis/css/sequences.css`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/css/tables.css` & `sae-vis-0.2.8/sae_vis/css/tables.css`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/data_config_classes.py` & `sae-vis-0.2.8/sae_vis/data_config_classes.py`

 * *Files 5% similar despite different names*

```diff
@@ -31,15 +31,19 @@
 )
 
 LOGITS_TABLE_CONFIG_HELP = dict(
     n_rows = "Number of top/bottom logits to show in the table.",
 )
 
 FEATURE_TABLES_CONFIG_HELP = dict(
-    n_rows = "Number of rows to show for each feature table."
+    n_rows = "Number of rows to show for each feature table.",
+    neuron_alignment_table = "Whether to show the neuron alignment table.",
+    correlated_neurons_table = "Whether to show the correlated neurons table.",
+    correlated_features_table = "Whether to show the (pairwise) correlated features table.",
+    correlated_b_features_table = "Whether to show the correlated encoder-B features table.",
 )
 
 @dataclass
 class BaseComponentConfig:
 
     def data_is_contained_in(self, other) -> bool:
         '''
@@ -134,18 +138,28 @@
     def help_dict(self) -> dict[str, str]:
         return LOGITS_TABLE_CONFIG_HELP
 
 
 @dataclass
 class FeatureTablesConfig(BaseComponentConfig):
     n_rows: int = 3
+    neuron_alignment_table: bool = True
+    correlated_neurons_table: bool = True
+    correlated_features_table: bool = True
+    correlated_b_features_table: bool = False
 
     def data_is_contained_in(self, other) -> bool:
         assert isinstance(other, self.__class__)
-        return self.n_rows <= other.n_rows
+        return all([
+            self.n_rows <= other.n_rows,
+            self.neuron_alignment_table <= other.neuron_alignment_table,
+            self.correlated_neurons_table <= other.correlated_neurons_table,
+            self.correlated_features_table <= other.correlated_features_table,
+            self.correlated_b_features_table <= other.correlated_b_features_table,
+        ])
 
     @property
     def help_dict(self) -> dict[str, str]:
         return FEATURE_TABLES_CONFIG_HELP
 
 
 GenericComponentConfig = Union[
@@ -196,27 +210,27 @@
             quantile groups).
         act_hist_cfg:
             The `ActsHistogramConfig` object, which contains all the parameters for the activations histogram.
         logits_hist_cfg:
             The `LogitsHistogramConfig` object, which contains all the parameters for the logits histogram.
         logits_table_cfg:
             The `LogitsTableConfig` object, which contains all the parameters for the logits table.
-        feat_tables_cfg:
+        feature_tables_cfg:
             The `FeatureTablesConfig` object, which contains all the parameters for the feature tables.
         prompt_cfg:
             The `PromptConfig` object, which contains all the parameters for the prompt-centric vis.
     '''
     columns: dict[int | tuple[int, int], Column] = field(default_factory=dict)
     height: int = 750
 
     seq_cfg: SequencesConfig | None = None
     act_hist_cfg: ActsHistogramConfig | None = None
     logits_hist_cfg: LogitsHistogramConfig | None = None
     logits_table_cfg: LogitsTableConfig | None = None
-    feat_tables_cfg: FeatureTablesConfig | None = None
+    feature_tables_cfg: FeatureTablesConfig | None = None
     prompt_cfg: PromptConfig | None = None
 
     def __init__(self, columns: list[Column], **kwargs):
         '''
         The __init__ method will allow you to extract things like `self.seq_cfg` from the object (even though they're 
         initially stored in the `columns` attribute). It also verifies that there are no duplicate components (which is
         redundant, and could mess up the HTML).
@@ -240,15 +254,15 @@
                 case "ActsHistogram":
                     self.act_hist_cfg = comp
                 case "LogitsHistogram":
                     self.logits_hist_cfg = comp
                 case "LogitsTable":
                     self.logits_table_cfg = comp
                 case "FeatureTables":
-                    self.feat_tables_cfg = comp
+                    self.feature_tables_cfg = comp
                 case _:
                     raise ValueError(f"Unknown component name {comp_name}")
 
     def data_is_contained_in(self, other: "SaeVisLayoutConfig") -> bool:
         '''
         Returns True if `self` uses only data that would already exist in `other`. This is useful because our prompt-
         centric vis needs to only use data that was already computed as part of our initial data gathering. For example,
```

### Comparing `sae-vis-0.2.7/sae_vis/data_fetching_fns.py` & `sae-vis-0.2.8/sae_vis/data_fetching_fns.py`

 * *Files 2% similar despite different names*

```diff
@@ -54,14 +54,15 @@
 
 def compute_feat_acts(
     model_acts: Float[Tensor, "batch seq d_in"],
     feature_idx: Int[Tensor, "feats"],
     encoder: AutoEncoder,
     encoder_B: Optional[AutoEncoder] = None,
     corrcoef_neurons: Optional[BatchedCorrCoef] = None,
+    corrcoef_encoder: Optional[BatchedCorrCoef] = None,
     corrcoef_encoder_B: Optional[BatchedCorrCoef] = None,
 ) -> Float[Tensor, "batch seq feats"]:
     '''
     This function computes the feature activations, given a bunch of model data. It also updates the rolling correlation
     coefficient objects, if they're given.
 
     Args:
@@ -71,14 +72,16 @@
             The features we're computing the activations for. This will be used to index the encoder's weights.
         encoder: AutoEncoder
             The encoder object, which we use to calculate the feature activations.
         encoder_B: Optional[AutoEncoder]
             The encoder-B object, which we use to calculate the feature activations.
         corrcoef_neurons: Optional[BatchedCorrCoef]
             The object storing the minimal data necessary to compute corrcoef between feature activations & neurons.
+        corrcoef_encoder: Optional[BatchedCorrCoef]
+            The object storing the minimal data necessary to compute corrcoef between pairwise feature activations.
         corrcoef_encoder_B: Optional[BatchedCorrCoef]
             The object storing minimal data to compute corrcoef between feature activations & encoder-B features.
     '''
     # Get the feature act direction by indexing encoder.W_enc, and the bias by indexing encoder.b_enc
     feature_act_dir = encoder.W_enc[:, feature_idx] # (d_in, feats)
     feature_bias = encoder.b_enc[feature_idx] # (feats,)
 
@@ -90,15 +93,22 @@
     # Update the CorrCoef object between feature activation & neurons
     if corrcoef_neurons is not None:
         corrcoef_neurons.update(
             einops.rearrange(feat_acts, "batch seq feats -> feats (batch seq)"),
             einops.rearrange(model_acts, "batch seq d_in -> d_in (batch seq)"),
         )
         
-    # Calculate encoder-B feature acts (we don't need to store them, cause it's just for the left-side feature tables)
+    # Update the CorrCoef object between pairwise feature activations
+    if corrcoef_encoder is not None:
+        corrcoef_encoder.update(
+            einops.rearrange(feat_acts, "batch seq feats -> feats (batch seq)"),
+            einops.rearrange(feat_acts, "batch seq feats -> feats (batch seq)"),
+        )
+
+    # Calculate encoder-B feature acts (we don't need to store encoder-B acts; it's just for left-hand feature tables)
     if corrcoef_encoder_B is not None:
         assert encoder_B is not None,\
             "Error: you need to supply an encoder-B object if you want to calculate encoder-B feature activations."
         x_cent_B = model_acts - encoder_B.b_dec
         feat_acts_pre_B = einops.einsum(x_cent_B, encoder_B.W_enc, "batch seq d_in, d_in d_hidden -> batch seq d_hidden")
         feat_acts_B = F.relu(feat_acts_pre_B + encoder.b_enc)
 
@@ -119,14 +129,15 @@
     all_feat_acts: Float[Tensor, "... feats"],
     feature_resid_dir: Float[Tensor, "feats d_model"],
     all_resid_post: Float[Tensor, "... d_model"],
     W_U: Float[Tensor, "d_model d_vocab"],
     cfg: SaeVisConfig,
     feature_out_dir: Optional[Float[Tensor, "feats d_out"]] = None,
     corrcoef_neurons: Optional[BatchedCorrCoef] = None,
+    corrcoef_encoder: Optional[BatchedCorrCoef] = None,
     corrcoef_encoder_B: Optional[BatchedCorrCoef] = None,
     progress: Optional[list[tqdm]] = None,
 ) -> tuple[SaeVisData, dict[str, float]]:
     """Convert generic activation data into a SaeVisData object, which can be used to create the feature-centric vis.
 
     This function exists so that feature dashboards can be generated without using our AutoEncoder or
     TransformerLens(Wrapper) classes. We pass through W_U & other data needed for computing the logit lens, so we don't
@@ -159,14 +170,17 @@
         feature_out_dir: Optional[Float[Tensor, "feats d_out"]]
             The directions that each SAE feature writes to the residual stream. This will be the same as 
             feature_resid_dir if the SAE is in the residual stream (as we will assume if it not provided)
             For example, feature_out_dir = encoder.W_dec[feature_indices] # [feats d_autoencoder]
         
         corrcoef_neurons: Optional[BatchedCorrCoef]
             The object storing the minimal data necessary to compute corrcoef between feature activations & neurons.
+        
+        corrcoef_encoder: Optional[BatchedCorrCoef]
+            The object storing the minimal data necessary to compute corrcoef between feature activations (pairwise).
 
         corrcoef_encoder_B: Optional[BatchedCorrCoef]
             The object storing minimal data to compute corrcoef between feature activations & encoder-B features.
 
         progress: Optional[list[tqdm]]
             An optional list containing progress bars for the forward passes and the sequence data. This is used to
             update the progress bars as the computation runs.
@@ -205,47 +219,79 @@
     layout = cfg.feature_centric_layout
     assert isinstance(layout, SaeVisLayoutConfig),\
         f"Error: cfg.feature_centric_layout must be a SaeVisLayoutConfig object, got {type(layout)}"
 
 
     # ! Calculate all data for the left-hand column visualisations, i.e. the 3 tables
 
-    if layout.feat_tables_cfg is not None and feature_out_dir is not None:
+    if layout.feature_tables_cfg is not None and feature_out_dir is not None:
+
+        # Store kwargs (makes it easier to turn the tables on and off individually)
+        feature_tables_data_kwargs = defaultdict(dict)
 
         # Table 1: neuron alignment, based on decoder weights
-        top3_neurons_aligned = TopK(tensor=feature_out_dir, k=layout.feat_tables_cfg.n_rows, largest=True)
-        feature_out_l1_norm = feature_out_dir.abs().sum(dim=-1, keepdim=True)
-        pct_of_l1: Arr = np.absolute(top3_neurons_aligned.values) / utils.to_numpy(feature_out_l1_norm)
+        if layout.feature_tables_cfg.neuron_alignment_table:
+            top3_neurons_aligned = TopK(tensor=feature_out_dir, k=layout.feature_tables_cfg.n_rows, largest=True)
+            feature_out_l1_norm = feature_out_dir.abs().sum(dim=-1, keepdim=True)
+            pct_of_l1: Arr = np.absolute(top3_neurons_aligned.values) / utils.to_numpy(feature_out_l1_norm)
+            for i in range(len(feature_indices)):
+                feature_tables_data_kwargs[i].update(
+                    neuron_alignment_indices = top3_neurons_aligned[i].indices.tolist(),
+                    neuron_alignment_values = top3_neurons_aligned[i].values.tolist(),
+                    neuron_alignment_l1 = pct_of_l1[i].tolist(),
+                )
         
         # Table 2: neurons correlated with this feature, based on their activations
-        assert isinstance(corrcoef_neurons, BatchedCorrCoef),\
-            f"Error: corrcoef_neurons should be of type BatchedCorrCoef, instead we got {type(corrcoef_neurons)}"
-        neuron_indices, neuron_pearson, neuron_cossim = corrcoef_neurons.topk_pearson(k=layout.feat_tables_cfg.n_rows)
+        if layout.feature_tables_cfg.correlated_neurons_table:
+            assert isinstance(corrcoef_neurons, BatchedCorrCoef),\
+                f"Error: corrcoef_neurons should be of type BatchedCorrCoef, instead we got {type(corrcoef_neurons)}"
+            neuron_indices, neuron_pearson, neuron_cossim = corrcoef_neurons.topk_pearson(
+                k=layout.feature_tables_cfg.n_rows, exclude_diag=False,
+            )
+            for i in range(len(feature_indices)):
+                feature_tables_data_kwargs[i].update(
+                    correlated_neurons_indices = neuron_indices[i],
+                    correlated_neurons_pearson = neuron_pearson[i],
+                    correlated_neurons_cossim = neuron_cossim[i],
+                )
+
+        # Table 3: primary encoder features correlated with this feature, based on their activations
+        if layout.feature_tables_cfg.correlated_features_table:
+            assert isinstance(corrcoef_encoder, BatchedCorrCoef),\
+                f"Error: corrcoef_encoder should be of type BatchedCorrCoef, instead we got {type(corrcoef_encoder)}"
+            enc_indices, enc_pearson, enc_cossim = corrcoef_encoder.topk_pearson(
+                k=layout.feature_tables_cfg.n_rows, exclude_diag=True,
+            )
+            for i in range(len(feature_indices)):
+                feature_tables_data_kwargs[i].update(
+                    correlated_features_indices = enc_indices[i],
+                    correlated_features_pearson = enc_pearson[i],
+                    correlated_features_cossim = enc_cossim[i],
+                )
         
-        # Table 3: encoder-B features correlated with this feature, based on their activations. Note that we don't need
+        # Table 4: encoder-B features correlated with this feature, based on their activations. Note that we don't need
         # to calculate this if we're not using encoder_B
-        encB_indices = encB_pearson = encB_cossim = [[] for _ in feature_indices]
-        if (corrcoef_encoder_B is not None):
+        if layout.feature_tables_cfg.correlated_b_features_table:
+            assert corrcoef_encoder_B is not None,\
+                f"Error: encoder_B is None, but you've set `correlated_b_features_table=True` in the layout."
             assert isinstance(corrcoef_encoder_B, BatchedCorrCoef),\
                 f"Error: corrcoef_encoder_B should be of type BatchedCorrCoef, instead we got {type(corrcoef_encoder_B)}"
-            encB_indices, encB_pearson, encB_cossim = corrcoef_encoder_B.topk_pearson(k=layout.feat_tables_cfg.n_rows)
-        
+            encB_indices, encB_pearson, encB_cossim = corrcoef_encoder_B.topk_pearson(
+                k=layout.feature_tables_cfg.n_rows, exclude_diag=False,
+            )
+            for i in range(len(feature_indices)):
+                feature_tables_data_kwargs[i].update(
+                    correlated_b_features_indices = encB_indices[i],
+                    correlated_b_features_pearson = encB_pearson[i],
+                    correlated_b_features_cossim = encB_cossim[i],
+                )
+                
         # Add all this data to the list of FeatureTablesData objects
         for i, feat in enumerate(feature_indices):
-            feature_data_dict[feat].feature_tables_data = FeatureTablesData(
-                neuron_alignment_indices = top3_neurons_aligned[i].indices.tolist(),
-                neuron_alignment_values = top3_neurons_aligned[i].values.tolist(),
-                neuron_alignment_l1 = pct_of_l1[i].tolist(),
-                correlated_neurons_indices = neuron_indices[i],
-                correlated_neurons_pearson = neuron_pearson[i],
-                correlated_neurons_cossim = neuron_cossim[i],
-                correlated_features_indices = encB_indices[i],
-                correlated_features_pearson = encB_pearson[i],
-                correlated_features_cossim = encB_cossim[i],
-            )
+            feature_data_dict[feat].feature_tables_data = FeatureTablesData(**feature_tables_data_kwargs[i])
 
     time_logs["(4) Getting data for tables"] = time.time() - t0
     t0 = time.time()
 
 
     # ! Get all data for the middle column visualisations, i.e. the two histograms & the logit table
 
@@ -405,14 +451,15 @@
 
     # Create lists to store the feature activations & final values of the residual stream
     all_resid_post = []
     all_feat_acts = []
 
     # Create objects to store the data for computing correlation coefficients (for left tables), if we're using them
     corrcoef_neurons = BatchedCorrCoef()
+    corrcoef_encoder = BatchedCorrCoef()
     corrcoef_encoder_B = BatchedCorrCoef() if encoder_B is not None else None
 
     # Get encoder & decoder directions
     feature_out_dir = encoder.W_dec[feature_indices] # [feats d_autoencoder]
     feature_resid_dir = to_resid_dir(feature_out_dir, model) # [feats d_model]
 
     time_logs["(1) Initialization"] = time.time() - t0
@@ -424,15 +471,23 @@
         # Fwd pass, get model activations
         t0 = time.time()
         residual, model_acts = model.forward(minibatch, return_logits=False)
         time_logs["(2) Forward passes to gather model activations"] += time.time() - t0
         
         # Compute feature activations from this
         t0 = time.time()
-        feat_acts = compute_feat_acts(model_acts, feature_idx_tensor, encoder, encoder_B, corrcoef_neurons, corrcoef_encoder_B)
+        feat_acts = compute_feat_acts(
+            model_acts=model_acts,
+            feature_idx=feature_idx_tensor,
+            encoder=encoder,
+            encoder_B=encoder_B,
+            corrcoef_neurons=corrcoef_neurons,
+            corrcoef_encoder=corrcoef_encoder,
+            corrcoef_encoder_B=corrcoef_encoder_B,
+        )
         time_logs["(3) Computing feature acts from model acts"] += time.time() - t0
 
         # Add these to the lists (we'll eventually concat)
         all_feat_acts.append(feat_acts)
         all_resid_post.append(residual)
 
         # Update the 1st progress bar (fwd passes & getting sequence data dominates the runtime of these computations)
@@ -449,14 +504,15 @@
         all_feat_acts = all_feat_acts,
         feature_resid_dir = feature_resid_dir,
         all_resid_post = all_resid_post,
         W_U = model.W_U,
         cfg = cfg,
         feature_out_dir = feature_out_dir,
         corrcoef_neurons = corrcoef_neurons,
+        corrcoef_encoder = corrcoef_encoder,
         corrcoef_encoder_B = corrcoef_encoder_B,
         progress = progress,
     )
 
     assert set(time_logs.keys()) & set(_time_logs.keys()) == set(),\
         f"Invalid keys: {set(time_logs.keys()) & set(_time_logs.keys())} should have zero overlap"
```

### Comparing `sae-vis-0.2.7/sae_vis/data_storing_fns.py` & `sae-vis-0.2.8/sae_vis/data_storing_fns.py`

 * *Files 2% similar despite different names*

```diff
@@ -5,14 +5,15 @@
 from typing import Optional, Union, Any, Callable
 from dataclasses import dataclass, field
 from dataclasses_json import dataclass_json
 from jaxtyping import Int
 import re
 from copy import deepcopy
 import json
+from tqdm.auto import tqdm
 
 from transformer_lens import HookedTransformer
 
 from sae_vis.model_fns import AutoEncoder
 
 from sae_vis.utils_fns import (
     to_str_tokens,
@@ -62,26 +63,33 @@
 
         correlated_neurons...
             The data for the correlated neurons table (each of its 3 columns). In other words, the data containing which
             neurons in the transformer are most correlated with the encoder feature.
 
         correlated_features...
             The data for the correlated features table (each of its 3 columns). In other words, the data containing
+            which features in this encoder are most correlated with each other.
+        
+        correlated_b_features...
+            The data for the correlated features table (each of its 3 columns). In other words, the data containing
             which features in encoder-B are most correlated with those in the original encoder. Note, this one might be
             absent if we're not using a B-encoder.
     '''
     neuron_alignment_indices: list[int] = field(default_factory=list)
     neuron_alignment_values: list[float] = field(default_factory=list)
     neuron_alignment_l1: list[float] = field(default_factory=list)
     correlated_neurons_indices: list[int] = field(default_factory=list)
     correlated_neurons_pearson: list[float] = field(default_factory=list)
     correlated_neurons_cossim: list[float] = field(default_factory=list)
     correlated_features_indices: list[int] = field(default_factory=list)
     correlated_features_pearson: list[float] = field(default_factory=list)
     correlated_features_cossim: list[float] = field(default_factory=list)
+    correlated_b_features_indices: list[int] = field(default_factory=list)
+    correlated_b_features_pearson: list[float] = field(default_factory=list)
+    correlated_b_features_cossim: list[float] = field(default_factory=list)
 
     def _get_html_data(
         self,
         cfg: FeatureTablesConfig,
         decode_fn: Callable[[int | list[int]], str | list[str]],
         id_suffix: str,
         column: int | tuple[int, int],
@@ -89,53 +97,48 @@
     ) -> HTML:
         '''
         Returns the HTML for the left-hand tables, wrapped in a 'grid-column' div.
 
         Note, we only ever use this obj in the context of the left-hand column of the feature-centric vis, and it's
         always the same width & height, which is why there's no customization available for this function.
         '''
-        # Crop the lists to `cfg.n_rows` (first checking the config doesn't ask for more rows than we have)
-        assert cfg.n_rows <= len(self.neuron_alignment_indices)
-        neuron_alignment_indices = self.neuron_alignment_indices[:cfg.n_rows]
-        neuron_alignment_values = self.neuron_alignment_values[:cfg.n_rows]
-        neuron_alignment_l1 = self.neuron_alignment_l1[:cfg.n_rows]
-        correlated_neurons_indices = self.correlated_neurons_indices[:cfg.n_rows]
-        correlated_neurons_pearson = self.correlated_neurons_pearson[:cfg.n_rows]
-        correlated_neurons_cossim = self.correlated_neurons_cossim[:cfg.n_rows]
-
         # Read HTML from file, and replace placeholders with real ID values
         html_str = (Path(__file__).parent / "html" / "feature_tables_template.html").read_text()
         html_str = html_str.replace("FEATURE_TABLES_ID", f"feature-tables-{id_suffix}")
 
-        # Add the neuron alignment and neuron correlation data to the object which will be turned into JavaScript
-        data: dict[str, Any] = {
-            "neuronAlignment": [
-                {"index": I, "value": f"{V:+.3f}", "percentageL1": f"{L:.1%}"}
-                for I, V, L in zip(neuron_alignment_indices, neuron_alignment_values, neuron_alignment_l1)
-            ],
-            "correlatedNeurons": [
-                {"index": I, "value": f"{P:+.3f}", "percentageL1": f"{C:+.3f}"}
-                for I, P, C in zip(correlated_neurons_indices, correlated_neurons_pearson, correlated_neurons_cossim)
-            ],
-        }
+        # Create dictionary storing the data
+        data: dict[str, list[dict]] = {}
 
-        # If we have correlated features from encoder_B, add that to the JavaScript data
-        if len(self.correlated_features_indices) > 0:
-            correlated_features_indices = self.correlated_features_indices[:cfg.n_rows]
-            correlated_features_pearson = self.correlated_features_pearson[:cfg.n_rows]
-            correlated_features_cossim = self.correlated_features_cossim[:cfg.n_rows]
-
-            assert (correlated_features_pearson is not None) and (correlated_features_cossim is not None), "All or none"
-            data["correlatedFeaturesB"] = [
-                {"index": I, "value": f"{P:+.3f}", "percentageL1": f"{C:+.3f}"}
-                for I, P, C in zip(correlated_features_indices, correlated_features_pearson, correlated_features_cossim)
+        # Store the neuron alignment data, if it exists
+        if len(self.neuron_alignment_indices) > 0:
+            assert len(self.neuron_alignment_indices) >= cfg.n_rows, "Not enough rows!"
+            data["neuronAlignment"] = [
+                {"index": I, "value": f"{V:+.3f}", "percentageL1": f"{L:.1%}"}
+                for I, V, L in zip(
+                    self.neuron_alignment_indices,
+                    self.neuron_alignment_values,
+                    self.neuron_alignment_l1
+                )
             ]
-        # If not, remove that table from the HTML string
-        else:
-            html_str = re.sub(r'<h4>CORRELATED FEATURES \(B-ENCODER\)</h4>.*?</table>', "", html_str, flags=re.DOTALL)
+
+        # Store the other 3, if they exist (they're all in the same format, so we can do it in a for loop)
+        for name, js_name in zip(
+            ["correlated_neurons", "correlated_features", "correlated_b_features"],
+            ["correlatedNeurons", "correlatedFeatures", "correlatedFeaturesB"],
+        ):
+            if len(getattr(self, f"{name}_indices")) > 0:
+                assert len(getattr(self, f"{name}_indices")) >= cfg.n_rows, "Not enough rows!"
+                data[js_name] = [
+                    {"index": I, "value": f"{P:+.3f}", "percentageL1": f"{C:+.3f}"}
+                    for I, P, C in zip(
+                        getattr(self, f"{name}_indices")[:cfg.n_rows],
+                        getattr(self, f"{name}_pearson")[:cfg.n_rows],
+                        getattr(self, f"{name}_cossim")[:cfg.n_rows]
+                    )
+                ]
 
         return HTML(
             html_data = {column: html_str},
             js_data = {"featureTablesData": {id_suffix: data}}
         )
 
 
@@ -915,15 +918,18 @@
         first_feature = next(iter(self.feature_data_dict)) if (feature_idx is None) else feature_idx
 
         # Get tokenize function (we only need to define it once)
         assert self.model is not None
         decode_fn = get_decode_html_safe_fn(self.model.tokenizer)
 
         # For each FeatureData object, we get the html_obj for it's feature-centric vis, and merge it with HTML_OBJ
-        for feature, feature_data in self.feature_data_dict.items():
+        iterator = list(self.feature_data_dict.items())
+        if self.cfg.verbose: iterator = tqdm(iterator, desc="Saving feature-centric vis")
+
+        for feature, feature_data in iterator:
 
             # Get the HTML object for a single-feature view
             html_obj = feature_data._get_html_data_feature_centric(self.cfg.feature_centric_layout, decode_fn)
 
             # Add the JavaScript, and arbitrarily set html_str to be the first feature's html_str (they're all same!)
             HTML_OBJ.js_data[str(feature)] = deepcopy(html_obj.js_data)
             if feature == first_feature: HTML_OBJ.html_data = deepcopy(html_obj.html_data)
```

### Comparing `sae-vis-0.2.7/sae_vis/html_fns.py` & `sae-vis-0.2.8/sae_vis/html_fns.py`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/js/_createDropdownsScript.js` & `sae-vis-0.2.8/sae_vis/js/_createDropdownsScript.js`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/js/actsHistogramScript.js` & `sae-vis-0.2.8/sae_vis/js/actsHistogramScript.js`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/js/featureTablesScript.js` & `sae-vis-0.2.8/sae_vis/js/featureTablesScript.js`

 * *Files 5% similar despite different names*

#### js-beautify {}

```diff
@@ -43,23 +43,27 @@
         .enter()
         .append('td')
         .attr('class', (d, i) => i === 0 ? 'left-aligned' : 'right-aligned')
         .html(d => d);
 }
 
 // Define some data which will tell us how to create our tables (this isn't a function of data, it's always the same)
-var featureTablesMetaData = [{
+const featureTablesMetaData = [{
     title: "NEURON ALIGNMENT",
     columns: ["Index", "Value", "% of L<sub>1</sub>"],
     dataKey: "neuronAlignment"
 }, {
     title: "CORRELATED NEURONS",
     columns: ["Index", "Pearson Corr.", "Cosine Sim."],
     dataKey: "correlatedNeurons"
 }, {
+    title: "CORRELATED FEATURES",
+    columns: ["Index", "Pearson Corr.", "Cosine Sim."],
+    dataKey: "correlatedFeatures"
+}, {
     title: "CORRELATED FEATURES (B-ENCODER)",
     columns: ["Index", "Pearson Corr.", "Cosine Sim."],
     dataKey: "correlatedFeaturesB"
 }, ]
 
 // 'featureTablesData' is a dictionary mapping suffixes to feature tables data (to make each table unique)
 // We iterate over it, and create a table for each one
```

### Comparing `sae-vis-0.2.7/sae_vis/js/gridColumnTitlesScript.js` & `sae-vis-0.2.8/sae_vis/js/gridColumnTitlesScript.js`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/js/logitsHistogramScript.js` & `sae-vis-0.2.8/sae_vis/js/logitsHistogramScript.js`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/js/logitsTableScript.js` & `sae-vis-0.2.8/sae_vis/js/logitsTableScript.js`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/js/tokenScript.js` & `sae-vis-0.2.8/sae_vis/js/tokenScript.js`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/model_fns.py` & `sae-vis-0.2.8/sae_vis/model_fns.py`

 * *Files identical despite different names*

### Comparing `sae-vis-0.2.7/sae_vis/utils_fns.py` & `sae-vis-0.2.8/sae_vis/utils_fns.py`

 * *Files 1% similar despite different names*

```diff
@@ -765,54 +765,77 @@
         self.n += x.shape[-1]
         self.x_sum += einops.reduce(x, "X N -> X", "sum")
         self.y_sum += einops.reduce(y, "Y N -> Y", "sum")
         self.xy_sum += einops.einsum(x, y, "X N, Y N -> X Y")
         self.x2_sum += einops.reduce(x ** 2, "X N -> X", "sum")
         self.y2_sum += einops.reduce(y ** 2, "Y N -> Y", "sum")
 
-    def corrcoef(self) -> Tuple[Float[Tensor, "X Y"], Float[Tensor, "X Y"]]:
+    def corrcoef(
+        self,
+        exclude_diag: bool = False,
+    ) -> Tuple[Float[Tensor, "X Y"], Float[Tensor, "X Y"]]:
+        '''
+        Computes the correlation coefficients between x and y, using the formulae given in the class docstring.
 
+        Args:
+            exclude_diag: bool
+                If True, we assume X and Y are the same dataset, and we don't include the diagonal in the topk (since
+                correlation with self is always 1, this is not interesting).
+        '''
+        # Compute cosine sim
         cossim_numer = self.xy_sum
         cossim_denom = torch.sqrt(torch.outer(self.x2_sum, self.y2_sum)) + 1e-6
         cossim = cossim_numer / cossim_denom
 
+        # Compute pearson corrcoef
         pearson_numer = self.n * self.xy_sum - torch.outer(self.x_sum, self.y_sum)
         pearson_denom = torch.sqrt(torch.outer(self.n * self.x2_sum - self.x_sum ** 2, self.n * self.y2_sum - self.y_sum ** 2)) + 1e-6
         pearson = pearson_numer / pearson_denom
 
+        # Exclude the diagonal if necessary (check datasets are the same shape first)
+        if exclude_diag:
+            d = cossim.shape[0]
+            assert tuple(cossim.shape) == tuple(pearson.shape) == (d, d), "X and Y should be the same dataset"
+            cossim[range(d), range(d)] = 0.0
+            pearson[range(d), range(d)] = 0.0
+
         return pearson, cossim
 
     def topk_pearson(
         self,
         k: int,
         largest: bool = True,
+        exclude_diag: bool = False,
     ) -> Tuple[list[list[int]], list[list[float]], list[list[float]]]:
         '''
         Takes topk of the pearson corrcoefs over the y-dimension (e.g. giving us the most correlated neurons or most
         correlated encoder-B features for each encoder feature).
 
         Args:
             k: int
                 Number of top indices to take (usually 3, for the left-hand tables)
             largest: bool
                 If True, then we take the largest k indices. If False, then we take the smallest k indices.
+            exclude_diag: bool
+                If True, we assume X and Y are the same dataset, and we don't include the diagonal in the topk (since
+                correlation with self is always 1, this is not interesting).
 
         Returns:
             pearson_indices: list[list[int]]
                 y-indices which are most correlated with each x-index (in terms of pearson corrcoef)
             pearson_values: list[list[float]]
                 Values of pearson corrcoef for each of the topk indices
             cossim_values: list[list[float]]
                 Values of cosine similarity for each of the topk indices
         '''
         # Get correlation coefficient, using the formula from corrcoef method
-        pearson, cossim = self.corrcoef()
+        pearson, cossim = self.corrcoef(exclude_diag=exclude_diag)
 
         # Get the top pearson values
-        pearson_topk = TopK(pearson, k, largest) # shape (X, k)
+        pearson_topk = TopK(tensor=pearson, k=k, largest=largest) # shape (X, k)
 
         # Get the cossim values for the top pearson values, i.e. cossim_values[X, k] = cossim[X, pearson_indices[X, k]]
         cossim_values = eindex(cossim, pearson_topk.indices, "X [X k]")
         
         return pearson_topk.indices.tolist(), pearson_topk.values.tolist(), cossim_values.tolist()
```

### Comparing `sae-vis-0.2.7/sae_vis.egg-info/SOURCES.txt` & `sae-vis-0.2.8/sae_vis.egg-info/SOURCES.txt`

 * *Files identical despite different names*

